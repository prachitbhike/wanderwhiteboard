var M5=Object.defineProperty;var H1=e=>{throw TypeError(e)};var A5=(e,t,n)=>t in e?M5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var S=(e,t,n)=>A5(e,typeof t!="symbol"?t+"":t,n),oy=(e,t,n)=>t.has(e)||H1("Cannot "+n);var Y=(e,t,n)=>(oy(e,t,"read from private field"),n?n.call(e):t.get(e)),De=(e,t,n)=>t.has(e)?H1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),we=(e,t,n,r)=>(oy(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Zt=(e,t,n)=>(oy(e,t,"access private method"),n);var mh=(e,t,n,r)=>({set _(o){we(e,t,o,n)},get _(){return Y(e,t,r)}});function R5(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const s=Object.getOwnPropertyDescriptor(r,o);s&&Object.defineProperty(e,o,s.get?s:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var Kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var J2={exports:{}},Lg={},eI={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd=Symbol.for("react.element"),O5=Symbol.for("react.portal"),j5=Symbol.for("react.fragment"),D5=Symbol.for("react.strict_mode"),N5=Symbol.for("react.profiler"),$5=Symbol.for("react.provider"),L5=Symbol.for("react.context"),F5=Symbol.for("react.forward_ref"),z5=Symbol.for("react.suspense"),B5=Symbol.for("react.memo"),U5=Symbol.for("react.lazy"),V1=Symbol.iterator;function H5(e){return e===null||typeof e!="object"?null:(e=V1&&e[V1]||e["@@iterator"],typeof e=="function"?e:null)}var tI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nI=Object.assign,rI={};function ic(e,t,n){this.props=e,this.context=t,this.refs=rI,this.updater=n||tI}ic.prototype.isReactComponent={};ic.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ic.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oI(){}oI.prototype=ic.prototype;function kx(e,t,n){this.props=e,this.context=t,this.refs=rI,this.updater=n||tI}var Ex=kx.prototype=new oI;Ex.constructor=kx;nI(Ex,ic.prototype);Ex.isPureReactComponent=!0;var K1=Array.isArray,sI=Object.prototype.hasOwnProperty,Ix={current:null},iI={key:!0,ref:!0,__self:!0,__source:!0};function aI(e,t,n){var r,o={},s=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)sI.call(t,r)&&!iI.hasOwnProperty(r)&&(o[r]=t[r]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:kd,type:e,key:s,ref:i,props:o,_owner:Ix.current}}function V5(e,t){return{$$typeof:kd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _x(e){return typeof e=="object"&&e!==null&&e.$$typeof===kd}function K5(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var W1=/\/+/g;function sy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?K5(""+e.key):t.toString(36)}function xp(e,t,n,r,o){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case kd:case O5:i=!0}}if(i)return i=e,o=o(i),e=r===""?"."+sy(i,0):r,K1(o)?(n="",e!=null&&(n=e.replace(W1,"$&/")+"/"),xp(o,t,n,"",function(c){return c})):o!=null&&(_x(o)&&(o=V5(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(W1,"$&/")+"/")+e)),t.push(o)),1;if(i=0,r=r===""?".":r+":",K1(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+sy(s,a);i+=xp(s,t,n,l,o)}else if(l=H5(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+sy(s,a++),i+=xp(s,t,n,l,o);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function yh(e,t,n){if(e==null)return e;var r=[],o=0;return xp(e,r,"","",function(s){return t.call(n,s,o++)}),r}function W5(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _n={current:null},wp={transition:null},G5={ReactCurrentDispatcher:_n,ReactCurrentBatchConfig:wp,ReactCurrentOwner:Ix};function lI(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:yh,forEach:function(e,t,n){yh(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return yh(e,function(){t++}),t},toArray:function(e){return yh(e,function(t){return t})||[]},only:function(e){if(!_x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=ic;ke.Fragment=j5;ke.Profiler=N5;ke.PureComponent=kx;ke.StrictMode=D5;ke.Suspense=z5;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G5;ke.act=lI;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=nI({},e.props),o=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Ix.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)sI.call(t,l)&&!iI.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:kd,type:e.type,key:o,ref:s,props:r,_owner:i}};ke.createContext=function(e){return e={$$typeof:L5,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$5,_context:e},e.Consumer=e};ke.createElement=aI;ke.createFactory=function(e){var t=aI.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:F5,render:e}};ke.isValidElement=_x;ke.lazy=function(e){return{$$typeof:U5,_payload:{_status:-1,_result:e},_init:W5}};ke.memo=function(e,t){return{$$typeof:B5,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=wp.transition;wp.transition={};try{e()}finally{wp.transition=t}};ke.unstable_act=lI;ke.useCallback=function(e,t){return _n.current.useCallback(e,t)};ke.useContext=function(e){return _n.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return _n.current.useDeferredValue(e)};ke.useEffect=function(e,t){return _n.current.useEffect(e,t)};ke.useId=function(){return _n.current.useId()};ke.useImperativeHandle=function(e,t,n){return _n.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return _n.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return _n.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return _n.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return _n.current.useReducer(e,t,n)};ke.useRef=function(e){return _n.current.useRef(e)};ke.useState=function(e){return _n.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return _n.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return _n.current.useTransition()};ke.version="18.3.1";eI.exports=ke;var b=eI.exports;const H=xa(b),cI=R5({__proto__:null,default:H},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y5=b,X5=Symbol.for("react.element"),q5=Symbol.for("react.fragment"),Q5=Object.prototype.hasOwnProperty,Z5=Y5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J5={key:!0,ref:!0,__self:!0,__source:!0};function uI(e,t,n){var r,o={},s=null,i=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Q5.call(t,r)&&!J5.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:X5,type:e,key:s,ref:i,props:o,_owner:Z5.current}}Lg.Fragment=q5;Lg.jsx=uI;Lg.jsxs=uI;J2.exports=Lg;var p=J2.exports,dI={exports:{}},pr={},hI={exports:{}},pI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,z){var V=D.length;D.push(z);e:for(;0<V;){var K=V-1>>>1,J=D[K];if(0<o(J,z))D[K]=z,D[V]=J,V=K;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var z=D[0],V=D.pop();if(V!==z){D[0]=V;e:for(var K=0,J=D.length,ne=J>>>1;K<ne;){var me=2*(K+1)-1,te=D[me],de=me+1,Te=D[de];if(0>o(te,V))de<J&&0>o(Te,te)?(D[K]=Te,D[de]=V,K=de):(D[K]=te,D[me]=V,K=me);else if(de<J&&0>o(Te,V))D[K]=Te,D[de]=V,K=de;else break e}}return z}function o(D,z){var V=D.sortIndex-z.sortIndex;return V!==0?V:D.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,y=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=D)r(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(c)}}function C(D){if(g=!1,w(D),!y)if(n(l)!==null)y=!0,F(P);else{var z=n(c);z!==null&&G(C,z.startTime-D)}}function P(D,z){y=!1,g&&(g=!1,v(_),_=-1),f=!0;var V=h;try{for(w(z),d=n(l);d!==null&&(!(d.expirationTime>z)||D&&!R());){var K=d.callback;if(typeof K=="function"){d.callback=null,h=d.priorityLevel;var J=K(d.expirationTime<=z);z=e.unstable_now(),typeof J=="function"?d.callback=J:d===n(l)&&r(l),w(z)}else r(l);d=n(l)}if(d!==null)var ne=!0;else{var me=n(c);me!==null&&G(C,me.startTime-z),ne=!1}return ne}finally{d=null,h=V,f=!1}}var k=!1,I=null,_=-1,M=5,T=-1;function R(){return!(e.unstable_now()-T<M)}function j(){if(I!==null){var D=e.unstable_now();T=D;var z=!0;try{z=I(!0,D)}finally{z?$():(k=!1,I=null)}}else k=!1}var $;if(typeof x=="function")$=function(){x(j)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,U=L.port2;L.port1.onmessage=j,$=function(){U.postMessage(null)}}else $=function(){m(j,0)};function F(D){I=D,k||(k=!0,$())}function G(D,z){_=m(function(){D(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){y||f||(y=!0,F(P))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var V=h;h=z;try{return D()}finally{h=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,z){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var V=h;h=D;try{return z()}finally{h=V}},e.unstable_scheduleCallback=function(D,z,V){var K=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?K+V:K):V=K,D){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=V+J,D={id:u++,callback:z,priorityLevel:D,startTime:V,expirationTime:J,sortIndex:-1},V>K?(D.sortIndex=V,t(c,D),n(l)===null&&D===n(c)&&(g?(v(_),_=-1):g=!0,G(C,V-K))):(D.sortIndex=J,t(l,D),y||f||(y=!0,F(P))),D},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(D){var z=h;return function(){var V=h;h=z;try{return D.apply(this,arguments)}finally{h=V}}}})(pI);hI.exports=pI;var eN=hI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tN=b,dr=eN;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fI=new Set,$u={};function wa(e,t){Vl(e,t),Vl(e+"Capture",t)}function Vl(e,t){for($u[e]=t,e=0;e<t.length;e++)fI.add(t[e])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),w0=Object.prototype.hasOwnProperty,nN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G1={},Y1={};function rN(e){return w0.call(Y1,e)?!0:w0.call(G1,e)?!1:nN.test(e)?Y1[e]=!0:(G1[e]=!0,!1)}function oN(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sN(e,t,n,r){if(t===null||typeof t>"u"||oN(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tn(e,t,n,r,o,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xt[e]=new Tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xt[t]=new Tn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xt[e]=new Tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xt[e]=new Tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xt[e]=new Tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xt[e]=new Tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xt[e]=new Tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xt[e]=new Tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xt[e]=new Tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Tx=/[\-:]([a-z])/g;function Mx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Tx,Mx);Xt[t]=new Tn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Tx,Mx);Xt[t]=new Tn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Tx,Mx);Xt[t]=new Tn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xt[e]=new Tn(e,1,!1,e.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new Tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xt[e]=new Tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ax(e,t,n,r){var o=Xt.hasOwnProperty(t)?Xt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sN(t,n,o,r)&&(n=null),r||o===null?rN(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ys=tN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vh=Symbol.for("react.element"),tl=Symbol.for("react.portal"),nl=Symbol.for("react.fragment"),Rx=Symbol.for("react.strict_mode"),b0=Symbol.for("react.profiler"),gI=Symbol.for("react.provider"),mI=Symbol.for("react.context"),Ox=Symbol.for("react.forward_ref"),C0=Symbol.for("react.suspense"),P0=Symbol.for("react.suspense_list"),jx=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),yI=Symbol.for("react.offscreen"),X1=Symbol.iterator;function jc(e){return e===null||typeof e!="object"?null:(e=X1&&e[X1]||e["@@iterator"],typeof e=="function"?e:null)}var gt=Object.assign,iy;function cu(e){if(iy===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);iy=t&&t[1]||""}return`
`+iy+e}var ay=!1;function ly(e,t){if(!e||ay)return"";ay=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),s=r.stack.split(`
`),i=o.length-1,a=s.length-1;1<=i&&0<=a&&o[i]!==s[a];)a--;for(;1<=i&&0<=a;i--,a--)if(o[i]!==s[a]){if(i!==1||a!==1)do if(i--,a--,0>a||o[i]!==s[a]){var l=`
`+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=a);break}}}finally{ay=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?cu(e):""}function iN(e){switch(e.tag){case 5:return cu(e.type);case 16:return cu("Lazy");case 13:return cu("Suspense");case 19:return cu("SuspenseList");case 0:case 2:case 15:return e=ly(e.type,!1),e;case 11:return e=ly(e.type.render,!1),e;case 1:return e=ly(e.type,!0),e;default:return""}}function k0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case nl:return"Fragment";case tl:return"Portal";case b0:return"Profiler";case Rx:return"StrictMode";case C0:return"Suspense";case P0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case mI:return(e.displayName||"Context")+".Consumer";case gI:return(e._context.displayName||"Context")+".Provider";case Ox:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case jx:return t=e.displayName||null,t!==null?t:k0(e.type)||"Memo";case $s:t=e._payload,e=e._init;try{return k0(e(t))}catch{}}return null}function aN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k0(t);case 8:return t===Rx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vI(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function lN(e){var t=vI(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Sh(e){e._valueTracker||(e._valueTracker=lN(e))}function SI(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=vI(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function kf(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function E0(e,t){var n=t.checked;return gt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function q1(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=hi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xI(e,t){t=t.checked,t!=null&&Ax(e,"checked",t,!1)}function I0(e,t){xI(e,t);var n=hi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_0(e,t.type,n):t.hasOwnProperty("defaultValue")&&_0(e,t.type,hi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Q1(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _0(e,t,n){(t!=="number"||kf(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var uu=Array.isArray;function wl(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+hi(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function T0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return gt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Z1(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(uu(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:hi(n)}}function wI(e,t){var n=hi(t.value),r=hi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function J1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function bI(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?bI(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xh,CI=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xh=xh||document.createElement("div"),xh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Lu(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var vu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cN=["Webkit","ms","Moz","O"];Object.keys(vu).forEach(function(e){cN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vu[t]=vu[e]})});function PI(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||vu.hasOwnProperty(e)&&vu[e]?(""+t).trim():t+"px"}function kI(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=PI(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var uN=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function A0(e,t){if(t){if(uN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function R0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var O0=null;function Dx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var j0=null,bl=null,Cl=null;function eC(e){if(e=_d(e)){if(typeof j0!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=Hg(t),j0(e.stateNode,e.type,t))}}function EI(e){bl?Cl?Cl.push(e):Cl=[e]:bl=e}function II(){if(bl){var e=bl,t=Cl;if(Cl=bl=null,eC(e),t)for(e=0;e<t.length;e++)eC(t[e])}}function _I(e,t){return e(t)}function TI(){}var cy=!1;function MI(e,t,n){if(cy)return e(t,n);cy=!0;try{return _I(e,t,n)}finally{cy=!1,(bl!==null||Cl!==null)&&(TI(),II())}}function Fu(e,t){var n=e.stateNode;if(n===null)return null;var r=Hg(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var D0=!1;if(us)try{var Dc={};Object.defineProperty(Dc,"passive",{get:function(){D0=!0}}),window.addEventListener("test",Dc,Dc),window.removeEventListener("test",Dc,Dc)}catch{D0=!1}function dN(e,t,n,r,o,s,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Su=!1,Ef=null,If=!1,N0=null,hN={onError:function(e){Su=!0,Ef=e}};function pN(e,t,n,r,o,s,i,a,l){Su=!1,Ef=null,dN.apply(hN,arguments)}function fN(e,t,n,r,o,s,i,a,l){if(pN.apply(this,arguments),Su){if(Su){var c=Ef;Su=!1,Ef=null}else throw Error(Q(198));If||(If=!0,N0=c)}}function ba(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function AI(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tC(e){if(ba(e)!==e)throw Error(Q(188))}function gN(e){var t=e.alternate;if(!t){if(t=ba(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return tC(o),e;if(s===r)return tC(o),t;s=s.sibling}throw Error(Q(188))}if(n.return!==r.return)n=o,r=s;else{for(var i=!1,a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i){for(a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function RI(e){return e=gN(e),e!==null?OI(e):null}function OI(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=OI(e);if(t!==null)return t;e=e.sibling}return null}var jI=dr.unstable_scheduleCallback,nC=dr.unstable_cancelCallback,mN=dr.unstable_shouldYield,yN=dr.unstable_requestPaint,wt=dr.unstable_now,vN=dr.unstable_getCurrentPriorityLevel,Nx=dr.unstable_ImmediatePriority,DI=dr.unstable_UserBlockingPriority,_f=dr.unstable_NormalPriority,SN=dr.unstable_LowPriority,NI=dr.unstable_IdlePriority,Fg=null,Eo=null;function xN(e){if(Eo&&typeof Eo.onCommitFiberRoot=="function")try{Eo.onCommitFiberRoot(Fg,e,void 0,(e.current.flags&128)===128)}catch{}}var to=Math.clz32?Math.clz32:CN,wN=Math.log,bN=Math.LN2;function CN(e){return e>>>=0,e===0?32:31-(wN(e)/bN|0)|0}var wh=64,bh=4194304;function du(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tf(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,s=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~o;a!==0?r=du(a):(s&=i,s!==0&&(r=du(s)))}else i=n&~o,i!==0?r=du(i):s!==0&&(r=du(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,s=t&-t,o>=s||o===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-to(t),o=1<<n,r|=e[n],t&=~o;return r}function PN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kN(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-to(s),a=1<<i,l=o[i];l===-1?(!(a&n)||a&r)&&(o[i]=PN(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function $0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $I(){var e=wh;return wh<<=1,!(wh&4194240)&&(wh=64),e}function uy(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ed(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-to(t),e[t]=n}function EN(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-to(n),s=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~s}}function $x(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-to(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var He=0;function LI(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var FI,Lx,zI,BI,UI,L0=!1,Ch=[],ti=null,ni=null,ri=null,zu=new Map,Bu=new Map,zs=[],IN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rC(e,t){switch(e){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":zu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bu.delete(t.pointerId)}}function Nc(e,t,n,r,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},t!==null&&(t=_d(t),t!==null&&Lx(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function _N(e,t,n,r,o){switch(t){case"focusin":return ti=Nc(ti,e,t,n,r,o),!0;case"dragenter":return ni=Nc(ni,e,t,n,r,o),!0;case"mouseover":return ri=Nc(ri,e,t,n,r,o),!0;case"pointerover":var s=o.pointerId;return zu.set(s,Nc(zu.get(s)||null,e,t,n,r,o)),!0;case"gotpointercapture":return s=o.pointerId,Bu.set(s,Nc(Bu.get(s)||null,e,t,n,r,o)),!0}return!1}function HI(e){var t=Yi(e.target);if(t!==null){var n=ba(t);if(n!==null){if(t=n.tag,t===13){if(t=AI(n),t!==null){e.blockedOn=t,UI(e.priority,function(){zI(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=F0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);O0=r,n.target.dispatchEvent(r),O0=null}else return t=_d(n),t!==null&&Lx(t),e.blockedOn=n,!1;t.shift()}return!0}function oC(e,t,n){bp(e)&&n.delete(t)}function TN(){L0=!1,ti!==null&&bp(ti)&&(ti=null),ni!==null&&bp(ni)&&(ni=null),ri!==null&&bp(ri)&&(ri=null),zu.forEach(oC),Bu.forEach(oC)}function $c(e,t){e.blockedOn===t&&(e.blockedOn=null,L0||(L0=!0,dr.unstable_scheduleCallback(dr.unstable_NormalPriority,TN)))}function Uu(e){function t(o){return $c(o,e)}if(0<Ch.length){$c(Ch[0],e);for(var n=1;n<Ch.length;n++){var r=Ch[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ti!==null&&$c(ti,e),ni!==null&&$c(ni,e),ri!==null&&$c(ri,e),zu.forEach(t),Bu.forEach(t),n=0;n<zs.length;n++)r=zs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<zs.length&&(n=zs[0],n.blockedOn===null);)HI(n),n.blockedOn===null&&zs.shift()}var Pl=ys.ReactCurrentBatchConfig,Mf=!0;function MN(e,t,n,r){var o=He,s=Pl.transition;Pl.transition=null;try{He=1,Fx(e,t,n,r)}finally{He=o,Pl.transition=s}}function AN(e,t,n,r){var o=He,s=Pl.transition;Pl.transition=null;try{He=4,Fx(e,t,n,r)}finally{He=o,Pl.transition=s}}function Fx(e,t,n,r){if(Mf){var o=F0(e,t,n,r);if(o===null)xy(e,t,r,Af,n),rC(e,r);else if(_N(o,e,t,n,r))r.stopPropagation();else if(rC(e,r),t&4&&-1<IN.indexOf(e)){for(;o!==null;){var s=_d(o);if(s!==null&&FI(s),s=F0(e,t,n,r),s===null&&xy(e,t,r,Af,n),s===o)break;o=s}o!==null&&r.stopPropagation()}else xy(e,t,r,null,n)}}var Af=null;function F0(e,t,n,r){if(Af=null,e=Dx(r),e=Yi(e),e!==null)if(t=ba(e),t===null)e=null;else if(n=t.tag,n===13){if(e=AI(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Af=e,null}function VI(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vN()){case Nx:return 1;case DI:return 4;case _f:case SN:return 16;case NI:return 536870912;default:return 16}default:return 16}}var Ys=null,zx=null,Cp=null;function KI(){if(Cp)return Cp;var e,t=zx,n=t.length,r,o="value"in Ys?Ys.value:Ys.textContent,s=o.length;for(e=0;e<n&&t[e]===o[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===o[s-r];r++);return Cp=o.slice(e,1<r?1-r:void 0)}function Pp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ph(){return!0}function sC(){return!1}function fr(e){function t(n,r,o,s,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ph:sC,this.isPropagationStopped=sC,this}return gt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ph)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ph)},persist:function(){},isPersistent:Ph}),t}var ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bx=fr(ac),Id=gt({},ac,{view:0,detail:0}),RN=fr(Id),dy,hy,Lc,zg=gt({},Id,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ux,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Lc&&(Lc&&e.type==="mousemove"?(dy=e.screenX-Lc.screenX,hy=e.screenY-Lc.screenY):hy=dy=0,Lc=e),dy)},movementY:function(e){return"movementY"in e?e.movementY:hy}}),iC=fr(zg),ON=gt({},zg,{dataTransfer:0}),jN=fr(ON),DN=gt({},Id,{relatedTarget:0}),py=fr(DN),NN=gt({},ac,{animationName:0,elapsedTime:0,pseudoElement:0}),$N=fr(NN),LN=gt({},ac,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),FN=fr(LN),zN=gt({},ac,{data:0}),aC=fr(zN),BN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VN(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=HN[e])?!!t[e]:!1}function Ux(){return VN}var KN=gt({},Id,{key:function(e){if(e.key){var t=BN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?UN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ux,charCode:function(e){return e.type==="keypress"?Pp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WN=fr(KN),GN=gt({},zg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lC=fr(GN),YN=gt({},Id,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ux}),XN=fr(YN),qN=gt({},ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),QN=fr(qN),ZN=gt({},zg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),JN=fr(ZN),e$=[9,13,27,32],Hx=us&&"CompositionEvent"in window,xu=null;us&&"documentMode"in document&&(xu=document.documentMode);var t$=us&&"TextEvent"in window&&!xu,WI=us&&(!Hx||xu&&8<xu&&11>=xu),cC=" ",uC=!1;function GI(e,t){switch(e){case"keyup":return e$.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function YI(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rl=!1;function n$(e,t){switch(e){case"compositionend":return YI(t);case"keypress":return t.which!==32?null:(uC=!0,cC);case"textInput":return e=t.data,e===cC&&uC?null:e;default:return null}}function r$(e,t){if(rl)return e==="compositionend"||!Hx&&GI(e,t)?(e=KI(),Cp=zx=Ys=null,rl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return WI&&t.locale!=="ko"?null:t.data;default:return null}}var o$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!o$[e.type]:t==="textarea"}function XI(e,t,n,r){EI(r),t=Rf(t,"onChange"),0<t.length&&(n=new Bx("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var wu=null,Hu=null;function s$(e){i_(e,0)}function Bg(e){var t=il(e);if(SI(t))return e}function i$(e,t){if(e==="change")return t}var qI=!1;if(us){var fy;if(us){var gy="oninput"in document;if(!gy){var hC=document.createElement("div");hC.setAttribute("oninput","return;"),gy=typeof hC.oninput=="function"}fy=gy}else fy=!1;qI=fy&&(!document.documentMode||9<document.documentMode)}function pC(){wu&&(wu.detachEvent("onpropertychange",QI),Hu=wu=null)}function QI(e){if(e.propertyName==="value"&&Bg(Hu)){var t=[];XI(t,Hu,e,Dx(e)),MI(s$,t)}}function a$(e,t,n){e==="focusin"?(pC(),wu=t,Hu=n,wu.attachEvent("onpropertychange",QI)):e==="focusout"&&pC()}function l$(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bg(Hu)}function c$(e,t){if(e==="click")return Bg(t)}function u$(e,t){if(e==="input"||e==="change")return Bg(t)}function d$(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var io=typeof Object.is=="function"?Object.is:d$;function Vu(e,t){if(io(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!w0.call(t,o)||!io(e[o],t[o]))return!1}return!0}function fC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gC(e,t){var n=fC(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fC(n)}}function ZI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ZI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function JI(){for(var e=window,t=kf();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=kf(e.document)}return t}function Vx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function h$(e){var t=JI(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ZI(n.ownerDocument.documentElement,n)){if(r!==null&&Vx(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!e.extend&&s>r&&(o=r,r=s,s=o),o=gC(n,s);var i=gC(n,r);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var p$=us&&"documentMode"in document&&11>=document.documentMode,ol=null,z0=null,bu=null,B0=!1;function mC(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;B0||ol==null||ol!==kf(r)||(r=ol,"selectionStart"in r&&Vx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bu&&Vu(bu,r)||(bu=r,r=Rf(z0,"onSelect"),0<r.length&&(t=new Bx("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ol)))}function kh(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var sl={animationend:kh("Animation","AnimationEnd"),animationiteration:kh("Animation","AnimationIteration"),animationstart:kh("Animation","AnimationStart"),transitionend:kh("Transition","TransitionEnd")},my={},e_={};us&&(e_=document.createElement("div").style,"AnimationEvent"in window||(delete sl.animationend.animation,delete sl.animationiteration.animation,delete sl.animationstart.animation),"TransitionEvent"in window||delete sl.transitionend.transition);function Ug(e){if(my[e])return my[e];if(!sl[e])return e;var t=sl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in e_)return my[e]=t[n];return e}var t_=Ug("animationend"),n_=Ug("animationiteration"),r_=Ug("animationstart"),o_=Ug("transitionend"),s_=new Map,yC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(e,t){s_.set(e,t),wa(t,[e])}for(var yy=0;yy<yC.length;yy++){var vy=yC[yy],f$=vy.toLowerCase(),g$=vy[0].toUpperCase()+vy.slice(1);Pi(f$,"on"+g$)}Pi(t_,"onAnimationEnd");Pi(n_,"onAnimationIteration");Pi(r_,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(o_,"onTransitionEnd");Vl("onMouseEnter",["mouseout","mouseover"]);Vl("onMouseLeave",["mouseout","mouseover"]);Vl("onPointerEnter",["pointerout","pointerover"]);Vl("onPointerLeave",["pointerout","pointerover"]);wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m$=new Set("cancel close invalid load scroll toggle".split(" ").concat(hu));function vC(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,fN(r,t,void 0,e),e.currentTarget=null}function i_(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&o.isPropagationStopped())break e;vC(o,a,c),s=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&o.isPropagationStopped())break e;vC(o,a,c),s=l}}}if(If)throw e=N0,If=!1,N0=null,e}function rt(e,t){var n=t[W0];n===void 0&&(n=t[W0]=new Set);var r=e+"__bubble";n.has(r)||(a_(t,e,2,!1),n.add(r))}function Sy(e,t,n){var r=0;t&&(r|=4),a_(n,e,r,t)}var Eh="_reactListening"+Math.random().toString(36).slice(2);function Ku(e){if(!e[Eh]){e[Eh]=!0,fI.forEach(function(n){n!=="selectionchange"&&(m$.has(n)||Sy(n,!1,e),Sy(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Eh]||(t[Eh]=!0,Sy("selectionchange",!1,t))}}function a_(e,t,n,r){switch(VI(t)){case 1:var o=MN;break;case 4:o=AN;break;default:o=Fx}n=o.bind(null,t,n,e),o=void 0,!D0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function xy(e,t,n,r,o){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;i=i.return}for(;a!==null;){if(i=Yi(a),i===null)return;if(l=i.tag,l===5||l===6){r=s=i;continue e}a=a.parentNode}}r=r.return}MI(function(){var c=s,u=Dx(n),d=[];e:{var h=s_.get(e);if(h!==void 0){var f=Bx,y=e;switch(e){case"keypress":if(Pp(n)===0)break e;case"keydown":case"keyup":f=WN;break;case"focusin":y="focus",f=py;break;case"focusout":y="blur",f=py;break;case"beforeblur":case"afterblur":f=py;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=iC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=jN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=XN;break;case t_:case n_:case r_:f=$N;break;case o_:f=QN;break;case"scroll":f=RN;break;case"wheel":f=JN;break;case"copy":case"cut":case"paste":f=FN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=lC}var g=(t&4)!==0,m=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var x=c,w;x!==null;){w=x;var C=w.stateNode;if(w.tag===5&&C!==null&&(w=C,v!==null&&(C=Fu(x,v),C!=null&&g.push(Wu(x,C,w)))),m)break;x=x.return}0<g.length&&(h=new f(h,y,null,n,u),d.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==O0&&(y=n.relatedTarget||n.fromElement)&&(Yi(y)||y[ds]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(y=n.relatedTarget||n.toElement,f=c,y=y?Yi(y):null,y!==null&&(m=ba(y),y!==m||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=c),f!==y)){if(g=iC,C="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=lC,C="onPointerLeave",v="onPointerEnter",x="pointer"),m=f==null?h:il(f),w=y==null?h:il(y),h=new g(C,x+"leave",f,n,u),h.target=m,h.relatedTarget=w,C=null,Yi(u)===c&&(g=new g(v,x+"enter",y,n,u),g.target=w,g.relatedTarget=m,C=g),m=C,f&&y)t:{for(g=f,v=y,x=0,w=g;w;w=Da(w))x++;for(w=0,C=v;C;C=Da(C))w++;for(;0<x-w;)g=Da(g),x--;for(;0<w-x;)v=Da(v),w--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Da(g),v=Da(v)}g=null}else g=null;f!==null&&SC(d,h,f,g,!1),y!==null&&m!==null&&SC(d,m,y,g,!0)}}e:{if(h=c?il(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var P=i$;else if(dC(h))if(qI)P=u$;else{P=l$;var k=a$}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(P=c$);if(P&&(P=P(e,c))){XI(d,P,n,u);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&_0(h,"number",h.value)}switch(k=c?il(c):window,e){case"focusin":(dC(k)||k.contentEditable==="true")&&(ol=k,z0=c,bu=null);break;case"focusout":bu=z0=ol=null;break;case"mousedown":B0=!0;break;case"contextmenu":case"mouseup":case"dragend":B0=!1,mC(d,n,u);break;case"selectionchange":if(p$)break;case"keydown":case"keyup":mC(d,n,u)}var I;if(Hx)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else rl?GI(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(WI&&n.locale!=="ko"&&(rl||_!=="onCompositionStart"?_==="onCompositionEnd"&&rl&&(I=KI()):(Ys=u,zx="value"in Ys?Ys.value:Ys.textContent,rl=!0)),k=Rf(c,_),0<k.length&&(_=new aC(_,e,null,n,u),d.push({event:_,listeners:k}),I?_.data=I:(I=YI(n),I!==null&&(_.data=I)))),(I=t$?n$(e,n):r$(e,n))&&(c=Rf(c,"onBeforeInput"),0<c.length&&(u=new aC("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=I))}i_(d,t)})}function Wu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Rf(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=Fu(e,n),s!=null&&r.unshift(Wu(e,s,o)),s=Fu(e,t),s!=null&&r.push(Wu(e,s,o))),e=e.return}return r}function Da(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function SC(e,t,n,r,o){for(var s=t._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,o?(l=Fu(n,s),l!=null&&i.unshift(Wu(n,l,a))):o||(l=Fu(n,s),l!=null&&i.push(Wu(n,l,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var y$=/\r\n?/g,v$=/\u0000|\uFFFD/g;function xC(e){return(typeof e=="string"?e:""+e).replace(y$,`
`).replace(v$,"")}function Ih(e,t,n){if(t=xC(t),xC(e)!==t&&n)throw Error(Q(425))}function Of(){}var U0=null,H0=null;function V0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var K0=typeof setTimeout=="function"?setTimeout:void 0,S$=typeof clearTimeout=="function"?clearTimeout:void 0,wC=typeof Promise=="function"?Promise:void 0,x$=typeof queueMicrotask=="function"?queueMicrotask:typeof wC<"u"?function(e){return wC.resolve(null).then(e).catch(w$)}:K0;function w$(e){setTimeout(function(){throw e})}function wy(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),Uu(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Uu(t)}function oi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function bC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var lc=Math.random().toString(36).slice(2),Co="__reactFiber$"+lc,Gu="__reactProps$"+lc,ds="__reactContainer$"+lc,W0="__reactEvents$"+lc,b$="__reactListeners$"+lc,C$="__reactHandles$"+lc;function Yi(e){var t=e[Co];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ds]||n[Co]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=bC(e);e!==null;){if(n=e[Co])return n;e=bC(e)}return t}e=n,n=e.parentNode}return null}function _d(e){return e=e[Co]||e[ds],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function il(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function Hg(e){return e[Gu]||null}var G0=[],al=-1;function ki(e){return{current:e}}function st(e){0>al||(e.current=G0[al],G0[al]=null,al--)}function Qe(e,t){al++,G0[al]=e.current,e.current=t}var pi={},fn=ki(pi),zn=ki(!1),ua=pi;function Kl(e,t){var n=e.type.contextTypes;if(!n)return pi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in n)o[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Bn(e){return e=e.childContextTypes,e!=null}function jf(){st(zn),st(fn)}function CC(e,t,n){if(fn.current!==pi)throw Error(Q(168));Qe(fn,t),Qe(zn,n)}function l_(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(Q(108,aN(e)||"Unknown",o));return gt({},n,r)}function Df(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pi,ua=fn.current,Qe(fn,e),Qe(zn,zn.current),!0}function PC(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=l_(e,t,ua),r.__reactInternalMemoizedMergedChildContext=e,st(zn),st(fn),Qe(fn,e)):st(zn),Qe(zn,n)}var Qo=null,Vg=!1,by=!1;function c_(e){Qo===null?Qo=[e]:Qo.push(e)}function P$(e){Vg=!0,c_(e)}function Ei(){if(!by&&Qo!==null){by=!0;var e=0,t=He;try{var n=Qo;for(He=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qo=null,Vg=!1}catch(o){throw Qo!==null&&(Qo=Qo.slice(e+1)),jI(Nx,Ei),o}finally{He=t,by=!1}}return null}var ll=[],cl=0,Nf=null,$f=0,kr=[],Er=0,da=null,ns=1,rs="";function Bi(e,t){ll[cl++]=$f,ll[cl++]=Nf,Nf=e,$f=t}function u_(e,t,n){kr[Er++]=ns,kr[Er++]=rs,kr[Er++]=da,da=e;var r=ns;e=rs;var o=32-to(r)-1;r&=~(1<<o),n+=1;var s=32-to(t)+o;if(30<s){var i=o-o%5;s=(r&(1<<i)-1).toString(32),r>>=i,o-=i,ns=1<<32-to(t)+o|n<<o|r,rs=s+e}else ns=1<<s|n<<o|r,rs=e}function Kx(e){e.return!==null&&(Bi(e,1),u_(e,1,0))}function Wx(e){for(;e===Nf;)Nf=ll[--cl],ll[cl]=null,$f=ll[--cl],ll[cl]=null;for(;e===da;)da=kr[--Er],kr[Er]=null,rs=kr[--Er],kr[Er]=null,ns=kr[--Er],kr[Er]=null}var ar=null,ir=null,lt=!1,Yr=null;function d_(e,t){var n=Tr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function kC(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ar=e,ir=oi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ar=e,ir=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=da!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Tr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ar=e,ir=null,!0):!1;default:return!1}}function Y0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function X0(e){if(lt){var t=ir;if(t){var n=t;if(!kC(e,t)){if(Y0(e))throw Error(Q(418));t=oi(n.nextSibling);var r=ar;t&&kC(e,t)?d_(r,n):(e.flags=e.flags&-4097|2,lt=!1,ar=e)}}else{if(Y0(e))throw Error(Q(418));e.flags=e.flags&-4097|2,lt=!1,ar=e}}}function EC(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ar=e}function _h(e){if(e!==ar)return!1;if(!lt)return EC(e),lt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!V0(e.type,e.memoizedProps)),t&&(t=ir)){if(Y0(e))throw h_(),Error(Q(418));for(;t;)d_(e,t),t=oi(t.nextSibling)}if(EC(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ir=oi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ir=null}}else ir=ar?oi(e.stateNode.nextSibling):null;return!0}function h_(){for(var e=ir;e;)e=oi(e.nextSibling)}function Wl(){ir=ar=null,lt=!1}function Gx(e){Yr===null?Yr=[e]:Yr.push(e)}var k$=ys.ReactCurrentBatchConfig;function Fc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var o=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var a=o.refs;i===null?delete a[s]:a[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function Th(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function IC(e){var t=e._init;return t(e._payload)}function p_(e){function t(v,x){if(e){var w=v.deletions;w===null?(v.deletions=[x],v.flags|=16):w.push(x)}}function n(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function r(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function o(v,x){return v=li(v,x),v.index=0,v.sibling=null,v}function s(v,x,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<x?(v.flags|=2,x):w):(v.flags|=2,x)):(v.flags|=1048576,x)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,x,w,C){return x===null||x.tag!==6?(x=Ty(w,v.mode,C),x.return=v,x):(x=o(x,w),x.return=v,x)}function l(v,x,w,C){var P=w.type;return P===nl?u(v,x,w.props.children,C,w.key):x!==null&&(x.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===$s&&IC(P)===x.type)?(C=o(x,w.props),C.ref=Fc(v,x,w),C.return=v,C):(C=Ap(w.type,w.key,w.props,null,v.mode,C),C.ref=Fc(v,x,w),C.return=v,C)}function c(v,x,w,C){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=My(w,v.mode,C),x.return=v,x):(x=o(x,w.children||[]),x.return=v,x)}function u(v,x,w,C,P){return x===null||x.tag!==7?(x=ia(w,v.mode,C,P),x.return=v,x):(x=o(x,w),x.return=v,x)}function d(v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ty(""+x,v.mode,w),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case vh:return w=Ap(x.type,x.key,x.props,null,v.mode,w),w.ref=Fc(v,null,x),w.return=v,w;case tl:return x=My(x,v.mode,w),x.return=v,x;case $s:var C=x._init;return d(v,C(x._payload),w)}if(uu(x)||jc(x))return x=ia(x,v.mode,w,null),x.return=v,x;Th(v,x)}return null}function h(v,x,w,C){var P=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return P!==null?null:a(v,x,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case vh:return w.key===P?l(v,x,w,C):null;case tl:return w.key===P?c(v,x,w,C):null;case $s:return P=w._init,h(v,x,P(w._payload),C)}if(uu(w)||jc(w))return P!==null?null:u(v,x,w,C,null);Th(v,w)}return null}function f(v,x,w,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return v=v.get(w)||null,a(x,v,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case vh:return v=v.get(C.key===null?w:C.key)||null,l(x,v,C,P);case tl:return v=v.get(C.key===null?w:C.key)||null,c(x,v,C,P);case $s:var k=C._init;return f(v,x,w,k(C._payload),P)}if(uu(C)||jc(C))return v=v.get(w)||null,u(x,v,C,P,null);Th(x,C)}return null}function y(v,x,w,C){for(var P=null,k=null,I=x,_=x=0,M=null;I!==null&&_<w.length;_++){I.index>_?(M=I,I=null):M=I.sibling;var T=h(v,I,w[_],C);if(T===null){I===null&&(I=M);break}e&&I&&T.alternate===null&&t(v,I),x=s(T,x,_),k===null?P=T:k.sibling=T,k=T,I=M}if(_===w.length)return n(v,I),lt&&Bi(v,_),P;if(I===null){for(;_<w.length;_++)I=d(v,w[_],C),I!==null&&(x=s(I,x,_),k===null?P=I:k.sibling=I,k=I);return lt&&Bi(v,_),P}for(I=r(v,I);_<w.length;_++)M=f(I,v,_,w[_],C),M!==null&&(e&&M.alternate!==null&&I.delete(M.key===null?_:M.key),x=s(M,x,_),k===null?P=M:k.sibling=M,k=M);return e&&I.forEach(function(R){return t(v,R)}),lt&&Bi(v,_),P}function g(v,x,w,C){var P=jc(w);if(typeof P!="function")throw Error(Q(150));if(w=P.call(w),w==null)throw Error(Q(151));for(var k=P=null,I=x,_=x=0,M=null,T=w.next();I!==null&&!T.done;_++,T=w.next()){I.index>_?(M=I,I=null):M=I.sibling;var R=h(v,I,T.value,C);if(R===null){I===null&&(I=M);break}e&&I&&R.alternate===null&&t(v,I),x=s(R,x,_),k===null?P=R:k.sibling=R,k=R,I=M}if(T.done)return n(v,I),lt&&Bi(v,_),P;if(I===null){for(;!T.done;_++,T=w.next())T=d(v,T.value,C),T!==null&&(x=s(T,x,_),k===null?P=T:k.sibling=T,k=T);return lt&&Bi(v,_),P}for(I=r(v,I);!T.done;_++,T=w.next())T=f(I,v,_,T.value,C),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?_:T.key),x=s(T,x,_),k===null?P=T:k.sibling=T,k=T);return e&&I.forEach(function(j){return t(v,j)}),lt&&Bi(v,_),P}function m(v,x,w,C){if(typeof w=="object"&&w!==null&&w.type===nl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case vh:e:{for(var P=w.key,k=x;k!==null;){if(k.key===P){if(P=w.type,P===nl){if(k.tag===7){n(v,k.sibling),x=o(k,w.props.children),x.return=v,v=x;break e}}else if(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===$s&&IC(P)===k.type){n(v,k.sibling),x=o(k,w.props),x.ref=Fc(v,k,w),x.return=v,v=x;break e}n(v,k);break}else t(v,k);k=k.sibling}w.type===nl?(x=ia(w.props.children,v.mode,C,w.key),x.return=v,v=x):(C=Ap(w.type,w.key,w.props,null,v.mode,C),C.ref=Fc(v,x,w),C.return=v,v=C)}return i(v);case tl:e:{for(k=w.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(v,x.sibling),x=o(x,w.children||[]),x.return=v,v=x;break e}else{n(v,x);break}else t(v,x);x=x.sibling}x=My(w,v.mode,C),x.return=v,v=x}return i(v);case $s:return k=w._init,m(v,x,k(w._payload),C)}if(uu(w))return y(v,x,w,C);if(jc(w))return g(v,x,w,C);Th(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(v,x.sibling),x=o(x,w),x.return=v,v=x):(n(v,x),x=Ty(w,v.mode,C),x.return=v,v=x),i(v)):n(v,x)}return m}var Gl=p_(!0),f_=p_(!1),Lf=ki(null),Ff=null,ul=null,Yx=null;function Xx(){Yx=ul=Ff=null}function qx(e){var t=Lf.current;st(Lf),e._currentValue=t}function q0(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function kl(e,t){Ff=e,Yx=ul=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ln=!0),e.firstContext=null)}function Rr(e){var t=e._currentValue;if(Yx!==e)if(e={context:e,memoizedValue:t,next:null},ul===null){if(Ff===null)throw Error(Q(308));ul=e,Ff.dependencies={lanes:0,firstContext:e}}else ul=ul.next=e;return t}var Xi=null;function Qx(e){Xi===null?Xi=[e]:Xi.push(e)}function g_(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Qx(t)):(n.next=o.next,o.next=n),t.interleaved=n,hs(e,r)}function hs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ls=!1;function Zx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function si(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,hs(e,n)}return o=r.interleaved,o===null?(t.next=t,Qx(r)):(t.next=o.next,o.next=t),r.interleaved=t,hs(e,n)}function kp(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$x(e,n)}}function _C(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?o=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?o=s=t:s=s.next=t}else o=s=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zf(e,t,n,r){var o=e.updateQueue;Ls=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=o.baseState;i=0,u=c=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,g=a;switch(h=t,f=n,g.tag){case 1:if(y=g.payload,typeof y=="function"){d=y.call(f,d,h);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,h=typeof y=="function"?y.call(f,d,h):y,h==null)break e;d=gt({},d,h);break e;case 2:Ls=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=o.effects,h===null?o.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;h=a,a=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(!0);if(u===null&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,t=o.shared.interleaved,t!==null){o=t;do i|=o.lane,o=o.next;while(o!==t)}else s===null&&(o.shared.lanes=0);pa|=i,e.lanes=i,e.memoizedState=d}}function TC(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Q(191,o));o.call(r)}}}var Td={},Io=ki(Td),Yu=ki(Td),Xu=ki(Td);function qi(e){if(e===Td)throw Error(Q(174));return e}function Jx(e,t){switch(Qe(Xu,t),Qe(Yu,e),Qe(Io,Td),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:M0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=M0(t,e)}st(Io),Qe(Io,t)}function Yl(){st(Io),st(Yu),st(Xu)}function y_(e){qi(Xu.current);var t=qi(Io.current),n=M0(t,e.type);t!==n&&(Qe(Yu,e),Qe(Io,n))}function ew(e){Yu.current===e&&(st(Io),st(Yu))}var dt=ki(0);function Bf(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cy=[];function tw(){for(var e=0;e<Cy.length;e++)Cy[e]._workInProgressVersionPrimary=null;Cy.length=0}var Ep=ys.ReactCurrentDispatcher,Py=ys.ReactCurrentBatchConfig,ha=0,ft=null,It=null,At=null,Uf=!1,Cu=!1,qu=0,E$=0;function Jt(){throw Error(Q(321))}function nw(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!io(e[n],t[n]))return!1;return!0}function rw(e,t,n,r,o,s){if(ha=s,ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ep.current=e===null||e.memoizedState===null?M$:A$,e=n(r,o),Cu){s=0;do{if(Cu=!1,qu=0,25<=s)throw Error(Q(301));s+=1,At=It=null,t.updateQueue=null,Ep.current=R$,e=n(r,o)}while(Cu)}if(Ep.current=Hf,t=It!==null&&It.next!==null,ha=0,At=It=ft=null,Uf=!1,t)throw Error(Q(300));return e}function ow(){var e=qu!==0;return qu=0,e}function go(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?ft.memoizedState=At=e:At=At.next=e,At}function Or(){if(It===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=It.next;var t=At===null?ft.memoizedState:At.next;if(t!==null)At=t,It=e;else{if(e===null)throw Error(Q(310));It=e,e={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},At===null?ft.memoizedState=At=e:At=At.next=e}return At}function Qu(e,t){return typeof t=="function"?t(e):t}function ky(e){var t=Or(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=It,o=r.baseQueue,s=n.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}r.baseQueue=o=s,n.pending=null}if(o!==null){s=o.next,r=r.baseState;var a=i=null,l=null,c=s;do{var u=c.lane;if((ha&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,ft.lanes|=u,pa|=u}c=c.next}while(c!==null&&c!==s);l===null?i=r:l.next=a,io(r,t.memoizedState)||(Ln=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do s=o.lane,ft.lanes|=s,pa|=s,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ey(e){var t=Or(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,s=t.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do s=e(s,i.action),i=i.next;while(i!==o);io(s,t.memoizedState)||(Ln=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function v_(){}function S_(e,t){var n=ft,r=Or(),o=t(),s=!io(r.memoizedState,o);if(s&&(r.memoizedState=o,Ln=!0),r=r.queue,sw(b_.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||At!==null&&At.memoizedState.tag&1){if(n.flags|=2048,Zu(9,w_.bind(null,n,r,o,t),void 0,null),Rt===null)throw Error(Q(349));ha&30||x_(n,t,o)}return o}function x_(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function w_(e,t,n,r){t.value=n,t.getSnapshot=r,C_(t)&&P_(e)}function b_(e,t,n){return n(function(){C_(t)&&P_(e)})}function C_(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!io(e,n)}catch{return!0}}function P_(e){var t=hs(e,1);t!==null&&no(t,e,1,-1)}function MC(e){var t=go();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qu,lastRenderedState:e},t.queue=e,e=e.dispatch=T$.bind(null,ft,e),[t.memoizedState,e]}function Zu(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function k_(){return Or().memoizedState}function Ip(e,t,n,r){var o=go();ft.flags|=e,o.memoizedState=Zu(1|t,n,void 0,r===void 0?null:r)}function Kg(e,t,n,r){var o=Or();r=r===void 0?null:r;var s=void 0;if(It!==null){var i=It.memoizedState;if(s=i.destroy,r!==null&&nw(r,i.deps)){o.memoizedState=Zu(t,n,s,r);return}}ft.flags|=e,o.memoizedState=Zu(1|t,n,s,r)}function AC(e,t){return Ip(8390656,8,e,t)}function sw(e,t){return Kg(2048,8,e,t)}function E_(e,t){return Kg(4,2,e,t)}function I_(e,t){return Kg(4,4,e,t)}function __(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function T_(e,t,n){return n=n!=null?n.concat([e]):null,Kg(4,4,__.bind(null,t,e),n)}function iw(){}function M_(e,t){var n=Or();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nw(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function A_(e,t){var n=Or();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nw(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function R_(e,t,n){return ha&21?(io(n,t)||(n=$I(),ft.lanes|=n,pa|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ln=!0),e.memoizedState=n)}function I$(e,t){var n=He;He=n!==0&&4>n?n:4,e(!0);var r=Py.transition;Py.transition={};try{e(!1),t()}finally{He=n,Py.transition=r}}function O_(){return Or().memoizedState}function _$(e,t,n){var r=ai(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},j_(e))D_(t,n);else if(n=g_(e,t,n,r),n!==null){var o=En();no(n,e,r,o),N_(n,t,r)}}function T$(e,t,n){var r=ai(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(j_(e))D_(t,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,a=s(i,n);if(o.hasEagerState=!0,o.eagerState=a,io(a,i)){var l=t.interleaved;l===null?(o.next=o,Qx(t)):(o.next=l.next,l.next=o),t.interleaved=o;return}}catch{}finally{}n=g_(e,t,o,r),n!==null&&(o=En(),no(n,e,r,o),N_(n,t,r))}}function j_(e){var t=e.alternate;return e===ft||t!==null&&t===ft}function D_(e,t){Cu=Uf=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function N_(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$x(e,n)}}var Hf={readContext:Rr,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},M$={readContext:Rr,useCallback:function(e,t){return go().memoizedState=[e,t===void 0?null:t],e},useContext:Rr,useEffect:AC,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ip(4194308,4,__.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ip(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ip(4,2,e,t)},useMemo:function(e,t){var n=go();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=go();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=_$.bind(null,ft,e),[r.memoizedState,e]},useRef:function(e){var t=go();return e={current:e},t.memoizedState=e},useState:MC,useDebugValue:iw,useDeferredValue:function(e){return go().memoizedState=e},useTransition:function(){var e=MC(!1),t=e[0];return e=I$.bind(null,e[1]),go().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ft,o=go();if(lt){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),Rt===null)throw Error(Q(349));ha&30||x_(r,t,n)}o.memoizedState=n;var s={value:n,getSnapshot:t};return o.queue=s,AC(b_.bind(null,r,s,e),[e]),r.flags|=2048,Zu(9,w_.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=go(),t=Rt.identifierPrefix;if(lt){var n=rs,r=ns;n=(r&~(1<<32-to(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=qu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=E$++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},A$={readContext:Rr,useCallback:M_,useContext:Rr,useEffect:sw,useImperativeHandle:T_,useInsertionEffect:E_,useLayoutEffect:I_,useMemo:A_,useReducer:ky,useRef:k_,useState:function(){return ky(Qu)},useDebugValue:iw,useDeferredValue:function(e){var t=Or();return R_(t,It.memoizedState,e)},useTransition:function(){var e=ky(Qu)[0],t=Or().memoizedState;return[e,t]},useMutableSource:v_,useSyncExternalStore:S_,useId:O_,unstable_isNewReconciler:!1},R$={readContext:Rr,useCallback:M_,useContext:Rr,useEffect:sw,useImperativeHandle:T_,useInsertionEffect:E_,useLayoutEffect:I_,useMemo:A_,useReducer:Ey,useRef:k_,useState:function(){return Ey(Qu)},useDebugValue:iw,useDeferredValue:function(e){var t=Or();return It===null?t.memoizedState=e:R_(t,It.memoizedState,e)},useTransition:function(){var e=Ey(Qu)[0],t=Or().memoizedState;return[e,t]},useMutableSource:v_,useSyncExternalStore:S_,useId:O_,unstable_isNewReconciler:!1};function Ur(e,t){if(e&&e.defaultProps){t=gt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Q0(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:gt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wg={isMounted:function(e){return(e=e._reactInternals)?ba(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=En(),o=ai(e),s=os(r,o);s.payload=t,n!=null&&(s.callback=n),t=si(e,s,o),t!==null&&(no(t,e,o,r),kp(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=En(),o=ai(e),s=os(r,o);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=si(e,s,o),t!==null&&(no(t,e,o,r),kp(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=En(),r=ai(e),o=os(n,r);o.tag=2,t!=null&&(o.callback=t),t=si(e,o,r),t!==null&&(no(t,e,r,n),kp(t,e,r))}};function RC(e,t,n,r,o,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,i):t.prototype&&t.prototype.isPureReactComponent?!Vu(n,r)||!Vu(o,s):!0}function $_(e,t,n){var r=!1,o=pi,s=t.contextType;return typeof s=="object"&&s!==null?s=Rr(s):(o=Bn(t)?ua:fn.current,r=t.contextTypes,s=(r=r!=null)?Kl(e,o):pi),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wg,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=s),t}function OC(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Wg.enqueueReplaceState(t,t.state,null)}function Z0(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Zx(e);var s=t.contextType;typeof s=="object"&&s!==null?o.context=Rr(s):(s=Bn(t)?ua:fn.current,o.context=Kl(e,s)),o.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Q0(e,t,s,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Wg.enqueueReplaceState(o,o.state,null),zf(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Xl(e,t){try{var n="",r=t;do n+=iN(r),r=r.return;while(r);var o=n}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:o,digest:null}}function Iy(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function J0(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var O$=typeof WeakMap=="function"?WeakMap:Map;function L_(e,t,n){n=os(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kf||(Kf=!0,cS=r),J0(e,t)},n}function F_(e,t,n){n=os(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){J0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){J0(e,t),typeof r!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function jC(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new O$;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=G$.bind(null,e,t,n),t.then(e,e))}function DC(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function NC(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=os(-1,1),t.tag=2,si(n,t,1))),n.lanes|=1),e)}var j$=ys.ReactCurrentOwner,Ln=!1;function bn(e,t,n,r){t.child=e===null?f_(t,null,n,r):Gl(t,e.child,n,r)}function $C(e,t,n,r,o){n=n.render;var s=t.ref;return kl(t,o),r=rw(e,t,n,r,s,o),n=ow(),e!==null&&!Ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ps(e,t,o)):(lt&&n&&Kx(t),t.flags|=1,bn(e,t,r,o),t.child)}function LC(e,t,n,r,o){if(e===null){var s=n.type;return typeof s=="function"&&!fw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,z_(e,t,s,r,o)):(e=Ap(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&o)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:Vu,n(i,r)&&e.ref===t.ref)return ps(e,t,o)}return t.flags|=1,e=li(s,r),e.ref=t.ref,e.return=t,t.child=e}function z_(e,t,n,r,o){if(e!==null){var s=e.memoizedProps;if(Vu(s,r)&&e.ref===t.ref)if(Ln=!1,t.pendingProps=r=s,(e.lanes&o)!==0)e.flags&131072&&(Ln=!0);else return t.lanes=e.lanes,ps(e,t,o)}return eS(e,t,n,r,o)}function B_(e,t,n){var r=t.pendingProps,o=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(hl,er),er|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qe(hl,er),er|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Qe(hl,er),er|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Qe(hl,er),er|=r;return bn(e,t,o,n),t.child}function U_(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function eS(e,t,n,r,o){var s=Bn(n)?ua:fn.current;return s=Kl(t,s),kl(t,o),n=rw(e,t,n,r,s,o),r=ow(),e!==null&&!Ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ps(e,t,o)):(lt&&r&&Kx(t),t.flags|=1,bn(e,t,n,o),t.child)}function FC(e,t,n,r,o){if(Bn(n)){var s=!0;Df(t)}else s=!1;if(kl(t,o),t.stateNode===null)_p(e,t),$_(t,n,r),Z0(t,n,r,o),r=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Rr(c):(c=Bn(n)?ua:fn.current,c=Kl(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==c)&&OC(t,i,r,c),Ls=!1;var h=t.memoizedState;i.state=h,zf(t,r,i,o),l=t.memoizedState,a!==r||h!==l||zn.current||Ls?(typeof u=="function"&&(Q0(t,n,u,r),l=t.memoizedState),(a=Ls||RC(t,n,a,r,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,m_(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Ur(t.type,a),i.props=c,d=t.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Rr(l):(l=Bn(n)?ua:fn.current,l=Kl(t,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&OC(t,i,r,l),Ls=!1,h=t.memoizedState,i.state=h,zf(t,r,i,o);var y=t.memoizedState;a!==d||h!==y||zn.current||Ls?(typeof f=="function"&&(Q0(t,n,f,r),y=t.memoizedState),(c=Ls||RC(t,n,c,r,h,y,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),i.props=r,i.state=y,i.context=l,r=c):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return tS(e,t,n,r,s,o)}function tS(e,t,n,r,o,s){U_(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return o&&PC(t,n,!1),ps(e,t,s);r=t.stateNode,j$.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Gl(t,e.child,null,s),t.child=Gl(t,null,a,s)):bn(e,t,a,s),t.memoizedState=r.state,o&&PC(t,n,!0),t.child}function H_(e){var t=e.stateNode;t.pendingContext?CC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&CC(e,t.context,!1),Jx(e,t.containerInfo)}function zC(e,t,n,r,o){return Wl(),Gx(o),t.flags|=256,bn(e,t,n,r),t.child}var nS={dehydrated:null,treeContext:null,retryLane:0};function rS(e){return{baseLanes:e,cachePool:null,transitions:null}}function V_(e,t,n){var r=t.pendingProps,o=dt.current,s=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(o&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Qe(dt,o&1),e===null)return X0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,s?(r=t.mode,s=t.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Xg(i,r,0,null),e=ia(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=rS(n),t.memoizedState=nS,e):aw(t,i));if(o=e.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return D$(e,t,i,r,a,o,n);if(s){s=r.fallback,i=t.mode,o=e.child,a=o.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=li(o,l),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?s=li(a,s):(s=ia(s,i,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,i=e.child.memoizedState,i=i===null?rS(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~n,t.memoizedState=nS,r}return s=e.child,e=s.sibling,r=li(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function aw(e,t){return t=Xg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Mh(e,t,n,r){return r!==null&&Gx(r),Gl(t,e.child,null,n),e=aw(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function D$(e,t,n,r,o,s,i){if(n)return t.flags&256?(t.flags&=-257,r=Iy(Error(Q(422))),Mh(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,o=t.mode,r=Xg({mode:"visible",children:r.children},o,0,null),s=ia(s,o,i,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Gl(t,e.child,null,i),t.child.memoizedState=rS(i),t.memoizedState=nS,s);if(!(t.mode&1))return Mh(e,t,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Q(419)),r=Iy(s,r,void 0),Mh(e,t,i,r)}if(a=(i&e.childLanes)!==0,Ln||a){if(r=Rt,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,hs(e,o),no(r,e,o,-1))}return pw(),r=Iy(Error(Q(421))),Mh(e,t,i,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Y$.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,ir=oi(o.nextSibling),ar=t,lt=!0,Yr=null,e!==null&&(kr[Er++]=ns,kr[Er++]=rs,kr[Er++]=da,ns=e.id,rs=e.overflow,da=t),t=aw(t,r.children),t.flags|=4096,t)}function BC(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),q0(e.return,t,n)}function _y(e,t,n,r,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o)}function K_(e,t,n){var r=t.pendingProps,o=r.revealOrder,s=r.tail;if(bn(e,t,r.children,n),r=dt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&BC(e,n,t);else if(e.tag===19)BC(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Qe(dt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Bf(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),_y(t,!1,o,n,s);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Bf(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}_y(t,!0,n,null,s);break;case"together":_y(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _p(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ps(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pa|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=li(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=li(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function N$(e,t,n){switch(t.tag){case 3:H_(t),Wl();break;case 5:y_(t);break;case 1:Bn(t.type)&&Df(t);break;case 4:Jx(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Qe(Lf,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Qe(dt,dt.current&1),t.flags|=128,null):n&t.child.childLanes?V_(e,t,n):(Qe(dt,dt.current&1),e=ps(e,t,n),e!==null?e.sibling:null);Qe(dt,dt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return K_(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Qe(dt,dt.current),r)break;return null;case 22:case 23:return t.lanes=0,B_(e,t,n)}return ps(e,t,n)}var W_,oS,G_,Y_;W_=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};oS=function(){};G_=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,qi(Io.current);var s=null;switch(n){case"input":o=E0(e,o),r=E0(e,r),s=[];break;case"select":o=gt({},o,{value:void 0}),r=gt({},r,{value:void 0}),s=[];break;case"textarea":o=T0(e,o),r=T0(e,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Of)}A0(n,r);var i;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var a=o[c];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&($u.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&($u.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&rt("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Y_=function(e,t,n,r){n!==r&&(t.flags|=4)};function zc(e,t){if(!lt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function en(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $$(e,t,n){var r=t.pendingProps;switch(Wx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(t),null;case 1:return Bn(t.type)&&jf(),en(t),null;case 3:return r=t.stateNode,Yl(),st(zn),st(fn),tw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(_h(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yr!==null&&(hS(Yr),Yr=null))),oS(e,t),en(t),null;case 5:ew(t);var o=qi(Xu.current);if(n=t.type,e!==null&&t.stateNode!=null)G_(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return en(t),null}if(e=qi(Io.current),_h(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Co]=t,r[Gu]=s,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(o=0;o<hu.length;o++)rt(hu[o],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":q1(r,s),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},rt("invalid",r);break;case"textarea":Z1(r,s),rt("invalid",r)}A0(n,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var a=s[i];i==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ih(r.textContent,a,e),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ih(r.textContent,a,e),o=["children",""+a]):$u.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&rt("scroll",r)}switch(n){case"input":Sh(r),Q1(r,s,!0);break;case"textarea":Sh(r),J1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Of)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=bI(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Co]=t,e[Gu]=r,W_(e,t,!1,!1),t.stateNode=e;e:{switch(i=R0(n,r),n){case"dialog":rt("cancel",e),rt("close",e),o=r;break;case"iframe":case"object":case"embed":rt("load",e),o=r;break;case"video":case"audio":for(o=0;o<hu.length;o++)rt(hu[o],e);o=r;break;case"source":rt("error",e),o=r;break;case"img":case"image":case"link":rt("error",e),rt("load",e),o=r;break;case"details":rt("toggle",e),o=r;break;case"input":q1(e,r),o=E0(e,r),rt("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=gt({},r,{value:void 0}),rt("invalid",e);break;case"textarea":Z1(e,r),o=T0(e,r),rt("invalid",e);break;default:o=r}A0(n,o),a=o;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?kI(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CI(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Lu(e,l):typeof l=="number"&&Lu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($u.hasOwnProperty(s)?l!=null&&s==="onScroll"&&rt("scroll",e):l!=null&&Ax(e,s,l,i))}switch(n){case"input":Sh(e),Q1(e,r,!1);break;case"textarea":Sh(e),J1(e);break;case"option":r.value!=null&&e.setAttribute("value",""+hi(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?wl(e,!!r.multiple,s,!1):r.defaultValue!=null&&wl(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Of)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return en(t),null;case 6:if(e&&t.stateNode!=null)Y_(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=qi(Xu.current),qi(Io.current),_h(t)){if(r=t.stateNode,n=t.memoizedProps,r[Co]=t,(s=r.nodeValue!==n)&&(e=ar,e!==null))switch(e.tag){case 3:Ih(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ih(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Co]=t,t.stateNode=r}return en(t),null;case 13:if(st(dt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(lt&&ir!==null&&t.mode&1&&!(t.flags&128))h_(),Wl(),t.flags|=98560,s=!1;else if(s=_h(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(Q(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[Co]=t}else Wl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;en(t),s=!1}else Yr!==null&&(hS(Yr),Yr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||dt.current&1?_t===0&&(_t=3):pw())),t.updateQueue!==null&&(t.flags|=4),en(t),null);case 4:return Yl(),oS(e,t),e===null&&Ku(t.stateNode.containerInfo),en(t),null;case 10:return qx(t.type._context),en(t),null;case 17:return Bn(t.type)&&jf(),en(t),null;case 19:if(st(dt),s=t.memoizedState,s===null)return en(t),null;if(r=(t.flags&128)!==0,i=s.rendering,i===null)if(r)zc(s,!1);else{if(_t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Bf(e),i!==null){for(t.flags|=128,zc(s,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Qe(dt,dt.current&1|2),t.child}e=e.sibling}s.tail!==null&&wt()>ql&&(t.flags|=128,r=!0,zc(s,!1),t.lanes=4194304)}else{if(!r)if(e=Bf(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),zc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!lt)return en(t),null}else 2*wt()-s.renderingStartTime>ql&&n!==1073741824&&(t.flags|=128,r=!0,zc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(n=s.last,n!==null?n.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=wt(),t.sibling=null,n=dt.current,Qe(dt,r?n&1|2:n&1),t):(en(t),null);case 22:case 23:return hw(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?er&1073741824&&(en(t),t.subtreeFlags&6&&(t.flags|=8192)):en(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function L$(e,t){switch(Wx(t),t.tag){case 1:return Bn(t.type)&&jf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Yl(),st(zn),st(fn),tw(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ew(t),null;case 13:if(st(dt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));Wl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return st(dt),null;case 4:return Yl(),null;case 10:return qx(t.type._context),null;case 22:case 23:return hw(),null;case 24:return null;default:return null}}var Ah=!1,an=!1,F$=typeof WeakSet=="function"?WeakSet:Set,oe=null;function dl(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xt(e,t,r)}else n.current=null}function sS(e,t,n){try{n()}catch(r){xt(e,t,r)}}var UC=!1;function z$(e,t){if(U0=Mf,e=JI(),Vx(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var f;d!==n||o!==0&&d.nodeType!==3||(a=i+o),d!==s||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break t;if(h===n&&++c===o&&(a=i),h===s&&++u===r&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(H0={focusedElem:e,selectionRange:n},Mf=!1,oe=t;oe!==null;)if(t=oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,oe=e;else for(;oe!==null;){t=oe;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,m=y.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ur(t.type,g),m);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(C){xt(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,oe=e;break}oe=t.return}return y=UC,UC=!1,y}function Pu(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var s=o.destroy;o.destroy=void 0,s!==void 0&&sS(t,n,s)}o=o.next}while(o!==r)}}function Gg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iS(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function X_(e){var t=e.alternate;t!==null&&(e.alternate=null,X_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Co],delete t[Gu],delete t[W0],delete t[b$],delete t[C$])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function q_(e){return e.tag===5||e.tag===3||e.tag===4}function HC(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||q_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function aS(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Of));else if(r!==4&&(e=e.child,e!==null))for(aS(e,t,n),e=e.sibling;e!==null;)aS(e,t,n),e=e.sibling}function lS(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(lS(e,t,n),e=e.sibling;e!==null;)lS(e,t,n),e=e.sibling}var Bt=null,Kr=!1;function As(e,t,n){for(n=n.child;n!==null;)Q_(e,t,n),n=n.sibling}function Q_(e,t,n){if(Eo&&typeof Eo.onCommitFiberUnmount=="function")try{Eo.onCommitFiberUnmount(Fg,n)}catch{}switch(n.tag){case 5:an||dl(n,t);case 6:var r=Bt,o=Kr;Bt=null,As(e,t,n),Bt=r,Kr=o,Bt!==null&&(Kr?(e=Bt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Bt.removeChild(n.stateNode));break;case 18:Bt!==null&&(Kr?(e=Bt,n=n.stateNode,e.nodeType===8?wy(e.parentNode,n):e.nodeType===1&&wy(e,n),Uu(e)):wy(Bt,n.stateNode));break;case 4:r=Bt,o=Kr,Bt=n.stateNode.containerInfo,Kr=!0,As(e,t,n),Bt=r,Kr=o;break;case 0:case 11:case 14:case 15:if(!an&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&sS(n,t,i),o=o.next}while(o!==r)}As(e,t,n);break;case 1:if(!an&&(dl(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xt(n,t,a)}As(e,t,n);break;case 21:As(e,t,n);break;case 22:n.mode&1?(an=(r=an)||n.memoizedState!==null,As(e,t,n),an=r):As(e,t,n);break;default:As(e,t,n)}}function VC(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new F$),t.forEach(function(r){var o=X$.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Br(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var s=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:Bt=a.stateNode,Kr=!1;break e;case 3:Bt=a.stateNode.containerInfo,Kr=!0;break e;case 4:Bt=a.stateNode.containerInfo,Kr=!0;break e}a=a.return}if(Bt===null)throw Error(Q(160));Q_(s,i,o),Bt=null,Kr=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(c){xt(o,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Z_(t,e),t=t.sibling}function Z_(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Br(t,e),po(e),r&4){try{Pu(3,e,e.return),Gg(3,e)}catch(g){xt(e,e.return,g)}try{Pu(5,e,e.return)}catch(g){xt(e,e.return,g)}}break;case 1:Br(t,e),po(e),r&512&&n!==null&&dl(n,n.return);break;case 5:if(Br(t,e),po(e),r&512&&n!==null&&dl(n,n.return),e.flags&32){var o=e.stateNode;try{Lu(o,"")}catch(g){xt(e,e.return,g)}}if(r&4&&(o=e.stateNode,o!=null)){var s=e.memoizedProps,i=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&xI(o,s),R0(a,i);var c=R0(a,s);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?kI(o,d):u==="dangerouslySetInnerHTML"?CI(o,d):u==="children"?Lu(o,d):Ax(o,u,d,c)}switch(a){case"input":I0(o,s);break;case"textarea":wI(o,s);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?wl(o,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?wl(o,!!s.multiple,s.defaultValue,!0):wl(o,!!s.multiple,s.multiple?[]:"",!1))}o[Gu]=s}catch(g){xt(e,e.return,g)}}break;case 6:if(Br(t,e),po(e),r&4){if(e.stateNode===null)throw Error(Q(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(g){xt(e,e.return,g)}}break;case 3:if(Br(t,e),po(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Uu(t.containerInfo)}catch(g){xt(e,e.return,g)}break;case 4:Br(t,e),po(e);break;case 13:Br(t,e),po(e),o=e.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(uw=wt())),r&4&&VC(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(an=(c=an)||u,Br(t,e),an=c):Br(t,e),po(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(oe=e,u=e.child;u!==null;){for(d=oe=u;oe!==null;){switch(h=oe,f=h.child,h.tag){case 0:case 11:case 14:case 15:Pu(4,h,h.return);break;case 1:dl(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){xt(r,n,g)}}break;case 5:dl(h,h.return);break;case 22:if(h.memoizedState!==null){WC(d);continue}}f!==null?(f.return=h,oe=f):WC(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{o=d.stateNode,c?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=PI("display",i))}catch(g){xt(e,e.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){xt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Br(t,e),po(e),r&4&&VC(e);break;case 21:break;default:Br(t,e),po(e)}}function po(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(q_(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Lu(o,""),r.flags&=-33);var s=HC(e);lS(e,s,o);break;case 3:case 4:var i=r.stateNode.containerInfo,a=HC(e);aS(e,a,i);break;default:throw Error(Q(161))}}catch(l){xt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function B$(e,t,n){oe=e,J_(e)}function J_(e,t,n){for(var r=(e.mode&1)!==0;oe!==null;){var o=oe,s=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||Ah;if(!i){var a=o.alternate,l=a!==null&&a.memoizedState!==null||an;a=Ah;var c=an;if(Ah=i,(an=l)&&!c)for(oe=o;oe!==null;)i=oe,l=i.child,i.tag===22&&i.memoizedState!==null?GC(o):l!==null?(l.return=i,oe=l):GC(o);for(;s!==null;)oe=s,J_(s),s=s.sibling;oe=o,Ah=a,an=c}KC(e)}else o.subtreeFlags&8772&&s!==null?(s.return=o,oe=s):KC(e)}}function KC(e){for(;oe!==null;){var t=oe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:an||Gg(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!an)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Ur(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&TC(t,s,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}TC(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Uu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}an||t.flags&512&&iS(t)}catch(h){xt(t,t.return,h)}}if(t===e){oe=null;break}if(n=t.sibling,n!==null){n.return=t.return,oe=n;break}oe=t.return}}function WC(e){for(;oe!==null;){var t=oe;if(t===e){oe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,oe=n;break}oe=t.return}}function GC(e){for(;oe!==null;){var t=oe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Gg(4,t)}catch(l){xt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(l){xt(t,o,l)}}var s=t.return;try{iS(t)}catch(l){xt(t,s,l)}break;case 5:var i=t.return;try{iS(t)}catch(l){xt(t,i,l)}}}catch(l){xt(t,t.return,l)}if(t===e){oe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,oe=a;break}oe=t.return}}var U$=Math.ceil,Vf=ys.ReactCurrentDispatcher,lw=ys.ReactCurrentOwner,Mr=ys.ReactCurrentBatchConfig,Ae=0,Rt=null,Pt=null,Yt=0,er=0,hl=ki(0),_t=0,Ju=null,pa=0,Yg=0,cw=0,ku=null,Nn=null,uw=0,ql=1/0,Xo=null,Kf=!1,cS=null,ii=null,Rh=!1,Xs=null,Wf=0,Eu=0,uS=null,Tp=-1,Mp=0;function En(){return Ae&6?wt():Tp!==-1?Tp:Tp=wt()}function ai(e){return e.mode&1?Ae&2&&Yt!==0?Yt&-Yt:k$.transition!==null?(Mp===0&&(Mp=$I()),Mp):(e=He,e!==0||(e=window.event,e=e===void 0?16:VI(e.type)),e):1}function no(e,t,n,r){if(50<Eu)throw Eu=0,uS=null,Error(Q(185));Ed(e,n,r),(!(Ae&2)||e!==Rt)&&(e===Rt&&(!(Ae&2)&&(Yg|=n),_t===4&&Bs(e,Yt)),Un(e,r),n===1&&Ae===0&&!(t.mode&1)&&(ql=wt()+500,Vg&&Ei()))}function Un(e,t){var n=e.callbackNode;kN(e,t);var r=Tf(e,e===Rt?Yt:0);if(r===0)n!==null&&nC(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&nC(n),t===1)e.tag===0?P$(YC.bind(null,e)):c_(YC.bind(null,e)),x$(function(){!(Ae&6)&&Ei()}),n=null;else{switch(LI(r)){case 1:n=Nx;break;case 4:n=DI;break;case 16:n=_f;break;case 536870912:n=NI;break;default:n=_f}n=aT(n,eT.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function eT(e,t){if(Tp=-1,Mp=0,Ae&6)throw Error(Q(327));var n=e.callbackNode;if(El()&&e.callbackNode!==n)return null;var r=Tf(e,e===Rt?Yt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Gf(e,r);else{t=r;var o=Ae;Ae|=2;var s=nT();(Rt!==e||Yt!==t)&&(Xo=null,ql=wt()+500,sa(e,t));do try{K$();break}catch(a){tT(e,a)}while(!0);Xx(),Vf.current=s,Ae=o,Pt!==null?t=0:(Rt=null,Yt=0,t=_t)}if(t!==0){if(t===2&&(o=$0(e),o!==0&&(r=o,t=dS(e,o))),t===1)throw n=Ju,sa(e,0),Bs(e,r),Un(e,wt()),n;if(t===6)Bs(e,r);else{if(o=e.current.alternate,!(r&30)&&!H$(o)&&(t=Gf(e,r),t===2&&(s=$0(e),s!==0&&(r=s,t=dS(e,s))),t===1))throw n=Ju,sa(e,0),Bs(e,r),Un(e,wt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:Ui(e,Nn,Xo);break;case 3:if(Bs(e,r),(r&130023424)===r&&(t=uw+500-wt(),10<t)){if(Tf(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){En(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=K0(Ui.bind(null,e,Nn,Xo),t);break}Ui(e,Nn,Xo);break;case 4:if(Bs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var i=31-to(r);s=1<<i,i=t[i],i>o&&(o=i),r&=~s}if(r=o,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*U$(r/1960))-r,10<r){e.timeoutHandle=K0(Ui.bind(null,e,Nn,Xo),r);break}Ui(e,Nn,Xo);break;case 5:Ui(e,Nn,Xo);break;default:throw Error(Q(329))}}}return Un(e,wt()),e.callbackNode===n?eT.bind(null,e):null}function dS(e,t){var n=ku;return e.current.memoizedState.isDehydrated&&(sa(e,t).flags|=256),e=Gf(e,t),e!==2&&(t=Nn,Nn=n,t!==null&&hS(t)),e}function hS(e){Nn===null?Nn=e:Nn.push.apply(Nn,e)}function H$(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],s=o.getSnapshot;o=o.value;try{if(!io(s(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bs(e,t){for(t&=~cw,t&=~Yg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-to(t),r=1<<n;e[n]=-1,t&=~r}}function YC(e){if(Ae&6)throw Error(Q(327));El();var t=Tf(e,0);if(!(t&1))return Un(e,wt()),null;var n=Gf(e,t);if(e.tag!==0&&n===2){var r=$0(e);r!==0&&(t=r,n=dS(e,r))}if(n===1)throw n=Ju,sa(e,0),Bs(e,t),Un(e,wt()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ui(e,Nn,Xo),Un(e,wt()),null}function dw(e,t){var n=Ae;Ae|=1;try{return e(t)}finally{Ae=n,Ae===0&&(ql=wt()+500,Vg&&Ei())}}function fa(e){Xs!==null&&Xs.tag===0&&!(Ae&6)&&El();var t=Ae;Ae|=1;var n=Mr.transition,r=He;try{if(Mr.transition=null,He=1,e)return e()}finally{He=r,Mr.transition=n,Ae=t,!(Ae&6)&&Ei()}}function hw(){er=hl.current,st(hl)}function sa(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,S$(n)),Pt!==null)for(n=Pt.return;n!==null;){var r=n;switch(Wx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jf();break;case 3:Yl(),st(zn),st(fn),tw();break;case 5:ew(r);break;case 4:Yl();break;case 13:st(dt);break;case 19:st(dt);break;case 10:qx(r.type._context);break;case 22:case 23:hw()}n=n.return}if(Rt=e,Pt=e=li(e.current,null),Yt=er=t,_t=0,Ju=null,cw=Yg=pa=0,Nn=ku=null,Xi!==null){for(t=0;t<Xi.length;t++)if(n=Xi[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=o,r.next=i}n.pending=r}Xi=null}return e}function tT(e,t){do{var n=Pt;try{if(Xx(),Ep.current=Hf,Uf){for(var r=ft.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Uf=!1}if(ha=0,At=It=ft=null,Cu=!1,qu=0,lw.current=null,n===null||n.return===null){_t=1,Ju=t,Pt=null;break}e:{var s=e,i=n.return,a=n,l=t;if(t=Yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=DC(i);if(f!==null){f.flags&=-257,NC(f,i,a,s,t),f.mode&1&&jC(s,c,t),t=f,l=c;var y=t.updateQueue;if(y===null){var g=new Set;g.add(l),t.updateQueue=g}else y.add(l);break e}else{if(!(t&1)){jC(s,c,t),pw();break e}l=Error(Q(426))}}else if(lt&&a.mode&1){var m=DC(i);if(m!==null){!(m.flags&65536)&&(m.flags|=256),NC(m,i,a,s,t),Gx(Xl(l,a));break e}}s=l=Xl(l,a),_t!==4&&(_t=2),ku===null?ku=[s]:ku.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=L_(s,l,t);_C(s,v);break e;case 1:a=l;var x=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ii===null||!ii.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var C=F_(s,a,t);_C(s,C);break e}}s=s.return}while(s!==null)}oT(n)}catch(P){t=P,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(!0)}function nT(){var e=Vf.current;return Vf.current=Hf,e===null?Hf:e}function pw(){(_t===0||_t===3||_t===2)&&(_t=4),Rt===null||!(pa&268435455)&&!(Yg&268435455)||Bs(Rt,Yt)}function Gf(e,t){var n=Ae;Ae|=2;var r=nT();(Rt!==e||Yt!==t)&&(Xo=null,sa(e,t));do try{V$();break}catch(o){tT(e,o)}while(!0);if(Xx(),Ae=n,Vf.current=r,Pt!==null)throw Error(Q(261));return Rt=null,Yt=0,_t}function V$(){for(;Pt!==null;)rT(Pt)}function K$(){for(;Pt!==null&&!mN();)rT(Pt)}function rT(e){var t=iT(e.alternate,e,er);e.memoizedProps=e.pendingProps,t===null?oT(e):Pt=t,lw.current=null}function oT(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=L$(n,t),n!==null){n.flags&=32767,Pt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,Pt=null;return}}else if(n=$$(n,t,er),n!==null){Pt=n;return}if(t=t.sibling,t!==null){Pt=t;return}Pt=t=e}while(t!==null);_t===0&&(_t=5)}function Ui(e,t,n){var r=He,o=Mr.transition;try{Mr.transition=null,He=1,W$(e,t,n,r)}finally{Mr.transition=o,He=r}return null}function W$(e,t,n,r){do El();while(Xs!==null);if(Ae&6)throw Error(Q(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(EN(e,s),e===Rt&&(Pt=Rt=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Rh||(Rh=!0,aT(_f,function(){return El(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Mr.transition,Mr.transition=null;var i=He;He=1;var a=Ae;Ae|=4,lw.current=null,z$(e,n),Z_(n,e),h$(H0),Mf=!!U0,H0=U0=null,e.current=n,B$(n),yN(),Ae=a,He=i,Mr.transition=s}else e.current=n;if(Rh&&(Rh=!1,Xs=e,Wf=o),s=e.pendingLanes,s===0&&(ii=null),xN(n.stateNode),Un(e,wt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Kf)throw Kf=!1,e=cS,cS=null,e;return Wf&1&&e.tag!==0&&El(),s=e.pendingLanes,s&1?e===uS?Eu++:(Eu=0,uS=e):Eu=0,Ei(),null}function El(){if(Xs!==null){var e=LI(Wf),t=Mr.transition,n=He;try{if(Mr.transition=null,He=16>e?16:e,Xs===null)var r=!1;else{if(e=Xs,Xs=null,Wf=0,Ae&6)throw Error(Q(331));var o=Ae;for(Ae|=4,oe=e.current;oe!==null;){var s=oe,i=s.child;if(oe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(oe=c;oe!==null;){var u=oe;switch(u.tag){case 0:case 11:case 15:Pu(8,u,s)}var d=u.child;if(d!==null)d.return=u,oe=d;else for(;oe!==null;){u=oe;var h=u.sibling,f=u.return;if(X_(u),u===c){oe=null;break}if(h!==null){h.return=f,oe=h;break}oe=f}}}var y=s.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}oe=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,oe=i;else e:for(;oe!==null;){if(s=oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Pu(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,oe=v;break e}oe=s.return}}var x=e.current;for(oe=x;oe!==null;){i=oe;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,oe=w;else e:for(i=x;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Gg(9,a)}}catch(P){xt(a,a.return,P)}if(a===i){oe=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,oe=C;break e}oe=a.return}}if(Ae=o,Ei(),Eo&&typeof Eo.onPostCommitFiberRoot=="function")try{Eo.onPostCommitFiberRoot(Fg,e)}catch{}r=!0}return r}finally{He=n,Mr.transition=t}}return!1}function XC(e,t,n){t=Xl(n,t),t=L_(e,t,1),e=si(e,t,1),t=En(),e!==null&&(Ed(e,1,t),Un(e,t))}function xt(e,t,n){if(e.tag===3)XC(e,e,n);else for(;t!==null;){if(t.tag===3){XC(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ii===null||!ii.has(r))){e=Xl(n,e),e=F_(t,e,1),t=si(t,e,1),e=En(),t!==null&&(Ed(t,1,e),Un(t,e));break}}t=t.return}}function G$(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=En(),e.pingedLanes|=e.suspendedLanes&n,Rt===e&&(Yt&n)===n&&(_t===4||_t===3&&(Yt&130023424)===Yt&&500>wt()-uw?sa(e,0):cw|=n),Un(e,t)}function sT(e,t){t===0&&(e.mode&1?(t=bh,bh<<=1,!(bh&130023424)&&(bh=4194304)):t=1);var n=En();e=hs(e,t),e!==null&&(Ed(e,t,n),Un(e,n))}function Y$(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),sT(e,n)}function X$(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),sT(e,n)}var iT;iT=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||zn.current)Ln=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ln=!1,N$(e,t,n);Ln=!!(e.flags&131072)}else Ln=!1,lt&&t.flags&1048576&&u_(t,$f,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;_p(e,t),e=t.pendingProps;var o=Kl(t,fn.current);kl(t,n),o=rw(null,t,r,e,o,n);var s=ow();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bn(r)?(s=!0,Df(t)):s=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Zx(t),o.updater=Wg,t.stateNode=o,o._reactInternals=t,Z0(t,r,e,n),t=tS(null,t,r,!0,s,n)):(t.tag=0,lt&&s&&Kx(t),bn(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(_p(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=Q$(r),e=Ur(r,e),o){case 0:t=eS(null,t,r,e,n);break e;case 1:t=FC(null,t,r,e,n);break e;case 11:t=$C(null,t,r,e,n);break e;case 14:t=LC(null,t,r,Ur(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Ur(r,o),eS(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Ur(r,o),FC(e,t,r,o,n);case 3:e:{if(H_(t),e===null)throw Error(Q(387));r=t.pendingProps,s=t.memoizedState,o=s.element,m_(e,t),zf(t,r,null,n);var i=t.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){o=Xl(Error(Q(423)),t),t=zC(e,t,r,n,o);break e}else if(r!==o){o=Xl(Error(Q(424)),t),t=zC(e,t,r,n,o);break e}else for(ir=oi(t.stateNode.containerInfo.firstChild),ar=t,lt=!0,Yr=null,n=f_(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wl(),r===o){t=ps(e,t,n);break e}bn(e,t,r,n)}t=t.child}return t;case 5:return y_(t),e===null&&X0(t),r=t.type,o=t.pendingProps,s=e!==null?e.memoizedProps:null,i=o.children,V0(r,o)?i=null:s!==null&&V0(r,s)&&(t.flags|=32),U_(e,t),bn(e,t,i,n),t.child;case 6:return e===null&&X0(t),null;case 13:return V_(e,t,n);case 4:return Jx(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gl(t,null,r,n):bn(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Ur(r,o),$C(e,t,r,o,n);case 7:return bn(e,t,t.pendingProps,n),t.child;case 8:return bn(e,t,t.pendingProps.children,n),t.child;case 12:return bn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,s=t.memoizedProps,i=o.value,Qe(Lf,r._currentValue),r._currentValue=i,s!==null)if(io(s.value,i)){if(s.children===o.children&&!zn.current){t=ps(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){i=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=os(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),q0(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(Q(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),q0(i,n,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}bn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,kl(t,n),o=Rr(o),r=r(o),t.flags|=1,bn(e,t,r,n),t.child;case 14:return r=t.type,o=Ur(r,t.pendingProps),o=Ur(r.type,o),LC(e,t,r,o,n);case 15:return z_(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Ur(r,o),_p(e,t),t.tag=1,Bn(r)?(e=!0,Df(t)):e=!1,kl(t,n),$_(t,r,o),Z0(t,r,o,n),tS(null,t,r,!0,e,n);case 19:return K_(e,t,n);case 22:return B_(e,t,n)}throw Error(Q(156,t.tag))};function aT(e,t){return jI(e,t)}function q$(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(e,t,n,r){return new q$(e,t,n,r)}function fw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Q$(e){if(typeof e=="function")return fw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ox)return 11;if(e===jx)return 14}return 2}function li(e,t){var n=e.alternate;return n===null?(n=Tr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ap(e,t,n,r,o,s){var i=2;if(r=e,typeof e=="function")fw(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case nl:return ia(n.children,o,s,t);case Rx:i=8,o|=8;break;case b0:return e=Tr(12,n,t,o|2),e.elementType=b0,e.lanes=s,e;case C0:return e=Tr(13,n,t,o),e.elementType=C0,e.lanes=s,e;case P0:return e=Tr(19,n,t,o),e.elementType=P0,e.lanes=s,e;case yI:return Xg(n,o,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gI:i=10;break e;case mI:i=9;break e;case Ox:i=11;break e;case jx:i=14;break e;case $s:i=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=Tr(i,n,t,o),t.elementType=e,t.type=r,t.lanes=s,t}function ia(e,t,n,r){return e=Tr(7,e,r,t),e.lanes=n,e}function Xg(e,t,n,r){return e=Tr(22,e,r,t),e.elementType=yI,e.lanes=n,e.stateNode={isHidden:!1},e}function Ty(e,t,n){return e=Tr(6,e,null,t),e.lanes=n,e}function My(e,t,n){return t=Tr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Z$(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uy(0),this.expirationTimes=uy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uy(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function gw(e,t,n,r,o,s,i,a,l){return e=new Z$(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Tr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zx(s),e}function J$(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function lT(e){if(!e)return pi;e=e._reactInternals;e:{if(ba(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(Bn(n))return l_(e,n,t)}return t}function cT(e,t,n,r,o,s,i,a,l){return e=gw(n,r,!0,e,o,s,i,a,l),e.context=lT(null),n=e.current,r=En(),o=ai(n),s=os(r,o),s.callback=t??null,si(n,s,o),e.current.lanes=o,Ed(e,o,r),Un(e,r),e}function qg(e,t,n,r){var o=t.current,s=En(),i=ai(o);return n=lT(n),t.context===null?t.context=n:t.pendingContext=n,t=os(s,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=si(o,t,i),e!==null&&(no(e,o,i,s),kp(e,o,i)),i}function Yf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function qC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function mw(e,t){qC(e,t),(e=e.alternate)&&qC(e,t)}function eL(){return null}var uT=typeof reportError=="function"?reportError:function(e){console.error(e)};function yw(e){this._internalRoot=e}Qg.prototype.render=yw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));qg(e,t,null,null)};Qg.prototype.unmount=yw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fa(function(){qg(null,e,null,null)}),t[ds]=null}};function Qg(e){this._internalRoot=e}Qg.prototype.unstable_scheduleHydration=function(e){if(e){var t=BI();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zs.length&&t!==0&&t<zs[n].priority;n++);zs.splice(n,0,e),n===0&&HI(e)}};function vw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Zg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function QC(){}function tL(e,t,n,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var c=Yf(i);s.call(c)}}var i=cT(t,r,e,0,null,!1,!1,"",QC);return e._reactRootContainer=i,e[ds]=i.current,Ku(e.nodeType===8?e.parentNode:e),fa(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var c=Yf(l);a.call(c)}}var l=gw(e,0,!1,null,null,!1,!1,"",QC);return e._reactRootContainer=l,e[ds]=l.current,Ku(e.nodeType===8?e.parentNode:e),fa(function(){qg(t,l,n,r)}),l}function Jg(e,t,n,r,o){var s=n._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var a=o;o=function(){var l=Yf(i);a.call(l)}}qg(t,i,e,o)}else i=tL(n,t,e,o,r);return Yf(i)}FI=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=du(t.pendingLanes);n!==0&&($x(t,n|1),Un(t,wt()),!(Ae&6)&&(ql=wt()+500,Ei()))}break;case 13:fa(function(){var r=hs(e,1);if(r!==null){var o=En();no(r,e,1,o)}}),mw(e,1)}};Lx=function(e){if(e.tag===13){var t=hs(e,134217728);if(t!==null){var n=En();no(t,e,134217728,n)}mw(e,134217728)}};zI=function(e){if(e.tag===13){var t=ai(e),n=hs(e,t);if(n!==null){var r=En();no(n,e,t,r)}mw(e,t)}};BI=function(){return He};UI=function(e,t){var n=He;try{return He=e,t()}finally{He=n}};j0=function(e,t,n){switch(t){case"input":if(I0(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Hg(r);if(!o)throw Error(Q(90));SI(r),I0(r,o)}}}break;case"textarea":wI(e,n);break;case"select":t=n.value,t!=null&&wl(e,!!n.multiple,t,!1)}};_I=dw;TI=fa;var nL={usingClientEntryPoint:!1,Events:[_d,il,Hg,EI,II,dw]},Bc={findFiberByHostInstance:Yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rL={bundleType:Bc.bundleType,version:Bc.version,rendererPackageName:Bc.rendererPackageName,rendererConfig:Bc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ys.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=RI(e),e===null?null:e.stateNode},findFiberByHostInstance:Bc.findFiberByHostInstance||eL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oh.isDisabled&&Oh.supportsFiber)try{Fg=Oh.inject(rL),Eo=Oh}catch{}}pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nL;pr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vw(t))throw Error(Q(200));return J$(e,t,null,n)};pr.createRoot=function(e,t){if(!vw(e))throw Error(Q(299));var n=!1,r="",o=uT;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=gw(e,1,!1,null,null,n,!1,r,o),e[ds]=t.current,Ku(e.nodeType===8?e.parentNode:e),new yw(t)};pr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=RI(t),e=e===null?null:e.stateNode,e};pr.flushSync=function(e){return fa(e)};pr.hydrate=function(e,t,n){if(!Zg(t))throw Error(Q(200));return Jg(null,e,t,!0,n)};pr.hydrateRoot=function(e,t,n){if(!vw(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,o=!1,s="",i=uT;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=cT(t,null,e,1,n??null,o,!1,s,i),e[ds]=t.current,Ku(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Qg(t)};pr.render=function(e,t,n){if(!Zg(t))throw Error(Q(200));return Jg(null,e,t,!1,n)};pr.unmountComponentAtNode=function(e){if(!Zg(e))throw Error(Q(40));return e._reactRootContainer?(fa(function(){Jg(null,null,e,!1,function(){e._reactRootContainer=null,e[ds]=null})}),!0):!1};pr.unstable_batchedUpdates=dw;pr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zg(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return Jg(e,t,n,!1,r)};pr.version="18.3.1-next-f1338f8080-20240426";function dT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dT)}catch(e){console.error(e)}}dT(),dI.exports=pr;var Md=dI.exports;const hT=xa(Md);var pT,ZC=Md;pT=ZC.createRoot,ZC.hydrateRoot;const oL=1,sL=1e6;let Ay=0;function iL(){return Ay=(Ay+1)%Number.MAX_SAFE_INTEGER,Ay.toString()}const Ry=new Map,JC=e=>{if(Ry.has(e))return;const t=setTimeout(()=>{Ry.delete(e),Iu({type:"REMOVE_TOAST",toastId:e})},sL);Ry.set(e,t)},aL=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,oL)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?JC(n):e.toasts.forEach(r=>{JC(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Rp=[];let Op={toasts:[]};function Iu(e){Op=aL(Op,e),Rp.forEach(t=>{t(Op)})}function lL({...e}){const t=iL(),n=o=>Iu({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>Iu({type:"DISMISS_TOAST",toastId:t});return Iu({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:n}}function cL(){const[e,t]=b.useState(Op);return b.useEffect(()=>(Rp.push(t),()=>{const n=Rp.indexOf(t);n>-1&&Rp.splice(n,1)}),[e]),{...e,toast:lL,dismiss:n=>Iu({type:"DISMISS_TOAST",toastId:n})}}function ee(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function uL(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function em(...e){return t=>e.forEach(n=>uL(n,t))}function Ye(...e){return b.useCallback(em(...e),e)}function dL(e,t=[]){let n=[];function r(s,i){const a=b.createContext(i),l=n.length;n=[...n,i];function c(d){const{scope:h,children:f,...y}=d,g=(h==null?void 0:h[e][l])||a,m=b.useMemo(()=>y,Object.values(y));return p.jsx(g.Provider,{value:m,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,y=b.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=n.map(i=>b.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,hL(o,...t)]}function hL(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var fi=b.forwardRef((e,t)=>{const{children:n,...r}=e,o=b.Children.toArray(n),s=o.find(pL);if(s){const i=s.props.children,a=o.map(l=>l===s?b.Children.count(i)>1?b.Children.only(null):b.isValidElement(i)?i.props.children:null:l);return p.jsx(pS,{...r,ref:t,children:b.isValidElement(i)?b.cloneElement(i,void 0,a):null})}return p.jsx(pS,{...r,ref:t,children:n})});fi.displayName="Slot";var pS=b.forwardRef((e,t)=>{const{children:n,...r}=e;if(b.isValidElement(n)){const o=gL(n);return b.cloneElement(n,{...fL(r,n.props),ref:t?em(t,o):o})}return b.Children.count(n)>1?b.Children.only(null):null});pS.displayName="SlotClone";var fT=({children:e})=>p.jsx(p.Fragment,{children:e});function pL(e){return b.isValidElement(e)&&e.type===fT}function fL(e,t){const n={...t};for(const r in t){const o=e[r],s=t[r];/^on[A-Z]/.test(r)?o&&s?n[r]=(...a)=>{s(...a),o(...a)}:o&&(n[r]=o):r==="style"?n[r]={...o,...s}:r==="className"&&(n[r]=[o,s].filter(Boolean).join(" "))}return{...e,...n}}function gL(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function tm(e){const t=e+"CollectionProvider",[n,r]=dL(t),[o,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=f=>{const{scope:y,children:g}=f,m=H.useRef(null),v=H.useRef(new Map).current;return p.jsx(o,{scope:y,itemMap:v,collectionRef:m,children:g})};i.displayName=t;const a=e+"CollectionSlot",l=H.forwardRef((f,y)=>{const{scope:g,children:m}=f,v=s(a,g),x=Ye(y,v.collectionRef);return p.jsx(fi,{ref:x,children:m})});l.displayName=a;const c=e+"CollectionItemSlot",u="data-radix-collection-item",d=H.forwardRef((f,y)=>{const{scope:g,children:m,...v}=f,x=H.useRef(null),w=Ye(y,x),C=s(c,g);return H.useEffect(()=>(C.itemMap.set(x,{ref:x,...v}),()=>void C.itemMap.delete(x))),p.jsx(fi,{[u]:"",ref:w,children:m})});d.displayName=c;function h(f){const y=s(e+"CollectionConsumer",f);return H.useCallback(()=>{const m=y.collectionRef.current;if(!m)return[];const v=Array.from(m.querySelectorAll(`[${u}]`));return Array.from(y.itemMap.values()).sort((C,P)=>v.indexOf(C.ref.current)-v.indexOf(P.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:l,ItemSlot:d},h,r]}function mL(e,t){const n=b.createContext(t),r=s=>{const{children:i,...a}=s,l=b.useMemo(()=>a,Object.values(a));return p.jsx(n.Provider,{value:l,children:i})};r.displayName=e+"Provider";function o(s){const i=b.useContext(n);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[r,o]}function vs(e,t=[]){let n=[];function r(s,i){const a=b.createContext(i),l=n.length;n=[...n,i];const c=d=>{var v;const{scope:h,children:f,...y}=d,g=((v=h==null?void 0:h[e])==null?void 0:v[l])||a,m=b.useMemo(()=>y,Object.values(y));return p.jsx(g.Provider,{value:m,children:f})};c.displayName=s+"Provider";function u(d,h){var g;const f=((g=h==null?void 0:h[e])==null?void 0:g[l])||a,y=b.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const o=()=>{const s=n.map(i=>b.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,yL(o,...t)]}function yL(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var vL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ce=vL.reduce((e,t)=>{const n=b.forwardRef((r,o)=>{const{asChild:s,...i}=r,a=s?fi:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(a,{...i,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Sw(e,t){e&&Md.flushSync(()=>e.dispatchEvent(t))}function qt(e){const t=b.useRef(e);return b.useEffect(()=>{t.current=e}),b.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function SL(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e);b.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var xL="DismissableLayer",fS="dismissableLayer.update",wL="dismissableLayer.pointerDownOutside",bL="dismissableLayer.focusOutside",eP,gT=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cc=b.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:a,...l}=e,c=b.useContext(gT),[u,d]=b.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=b.useState({}),y=Ye(t,I=>d(I)),g=Array.from(c.layers),[m]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(m),x=u?g.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,C=x>=v,P=PL(I=>{const _=I.target,M=[...c.branches].some(T=>T.contains(_));!C||M||(o==null||o(I),i==null||i(I),I.defaultPrevented||a==null||a())},h),k=kL(I=>{const _=I.target;[...c.branches].some(T=>T.contains(_))||(s==null||s(I),i==null||i(I),I.defaultPrevented||a==null||a())},h);return SL(I=>{x===c.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&a&&(I.preventDefault(),a()))},h),b.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(eP=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),tP(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=eP)}},[u,h,n,c]),b.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),tP())},[u,c]),b.useEffect(()=>{const I=()=>f({});return document.addEventListener(fS,I),()=>document.removeEventListener(fS,I)},[]),p.jsx(Ce.div,{...l,ref:y,style:{pointerEvents:w?C?"auto":"none":void 0,...e.style},onFocusCapture:ee(e.onFocusCapture,k.onFocusCapture),onBlurCapture:ee(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:ee(e.onPointerDownCapture,P.onPointerDownCapture)})});cc.displayName=xL;var CL="DismissableLayerBranch",mT=b.forwardRef((e,t)=>{const n=b.useContext(gT),r=b.useRef(null),o=Ye(t,r);return b.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),p.jsx(Ce.div,{...e,ref:o})});mT.displayName=CL;function PL(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e),r=b.useRef(!1),o=b.useRef(()=>{});return b.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){yT(wL,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=l,t.addEventListener("click",o.current,{once:!0})):l()}else t.removeEventListener("click",o.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function kL(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e),r=b.useRef(!1);return b.useEffect(()=>{const o=s=>{s.target&&!r.current&&yT(bL,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function tP(){const e=new CustomEvent(fS);document.dispatchEvent(e)}function yT(e,t,n,{discrete:r}){const o=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Sw(o,s):o.dispatchEvent(s)}var EL=cc,IL=mT,gi=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},_L="Portal",Ad=b.forwardRef((e,t)=>{var a;const{container:n,...r}=e,[o,s]=b.useState(!1);gi(()=>s(!0),[]);const i=n||o&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return i?hT.createPortal(p.jsx(Ce.div,{...r,ref:t}),i):null});Ad.displayName=_L;function TL(e,t){return b.useReducer((n,r)=>t[n][r]??n,e)}var gr=e=>{const{present:t,children:n}=e,r=ML(t),o=typeof n=="function"?n({present:r.isPresent}):b.Children.only(n),s=Ye(r.ref,AL(o));return typeof n=="function"||r.isPresent?b.cloneElement(o,{ref:s}):null};gr.displayName="Presence";function ML(e){const[t,n]=b.useState(),r=b.useRef({}),o=b.useRef(e),s=b.useRef("none"),i=e?"mounted":"unmounted",[a,l]=TL(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const c=jh(r.current);s.current=a==="mounted"?c:"none"},[a]),gi(()=>{const c=r.current,u=o.current;if(u!==e){const h=s.current,f=jh(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,l]),gi(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=f=>{const g=jh(r.current).includes(f.animationName);if(f.target===t&&g&&(l("ANIMATION_END"),!o.current)){const m=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=m)})}},h=f=>{f.target===t&&(s.current=jh(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:b.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function jh(e){return(e==null?void 0:e.animationName)||"none"}function AL(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Ss({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,o]=RL({defaultProp:t,onChange:n}),s=e!==void 0,i=s?e:r,a=qt(n),l=b.useCallback(c=>{if(s){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else o(c)},[s,e,o,a]);return[i,l]}function RL({defaultProp:e,onChange:t}){const n=b.useState(e),[r]=n,o=b.useRef(r),s=qt(t);return b.useEffect(()=>{o.current!==r&&(s(r),o.current=r)},[r,o,s]),n}var OL="VisuallyHidden",nm=b.forwardRef((e,t)=>p.jsx(Ce.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));nm.displayName=OL;var jL=nm,xw="ToastProvider",[ww,DL,NL]=tm("Toast"),[vT,vce]=vs("Toast",[NL]),[$L,rm]=vT(xw),bw=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:s=50,children:i}=e,[a,l]=b.useState(null),[c,u]=b.useState(0),d=b.useRef(!1),h=b.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${xw}\`. Expected non-empty \`string\`.`),p.jsx(ww.Provider,{scope:t,children:p.jsx($L,{scope:t,label:n,duration:r,swipeDirection:o,swipeThreshold:s,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:b.useCallback(()=>u(f=>f+1),[]),onToastRemove:b.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:i})})};bw.displayName=xw;var ST="ToastViewport",LL=["F8"],gS="toast.viewportPause",mS="toast.viewportResume",Cw=b.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=LL,label:o="Notifications ({hotkey})",...s}=e,i=rm(ST,n),a=DL(n),l=b.useRef(null),c=b.useRef(null),u=b.useRef(null),d=b.useRef(null),h=Ye(t,d,i.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=i.toastCount>0;b.useEffect(()=>{const m=v=>{var w;r.length!==0&&r.every(C=>v[C]||v.code===C)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[r]),b.useEffect(()=>{const m=l.current,v=d.current;if(y&&m&&v){const x=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(gS);v.dispatchEvent(k),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(mS);v.dispatchEvent(k),i.isClosePausedRef.current=!1}},C=k=>{!m.contains(k.relatedTarget)&&w()},P=()=>{m.contains(document.activeElement)||w()};return m.addEventListener("focusin",x),m.addEventListener("focusout",C),m.addEventListener("pointermove",x),m.addEventListener("pointerleave",P),window.addEventListener("blur",x),window.addEventListener("focus",w),()=>{m.removeEventListener("focusin",x),m.removeEventListener("focusout",C),m.removeEventListener("pointermove",x),m.removeEventListener("pointerleave",P),window.removeEventListener("blur",x),window.removeEventListener("focus",w)}}},[y,i.isClosePausedRef]);const g=b.useCallback(({tabbingDirection:m})=>{const x=a().map(w=>{const C=w.ref.current,P=[C,...QL(C)];return m==="forwards"?P:P.reverse()});return(m==="forwards"?x.reverse():x).flat()},[a]);return b.useEffect(()=>{const m=d.current;if(m){const v=x=>{var P,k,I;const w=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!w){const _=document.activeElement,M=x.shiftKey;if(x.target===m&&M){(P=c.current)==null||P.focus();return}const j=g({tabbingDirection:M?"backwards":"forwards"}),$=j.findIndex(L=>L===_);Oy(j.slice($+1))?x.preventDefault():M?(k=c.current)==null||k.focus():(I=u.current)==null||I.focus()}};return m.addEventListener("keydown",v),()=>m.removeEventListener("keydown",v)}},[a,g]),p.jsxs(IL,{ref:l,role:"region","aria-label":o.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&p.jsx(yS,{ref:c,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"forwards"});Oy(m)}}),p.jsx(ww.Slot,{scope:n,children:p.jsx(Ce.ol,{tabIndex:-1,...s,ref:h})}),y&&p.jsx(yS,{ref:u,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"backwards"});Oy(m)}})]})});Cw.displayName=ST;var xT="ToastFocusProxy",yS=b.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=e,s=rm(xT,n);return p.jsx(nm,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{var c;const a=i.relatedTarget;!((c=s.viewport)!=null&&c.contains(a))&&r()}})});yS.displayName=xT;var om="Toast",FL="toast.swipeStart",zL="toast.swipeMove",BL="toast.swipeCancel",UL="toast.swipeEnd",wT=b.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:s,...i}=e,[a=!0,l]=Ss({prop:r,defaultProp:o,onChange:s});return p.jsx(gr,{present:n||a,children:p.jsx(KL,{open:a,...i,ref:t,onClose:()=>l(!1),onPause:qt(e.onPause),onResume:qt(e.onResume),onSwipeStart:ee(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ee(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ee(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ee(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});wT.displayName=om;var[HL,VL]=vT(om,{onClose(){}}),KL=b.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:s,onClose:i,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...y}=e,g=rm(om,n),[m,v]=b.useState(null),x=Ye(t,L=>v(L)),w=b.useRef(null),C=b.useRef(null),P=o||g.duration,k=b.useRef(0),I=b.useRef(P),_=b.useRef(0),{onToastAdd:M,onToastRemove:T}=g,R=qt(()=>{var U;(m==null?void 0:m.contains(document.activeElement))&&((U=g.viewport)==null||U.focus()),i()}),j=b.useCallback(L=>{!L||L===1/0||(window.clearTimeout(_.current),k.current=new Date().getTime(),_.current=window.setTimeout(R,L))},[R]);b.useEffect(()=>{const L=g.viewport;if(L){const U=()=>{j(I.current),c==null||c()},F=()=>{const G=new Date().getTime()-k.current;I.current=I.current-G,window.clearTimeout(_.current),l==null||l()};return L.addEventListener(gS,F),L.addEventListener(mS,U),()=>{L.removeEventListener(gS,F),L.removeEventListener(mS,U)}}},[g.viewport,P,l,c,j]),b.useEffect(()=>{s&&!g.isClosePausedRef.current&&j(P)},[s,P,g.isClosePausedRef,j]),b.useEffect(()=>(M(),()=>T()),[M,T]);const $=b.useMemo(()=>m?_T(m):null,[m]);return g.viewport?p.jsxs(p.Fragment,{children:[$&&p.jsx(WL,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:$}),p.jsx(HL,{scope:n,onClose:R,children:Md.createPortal(p.jsx(ww.ItemSlot,{scope:n,children:p.jsx(EL,{asChild:!0,onEscapeKeyDown:ee(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||R(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:p.jsx(Ce.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...y,ref:x,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ee(e.onKeyDown,L=>{L.key==="Escape"&&(a==null||a(L.nativeEvent),L.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:ee(e.onPointerDown,L=>{L.button===0&&(w.current={x:L.clientX,y:L.clientY})}),onPointerMove:ee(e.onPointerMove,L=>{if(!w.current)return;const U=L.clientX-w.current.x,F=L.clientY-w.current.y,G=!!C.current,D=["left","right"].includes(g.swipeDirection),z=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,V=D?z(0,U):0,K=D?0:z(0,F),J=L.pointerType==="touch"?10:2,ne={x:V,y:K},me={originalEvent:L,delta:ne};G?(C.current=ne,Dh(zL,d,me,{discrete:!1})):nP(ne,g.swipeDirection,J)?(C.current=ne,Dh(FL,u,me,{discrete:!1}),L.target.setPointerCapture(L.pointerId)):(Math.abs(U)>J||Math.abs(F)>J)&&(w.current=null)}),onPointerUp:ee(e.onPointerUp,L=>{const U=C.current,F=L.target;if(F.hasPointerCapture(L.pointerId)&&F.releasePointerCapture(L.pointerId),C.current=null,w.current=null,U){const G=L.currentTarget,D={originalEvent:L,delta:U};nP(U,g.swipeDirection,g.swipeThreshold)?Dh(UL,f,D,{discrete:!0}):Dh(BL,h,D,{discrete:!0}),G.addEventListener("click",z=>z.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),WL=e=>{const{__scopeToast:t,children:n,...r}=e,o=rm(om,t),[s,i]=b.useState(!1),[a,l]=b.useState(!1);return XL(()=>i(!0)),b.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:p.jsx(Ad,{asChild:!0,children:p.jsx(nm,{...r,children:s&&p.jsxs(p.Fragment,{children:[o.label," ",n]})})})},GL="ToastTitle",bT=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return p.jsx(Ce.div,{...r,ref:t})});bT.displayName=GL;var YL="ToastDescription",CT=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return p.jsx(Ce.div,{...r,ref:t})});CT.displayName=YL;var PT="ToastAction",kT=b.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?p.jsx(IT,{altText:n,asChild:!0,children:p.jsx(Pw,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${PT}\`. Expected non-empty \`string\`.`),null)});kT.displayName=PT;var ET="ToastClose",Pw=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,o=VL(ET,n);return p.jsx(IT,{asChild:!0,children:p.jsx(Ce.button,{type:"button",...r,ref:t,onClick:ee(e.onClick,o.onClose)})})});Pw.displayName=ET;var IT=b.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...o}=e;return p.jsx(Ce.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function _T(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),qL(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!o)if(s){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(..._T(r))}}),t}function Dh(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Sw(o,s):o.dispatchEvent(s)}var nP=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),s=r>o;return t==="left"||t==="right"?s&&r>n:!s&&o>n};function XL(e=()=>{}){const t=qt(e);gi(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function qL(e){return e.nodeType===e.ELEMENT_NODE}function QL(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Oy(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var ZL=bw,TT=Cw,kw=wT,Ew=bT,Iw=CT,_w=kT,Xf=Pw;function MT(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=MT(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function AT(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=MT(e))&&(r&&(r+=" "),r+=t);return r}const rP=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,oP=AT,RT=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return oP(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:s}=t,i=Object.keys(o).map(c=>{const u=n==null?void 0:n[c],d=s==null?void 0:s[c];if(u===null)return null;const h=rP(u)||rP(d);return o[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(y=>{let[g,m]=y;return Array.isArray(m)?m.includes({...s,...a}[g]):{...s,...a}[g]===m})?[...c,d,h]:c},[]);return oP(e,i,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OT=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var e6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=b.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:s,iconNode:i,...a},l)=>b.createElement("svg",{ref:l,...e6,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:OT("lucide",o),...a},[...i.map(([c,u])=>b.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=(e,t)=>{const n=b.forwardRef(({className:r,...o},s)=>b.createElement(t6,{ref:s,iconNode:t,className:OT(`lucide-${JL(e)}`,r),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=$o("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=$o("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=$o("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=$o("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=$o("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=$o("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=$o("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=$o("PlaneLanding",[["path",{d:"M2 22h20",key:"272qi7"}],["path",{d:"M3.77 10.77 2 9l2-4.5 1.1.55c.55.28.9.84.9 1.45s.35 1.17.9 1.45L8 8.5l3-6 1.05.53a2 2 0 0 1 1.09 1.52l.72 5.4a2 2 0 0 0 1.09 1.52l4.4 2.2c.42.22.78.55 1.01.96l.6 1.03c.49.88-.06 1.98-1.06 2.1l-1.18.15c-.47.06-.95-.02-1.37-.24L4.29 11.15a2 2 0 0 1-.52-.38Z",key:"1ma21e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=$o("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=$o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Tw="-",l6=e=>{const t=u6(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const a=i.split(Tw);return a[0]===""&&a.length!==1&&a.shift(),DT(a,t)||c6(i)},getConflictingClassGroupIds:(i,a)=>{const l=n[i]||[];return a&&r[i]?[...l,...r[i]]:l}}},DT=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?DT(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(Tw);return(i=t.validators.find(({validator:a})=>a(s)))==null?void 0:i.classGroupId},aP=/^\[(.+)\]$/,c6=e=>{if(aP.test(e)){const t=aP.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},u6=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return h6(Object.entries(e.classGroups),n).forEach(([s,i])=>{SS(i,r,s,t)}),r},SS=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:lP(t,o);s.classGroupId=n;return}if(typeof o=="function"){if(d6(o)){SS(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([s,i])=>{SS(i,lP(t,s),n,r)})})},lP=(e,t)=>{let n=e;return t.split(Tw).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},d6=e=>e.isThemeGetter,h6=(e,t)=>t?e.map(([n,r])=>{const o=r.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,a])=>[t+i,a])):s);return[n,o]}):e,p6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return o(s,i),i},set(s,i){n.has(s)?n.set(s,i):o(s,i)}}},NT="!",f6=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,o=t[0],s=t.length,i=a=>{const l=[];let c=0,u=0,d;for(let m=0;m<a.length;m++){let v=a[m];if(c===0){if(v===o&&(r||a.slice(m,m+s)===t)){l.push(a.slice(u,m)),u=m+s;continue}if(v==="/"){d=m;continue}}v==="["?c++:v==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(NT),y=f?h.substring(1):h,g=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:y,maybePostfixModifierPosition:g}};return n?a=>n({className:a,parseClassName:i}):i},g6=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},m6=e=>({cache:p6(e.cacheSize),parseClassName:f6(e),...l6(e)}),y6=/\s+/,v6=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=t,s=[],i=e.trim().split(y6);let a="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=n(c);let y=!!f,g=r(y?h.substring(0,f):h);if(!g){if(!y){a=c+(a.length>0?" "+a:a);continue}if(g=r(h),!g){a=c+(a.length>0?" "+a:a);continue}y=!1}const m=g6(u).join(":"),v=d?m+NT:m,x=v+g;if(s.includes(x))continue;s.push(x);const w=o(g,y);for(let C=0;C<w.length;++C){const P=w[C];s.push(v+P)}a=c+(a.length>0?" "+a:a)}return a};function S6(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=$T(t))&&(r&&(r+=" "),r+=n);return r}const $T=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=$T(e[r]))&&(n&&(n+=" "),n+=t);return n};function x6(e,...t){let n,r,o,s=i;function i(l){const c=t.reduce((u,d)=>d(u),e());return n=m6(c),r=n.cache.get,o=n.cache.set,s=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=v6(l,n);return o(l,u),u}return function(){return s(S6.apply(null,arguments))}}const nt=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},LT=/^\[(?:([a-z-]+):)?(.+)\]$/i,w6=/^\d+\/\d+$/,b6=new Set(["px","full","screen"]),C6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,P6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,k6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,E6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,I6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vo=e=>Il(e)||b6.has(e)||w6.test(e),Rs=e=>uc(e,"length",D6),Il=e=>!!e&&!Number.isNaN(Number(e)),jy=e=>uc(e,"number",Il),Uc=e=>!!e&&Number.isInteger(Number(e)),_6=e=>e.endsWith("%")&&Il(e.slice(0,-1)),xe=e=>LT.test(e),Os=e=>C6.test(e),T6=new Set(["length","size","percentage"]),M6=e=>uc(e,T6,FT),A6=e=>uc(e,"position",FT),R6=new Set(["image","url"]),O6=e=>uc(e,R6,$6),j6=e=>uc(e,"",N6),Hc=()=>!0,uc=(e,t,n)=>{const r=LT.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},D6=e=>P6.test(e)&&!k6.test(e),FT=()=>!1,N6=e=>E6.test(e),$6=e=>I6.test(e),L6=()=>{const e=nt("colors"),t=nt("spacing"),n=nt("blur"),r=nt("brightness"),o=nt("borderColor"),s=nt("borderRadius"),i=nt("borderSpacing"),a=nt("borderWidth"),l=nt("contrast"),c=nt("grayscale"),u=nt("hueRotate"),d=nt("invert"),h=nt("gap"),f=nt("gradientColorStops"),y=nt("gradientColorStopPositions"),g=nt("inset"),m=nt("margin"),v=nt("opacity"),x=nt("padding"),w=nt("saturate"),C=nt("scale"),P=nt("sepia"),k=nt("skew"),I=nt("space"),_=nt("translate"),M=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",xe,t],j=()=>[xe,t],$=()=>["",Vo,Rs],L=()=>["auto",Il,xe],U=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",xe],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[Il,xe];return{cacheSize:500,separator:":",theme:{colors:[Hc],spacing:[Vo,Rs],blur:["none","",Os,xe],brightness:K(),borderColor:[e],borderRadius:["none","","full",Os,xe],borderSpacing:j(),borderWidth:$(),contrast:K(),grayscale:z(),hueRotate:K(),invert:z(),gap:j(),gradientColorStops:[e],gradientColorStopPositions:[_6,Rs],inset:R(),margin:R(),opacity:K(),padding:j(),saturate:K(),scale:K(),sepia:z(),skew:K(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",xe]}],container:["container"],columns:[{columns:[Os]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...U(),xe]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Uc,xe]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",xe]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Uc,xe]}],"grid-cols":[{"grid-cols":[Hc]}],"col-start-end":[{col:["auto",{span:["full",Uc,xe]},xe]}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":[Hc]}],"row-start-end":[{row:["auto",{span:[Uc,xe]},xe]}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",xe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",xe]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...D()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...D(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...D(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",xe,t]}],"min-w":[{"min-w":[xe,t,"min","max","fit"]}],"max-w":[{"max-w":[xe,t,"none","full","min","max","fit","prose",{screen:[Os]},Os]}],h:[{h:[xe,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[xe,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[xe,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[xe,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Os,Rs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",jy]}],"font-family":[{font:[Hc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",xe]}],"line-clamp":[{"line-clamp":["none",Il,jy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Vo,xe]}],"list-image":[{"list-image":["none",xe]}],"list-style-type":[{list:["none","disc","decimal",xe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Vo,Rs]}],"underline-offset":[{"underline-offset":["auto",Vo,xe]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...U(),A6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",M6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},O6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:F()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[Vo,xe]}],"outline-w":[{outline:[Vo,Rs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:$()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[Vo,Rs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Os,j6]}],"shadow-color":[{shadow:[Hc]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Os,xe]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",xe]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",xe]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",xe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Uc,xe]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",xe]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xe]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xe]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Vo,Rs,jy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},F6=x6(L6);function Ct(...e){return F6(AT(e))}const z6=ZL,zT=b.forwardRef(({className:e,...t},n)=>p.jsx(TT,{ref:n,className:Ct("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));zT.displayName=TT.displayName;const B6=RT("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),BT=b.forwardRef(({className:e,variant:t,...n},r)=>p.jsx(kw,{ref:r,className:Ct(B6({variant:t}),e),...n}));BT.displayName=kw.displayName;const U6=b.forwardRef(({className:e,...t},n)=>p.jsx(_w,{ref:n,className:Ct("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));U6.displayName=_w.displayName;const UT=b.forwardRef(({className:e,...t},n)=>p.jsx(Xf,{ref:n,className:Ct("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:p.jsx(a6,{className:"h-4 w-4"})}));UT.displayName=Xf.displayName;const HT=b.forwardRef(({className:e,...t},n)=>p.jsx(Ew,{ref:n,className:Ct("text-sm font-semibold",e),...t}));HT.displayName=Ew.displayName;const VT=b.forwardRef(({className:e,...t},n)=>p.jsx(Iw,{ref:n,className:Ct("text-sm opacity-90",e),...t}));VT.displayName=Iw.displayName;function H6(){const{toasts:e}=cL();return p.jsxs(z6,{children:[e.map(function({id:t,title:n,description:r,action:o,...s}){return p.jsxs(BT,{...s,children:[p.jsxs("div",{className:"grid gap-1",children:[n&&p.jsx(HT,{children:n}),r&&p.jsx(VT,{children:r})]}),o,p.jsx(UT,{})]},t)}),p.jsx(zT,{})]})}var cP=["light","dark"],V6="(prefers-color-scheme: dark)",K6=b.createContext(void 0),W6={setTheme:e=>{},themes:[]},G6=()=>{var e;return(e=b.useContext(K6))!=null?e:W6};b.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:s,value:i,attrs:a,nonce:l})=>{let c=s==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(y=>`'${y}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?cP.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(y,g=!1,m=!0)=>{let v=i?i[y]:y,x=g?y+"|| ''":`'${v}'`,w="";return o&&m&&!g&&cP.includes(y)&&(w+=`d.style.colorScheme = '${y}';`),n==="class"?g||v?w+=`c.add(${x})`:w+="null":v&&(w+=`d[s](n,${x})`),w},f=e?`!function(){${u}${h(e)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${c})){var t='${V6}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}${c?"":"else{"+h(s,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}else{${h(s,!1,!1)};}${d}}catch(t){}}();`;return b.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:f}})});var Y6=e=>{switch(e){case"success":return Q6;case"info":return J6;case"warning":return Z6;case"error":return e8;default:return null}},X6=Array(12).fill(0),q6=({visible:e})=>H.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},H.createElement("div",{className:"sonner-spinner"},X6.map((t,n)=>H.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Q6=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Z6=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),J6=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),e8=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),t8=()=>{let[e,t]=H.useState(document.hidden);return H.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},xS=1,n8=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,o=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:xS++,s=this.toasts.find(a=>a.id===o),i=e.dismissible===void 0?!0:e.dismissible;return s?this.toasts=this.toasts.map(a=>a.id===o?(this.publish({...a,...e,id:o,title:n}),{...a,...e,id:o,dismissible:i,title:n}):a):this.addToast({title:n,...r,dismissible:i,id:o}),o},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),o=n!==void 0;return r.then(async s=>{if(o8(s)&&!s.ok){o=!1;let i=typeof t.error=="function"?await t.error(`HTTP error! status: ${s.status}`):t.error,a=typeof t.description=="function"?await t.description(`HTTP error! status: ${s.status}`):t.description;this.create({id:n,type:"error",message:i,description:a})}else if(t.success!==void 0){o=!1;let i=typeof t.success=="function"?await t.success(s):t.success,a=typeof t.description=="function"?await t.description(s):t.description;this.create({id:n,type:"success",message:i,description:a})}}).catch(async s=>{if(t.error!==void 0){o=!1;let i=typeof t.error=="function"?await t.error(s):t.error,a=typeof t.description=="function"?await t.description(s):t.description;this.create({id:n,type:"error",message:i,description:a})}}).finally(()=>{var s;o&&(this.dismiss(n),n=void 0),(s=t.finally)==null||s.call(t)}),n},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||xS++;return this.create({jsx:e(n),id:n,...t}),n},this.subscribers=[],this.toasts=[]}},Jn=new n8,r8=(e,t)=>{let n=(t==null?void 0:t.id)||xS++;return Jn.addToast({title:e,...t,id:n}),n},o8=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",s8=r8,i8=()=>Jn.toasts;Object.assign(s8,{success:Jn.success,info:Jn.info,warning:Jn.warning,error:Jn.error,custom:Jn.custom,message:Jn.message,promise:Jn.promise,dismiss:Jn.dismiss,loading:Jn.loading},{getHistory:i8});function a8(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}a8(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Nh(e){return e.label!==void 0}var l8=3,c8="32px",u8=4e3,d8=356,h8=14,p8=20,f8=200;function g8(...e){return e.filter(Boolean).join(" ")}var m8=e=>{var t,n,r,o,s,i,a,l,c,u;let{invert:d,toast:h,unstyled:f,interacting:y,setHeights:g,visibleToasts:m,heights:v,index:x,toasts:w,expanded:C,removeToast:P,defaultRichColors:k,closeButton:I,style:_,cancelButtonStyle:M,actionButtonStyle:T,className:R="",descriptionClassName:j="",duration:$,position:L,gap:U,loadingIcon:F,expandByDefault:G,classNames:D,icons:z,closeButtonAriaLabel:V="Close toast",pauseWhenPageIsHidden:K,cn:J}=e,[ne,me]=H.useState(!1),[te,de]=H.useState(!1),[Te,Oe]=H.useState(!1),[Pe,Fe]=H.useState(!1),[je,$t]=H.useState(0),[kt,Lt]=H.useState(0),mt=H.useRef(null),et=H.useRef(null),$r=x===0,Oi=x+1<=m,Et=h.type,ks=h.dismissible!==!1,qm=h.className||"",Qm=h.descriptionClassName||"",Ra=H.useMemo(()=>v.findIndex(ye=>ye.toastId===h.id)||0,[v,h.id]),Zm=H.useMemo(()=>{var ye;return(ye=h.closeButton)!=null?ye:I},[h.closeButton,I]),sh=H.useMemo(()=>h.duration||$||u8,[h.duration,$]),Tc=H.useRef(0),Lr=H.useRef(0),Oa=H.useRef(0),Bo=H.useRef(null),[Gn,ih]=L.split("-"),Mc=H.useMemo(()=>v.reduce((ye,Me,ze)=>ze>=Ra?ye:ye+Me.height,0),[v,Ra]),ah=t8(),lh=h.invert||d,Es=Et==="loading";Lr.current=H.useMemo(()=>Ra*U+Mc,[Ra,Mc]),H.useEffect(()=>{me(!0)},[]),H.useLayoutEffect(()=>{if(!ne)return;let ye=et.current,Me=ye.style.height;ye.style.height="auto";let ze=ye.getBoundingClientRect().height;ye.style.height=Me,Lt(ze),g(yr=>yr.find(vr=>vr.toastId===h.id)?yr.map(vr=>vr.toastId===h.id?{...vr,height:ze}:vr):[{toastId:h.id,height:ze,position:h.position},...yr])},[ne,h.title,h.description,g,h.id]);let Fr=H.useCallback(()=>{de(!0),$t(Lr.current),g(ye=>ye.filter(Me=>Me.toastId!==h.id)),setTimeout(()=>{P(h)},f8)},[h,P,g,Lr]);H.useEffect(()=>{if(h.promise&&Et==="loading"||h.duration===1/0||h.type==="loading")return;let ye,Me=sh;return C||y||K&&ah?(()=>{if(Oa.current<Tc.current){let ze=new Date().getTime()-Tc.current;Me=Me-ze}Oa.current=new Date().getTime()})():Me!==1/0&&(Tc.current=new Date().getTime(),ye=setTimeout(()=>{var ze;(ze=h.onAutoClose)==null||ze.call(h,h),Fr()},Me)),()=>clearTimeout(ye)},[C,y,G,h,sh,Fr,h.promise,Et,K,ah]),H.useEffect(()=>{let ye=et.current;if(ye){let Me=ye.getBoundingClientRect().height;return Lt(Me),g(ze=>[{toastId:h.id,height:Me,position:h.position},...ze]),()=>g(ze=>ze.filter(yr=>yr.toastId!==h.id))}},[g,h.id]),H.useEffect(()=>{h.delete&&Fr()},[Fr,h.delete]);function ch(){return z!=null&&z.loading?H.createElement("div",{className:"sonner-loader","data-visible":Et==="loading"},z.loading):F?H.createElement("div",{className:"sonner-loader","data-visible":Et==="loading"},F):H.createElement(q6,{visible:Et==="loading"})}return H.createElement("li",{"aria-live":h.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:et,className:J(R,qm,D==null?void 0:D.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,D==null?void 0:D.default,D==null?void 0:D[Et],(n=h==null?void 0:h.classNames)==null?void 0:n[Et]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:k,"data-styled":!(h.jsx||h.unstyled||f),"data-mounted":ne,"data-promise":!!h.promise,"data-removed":te,"data-visible":Oi,"data-y-position":Gn,"data-x-position":ih,"data-index":x,"data-front":$r,"data-swiping":Te,"data-dismissible":ks,"data-type":Et,"data-invert":lh,"data-swipe-out":Pe,"data-expanded":!!(C||G&&ne),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${te?je:Lr.current}px`,"--initial-height":G?"auto":`${kt}px`,..._,...h.style},onPointerDown:ye=>{Es||!ks||(mt.current=new Date,$t(Lr.current),ye.target.setPointerCapture(ye.pointerId),ye.target.tagName!=="BUTTON"&&(Oe(!0),Bo.current={x:ye.clientX,y:ye.clientY}))},onPointerUp:()=>{var ye,Me,ze,yr;if(Pe||!ks)return;Bo.current=null;let vr=Number(((ye=et.current)==null?void 0:ye.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Is=new Date().getTime()-((Me=mt.current)==null?void 0:Me.getTime()),ji=Math.abs(vr)/Is;if(Math.abs(vr)>=p8||ji>.11){$t(Lr.current),(ze=h.onDismiss)==null||ze.call(h,h),Fr(),Fe(!0);return}(yr=et.current)==null||yr.style.setProperty("--swipe-amount","0px"),Oe(!1)},onPointerMove:ye=>{var Me;if(!Bo.current||!ks)return;let ze=ye.clientY-Bo.current.y,yr=ye.clientX-Bo.current.x,vr=(Gn==="top"?Math.min:Math.max)(0,ze),Is=ye.pointerType==="touch"?10:2;Math.abs(vr)>Is?(Me=et.current)==null||Me.style.setProperty("--swipe-amount",`${ze}px`):Math.abs(yr)>Is&&(Bo.current=null)}},Zm&&!h.jsx?H.createElement("button",{"aria-label":V,"data-disabled":Es,"data-close-button":!0,onClick:Es||!ks?()=>{}:()=>{var ye;Fr(),(ye=h.onDismiss)==null||ye.call(h,h)},className:J(D==null?void 0:D.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},H.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,h.jsx||H.isValidElement(h.title)?h.jsx||h.title:H.createElement(H.Fragment,null,Et||h.icon||h.promise?H.createElement("div",{"data-icon":"",className:J(D==null?void 0:D.icon,(s=h==null?void 0:h.classNames)==null?void 0:s.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||ch():null,h.type!=="loading"?h.icon||(z==null?void 0:z[Et])||Y6(Et):null):null,H.createElement("div",{"data-content":"",className:J(D==null?void 0:D.content,(i=h==null?void 0:h.classNames)==null?void 0:i.content)},H.createElement("div",{"data-title":"",className:J(D==null?void 0:D.title,(a=h==null?void 0:h.classNames)==null?void 0:a.title)},h.title),h.description?H.createElement("div",{"data-description":"",className:J(j,Qm,D==null?void 0:D.description,(l=h==null?void 0:h.classNames)==null?void 0:l.description)},h.description):null),H.isValidElement(h.cancel)?h.cancel:h.cancel&&Nh(h.cancel)?H.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||M,onClick:ye=>{var Me,ze;Nh(h.cancel)&&ks&&((ze=(Me=h.cancel).onClick)==null||ze.call(Me,ye),Fr())},className:J(D==null?void 0:D.cancelButton,(c=h==null?void 0:h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,H.isValidElement(h.action)?h.action:h.action&&Nh(h.action)?H.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||T,onClick:ye=>{var Me,ze;Nh(h.action)&&(ye.defaultPrevented||((ze=(Me=h.action).onClick)==null||ze.call(Me,ye),Fr()))},className:J(D==null?void 0:D.actionButton,(u=h==null?void 0:h.classNames)==null?void 0:u.actionButton)},h.action.label):null))};function uP(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var y8=e=>{let{invert:t,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:s,className:i,offset:a,theme:l="light",richColors:c,duration:u,style:d,visibleToasts:h=l8,toastOptions:f,dir:y=uP(),gap:g=h8,loadingIcon:m,icons:v,containerAriaLabel:x="Notifications",pauseWhenPageIsHidden:w,cn:C=g8}=e,[P,k]=H.useState([]),I=H.useMemo(()=>Array.from(new Set([n].concat(P.filter(K=>K.position).map(K=>K.position)))),[P,n]),[_,M]=H.useState([]),[T,R]=H.useState(!1),[j,$]=H.useState(!1),[L,U]=H.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),F=H.useRef(null),G=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=H.useRef(null),z=H.useRef(!1),V=H.useCallback(K=>{var J;(J=P.find(ne=>ne.id===K.id))!=null&&J.delete||Jn.dismiss(K.id),k(ne=>ne.filter(({id:me})=>me!==K.id))},[P]);return H.useEffect(()=>Jn.subscribe(K=>{if(K.dismiss){k(J=>J.map(ne=>ne.id===K.id?{...ne,delete:!0}:ne));return}setTimeout(()=>{hT.flushSync(()=>{k(J=>{let ne=J.findIndex(me=>me.id===K.id);return ne!==-1?[...J.slice(0,ne),{...J[ne],...K},...J.slice(ne+1)]:[K,...J]})})})}),[]),H.useEffect(()=>{if(l!=="system"){U(l);return}l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:K})=>{U(K?"dark":"light")})},[l]),H.useEffect(()=>{P.length<=1&&R(!1)},[P]),H.useEffect(()=>{let K=J=>{var ne,me;r.every(te=>J[te]||J.code===te)&&(R(!0),(ne=F.current)==null||ne.focus()),J.code==="Escape"&&(document.activeElement===F.current||(me=F.current)!=null&&me.contains(document.activeElement))&&R(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[r]),H.useEffect(()=>{if(F.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,z.current=!1)}},[F.current]),P.length?H.createElement("section",{"aria-label":`${x} ${G}`,tabIndex:-1},I.map((K,J)=>{var ne;let[me,te]=K.split("-");return H.createElement("ol",{key:K,dir:y==="auto"?uP():y,tabIndex:-1,ref:F,className:i,"data-sonner-toaster":!0,"data-theme":L,"data-y-position":me,"data-x-position":te,style:{"--front-toast-height":`${((ne=_[0])==null?void 0:ne.height)||0}px`,"--offset":typeof a=="number"?`${a}px`:a||c8,"--width":`${d8}px`,"--gap":`${g}px`,...d},onBlur:de=>{z.current&&!de.currentTarget.contains(de.relatedTarget)&&(z.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:de=>{de.target instanceof HTMLElement&&de.target.dataset.dismissible==="false"||z.current||(z.current=!0,D.current=de.relatedTarget)},onMouseEnter:()=>R(!0),onMouseMove:()=>R(!0),onMouseLeave:()=>{j||R(!1)},onPointerDown:de=>{de.target instanceof HTMLElement&&de.target.dataset.dismissible==="false"||$(!0)},onPointerUp:()=>$(!1)},P.filter(de=>!de.position&&J===0||de.position===K).map((de,Te)=>{var Oe,Pe;return H.createElement(m8,{key:de.id,icons:v,index:Te,toast:de,defaultRichColors:c,duration:(Oe=f==null?void 0:f.duration)!=null?Oe:u,className:f==null?void 0:f.className,descriptionClassName:f==null?void 0:f.descriptionClassName,invert:t,visibleToasts:h,closeButton:(Pe=f==null?void 0:f.closeButton)!=null?Pe:s,interacting:j,position:K,style:f==null?void 0:f.style,unstyled:f==null?void 0:f.unstyled,classNames:f==null?void 0:f.classNames,cancelButtonStyle:f==null?void 0:f.cancelButtonStyle,actionButtonStyle:f==null?void 0:f.actionButtonStyle,removeToast:V,toasts:P.filter(Fe=>Fe.position==de.position),heights:_.filter(Fe=>Fe.position==de.position),setHeights:M,expandByDefault:o,gap:g,loadingIcon:m,expanded:T,pauseWhenPageIsHidden:w,cn:C})}))})):null};const v8=({...e})=>{const{theme:t="system"}=G6();return p.jsx(y8,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var S8=cI.useId||(()=>{}),x8=0;function _o(e){const[t,n]=b.useState(S8());return gi(()=>{e||n(r=>r??String(x8++))},[e]),e||(t?`radix-${t}`:"")}const w8=["top","right","bottom","left"],mi=Math.min,tr=Math.max,qf=Math.round,$h=Math.floor,yi=e=>({x:e,y:e}),b8={left:"right",right:"left",bottom:"top",top:"bottom"},C8={start:"end",end:"start"};function wS(e,t,n){return tr(e,mi(t,n))}function fs(e,t){return typeof e=="function"?e(t):e}function gs(e){return e.split("-")[0]}function dc(e){return e.split("-")[1]}function Mw(e){return e==="x"?"y":"x"}function Aw(e){return e==="y"?"height":"width"}function vi(e){return["top","bottom"].includes(gs(e))?"y":"x"}function Rw(e){return Mw(vi(e))}function P8(e,t,n){n===void 0&&(n=!1);const r=dc(e),o=Rw(e),s=Aw(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=Qf(i)),[i,Qf(i)]}function k8(e){const t=Qf(e);return[bS(e),t,bS(t)]}function bS(e){return e.replace(/start|end/g,t=>C8[t])}function E8(e,t,n){const r=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?s:i;default:return[]}}function I8(e,t,n,r){const o=dc(e);let s=E8(gs(e),n==="start",r);return o&&(s=s.map(i=>i+"-"+o),t&&(s=s.concat(s.map(bS)))),s}function Qf(e){return e.replace(/left|right|bottom|top/g,t=>b8[t])}function _8(e){return{top:0,right:0,bottom:0,left:0,...e}}function KT(e){return typeof e!="number"?_8(e):{top:e,right:e,bottom:e,left:e}}function Zf(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function dP(e,t,n){let{reference:r,floating:o}=e;const s=vi(t),i=Rw(t),a=Aw(i),l=gs(t),c=s==="y",u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,h=r[a]/2-o[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-o.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-o.width,y:d};break;default:f={x:r.x,y:r.y}}switch(dc(t)){case"start":f[i]-=h*(n&&c?-1:1);break;case"end":f[i]+=h*(n&&c?-1:1);break}return f}const T8=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=n,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=dP(c,r,l),h=r,f={},y=0;for(let g=0;g<a.length;g++){const{name:m,fn:v}=a[g],{x,y:w,data:C,reset:P}=await v({x:u,y:d,initialPlacement:r,placement:h,strategy:o,middlewareData:f,rects:c,platform:i,elements:{reference:e,floating:t}});u=x??u,d=w??d,f={...f,[m]:{...f[m],...C}},P&&y<=50&&(y++,typeof P=="object"&&(P.placement&&(h=P.placement),P.rects&&(c=P.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):P.rects),{x:u,y:d}=dP(c,h,l)),g=-1)}return{x:u,y:d,placement:h,strategy:o,middlewareData:f}};async function ed(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=fs(t,e),y=KT(f),m=a[h?d==="floating"?"reference":"floating":d],v=Zf(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=d==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),C=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},P=Zf(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:w,strategy:l}):x);return{top:(v.top-P.top+y.top)/C.y,bottom:(P.bottom-v.bottom+y.bottom)/C.y,left:(v.left-P.left+y.left)/C.x,right:(P.right-v.right+y.right)/C.x}}const M8=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:s,platform:i,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=fs(e,t)||{};if(c==null)return{};const d=KT(u),h={x:n,y:r},f=Rw(o),y=Aw(f),g=await i.getDimensions(c),m=f==="y",v=m?"top":"left",x=m?"bottom":"right",w=m?"clientHeight":"clientWidth",C=s.reference[y]+s.reference[f]-h[f]-s.floating[y],P=h[f]-s.reference[f],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let I=k?k[w]:0;(!I||!await(i.isElement==null?void 0:i.isElement(k)))&&(I=a.floating[w]||s.floating[y]);const _=C/2-P/2,M=I/2-g[y]/2-1,T=mi(d[v],M),R=mi(d[x],M),j=T,$=I-g[y]-R,L=I/2-g[y]/2+_,U=wS(j,L,$),F=!l.arrow&&dc(o)!=null&&L!==U&&s.reference[y]/2-(L<j?T:R)-g[y]/2<0,G=F?L<j?L-j:L-$:0;return{[f]:h[f]+G,data:{[f]:U,centerOffset:L-U-G,...F&&{alignmentOffset:G}},reset:F}}}),A8=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:g=!0,...m}=fs(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=gs(o),x=vi(a),w=gs(a)===a,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),P=h||(w||!g?[Qf(a)]:k8(a)),k=y!=="none";!h&&k&&P.push(...I8(a,g,y,C));const I=[a,...P],_=await ed(t,m),M=[];let T=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&M.push(_[v]),d){const L=P8(o,i,C);M.push(_[L[0]],_[L[1]])}if(T=[...T,{placement:o,overflows:M}],!M.every(L=>L<=0)){var R,j;const L=(((R=s.flip)==null?void 0:R.index)||0)+1,U=I[L];if(U)return{data:{index:L,overflows:T},reset:{placement:U}};let F=(j=T.filter(G=>G.overflows[0]<=0).sort((G,D)=>G.overflows[1]-D.overflows[1])[0])==null?void 0:j.placement;if(!F)switch(f){case"bestFit":{var $;const G=($=T.filter(D=>{if(k){const z=vi(D.placement);return z===x||z==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(z=>z>0).reduce((z,V)=>z+V,0)]).sort((D,z)=>D[1]-z[1])[0])==null?void 0:$[0];G&&(F=G);break}case"initialPlacement":F=a;break}if(o!==F)return{reset:{placement:F}}}return{}}}};function hP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function pP(e){return w8.some(t=>e[t]>=0)}const R8=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=fs(e,t);switch(r){case"referenceHidden":{const s=await ed(t,{...o,elementContext:"reference"}),i=hP(s,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:pP(i)}}}case"escaped":{const s=await ed(t,{...o,altBoundary:!0}),i=hP(s,n.floating);return{data:{escapedOffsets:i,escaped:pP(i)}}}default:return{}}}}};async function O8(e,t){const{placement:n,platform:r,elements:o}=e,s=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=gs(n),a=dc(n),l=vi(n)==="y",c=["left","top"].includes(i)?-1:1,u=s&&l?-1:1,d=fs(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof y=="number"&&(f=a==="end"?y*-1:y),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const j8=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:s,placement:i,middlewareData:a}=t,l=await O8(t,e);return i===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},D8=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:m=>{let{x:v,y:x}=m;return{x:v,y:x}}},...l}=fs(e,t),c={x:n,y:r},u=await ed(t,l),d=vi(gs(o)),h=Mw(d);let f=c[h],y=c[d];if(s){const m=h==="y"?"top":"left",v=h==="y"?"bottom":"right",x=f+u[m],w=f-u[v];f=wS(x,f,w)}if(i){const m=d==="y"?"top":"left",v=d==="y"?"bottom":"right",x=y+u[m],w=y-u[v];y=wS(x,y,w)}const g=a.fn({...t,[h]:f,[d]:y});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[h]:s,[d]:i}}}}}},N8=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:s,middlewareData:i}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=fs(e,t),u={x:n,y:r},d=vi(o),h=Mw(d);let f=u[h],y=u[d];const g=fs(a,t),m=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=h==="y"?"height":"width",C=s.reference[h]-s.floating[w]+m.mainAxis,P=s.reference[h]+s.reference[w]-m.mainAxis;f<C?f=C:f>P&&(f=P)}if(c){var v,x;const w=h==="y"?"width":"height",C=["top","left"].includes(gs(o)),P=s.reference[d]-s.floating[w]+(C&&((v=i.offset)==null?void 0:v[d])||0)+(C?0:m.crossAxis),k=s.reference[d]+s.reference[w]+(C?0:((x=i.offset)==null?void 0:x[d])||0)-(C?m.crossAxis:0);y<P?y=P:y>k&&(y=k)}return{[h]:f,[d]:y}}}},$8=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:s,platform:i,elements:a}=t,{apply:l=()=>{},...c}=fs(e,t),u=await ed(t,c),d=gs(o),h=dc(o),f=vi(o)==="y",{width:y,height:g}=s.floating;let m,v;d==="top"||d==="bottom"?(m=d,v=h===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,m=h==="end"?"top":"bottom");const x=g-u.top-u.bottom,w=y-u.left-u.right,C=mi(g-u[m],x),P=mi(y-u[v],w),k=!t.middlewareData.shift;let I=C,_=P;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(_=w),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(I=x),k&&!h){const T=tr(u.left,0),R=tr(u.right,0),j=tr(u.top,0),$=tr(u.bottom,0);f?_=y-2*(T!==0||R!==0?T+R:tr(u.left,u.right)):I=g-2*(j!==0||$!==0?j+$:tr(u.top,u.bottom))}await l({...t,availableWidth:_,availableHeight:I});const M=await i.getDimensions(a.floating);return y!==M.width||g!==M.height?{reset:{rects:!0}}:{}}}};function sm(){return typeof window<"u"}function hc(e){return WT(e)?(e.nodeName||"").toLowerCase():"#document"}function lr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Lo(e){var t;return(t=(WT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function WT(e){return sm()?e instanceof Node||e instanceof lr(e).Node:!1}function ao(e){return sm()?e instanceof Element||e instanceof lr(e).Element:!1}function Mo(e){return sm()?e instanceof HTMLElement||e instanceof lr(e).HTMLElement:!1}function fP(e){return!sm()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof lr(e).ShadowRoot}function Rd(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=lo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function L8(e){return["table","td","th"].includes(hc(e))}function im(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Ow(e){const t=jw(),n=ao(e)?lo(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function F8(e){let t=Si(e);for(;Mo(t)&&!Ql(t);){if(Ow(t))return t;if(im(t))return null;t=Si(t)}return null}function jw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ql(e){return["html","body","#document"].includes(hc(e))}function lo(e){return lr(e).getComputedStyle(e)}function am(e){return ao(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Si(e){if(hc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||fP(e)&&e.host||Lo(e);return fP(t)?t.host:t}function GT(e){const t=Si(e);return Ql(t)?e.ownerDocument?e.ownerDocument.body:e.body:Mo(t)&&Rd(t)?t:GT(t)}function td(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=GT(e),s=o===((r=e.ownerDocument)==null?void 0:r.body),i=lr(o);if(s){const a=CS(i);return t.concat(i,i.visualViewport||[],Rd(o)?o:[],a&&n?td(a):[])}return t.concat(o,td(o,[],n))}function CS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function YT(e){const t=lo(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Mo(e),s=o?e.offsetWidth:n,i=o?e.offsetHeight:r,a=qf(n)!==s||qf(r)!==i;return a&&(n=s,r=i),{width:n,height:r,$:a}}function Dw(e){return ao(e)?e:e.contextElement}function _l(e){const t=Dw(e);if(!Mo(t))return yi(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:s}=YT(t);let i=(s?qf(n.width):n.width)/r,a=(s?qf(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const z8=yi(0);function XT(e){const t=lr(e);return!jw()||!t.visualViewport?z8:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function B8(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==lr(e)?!1:t}function ga(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),s=Dw(e);let i=yi(1);t&&(r?ao(r)&&(i=_l(r)):i=_l(e));const a=B8(s,n,r)?XT(s):yi(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(s){const h=lr(s),f=r&&ao(r)?lr(r):r;let y=h,g=CS(y);for(;g&&r&&f!==y;){const m=_l(g),v=g.getBoundingClientRect(),x=lo(g),w=v.left+(g.clientLeft+parseFloat(x.paddingLeft))*m.x,C=v.top+(g.clientTop+parseFloat(x.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,d*=m.y,l+=w,c+=C,y=lr(g),g=CS(y)}}return Zf({width:u,height:d,x:l,y:c})}function U8(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const s=o==="fixed",i=Lo(r),a=t?im(t.floating):!1;if(r===i||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=yi(1);const u=yi(0),d=Mo(r);if((d||!d&&!s)&&((hc(r)!=="body"||Rd(i))&&(l=am(r)),Mo(r))){const h=ga(r);c=_l(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}}function H8(e){return Array.from(e.getClientRects())}function PS(e,t){const n=am(e).scrollLeft;return t?t.left+n:ga(Lo(e)).left+n}function V8(e){const t=Lo(e),n=am(e),r=e.ownerDocument.body,o=tr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=tr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+PS(e);const a=-n.scrollTop;return lo(r).direction==="rtl"&&(i+=tr(t.clientWidth,r.clientWidth)-o),{width:o,height:s,x:i,y:a}}function K8(e,t){const n=lr(e),r=Lo(e),o=n.visualViewport;let s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=jw();(!c||c&&t==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function W8(e,t){const n=ga(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,s=Mo(e)?_l(e):yi(1),i=e.clientWidth*s.x,a=e.clientHeight*s.y,l=o*s.x,c=r*s.y;return{width:i,height:a,x:l,y:c}}function gP(e,t,n){let r;if(t==="viewport")r=K8(e,n);else if(t==="document")r=V8(Lo(e));else if(ao(t))r=W8(t,n);else{const o=XT(e);r={...t,x:t.x-o.x,y:t.y-o.y}}return Zf(r)}function qT(e,t){const n=Si(e);return n===t||!ao(n)||Ql(n)?!1:lo(n).position==="fixed"||qT(n,t)}function G8(e,t){const n=t.get(e);if(n)return n;let r=td(e,[],!1).filter(a=>ao(a)&&hc(a)!=="body"),o=null;const s=lo(e).position==="fixed";let i=s?Si(e):e;for(;ao(i)&&!Ql(i);){const a=lo(i),l=Ow(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Rd(i)&&!l&&qT(e,i))?r=r.filter(u=>u!==i):o=a,i=Si(i)}return t.set(e,r),r}function Y8(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[...n==="clippingAncestors"?im(t)?[]:G8(t,this._c):[].concat(n),r],a=i[0],l=i.reduce((c,u)=>{const d=gP(t,u,o);return c.top=tr(d.top,c.top),c.right=mi(d.right,c.right),c.bottom=mi(d.bottom,c.bottom),c.left=tr(d.left,c.left),c},gP(t,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function X8(e){const{width:t,height:n}=YT(e);return{width:t,height:n}}function q8(e,t,n){const r=Mo(t),o=Lo(t),s=n==="fixed",i=ga(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=yi(0);if(r||!r&&!s)if((hc(t)!=="body"||Rd(o))&&(a=am(t)),r){const f=ga(t,!0,s,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else o&&(l.x=PS(o));let c=0,u=0;if(o&&!r&&!s){const f=o.getBoundingClientRect();u=f.top+a.scrollTop,c=f.left+a.scrollLeft-PS(o,f)}const d=i.left+a.scrollLeft-l.x-c,h=i.top+a.scrollTop-l.y-u;return{x:d,y:h,width:i.width,height:i.height}}function Dy(e){return lo(e).position==="static"}function mP(e,t){if(!Mo(e)||lo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Lo(e)===n&&(n=n.ownerDocument.body),n}function QT(e,t){const n=lr(e);if(im(e))return n;if(!Mo(e)){let o=Si(e);for(;o&&!Ql(o);){if(ao(o)&&!Dy(o))return o;o=Si(o)}return n}let r=mP(e,t);for(;r&&L8(r)&&Dy(r);)r=mP(r,t);return r&&Ql(r)&&Dy(r)&&!Ow(r)?n:r||F8(e)||n}const Q8=async function(e){const t=this.getOffsetParent||QT,n=this.getDimensions,r=await n(e.floating);return{reference:q8(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Z8(e){return lo(e).direction==="rtl"}const J8={convertOffsetParentRelativeRectToViewportRelativeRect:U8,getDocumentElement:Lo,getClippingRect:Y8,getOffsetParent:QT,getElementRects:Q8,getClientRects:H8,getDimensions:X8,getScale:_l,isElement:ao,isRTL:Z8};function eF(e,t){let n=null,r;const o=Lo(e);function s(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||t(),!d||!h)return;const f=$h(u),y=$h(o.clientWidth-(c+d)),g=$h(o.clientHeight-(u+h)),m=$h(c),x={rootMargin:-f+"px "+-y+"px "+-g+"px "+-m+"px",threshold:tr(0,mi(1,l))||1};let w=!0;function C(P){const k=P[0].intersectionRatio;if(k!==l){if(!w)return i();k?i(!1,k):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(C,{...x,root:o.ownerDocument})}catch{n=new IntersectionObserver(C,x)}n.observe(e)}return i(!0),s}function tF(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Dw(e),u=o||s?[...c?td(c):[],...td(t)]:[];u.forEach(v=>{o&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const d=c&&a?eF(c,n):null;let h=-1,f=null;i&&(f=new ResizeObserver(v=>{let[x]=v;x&&x.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=f)==null||w.observe(t)})),n()}),c&&!l&&f.observe(c),f.observe(t));let y,g=l?ga(e):null;l&&m();function m(){const v=ga(e);g&&(v.x!==g.x||v.y!==g.y||v.width!==g.width||v.height!==g.height)&&n(),g=v,y=requestAnimationFrame(m)}return n(),()=>{var v;u.forEach(x=>{o&&x.removeEventListener("scroll",n),s&&x.removeEventListener("resize",n)}),d==null||d(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(y)}}const nF=j8,rF=D8,oF=A8,sF=$8,iF=R8,yP=M8,aF=N8,lF=(e,t,n)=>{const r=new Map,o={platform:J8,...n},s={...o.platform,_c:r};return T8(e,t,{...o,platform:s})};var jp=typeof document<"u"?b.useLayoutEffect:b.useEffect;function Jf(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Jf(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const s=o[r];if(!(s==="_owner"&&e.$$typeof)&&!Jf(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function ZT(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function vP(e,t){const n=ZT(e);return Math.round(t*n)/n}function Ny(e){const t=b.useRef(e);return jp(()=>{t.current=e}),t}function cF(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=b.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=b.useState(r);Jf(h,r)||f(r);const[y,g]=b.useState(null),[m,v]=b.useState(null),x=b.useCallback(D=>{D!==k.current&&(k.current=D,g(D))},[]),w=b.useCallback(D=>{D!==I.current&&(I.current=D,v(D))},[]),C=s||y,P=i||m,k=b.useRef(null),I=b.useRef(null),_=b.useRef(u),M=l!=null,T=Ny(l),R=Ny(o),j=Ny(c),$=b.useCallback(()=>{if(!k.current||!I.current)return;const D={placement:t,strategy:n,middleware:h};R.current&&(D.platform=R.current),lF(k.current,I.current,D).then(z=>{const V={...z,isPositioned:j.current!==!1};L.current&&!Jf(_.current,V)&&(_.current=V,Md.flushSync(()=>{d(V)}))})},[h,t,n,R,j]);jp(()=>{c===!1&&_.current.isPositioned&&(_.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[c]);const L=b.useRef(!1);jp(()=>(L.current=!0,()=>{L.current=!1}),[]),jp(()=>{if(C&&(k.current=C),P&&(I.current=P),C&&P){if(T.current)return T.current(C,P,$);$()}},[C,P,$,T,M]);const U=b.useMemo(()=>({reference:k,floating:I,setReference:x,setFloating:w}),[x,w]),F=b.useMemo(()=>({reference:C,floating:P}),[C,P]),G=b.useMemo(()=>{const D={position:n,left:0,top:0};if(!F.floating)return D;const z=vP(F.floating,u.x),V=vP(F.floating,u.y);return a?{...D,transform:"translate("+z+"px, "+V+"px)",...ZT(F.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:z,top:V}},[n,a,F.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:$,refs:U,elements:F,floatingStyles:G}),[u,$,U,F,G])}const uF=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?yP({element:r.current,padding:o}).fn(n):{}:r?yP({element:r,padding:o}).fn(n):{}}}},dF=(e,t)=>({...nF(e),options:[e,t]}),hF=(e,t)=>({...rF(e),options:[e,t]}),pF=(e,t)=>({...aF(e),options:[e,t]}),fF=(e,t)=>({...oF(e),options:[e,t]}),gF=(e,t)=>({...sF(e),options:[e,t]}),mF=(e,t)=>({...iF(e),options:[e,t]}),yF=(e,t)=>({...uF(e),options:[e,t]});var vF="Arrow",JT=b.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...s}=e;return p.jsx(Ce.svg,{...s,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});JT.displayName=vF;var SF=JT;function xF(e,t=[]){let n=[];function r(s,i){const a=b.createContext(i),l=n.length;n=[...n,i];function c(d){const{scope:h,children:f,...y}=d,g=(h==null?void 0:h[e][l])||a,m=b.useMemo(()=>y,Object.values(y));return p.jsx(g.Provider,{value:m,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,y=b.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=n.map(i=>b.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,wF(o,...t)]}function wF(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function eM(e){const[t,n]=b.useState(void 0);return gi(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;n({width:i,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var Nw="Popper",[tM,pc]=xF(Nw),[bF,nM]=tM(Nw),rM=e=>{const{__scopePopper:t,children:n}=e,[r,o]=b.useState(null);return p.jsx(bF,{scope:t,anchor:r,onAnchorChange:o,children:n})};rM.displayName=Nw;var oM="PopperAnchor",sM=b.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,s=nM(oM,n),i=b.useRef(null),a=Ye(t,i);return b.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:p.jsx(Ce.div,{...o,ref:a})});sM.displayName=oM;var $w="PopperContent",[CF,PF]=tM($w),iM=b.forwardRef((e,t)=>{var Te,Oe,Pe,Fe,je,$t;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:y,...g}=e,m=nM($w,n),[v,x]=b.useState(null),w=Ye(t,kt=>x(kt)),[C,P]=b.useState(null),k=eM(C),I=(k==null?void 0:k.width)??0,_=(k==null?void 0:k.height)??0,M=r+(s!=="center"?"-"+s:""),T=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},R=Array.isArray(c)?c:[c],j=R.length>0,$={padding:T,boundary:R.filter(EF),altBoundary:j},{refs:L,floatingStyles:U,placement:F,isPositioned:G,middlewareData:D}=cF({strategy:"fixed",placement:M,whileElementsMounted:(...kt)=>tF(...kt,{animationFrame:f==="always"}),elements:{reference:m.anchor},middleware:[dF({mainAxis:o+_,alignmentAxis:i}),l&&hF({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?pF():void 0,...$}),l&&fF({...$}),gF({...$,apply:({elements:kt,rects:Lt,availableWidth:mt,availableHeight:et})=>{const{width:$r,height:Oi}=Lt.reference,Et=kt.floating.style;Et.setProperty("--radix-popper-available-width",`${mt}px`),Et.setProperty("--radix-popper-available-height",`${et}px`),Et.setProperty("--radix-popper-anchor-width",`${$r}px`),Et.setProperty("--radix-popper-anchor-height",`${Oi}px`)}}),C&&yF({element:C,padding:a}),IF({arrowWidth:I,arrowHeight:_}),h&&mF({strategy:"referenceHidden",...$})]}),[z,V]=cM(F),K=qt(y);gi(()=>{G&&(K==null||K())},[G,K]);const J=(Te=D.arrow)==null?void 0:Te.x,ne=(Oe=D.arrow)==null?void 0:Oe.y,me=((Pe=D.arrow)==null?void 0:Pe.centerOffset)!==0,[te,de]=b.useState();return gi(()=>{v&&de(window.getComputedStyle(v).zIndex)},[v]),p.jsx("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:G?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:te,"--radix-popper-transform-origin":[(Fe=D.transformOrigin)==null?void 0:Fe.x,(je=D.transformOrigin)==null?void 0:je.y].join(" "),...(($t=D.hide)==null?void 0:$t.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:p.jsx(CF,{scope:n,placedSide:z,onArrowChange:P,arrowX:J,arrowY:ne,shouldHideArrow:me,children:p.jsx(Ce.div,{"data-side":z,"data-align":V,...g,ref:w,style:{...g.style,animation:G?void 0:"none"}})})})});iM.displayName=$w;var aM="PopperArrow",kF={top:"bottom",right:"left",bottom:"top",left:"right"},lM=b.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,s=PF(aM,r),i=kF[s.placedSide];return p.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:p.jsx(SF,{...o,ref:n,style:{...o.style,display:"block"}})})});lM.displayName=aM;function EF(e){return e!==null}var IF=e=>({name:"transformOrigin",options:e,fn(t){var m,v,x;const{placement:n,rects:r,middlewareData:o}=t,i=((m=o.arrow)==null?void 0:m.centerOffset)!==0,a=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,u]=cM(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((v=o.arrow)==null?void 0:v.x)??0)+a/2,f=(((x=o.arrow)==null?void 0:x.y)??0)+l/2;let y="",g="";return c==="bottom"?(y=i?d:`${h}px`,g=`${-l}px`):c==="top"?(y=i?d:`${h}px`,g=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,g=i?d:`${f}px`):c==="left"&&(y=`${r.floating.width+l}px`,g=i?d:`${f}px`),{data:{x:y,y:g}}}});function cM(e){const[t,n="center"]=e.split("-");return[t,n]}var Lw=rM,lm=sM,Fw=iM,zw=lM,[cm,Sce]=vs("Tooltip",[pc]),Bw=pc(),uM="TooltipProvider",_F=700,SP="tooltip.open",[TF,dM]=cm(uM),hM=e=>{const{__scopeTooltip:t,delayDuration:n=_F,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:s}=e,[i,a]=b.useState(!0),l=b.useRef(!1),c=b.useRef(0);return b.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),p.jsx(TF,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:b.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:b.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:b.useCallback(u=>{l.current=u},[]),disableHoverableContent:o,children:s})};hM.displayName=uM;var pM="Tooltip",[xce,um]=cm(pM),kS="TooltipTrigger",MF=b.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=um(kS,n),s=dM(kS,n),i=Bw(n),a=b.useRef(null),l=Ye(t,a,o.onTriggerChange),c=b.useRef(!1),u=b.useRef(!1),d=b.useCallback(()=>c.current=!1,[]);return b.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),p.jsx(lm,{asChild:!0,...i,children:p.jsx(Ce.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:l,onPointerMove:ee(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(o.onTriggerEnter(),u.current=!0)}),onPointerLeave:ee(e.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:ee(e.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ee(e.onFocus,()=>{c.current||o.onOpen()}),onBlur:ee(e.onBlur,o.onClose),onClick:ee(e.onClick,o.onClose)})})});MF.displayName=kS;var AF="TooltipPortal",[wce,RF]=cm(AF,{forceMount:void 0}),Zl="TooltipContent",fM=b.forwardRef((e,t)=>{const n=RF(Zl,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...s}=e,i=um(Zl,e.__scopeTooltip);return p.jsx(gr,{present:r||i.open,children:i.disableHoverableContent?p.jsx(gM,{side:o,...s,ref:t}):p.jsx(OF,{side:o,...s,ref:t})})}),OF=b.forwardRef((e,t)=>{const n=um(Zl,e.__scopeTooltip),r=dM(Zl,e.__scopeTooltip),o=b.useRef(null),s=Ye(t,o),[i,a]=b.useState(null),{trigger:l,onClose:c}=n,u=o.current,{onPointerInTransitChange:d}=r,h=b.useCallback(()=>{a(null),d(!1)},[d]),f=b.useCallback((y,g)=>{const m=y.currentTarget,v={x:y.clientX,y:y.clientY},x=$F(v,m.getBoundingClientRect()),w=LF(v,x),C=FF(g.getBoundingClientRect()),P=BF([...w,...C]);a(P),d(!0)},[d]);return b.useEffect(()=>()=>h(),[h]),b.useEffect(()=>{if(l&&u){const y=m=>f(m,u),g=m=>f(m,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",g)}}},[l,u,f,h]),b.useEffect(()=>{if(i){const y=g=>{const m=g.target,v={x:g.clientX,y:g.clientY},x=(l==null?void 0:l.contains(m))||(u==null?void 0:u.contains(m)),w=!zF(v,i);x?h():w&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,i,c,h]),p.jsx(gM,{...e,ref:s})}),[jF,DF]=cm(pM,{isInside:!1}),gM=b.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:s,onPointerDownOutside:i,...a}=e,l=um(Zl,n),c=Bw(n),{onClose:u}=l;return b.useEffect(()=>(document.addEventListener(SP,u),()=>document.removeEventListener(SP,u)),[u]),b.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),p.jsx(cc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:p.jsxs(Fw,{"data-state":l.stateAttribute,...c,...a,ref:t,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(fT,{children:r}),p.jsx(jF,{scope:n,isInside:!0,children:p.jsx(jL,{id:l.contentId,role:"tooltip",children:o||r})})]})})});fM.displayName=Zl;var mM="TooltipArrow",NF=b.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=Bw(n);return DF(mM,n).isInside?null:p.jsx(zw,{...o,...r,ref:t})});NF.displayName=mM;function $F(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(n,r,o,s)){case s:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function LF(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function FF(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function zF(e,t){const{x:n,y:r}=e;let o=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const a=t[s].x,l=t[s].y,c=t[i].x,u=t[i].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(o=!o)}return o}function BF(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),UF(t)}function UF(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(o.y-i.y)>=(s.y-i.y)*(o.x-i.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const s=n[n.length-1],i=n[n.length-2];if((s.x-i.x)*(o.y-i.y)>=(s.y-i.y)*(o.x-i.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var HF=hM,yM=fM;const VF=HF,KF=b.forwardRef(({className:e,sideOffset:t=4,...n},r)=>p.jsx(yM,{ref:r,sideOffset:t,className:Ct("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));KF.displayName=yM.displayName;var dm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hm=typeof window>"u"||"Deno"in globalThis;function Hr(){}function WF(e,t){return typeof e=="function"?e(t):e}function GF(e){return typeof e=="number"&&e>=0&&e!==1/0}function YF(e,t){return Math.max(e+(t||0)-Date.now(),0)}function xP(e,t){return typeof e=="function"?e(t):e}function XF(e,t){return typeof e=="function"?e(t):e}function wP(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:s,queryKey:i,stale:a}=e;if(i){if(r){if(t.queryHash!==Uw(i,t.options))return!1}else if(!rd(t.queryKey,i))return!1}if(n!=="all"){const l=t.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||o&&o!==t.state.fetchStatus||s&&!s(t))}function bP(e,t){const{exact:n,status:r,predicate:o,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(n){if(nd(t.options.mutationKey)!==nd(s))return!1}else if(!rd(t.options.mutationKey,s))return!1}return!(r&&t.state.status!==r||o&&!o(t))}function Uw(e,t){return((t==null?void 0:t.queryKeyHashFn)||nd)(e)}function nd(e){return JSON.stringify(e,(t,n)=>ES(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function rd(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!rd(e[n],t[n])):!1}function vM(e,t){if(e===t)return e;const n=CP(e)&&CP(t);if(n||ES(e)&&ES(t)){const r=n?e:Object.keys(e),o=r.length,s=n?t:Object.keys(t),i=s.length,a=n?[]:{};let l=0;for(let c=0;c<i;c++){const u=n?c:s[c];(!n&&r.includes(u)||n)&&e[u]===void 0&&t[u]===void 0?(a[u]=void 0,l++):(a[u]=vM(e[u],t[u]),a[u]===e[u]&&e[u]!==void 0&&l++)}return o===i&&l===o?e:a}return t}function CP(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ES(e){if(!PP(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!PP(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function PP(e){return Object.prototype.toString.call(e)==="[object Object]"}function qF(e){return new Promise(t=>{setTimeout(t,e)})}function QF(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?vM(e,t):t}function ZF(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function JF(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var Hw=Symbol();function SM(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Hw?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ta,Hs,Dl,K2,ez=(K2=class extends dm{constructor(){super();De(this,ta);De(this,Hs);De(this,Dl);we(this,Dl,t=>{if(!hm&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Y(this,Hs)||this.setEventListener(Y(this,Dl))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,Hs))==null||t.call(this),we(this,Hs,void 0))}setEventListener(t){var n;we(this,Dl,t),(n=Y(this,Hs))==null||n.call(this),we(this,Hs,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){Y(this,ta)!==t&&(we(this,ta,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Y(this,ta)=="boolean"?Y(this,ta):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ta=new WeakMap,Hs=new WeakMap,Dl=new WeakMap,K2),xM=new ez,Nl,Vs,$l,W2,tz=(W2=class extends dm{constructor(){super();De(this,Nl,!0);De(this,Vs);De(this,$l);we(this,$l,t=>{if(!hm&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Y(this,Vs)||this.setEventListener(Y(this,$l))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,Vs))==null||t.call(this),we(this,Vs,void 0))}setEventListener(t){var n;we(this,$l,t),(n=Y(this,Vs))==null||n.call(this),we(this,Vs,t(this.setOnline.bind(this)))}setOnline(t){Y(this,Nl)!==t&&(we(this,Nl,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return Y(this,Nl)}},Nl=new WeakMap,Vs=new WeakMap,$l=new WeakMap,W2),eg=new tz;function nz(){let e,t;const n=new Promise((o,s)=>{e=o,t=s});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),e(o)},n.reject=o=>{r({status:"rejected",reason:o}),t(o)},n}function rz(e){return Math.min(1e3*2**e,3e4)}function wM(e){return(e??"online")==="online"?eg.isOnline():!0}var bM=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function $y(e){return e instanceof bM}function CM(e){let t=!1,n=0,r=!1,o;const s=nz(),i=g=>{var m;r||(h(new bM(g)),(m=e.abort)==null||m.call(e))},a=()=>{t=!0},l=()=>{t=!1},c=()=>xM.isFocused()&&(e.networkMode==="always"||eg.isOnline())&&e.canRun(),u=()=>wM(e.networkMode)&&e.canRun(),d=g=>{var m;r||(r=!0,(m=e.onSuccess)==null||m.call(e,g),o==null||o(),s.resolve(g))},h=g=>{var m;r||(r=!0,(m=e.onError)==null||m.call(e,g),o==null||o(),s.reject(g))},f=()=>new Promise(g=>{var m;o=v=>{(r||c())&&g(v)},(m=e.onPause)==null||m.call(e)}).then(()=>{var g;o=void 0,r||(g=e.onContinue)==null||g.call(e)}),y=()=>{if(r)return;let g;const m=n===0?e.initialPromise:void 0;try{g=m??e.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(d).catch(v=>{var k;if(r)return;const x=e.retry??(hm?0:3),w=e.retryDelay??rz,C=typeof w=="function"?w(n,v):w,P=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,v);if(t||!P){h(v);return}n++,(k=e.onFail)==null||k.call(e,n,v),qF(C).then(()=>c()?void 0:f()).then(()=>{t?h(v):y()})})};return{promise:s,cancel:i,continue:()=>(o==null||o(),s),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?y():f().then(y),s)}}function oz(){let e=[],t=0,n=a=>{a()},r=a=>{a()},o=a=>setTimeout(a,0);const s=a=>{t?e.push(a):o(()=>{n(a)})},i=()=>{const a=e;e=[],a.length&&o(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;t++;try{l=a()}finally{t--,t||i()}return l},batchCalls:a=>(...l)=>{s(()=>{a(...l)})},schedule:s,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{o=a}}}var Cn=oz(),na,G2,PM=(G2=class{constructor(){De(this,na)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),GF(this.gcTime)&&we(this,na,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(hm?1/0:5*60*1e3))}clearGcTimeout(){Y(this,na)&&(clearTimeout(Y(this,na)),we(this,na,void 0))}},na=new WeakMap,G2),Ll,Fl,Cr,tn,Cd,ra,Vr,Wo,Y2,sz=(Y2=class extends PM{constructor(t){super();De(this,Vr);De(this,Ll);De(this,Fl);De(this,Cr);De(this,tn);De(this,Cd);De(this,ra);we(this,ra,!1),we(this,Cd,t.defaultOptions),this.setOptions(t.options),this.observers=[],we(this,Cr,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,we(this,Ll,az(this.options)),this.state=t.state??Y(this,Ll),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Y(this,tn))==null?void 0:t.promise}setOptions(t){this.options={...Y(this,Cd),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Y(this,Cr).remove(this)}setData(t,n){const r=QF(this.state.data,t,this.options);return Zt(this,Vr,Wo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Zt(this,Vr,Wo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,o;const n=(r=Y(this,tn))==null?void 0:r.promise;return(o=Y(this,tn))==null||o.cancel(t),n?n.then(Hr).catch(Hr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Y(this,Ll))}isActive(){return this.observers.some(t=>XF(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Hw||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!YF(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Y(this,tn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Y(this,tn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Y(this,Cr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Y(this,tn)&&(Y(this,ra)?Y(this,tn).cancel({revert:!0}):Y(this,tn).cancelRetry()),this.scheduleGc()),Y(this,Cr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Zt(this,Vr,Wo).call(this,{type:"invalidate"})}fetch(t,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Y(this,tn))return Y(this,tn).continueRetry(),Y(this,tn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,o=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(we(this,ra,!0),r.signal)})},s=()=>{const d=SM(this.options,n),h={queryKey:this.queryKey,meta:this.meta};return o(h),we(this,ra,!1),this.options.persister?this.options.persister(d,h,this):d(h)},i={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:s};o(i),(l=this.options.behavior)==null||l.onFetch(i,this),we(this,Fl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=i.fetchOptions)==null?void 0:c.meta))&&Zt(this,Vr,Wo).call(this,{type:"fetch",meta:(u=i.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,f,y,g;$y(d)&&d.silent||Zt(this,Vr,Wo).call(this,{type:"error",error:d}),$y(d)||((f=(h=Y(this,Cr).config).onError)==null||f.call(h,d,this),(g=(y=Y(this,Cr).config).onSettled)==null||g.call(y,this.state.data,d,this)),this.scheduleGc()};return we(this,tn,CM({initialPromise:n==null?void 0:n.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var h,f,y,g;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(m){a(m);return}(f=(h=Y(this,Cr).config).onSuccess)==null||f.call(h,d,this),(g=(y=Y(this,Cr).config).onSettled)==null||g.call(y,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{Zt(this,Vr,Wo).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{Zt(this,Vr,Wo).call(this,{type:"pause"})},onContinue:()=>{Zt(this,Vr,Wo).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),Y(this,tn).start()}},Ll=new WeakMap,Fl=new WeakMap,Cr=new WeakMap,tn=new WeakMap,Cd=new WeakMap,ra=new WeakMap,Vr=new WeakSet,Wo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...iz(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return $y(o)&&o.revert&&Y(this,Fl)?{...Y(this,Fl),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Cn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),Y(this,Cr).notify({query:this,type:"updated",action:t})})},Y2);function iz(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:wM(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function az(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var yo,X2,lz=(X2=class extends dm{constructor(t={}){super();De(this,yo);this.config=t,we(this,yo,new Map)}build(t,n,r){const o=n.queryKey,s=n.queryHash??Uw(o,n);let i=this.get(s);return i||(i=new sz({cache:this,queryKey:o,queryHash:s,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(o)}),this.add(i)),i}add(t){Y(this,yo).has(t.queryHash)||(Y(this,yo).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Y(this,yo).get(t.queryHash);n&&(t.destroy(),n===t&&Y(this,yo).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Cn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Y(this,yo).get(t)}getAll(){return[...Y(this,yo).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>wP(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>wP(t,r)):n}notify(t){Cn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},yo=new WeakMap,X2),vo,wn,oa,So,Ds,q2,cz=(q2=class extends PM{constructor(t){super();De(this,So);De(this,vo);De(this,wn);De(this,oa);this.mutationId=t.mutationId,we(this,wn,t.mutationCache),we(this,vo,[]),this.state=t.state||uz(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Y(this,vo).includes(t)||(Y(this,vo).push(t),this.clearGcTimeout(),Y(this,wn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){we(this,vo,Y(this,vo).filter(n=>n!==t)),this.scheduleGc(),Y(this,wn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Y(this,vo).length||(this.state.status==="pending"?this.scheduleGc():Y(this,wn).remove(this))}continue(){var t;return((t=Y(this,oa))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,s,i,a,l,c,u,d,h,f,y,g,m,v,x,w,C,P,k,I;we(this,oa,CM({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(_,M)=>{Zt(this,So,Ds).call(this,{type:"failed",failureCount:_,error:M})},onPause:()=>{Zt(this,So,Ds).call(this,{type:"pause"})},onContinue:()=>{Zt(this,So,Ds).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Y(this,wn).canRun(this)}));const n=this.state.status==="pending",r=!Y(this,oa).canStart();try{if(!n){Zt(this,So,Ds).call(this,{type:"pending",variables:t,isPaused:r}),await((s=(o=Y(this,wn).config).onMutate)==null?void 0:s.call(o,t,this));const M=await((a=(i=this.options).onMutate)==null?void 0:a.call(i,t));M!==this.state.context&&Zt(this,So,Ds).call(this,{type:"pending",context:M,variables:t,isPaused:r})}const _=await Y(this,oa).start();return await((c=(l=Y(this,wn).config).onSuccess)==null?void 0:c.call(l,_,t,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,_,t,this.state.context)),await((f=(h=Y(this,wn).config).onSettled)==null?void 0:f.call(h,_,null,this.state.variables,this.state.context,this)),await((g=(y=this.options).onSettled)==null?void 0:g.call(y,_,null,t,this.state.context)),Zt(this,So,Ds).call(this,{type:"success",data:_}),_}catch(_){try{throw await((v=(m=Y(this,wn).config).onError)==null?void 0:v.call(m,_,t,this.state.context,this)),await((w=(x=this.options).onError)==null?void 0:w.call(x,_,t,this.state.context)),await((P=(C=Y(this,wn).config).onSettled)==null?void 0:P.call(C,void 0,_,this.state.variables,this.state.context,this)),await((I=(k=this.options).onSettled)==null?void 0:I.call(k,void 0,_,t,this.state.context)),_}finally{Zt(this,So,Ds).call(this,{type:"error",error:_})}}finally{Y(this,wn).runNext(this)}}},vo=new WeakMap,wn=new WeakMap,oa=new WeakMap,So=new WeakSet,Ds=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Cn.batch(()=>{Y(this,vo).forEach(r=>{r.onMutationUpdate(t)}),Y(this,wn).notify({mutation:this,type:"updated",action:t})})},q2);function uz(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zn,Pd,Q2,dz=(Q2=class extends dm{constructor(t={}){super();De(this,Zn);De(this,Pd);this.config=t,we(this,Zn,new Map),we(this,Pd,Date.now())}build(t,n,r){const o=new cz({mutationCache:this,mutationId:++mh(this,Pd)._,options:t.defaultMutationOptions(n),state:r});return this.add(o),o}add(t){const n=Lh(t),r=Y(this,Zn).get(n)??[];r.push(t),Y(this,Zn).set(n,r),this.notify({type:"added",mutation:t})}remove(t){var r;const n=Lh(t);if(Y(this,Zn).has(n)){const o=(r=Y(this,Zn).get(n))==null?void 0:r.filter(s=>s!==t);o&&(o.length===0?Y(this,Zn).delete(n):Y(this,Zn).set(n,o))}this.notify({type:"removed",mutation:t})}canRun(t){var r;const n=(r=Y(this,Zn).get(Lh(t)))==null?void 0:r.find(o=>o.state.status==="pending");return!n||n===t}runNext(t){var r;const n=(r=Y(this,Zn).get(Lh(t)))==null?void 0:r.find(o=>o!==t&&o.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Cn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...Y(this,Zn).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>bP(n,r))}findAll(t={}){return this.getAll().filter(n=>bP(t,n))}notify(t){Cn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Cn.batch(()=>Promise.all(t.map(n=>n.continue().catch(Hr))))}},Zn=new WeakMap,Pd=new WeakMap,Q2);function Lh(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function kP(e){return{onFetch:(t,n)=>{var u,d,h,f,y;const r=t.options,o=(h=(d=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,s=((f=t.state.data)==null?void 0:f.pages)||[],i=((y=t.state.data)==null?void 0:y.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const m=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},v=SM(t.options,t.fetchOptions),x=async(w,C,P)=>{if(g)return Promise.reject();if(C==null&&w.pages.length)return Promise.resolve(w);const k={queryKey:t.queryKey,pageParam:C,direction:P?"backward":"forward",meta:t.options.meta};m(k);const I=await v(k),{maxPages:_}=t.options,M=P?JF:ZF;return{pages:M(w.pages,I,_),pageParams:M(w.pageParams,C,_)}};if(o&&s.length){const w=o==="backward",C=w?hz:EP,P={pages:s,pageParams:i},k=C(r,P);a=await x(P,k,w)}else{const w=e??s.length;do{const C=l===0?i[0]??r.initialPageParam:EP(r,a);if(l>0&&C==null)break;a=await x(a,C),l++}while(l<w)}return a};t.options.persister?t.fetchFn=()=>{var g,m;return(m=(g=t.options).persister)==null?void 0:m.call(g,c,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=c}}}function EP(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function hz(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var vt,Ks,Ws,zl,Bl,Gs,Ul,Hl,Z2,pz=(Z2=class{constructor(e={}){De(this,vt);De(this,Ks);De(this,Ws);De(this,zl);De(this,Bl);De(this,Gs);De(this,Ul);De(this,Hl);we(this,vt,e.queryCache||new lz),we(this,Ks,e.mutationCache||new dz),we(this,Ws,e.defaultOptions||{}),we(this,zl,new Map),we(this,Bl,new Map),we(this,Gs,0)}mount(){mh(this,Gs)._++,Y(this,Gs)===1&&(we(this,Ul,xM.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,vt).onFocus())})),we(this,Hl,eg.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,vt).onOnline())})))}unmount(){var e,t;mh(this,Gs)._--,Y(this,Gs)===0&&((e=Y(this,Ul))==null||e.call(this),we(this,Ul,void 0),(t=Y(this,Hl))==null||t.call(this),we(this,Hl,void 0))}isFetching(e){return Y(this,vt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Y(this,Ks).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Y(this,vt).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=Y(this,vt).build(this,n);return e.revalidateIfStale&&r.isStaleByTime(xP(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return Y(this,vt).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=Y(this,vt).get(r.queryHash),s=o==null?void 0:o.state.data,i=WF(t,s);if(i!==void 0)return Y(this,vt).build(this,r).setData(i,{...n,manual:!0})}setQueriesData(e,t,n){return Cn.batch(()=>Y(this,vt).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Y(this,vt).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Y(this,vt);Cn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Y(this,vt),r={type:"active",...e};return Cn.batch(()=>(n.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries(r,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=Cn.batch(()=>Y(this,vt).findAll(e).map(o=>o.cancel(n)));return Promise.all(r).then(Hr).catch(Hr)}invalidateQueries(e={},t={}){return Cn.batch(()=>{if(Y(this,vt).findAll(e).forEach(r=>{r.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},r=Cn.batch(()=>Y(this,vt).findAll(e).filter(o=>!o.isDisabled()).map(o=>{let s=o.fetch(void 0,n);return n.throwOnError||(s=s.catch(Hr)),o.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(Hr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Y(this,vt).build(this,t);return n.isStaleByTime(xP(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Hr).catch(Hr)}fetchInfiniteQuery(e){return e.behavior=kP(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Hr).catch(Hr)}ensureInfiniteQueryData(e){return e.behavior=kP(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return eg.isOnline()?Y(this,Ks).resumePausedMutations():Promise.resolve()}getQueryCache(){return Y(this,vt)}getMutationCache(){return Y(this,Ks)}getDefaultOptions(){return Y(this,Ws)}setDefaultOptions(e){we(this,Ws,e)}setQueryDefaults(e,t){Y(this,zl).set(nd(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Y(this,zl).values()];let n={};return t.forEach(r=>{rd(e,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(e,t){Y(this,Bl).set(nd(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Y(this,Bl).values()];let n={};return t.forEach(r=>{rd(e,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Y(this,Ws).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Uw(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===Hw&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Y(this,Ws).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Y(this,vt).clear(),Y(this,Ks).clear()}},vt=new WeakMap,Ks=new WeakMap,Ws=new WeakMap,zl=new WeakMap,Bl=new WeakMap,Gs=new WeakMap,Ul=new WeakMap,Hl=new WeakMap,Z2),fz=b.createContext(void 0),gz=({client:e,children:t})=>(b.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),p.jsx(fz.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tg.apply(this,arguments)}var qs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qs||(qs={}));const IP="popstate";function mz(e){e===void 0&&(e={});function t(r,o){let{pathname:s,search:i,hash:a}=r.location;return IS("",{pathname:s,search:i,hash:a},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:EM(o)}return vz(t,n,null,e)}function Hn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function kM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yz(){return Math.random().toString(36).substr(2,8)}function _P(e,t){return{usr:e.state,key:e.key,idx:t}}function IS(e,t,n,r){return n===void 0&&(n=null),tg({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?pm(t):t,{state:n,key:t&&t.key||r||yz()})}function EM(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function pm(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function vz(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:s=!1}=r,i=o.history,a=qs.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(tg({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function d(){a=qs.Pop;let m=u(),v=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:v})}function h(m,v){a=qs.Push;let x=IS(g.location,m,v);c=u()+1;let w=_P(x,c),C=g.createHref(x);try{i.pushState(w,"",C)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;o.location.assign(C)}s&&l&&l({action:a,location:g.location,delta:1})}function f(m,v){a=qs.Replace;let x=IS(g.location,m,v);c=u();let w=_P(x,c),C=g.createHref(x);i.replaceState(w,"",C),s&&l&&l({action:a,location:g.location,delta:0})}function y(m){let v=o.location.origin!=="null"?o.location.origin:o.location.href,x=typeof m=="string"?m:EM(m);return x=x.replace(/ $/,"%20"),Hn(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let g={get action(){return a},get location(){return e(o,i)},listen(m){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener(IP,d),l=m,()=>{o.removeEventListener(IP,d),l=null}},createHref(m){return t(o,m)},createURL:y,encodeLocation(m){let v=y(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:f,go(m){return i.go(m)}};return g}var TP;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(TP||(TP={}));function Sz(e,t,n){return n===void 0&&(n="/"),xz(e,t,n,!1)}function xz(e,t,n,r){let o=typeof t=="string"?pm(t):t,s=TM(o.pathname||"/",n);if(s==null)return null;let i=IM(e);wz(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let c=Rz(s);a=Mz(i[l],c,r)}return a}function IM(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(s,i,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Hn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Tl([r,l.relativePath]),u=n.concat(l);s.children&&s.children.length>0&&(Hn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),IM(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:_z(c,s.index),routesMeta:u})};return e.forEach((s,i)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))o(s,i);else for(let l of _M(s.path))o(s,i,l)}),t}function _M(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return o?[s,""]:[s];let i=_M(r.join("/")),a=[];return a.push(...i.map(l=>l===""?s:[s,l].join("/"))),o&&a.push(...i),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function wz(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Tz(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const bz=/^:[\w-]+$/,Cz=3,Pz=2,kz=1,Ez=10,Iz=-2,MP=e=>e==="*";function _z(e,t){let n=e.split("/"),r=n.length;return n.some(MP)&&(r+=Iz),t&&(r+=Pz),n.filter(o=>!MP(o)).reduce((o,s)=>o+(bz.test(s)?Cz:s===""?kz:Ez),r)}function Tz(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function Mz(e,t,n){let{routesMeta:r}=e,o={},s="/",i=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=AP({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=AP({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(o,d.params),i.push({params:o,pathname:Tl([s,d.pathname]),pathnameBase:Oz(Tl([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Tl([s,d.pathnameBase]))}return i}function AP(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Az(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let s=o[0],i=s.replace(/(.)\/+$/,"$1"),a=o.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let g=a[d]||"";i=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const y=a[d];return f&&!y?c[h]=void 0:c[h]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function Az(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),kM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function Rz(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return kM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function TM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const Tl=e=>e.join("/").replace(/\/\/+/g,"/"),Oz=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function jz(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const MM=["post","put","patch","delete"];new Set(MM);const Dz=["get",...MM];new Set(Dz);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ng.apply(this,arguments)}const Nz=b.createContext(null),$z=b.createContext(null),AM=b.createContext(null),fm=b.createContext(null),gm=b.createContext({outlet:null,matches:[],isDataRoute:!1}),RM=b.createContext(null);function Vw(){return b.useContext(fm)!=null}function OM(){return Vw()||Hn(!1),b.useContext(fm).location}function Lz(e,t){return Fz(e,t)}function Fz(e,t,n,r){Vw()||Hn(!1);let{navigator:o}=b.useContext(AM),{matches:s}=b.useContext(gm),i=s[s.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=OM(),u;if(t){var d;let m=typeof t=="string"?pm(t):t;l==="/"||(d=m.pathname)!=null&&d.startsWith(l)||Hn(!1),u=m}else u=c;let h=u.pathname||"/",f=h;if(l!=="/"){let m=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(m.length).join("/")}let y=Sz(e,{pathname:f}),g=Vz(y&&y.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:Tl([l,o.encodeLocation?o.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:Tl([l,o.encodeLocation?o.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),s,n,r);return t&&g?b.createElement(fm.Provider,{value:{location:ng({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:qs.Pop}},g):g}function zz(){let e=Yz(),t=jz(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},t),n?b.createElement("pre",{style:o},n):null,null)}const Bz=b.createElement(zz,null);class Uz extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?b.createElement(gm.Provider,{value:this.props.routeContext},b.createElement(RM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Hz(e){let{routeContext:t,match:n,children:r}=e,o=b.useContext(Nz);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(gm.Provider,{value:t},r)}function Vz(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var s;if(!n)return null;if(n.errors)e=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=(o=n)==null?void 0:o.errors;if(a!=null){let u=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Hn(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,y=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||y){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,h)=>{let f,y=!1,g=null,m=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||Bz,l&&(c<0&&h===0?(y=!0,m=null):c===h&&(y=!0,m=d.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,h+1)),x=()=>{let w;return f?w=g:y?w=m:d.route.Component?w=b.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,b.createElement(Hz,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?b.createElement(Uz,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var _S=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(_S||{});function Kz(e){let t=b.useContext($z);return t||Hn(!1),t}function Wz(e){let t=b.useContext(gm);return t||Hn(!1),t}function Gz(e){let t=Wz(),n=t.matches[t.matches.length-1];return n.route.id||Hn(!1),n.route.id}function Yz(){var e;let t=b.useContext(RM),n=Kz(_S.UseRouteError),r=Gz(_S.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function TS(e){Hn(!1)}function Xz(e){let{basename:t="/",children:n=null,location:r,navigationType:o=qs.Pop,navigator:s,static:i=!1,future:a}=e;Vw()&&Hn(!1);let l=t.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:s,static:i,future:ng({v7_relativeSplatPath:!1},a)}),[l,a,s,i]);typeof r=="string"&&(r=pm(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:y="default"}=r,g=b.useMemo(()=>{let m=TM(u,l);return m==null?null:{location:{pathname:m,search:d,hash:h,state:f,key:y},navigationType:o}},[l,u,d,h,f,y,o]);return g==null?null:b.createElement(AM.Provider,{value:c},b.createElement(fm.Provider,{children:n,value:g}))}function qz(e){let{children:t,location:n}=e;return Lz(MS(t),n)}new Promise(()=>{});function MS(e,t){t===void 0&&(t=[]);let n=[];return b.Children.forEach(e,(r,o)=>{if(!b.isValidElement(r))return;let s=[...t,o];if(r.type===b.Fragment){n.push.apply(n,MS(r.props.children,s));return}r.type!==TS&&Hn(!1),!r.props.index||!r.props.children||Hn(!1);let i={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=MS(r.props.children,s)),n.push(i)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Qz="6";try{window.__reactRouterVersion=Qz}catch{}const Zz="startTransition",RP=cI[Zz];function Jz(e){let{basename:t,children:n,future:r,window:o}=e,s=b.useRef();s.current==null&&(s.current=mz({window:o,v5Compat:!0}));let i=s.current,[a,l]=b.useState({action:i.action,location:i.location}),{v7_startTransition:c}=r||{},u=b.useCallback(d=>{c&&RP?RP(()=>l(d)):l(d)},[l,c]);return b.useLayoutEffect(()=>i.listen(u),[i,u]),b.createElement(Xz,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:i,future:r})}var OP;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(OP||(OP={}));var jP;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(jP||(jP={}));const e9=RT("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),xo=b.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},s)=>{const i=r?fi:"button";return p.jsx(i,{className:Ct(e9({variant:t,size:n,className:e})),ref:s,...o})});xo.displayName="Button";const t9=({className:e})=>p.jsx("header",{className:Ct("w-full px-6 py-4 glass border-b fixed top-0 z-50 animate-fade-in",e),children:p.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(jT,{className:"h-6 w-6 text-primary"}),p.jsx("h1",{className:"text-xl font-semibold",children:"WanderBoard"})]}),p.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[p.jsxs("nav",{className:"flex items-center gap-6",children:[p.jsx("a",{href:"#",className:"text-sm font-medium hover:text-primary transition-colors",children:"Dashboard"}),p.jsx("a",{href:"#",className:"text-sm font-medium hover:text-primary transition-colors",children:"My Trips"}),p.jsx("a",{href:"#",className:"text-sm font-medium hover:text-primary transition-colors",children:"Inspiration"}),p.jsx("a",{href:"#",className:"text-sm font-medium hover:text-primary transition-colors",children:"Collaborate"})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(vS,{className:"h-4 w-4"}),p.jsx("span",{children:"New Trip"})]}),p.jsxs(xo,{size:"sm",className:"gap-2",children:[p.jsx(r6,{className:"h-4 w-4"}),p.jsx("span",{children:"Explore"})]})]})]}),p.jsx(xo,{variant:"ghost",size:"icon",className:"md:hidden",children:p.jsx(s6,{className:"h-5 w-5"})})]})});function jM(e){return e&&typeof e=="object"&&"parents"in e}function DM(e){for(let t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}const rg=(e,t)=>{if(e.children.remove(t)&&e.children.isEmpty&&jM(e))for(let n=0,r=e.parents.length;n<r;n++)rg(e.parents[n],e)},Kw=(e,t)=>{if(e.children.add(t)&&jM(e))for(let n=0,r=e.parents.length;n<r;n++)Kw(e.parents[n],e)};function NM(e,t){return e===t||Object.is(e,t)||!!(e&&t&&typeof e.equals=="function"&&e.equals(t))}function Ii(e,t){const n=Symbol.for(`com.tldraw.state/${e}`),r=globalThis;return r[n]??(r[n]=t()),r[n]}const ss=Ii("empty_array",()=>Object.freeze([])),DP=8;class $M{constructor(){S(this,"arraySize",0);S(this,"array",Array(DP));S(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(t){if(this.array)return this.array.indexOf(t)!==-1?!1:this.arraySize<DP?(this.array[this.arraySize]=t,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(t),!0);if(this.set)return this.set.has(t)?!1:(this.set.add(t),!0);throw new Error("no set or array")}remove(t){if(this.array){const n=this.array.indexOf(t);return n===-1?!1:(this.array[n]=void 0,this.arraySize--,n!==this.arraySize&&(this.array[n]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(t)?(this.set.delete(t),!0):!1;throw new Error("no set or array")}visit(t){if(this.array){for(let n=0;n<this.arraySize;n++){const r=this.array[n];typeof r<"u"&&t(r)}return}if(this.set){this.set.forEach(t);return}throw new Error("no set or array")}}const cr=Symbol.for("com.tldraw.state/RESET_VALUE");class LM{constructor(t){S(this,"index",0);S(this,"buffer");this.capacity=t,this.buffer=new Array(t)}pushEntry(t,n,r){if(r!==void 0){if(r===cr){this.clear();return}this.buffer[this.index]=[t,n,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(t){const{index:n,capacity:r,buffer:o}=this;for(let s=0;s<r;s++){const i=(n-1+r-s)%r,a=o[i];if(!a)return cr;const[l,c]=a;if(s===0&&t>=c)return[];if(l<=t&&t<c){const u=s+1,d=new Array(u);for(let h=0;h<u;h++)d[h]=o[(i+h)%r][2];return d}}return cr}}class n9{constructor(t,n){S(this,"offset",0);S(this,"numNewParents",0);S(this,"maybeRemoved");this.below=t,this.child=n}}const ot=Ii("capture",()=>({stack:null}));function FM(e){ot.stack=new n9(ot.stack,e)}function zM(){var n;const e=ot.stack;if(ot.stack=e.below,e.numNewParents>0||e.offset!==e.child.parents.length){for(let r=e.offset;r<e.child.parents.length;r++){const o=e.child.parents[r];e.child.parents.indexOf(o)>=e.offset&&rg(o,e.child)}if(e.child.parents.length=e.offset,e.child.parentEpochs.length=e.offset,(n=ot.stack)!=null&&n.maybeRemoved)for(let r=0;r<ot.stack.maybeRemoved.length;r++){const o=ot.stack.maybeRemoved[r];e.child.parents.indexOf(o)===-1&&rg(o,e.child)}}}function AS(e){if(ot.stack){const t=ot.stack.child.parents.indexOf(e);if(t<0&&(ot.stack.numNewParents++,ot.stack.child.isActivelyListening&&Kw(e,ot.stack.child)),t<0||t>=ot.stack.offset){if(t!==ot.stack.offset&&t>0){const n=ot.stack.child.parents[ot.stack.offset];ot.stack.maybeRemoved?ot.stack.maybeRemoved.indexOf(n)===-1&&ot.stack.maybeRemoved.push(n):ot.stack.maybeRemoved=[n]}ot.stack.child.parents[ot.stack.offset]=e,ot.stack.child.parentEpochs[ot.stack.offset]=e.lastChangedEpoch,ot.stack.offset++}}}const Qi=-1;class r9{constructor(t,n,r){S(this,"_isActivelyListening",!1);S(this,"lastTraversedEpoch",Qi);S(this,"lastReactedEpoch",Qi);S(this,"_scheduleCount",0);S(this,"parentEpochs",[]);S(this,"parents",[]);S(this,"_scheduleEffect");S(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=t,this.runEffect=n,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==nr()){if(this.parents.length&&!DM(this)){this.lastReactedEpoch=nr();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let t=0,n=this.parents.length;t<n;t++)Kw(this.parents[t],this)}detach(){this._isActivelyListening=!1;for(let t=0,n=this.parents.length;t<n;t++)rg(this.parents[t],this)}execute(){try{FM(this);const t=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=nr(),t}finally{zM()}}}const fc=Ii("EffectScheduler",()=>r9);function Od(e,t,n){const r=new fc(e,t,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function o9(e,t,n){const r=new fc(e,t,n);return{scheduler:r,start:o=>{const s=(o==null?void 0:o.force)??!1;r.attach(),s?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class s9{constructor(t){S(this,"initialAtomValues",new Map);this.parent=t}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const t=this.initialAtomValues;this.initialAtomValues=new Map,BM(t.keys())}else this.initialAtomValues.forEach((t,n)=>{this.parent.initialAtomValues.has(n)||this.parent.initialAtomValues.set(n,t)})}abort(){cn.globalEpoch++,this.initialAtomValues.forEach((t,n)=>{var r;n.set(t),(r=n.historyBuffer)==null||r.clear()}),this.commit()}}const cn=Ii("transactions",()=>({globalEpoch:Qi+1,globalIsReacting:!1,currentTransaction:null}));function nr(){return cn.globalEpoch}function BM(e){if(cn.globalIsReacting)throw new Error("cannot change atoms during reaction cycle");try{cn.globalIsReacting=!0;const t=new Set,n=r=>{r.lastTraversedEpoch!==cn.globalEpoch&&(r.lastTraversedEpoch=cn.globalEpoch,r instanceof fc?t.add(r):r.children.visit(n))};for(const r of e)r.children.visit(n);for(const r of t)r.maybeScheduleEffect()}finally{cn.globalIsReacting=!1}}function i9(e,t){cn.currentTransaction?cn.currentTransaction.initialAtomValues.has(e)||cn.currentTransaction.initialAtomValues.set(e,t):BM([e])}function a9(){cn.globalEpoch++}function l9(e){const t=new s9(cn.currentTransaction);cn.currentTransaction=t;try{let n=!1;const r=e(()=>n=!0);return n?t.abort():t.commit(),r}catch(n){throw t.abort(),n}finally{cn.currentTransaction=cn.currentTransaction.parent}}function Xr(e){return cn.currentTransaction?e():l9(e)}class c9{constructor(t,n,r){S(this,"isEqual");S(this,"computeDiff");S(this,"lastChangedEpoch",nr());S(this,"children",new $M);S(this,"historyBuffer");this.name=t,this.current=n,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new LM(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(){return this.current}get(){return AS(this),this.current}set(t,n){var o,s;if(((o=this.isEqual)==null?void 0:o.call(this,this.current,t))??NM(this.current,t))return this.current;a9(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,nr(),n??((s=this.computeDiff)==null?void 0:s.call(this,this.current,t,this.lastChangedEpoch,nr()))??cr),this.lastChangedEpoch=nr();const r=this.current;return this.current=t,i9(this,r),t}update(t){return this.set(t(this.current))}getDiffSince(t){var n;return AS(this),t>=this.lastChangedEpoch?ss:((n=this.historyBuffer)==null?void 0:n.getChangesSince(t))??cr}}const u9=Ii("Atom",()=>c9);function kn(e,t,n){return new u9(e,t,n)}let NP=!1;function d9(){NP||(NP=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const RS=Symbol.for("com.tldraw.state/UNINITIALIZED"),Ml=e=>e===RS,OS=Ii("WithDiff",()=>class{constructor(t,n){this.value=t,this.diff=n}});function pu(e,t){return new OS(e,t)}class h9{constructor(t,n,r){S(this,"lastChangedEpoch",Qi);S(this,"lastTraversedEpoch",Qi);S(this,"lastCheckedEpoch",Qi);S(this,"parents",[]);S(this,"parentEpochs",[]);S(this,"children",new $M);S(this,"historyBuffer");S(this,"state",RS);S(this,"computeDiff");S(this,"isEqual");this.name=t,this.derive=n,r!=null&&r.historyLength&&(this.historyBuffer=new LM(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??NM}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(){var n;const t=this.lastChangedEpoch===Qi;if(!t&&(this.lastCheckedEpoch===nr()||!DM(this)))return this.lastCheckedEpoch=nr(),this.state;try{FM(this);const r=this.derive(this.state,this.lastCheckedEpoch),o=r instanceof OS?r.value:r;if(this.state===RS||!this.isEqual(o,this.state)){if(this.historyBuffer&&!t){const s=r instanceof OS?r.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,nr(),s??((n=this.computeDiff)==null?void 0:n.call(this,this.state,o,this.lastCheckedEpoch,nr()))??cr)}this.lastChangedEpoch=nr(),this.state=o}return this.lastCheckedEpoch=nr(),this.state}finally{zM()}}get(){const t=this.__unsafe__getWithoutCapture();return AS(this),t}getDiffSince(t){var n;return this.get(),t>=this.lastChangedEpoch?ss:((n=this.historyBuffer)==null?void 0:n.getChangesSince(t))??cr}}const Ww=Ii("Computed",()=>h9);function p9(e={},t,n,r){const o=r.value,s=Symbol.for("__@tldraw/state__computed__"+n);return r.value=function(){let i=this[s];return i||(i=new Ww(n,o.bind(this),e),Object.defineProperty(this,s,{enumerable:!1,configurable:!1,writable:!1,value:i})),i.get()},r.value[g9]=!0,r}function $P(e={},t,n,r){return r.get?(d9(),f9(e,t,n,r)):p9(e,t,n,r)}function f9(e={},t,n,r){const o=r.get,s=Symbol.for("__@tldraw/state__computed__"+n);return r.get=function(){let i=this[s];return i||(i=new Ww(n,o.bind(this),e),Object.defineProperty(this,s,{enumerable:!1,configurable:!1,writable:!1,value:i})),i.get()},r}const g9="@@__isComputedMethod__@@";function Z(){if(arguments.length===1){const e=arguments[0];return(t,n,r)=>$P(e,t,n,r)}else return typeof arguments[0]=="string"?new Ww(arguments[0],arguments[1],arguments[2]):$P(void 0,arguments[0],arguments[1],arguments[2])}const UM=1,m9=Ii("apiVersion",()=>UM);if(m9!==UM)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");function mm(e,t){const n=H.useRef(t);n.current=t;const[r,o,s]=H.useMemo(()=>{let i=null;const a=u=>(i=u,()=>{i=null}),l=new fc(`useStateTracking(${e})`,()=>{var u;return(u=n.current)==null?void 0:u.call(n)},{scheduleEffect(){i==null||i()}});return[l,a,()=>l.scheduleCount]},[e]);return H.useSyncExternalStore(o,s,s),H.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const LP={apply(e,t,n){return mm(e.displayName??e.name??"tracked(???)",()=>e.apply(t,n))}},y9=Symbol.for("react.memo"),v9=Symbol.for("react.forward_ref");function Ve(e){let t=null;const n=e.$$typeof;return n===y9&&(e=e.type,t=e.compare),n===v9?b.memo(b.forwardRef(new Proxy(e.render,LP))):b.memo(new Proxy(e,LP),t)}function HM(){const e=arguments[0],t=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return b.useMemo(()=>Z(`useComputed(${e})`,t,n),r)}function aa(e,t,n=ss){b.useEffect(()=>{const r=new fc(e,t);return r.attach(),r.execute(),()=>{r.detach()}},n)}function q(){const e=arguments,t=e.length===3?e[2]:[e[0]],n=e.length===3?e[0]:`useValue(${e[0].name})`,r=b.useRef(!0);r.current=!0;const o=b.useMemo(()=>e.length===1?e[0]:Z(n,()=>{if(r.current)return e[1]();try{return e[1]()}catch{return{}}}),t);try{const{subscribe:s,getSnapshot:i}=b.useMemo(()=>({subscribe:a=>Od(`useValue(${n})`,()=>{o.get(),a()}),getSnapshot:()=>o.get()}),[o]);return b.useSyncExternalStore(s,i,i)}finally{r.current=!1}}class Dp{constructor(t){S(this,"nextValue");S(this,"diff");this.previousValue=t}get(){var r,o,s,i;const t=((o=(r=this.diff)==null?void 0:r.removed)==null?void 0:o.size)??0,n=((i=(s=this.diff)==null?void 0:s.added)==null?void 0:i.size)??0;if(!(t===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(t,n){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(t),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(t):((o=this.diff).added??(o.added=new Set),this.diff.added.add(t))}add(t){var o,s,i;const n=this.previousValue.has(t);if(n)return((s=(o=this.diff)==null?void 0:o.removed)==null?void 0:s.has(t))?this._add(t,n):void 0;(i=this.nextValue)!=null&&i.has(t)||this._add(t,n)}_remove(t,n){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(t),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(t)):(o=this.diff.added)==null||o.delete(t)}remove(t){var o,s,i,a;const n=this.previousValue.has(t);if(!n)return((s=(o=this.diff)==null?void 0:o.added)==null?void 0:s.has(t))?this._remove(t,n):void 0;(a=(i=this.diff)==null?void 0:i.removed)!=null&&a.has(t)||this._remove(t,n)}}function og(e,t){const n=[];e:for(const r of e){for(const o of n)if(t?t(r,o):r===o)continue e;n.push(r)}return n}function pe(e){return e.filter(t=>t!=null)}function Dn(e){return e[e.length-1]}function S9(e,t){let n,r=1/0;for(const o of e){const s=t(o);s<r&&(n=o,r=s)}return n}function x9(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Object.is(e[n],t[n]))return!1;return!0}function VM(e){const t=(...n)=>{try{return e(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,t),r}};return t}function gc(e,t){const n=t&&e&&typeof e=="object"&&t in e?e[t]:e;throw new Error(`Unknown switch case ${n}`)}const la=VM((e,t)=>{if(!e)throw new Error(t||"Assertion Error")}),w9=VM((e,t)=>{if(e==null)throw new Error(t??"value must be defined");return e});function KM(e,t){let n;const r=(...o)=>(n||(n={},n.promise=new Promise((s,i)=>{n.resolve=s,n.reject=i})),clearTimeout(n.timeout),n.latestArgs=o,n.timeout=setTimeout(()=>{const s=n;n=void 0;try{s.resolve(e(...s.latestArgs))}catch(i){s.reject(i)}},t),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const FP=new WeakMap;function Gw(e,t){if(typeof e!="object"||e===null)return;let n=FP.get(e);n||(n={tags:{},extras:{}},FP.set(e,n)),t.tags&&(n.tags={...n.tags,...t.tags}),t.extras&&(n.extras={...n.extras,...t.extras})}class b9{static async base64ToFile(t){return fetch(t).then(function(n){return n.arrayBuffer()})}static async fileToBase64(t){return await new Promise((n,r)=>{if(t){const o=new FileReader;o.readAsDataURL(t),o.onload=()=>n(o.result),o.onerror=s=>r(s),o.onabort=s=>r(s)}})}}function Np(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t+""}let jS=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(jS=new Int32Array(jS));const C9=(e,t)=>{let n=~~t^-1;for(let r=0;r<e.length;r++)n=jS[(n^e[r])&255]^n>>>8;return n^-1},zP=4,BP=4;class Po{static isPng(t,n){return t.getUint8(n+0)===137&&t.getUint8(n+1)===80&&t.getUint8(n+2)===78&&t.getUint8(n+3)===71&&t.getUint8(n+4)===13&&t.getUint8(n+5)===10&&t.getUint8(n+6)===26&&t.getUint8(n+7)===10}static getChunkType(t,n){return[String.fromCharCode(t.getUint8(n)),String.fromCharCode(t.getUint8(n+1)),String.fromCharCode(t.getUint8(n+2)),String.fromCharCode(t.getUint8(n+3))].join("")}static readChunks(t,n=0){const r={};if(!Po.isPng(t,n))throw new Error("Not a PNG");for(n+=8;n<=t.buffer.byteLength;){const o=n,s=t.getInt32(n);n+=4;const i=Po.getChunkType(t,n);if(i==="IDAT"&&r[i]){n+=s+zP+BP;continue}if(i==="IEND")break;r[i]={start:o,dataOffset:n+4,size:s},n+=s+zP+BP}return r}static parsePhys(t,n){return{ppux:t.getUint32(n),ppuy:t.getUint32(n+4),unit:t.getUint8(n+4)}}static findChunk(t,n){return Po.readChunks(t)[n]}static setPhysChunk(t,n=1,r){let o=46,s=0;const i=Po.findChunk(t,"pHYs");i&&(o=i.start,s=i.size);const a=Po.findChunk(t,"IDAT");a&&(o=a.start,s=0);const l=new ArrayBuffer(21),c=new DataView(l);c.setUint32(0,9),c.setUint8(4,112),c.setUint8(5,72),c.setUint8(6,89),c.setUint8(7,115);const u=2835.5;c.setInt32(8,u*n),c.setInt32(12,u*n),c.setInt8(16,1);const d=new Uint8Array(l.slice(4,17));c.setInt32(17,C9(d));const h=t.buffer.slice(0,o),f=t.buffer.slice(o+s);return new Blob([h,l,f],r)}}class UP{static async getVideoSizeFromSrc(t){return await new Promise((n,r)=>{const o=document.createElement("video");o.onloadeddata=()=>n({w:o.videoWidth,h:o.videoHeight}),o.onerror=s=>{console.error(s),r(new Error("Could not get video size"))},o.crossOrigin="anonymous",o.src=t})}static async getImageSizeFromSrc(t){return await new Promise((n,r)=>{const o=new Image;o.onload=async()=>{try{const s=await b9.base64ToFile(t),i=new DataView(s);if(Po.isPng(i,0)){const a=Po.findChunk(i,"pHYs");if(a){const l=Po.parsePhys(i,a.dataOffset);if(l.unit===0&&l.ppux===l.ppuy){const c=Math.max(l.ppux/2834.5,1);n({w:Math.round(o.width/c),h:Math.round(o.height/c)});return}}}n({w:o.width,h:o.height})}catch(s){console.error(s),n({w:o.width,h:o.height})}},o.onerror=s=>{console.error(s),r(new Error("Could not get image size"))},o.crossOrigin="anonymous",o.src=t})}}function ci(e=""){let t=0,n=0,r=0,o=0;function s(){const i=t^t<<11;return t=n,n=r,r=o,o^=(o>>>19^i^i>>>8)>>>0,o/4294967296*2}for(let i=0;i<e.length+64;i++)t^=e.charCodeAt(i)|0,s();return s}function sg(e,t,n,r=!1){const[o,s]=t,[i,a]=n,l=i+(e-o)/(s-o)*(a-i);return r?i<a?Math.max(Math.min(l,a),i):Math.max(Math.min(l,i),a):l}function ym(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ca(e,t){if(ym(e,t))return e[t]}function hn(e){if(!e)return e;if(Array.isArray(e)){const t=[],n=e.length;for(let r=0;r<n;r++)t.push(hn(e[r]));return t}else if(typeof e=="object"){const t=Object.keys(e),n=t.length,r={};for(let o=0;o<n;o++){const s=t[o];r[s]=hn(e[s])}return r}return e}function HP(e){return Object.keys(e)}function St(e){return Object.values(e)}function is(e){return Object.entries(e)}function WM(e){return Object.fromEntries(e)}function Ly(e,t){const n={};let r=!1;for(const[o,s]of is(e))t(o,s)?n[o]=s:r=!0;return r?n:e}function VP(e,t){const n={};for(const[r,o]of is(e)){const s=t(r,o);n[r]=s}return n}function GM(e,t){if(e===t)return!0;const n=new Set(Object.keys(e)),r=new Set(Object.keys(t));if(n.size!==r.size)return!1;for(const o of n)if(!r.has(o)||!Object.is(e[o],t[o]))return!1;return!0}const P9=()=>typeof process<"u"&&!1,ig=[],k9=()=>{const e=ig.splice(0,ig.length);for(const t of e)t()};let Fy;function E9(){Fy||(Fy=requestAnimationFrame(()=>{Fy=void 0,k9()}))}function I9(e){if(P9())return e();ig.includes(e)||(ig.push(e),E9())}function _9(e,t){return e.id>t.id?1:-1}function T9(e){return e!==null}const ui=typeof window<"u"&&window.structuredClone?window.structuredClone:e=>e&&JSON.parse(JSON.stringify(e));let YM=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");class Yw{constructor(t,n){S(this,"createDefaultProperties");S(this,"migrations");S(this,"validator");S(this,"scope");S(this,"isInstance",t=>(t==null?void 0:t.typeName)===this.typeName);this.typeName=t,this.createDefaultProperties=n.createDefaultProperties,this.migrations=n.migrations,this.validator=n.validator??{validate:r=>r},this.scope=n.scope??"document"}create(t){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,o]of Object.entries(t))o!==void 0&&(n[r]=o);return n.typeName=this.typeName,n}clone(t){return{...ui(t),id:this.createId()}}createId(t){return this.typeName+":"+(t??YM())}createCustomId(t){return this.typeName+":"+t}parseId(t){if(!this.isId(t))throw new Error(`ID "${t}" is not a valid ID for type "${this.typeName}"`);return t.slice(this.typeName.length+1)}isId(t){if(!t)return!1;for(let n=0;n<this.typeName.length;n++)if(t[n]!==this.typeName[n])return!1;return t[this.typeName.length]===":"}withDefaultProperties(t){return new Yw(this.typeName,{createDefaultProperties:t,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(t){return this.validator.validate(t)}}function xs(e,t){return new Yw(e,{createDefaultProperties:()=>({}),migrations:t.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}class KP{constructor(){S(this,"items",new WeakMap)}get(t,n){return this.items.has(t)||this.items.set(t,n(t)),this.items.get(t)}}var ag={exports:{}};ag.exports;(function(e,t){var n=200,r="__lodash_hash_undefined__",o=1,s=2,i=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",f="[object Function]",y="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",x="[object Object]",w="[object Promise]",C="[object Proxy]",P="[object RegExp]",k="[object Set]",I="[object String]",_="[object Symbol]",M="[object Undefined]",T="[object WeakMap]",R="[object ArrayBuffer]",j="[object DataView]",$="[object Float32Array]",L="[object Float64Array]",U="[object Int8Array]",F="[object Int16Array]",G="[object Int32Array]",D="[object Uint8Array]",z="[object Uint8ClampedArray]",V="[object Uint16Array]",K="[object Uint32Array]",J=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,te={};te[$]=te[L]=te[U]=te[F]=te[G]=te[D]=te[z]=te[V]=te[K]=!0,te[a]=te[l]=te[R]=te[u]=te[j]=te[d]=te[h]=te[f]=te[g]=te[m]=te[x]=te[P]=te[k]=te[I]=te[T]=!1;var de=typeof Kt=="object"&&Kt&&Kt.Object===Object&&Kt,Te=typeof self=="object"&&self&&self.Object===Object&&self,Oe=de||Te||Function("return this")(),Pe=t&&!t.nodeType&&t,Fe=Pe&&!0&&e&&!e.nodeType&&e,je=Fe&&Fe.exports===Pe,$t=je&&de.process,kt=function(){try{return $t&&$t.binding&&$t.binding("util")}catch{}}(),Lt=kt&&kt.isTypedArray;function mt(A,N){for(var X=-1,re=A==null?0:A.length,tt=0,Se=[];++X<re;){var yt=A[X];N(yt,X,A)&&(Se[tt++]=yt)}return Se}function et(A,N){for(var X=-1,re=N.length,tt=A.length;++X<re;)A[tt+X]=N[X];return A}function $r(A,N){for(var X=-1,re=A==null?0:A.length;++X<re;)if(N(A[X],X,A))return!0;return!1}function Oi(A,N){for(var X=-1,re=Array(A);++X<A;)re[X]=N(X);return re}function Et(A){return function(N){return A(N)}}function ks(A,N){return A.has(N)}function qm(A,N){return A==null?void 0:A[N]}function Qm(A){var N=-1,X=Array(A.size);return A.forEach(function(re,tt){X[++N]=[tt,re]}),X}function Ra(A,N){return function(X){return A(N(X))}}function Zm(A){var N=-1,X=Array(A.size);return A.forEach(function(re){X[++N]=re}),X}var sh=Array.prototype,Tc=Function.prototype,Lr=Object.prototype,Oa=Oe["__core-js_shared__"],Bo=Tc.toString,Gn=Lr.hasOwnProperty,ih=function(){var A=/[^.]+$/.exec(Oa&&Oa.keys&&Oa.keys.IE_PROTO||"");return A?"Symbol(src)_1."+A:""}(),Mc=Lr.toString,ah=RegExp("^"+Bo.call(Gn).replace(J,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lh=je?Oe.Buffer:void 0,Es=Oe.Symbol,Fr=Oe.Uint8Array,ch=Lr.propertyIsEnumerable,ye=sh.splice,Me=Es?Es.toStringTag:void 0,ze=Object.getOwnPropertySymbols,yr=lh?lh.isBuffer:void 0,vr=Ra(Object.keys,Object),Is=ja(Oe,"DataView"),ji=ja(Oe,"Map"),Jm=ja(Oe,"Promise"),ey=ja(Oe,"Set"),ty=ja(Oe,"WeakMap"),Ac=ja(Object,"create"),N4=$i(Is),$4=$i(ji),L4=$i(Jm),F4=$i(ey),z4=$i(ty),R1=Es?Es.prototype:void 0,ny=R1?R1.valueOf:void 0;function Di(A){var N=-1,X=A==null?0:A.length;for(this.clear();++N<X;){var re=A[N];this.set(re[0],re[1])}}function B4(){this.__data__=Ac?Ac(null):{},this.size=0}function U4(A){var N=this.has(A)&&delete this.__data__[A];return this.size-=N?1:0,N}function H4(A){var N=this.__data__;if(Ac){var X=N[A];return X===r?void 0:X}return Gn.call(N,A)?N[A]:void 0}function V4(A){var N=this.__data__;return Ac?N[A]!==void 0:Gn.call(N,A)}function K4(A,N){var X=this.__data__;return this.size+=this.has(A)?0:1,X[A]=Ac&&N===void 0?r:N,this}Di.prototype.clear=B4,Di.prototype.delete=U4,Di.prototype.get=H4,Di.prototype.has=V4,Di.prototype.set=K4;function Uo(A){var N=-1,X=A==null?0:A.length;for(this.clear();++N<X;){var re=A[N];this.set(re[0],re[1])}}function W4(){this.__data__=[],this.size=0}function G4(A){var N=this.__data__,X=dh(N,A);if(X<0)return!1;var re=N.length-1;return X==re?N.pop():ye.call(N,X,1),--this.size,!0}function Y4(A){var N=this.__data__,X=dh(N,A);return X<0?void 0:N[X][1]}function X4(A){return dh(this.__data__,A)>-1}function q4(A,N){var X=this.__data__,re=dh(X,A);return re<0?(++this.size,X.push([A,N])):X[re][1]=N,this}Uo.prototype.clear=W4,Uo.prototype.delete=G4,Uo.prototype.get=Y4,Uo.prototype.has=X4,Uo.prototype.set=q4;function Ni(A){var N=-1,X=A==null?0:A.length;for(this.clear();++N<X;){var re=A[N];this.set(re[0],re[1])}}function Q4(){this.size=0,this.__data__={hash:new Di,map:new(ji||Uo),string:new Di}}function Z4(A){var N=hh(this,A).delete(A);return this.size-=N?1:0,N}function J4(A){return hh(this,A).get(A)}function e5(A){return hh(this,A).has(A)}function t5(A,N){var X=hh(this,A),re=X.size;return X.set(A,N),this.size+=X.size==re?0:1,this}Ni.prototype.clear=Q4,Ni.prototype.delete=Z4,Ni.prototype.get=J4,Ni.prototype.has=e5,Ni.prototype.set=t5;function uh(A){var N=-1,X=A==null?0:A.length;for(this.__data__=new Ni;++N<X;)this.add(A[N])}function n5(A){return this.__data__.set(A,r),this}function r5(A){return this.__data__.has(A)}uh.prototype.add=uh.prototype.push=n5,uh.prototype.has=r5;function _s(A){var N=this.__data__=new Uo(A);this.size=N.size}function o5(){this.__data__=new Uo,this.size=0}function s5(A){var N=this.__data__,X=N.delete(A);return this.size=N.size,X}function i5(A){return this.__data__.get(A)}function a5(A){return this.__data__.has(A)}function l5(A,N){var X=this.__data__;if(X instanceof Uo){var re=X.__data__;if(!ji||re.length<n-1)return re.push([A,N]),this.size=++X.size,this;X=this.__data__=new Ni(re)}return X.set(A,N),this.size=X.size,this}_s.prototype.clear=o5,_s.prototype.delete=s5,_s.prototype.get=i5,_s.prototype.has=a5,_s.prototype.set=l5;function c5(A,N){var X=ph(A),re=!X&&P5(A),tt=!X&&!re&&ry(A),Se=!X&&!re&&!tt&&B1(A),yt=X||re||tt||Se,Tt=yt?Oi(A.length,String):[],Ft=Tt.length;for(var ct in A)Gn.call(A,ct)&&!(yt&&(ct=="length"||tt&&(ct=="offset"||ct=="parent")||Se&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||S5(ct,Ft)))&&Tt.push(ct);return Tt}function dh(A,N){for(var X=A.length;X--;)if($1(A[X][0],N))return X;return-1}function u5(A,N,X){var re=N(A);return ph(A)?re:et(re,X(A))}function Rc(A){return A==null?A===void 0?M:v:Me&&Me in Object(A)?y5(A):C5(A)}function O1(A){return Oc(A)&&Rc(A)==a}function j1(A,N,X,re,tt){return A===N?!0:A==null||N==null||!Oc(A)&&!Oc(N)?A!==A&&N!==N:d5(A,N,X,re,j1,tt)}function d5(A,N,X,re,tt,Se){var yt=ph(A),Tt=ph(N),Ft=yt?l:Ts(A),ct=Tt?l:Ts(N);Ft=Ft==a?x:Ft,ct=ct==a?x:ct;var Yn=Ft==x,zr=ct==x,Qt=Ft==ct;if(Qt&&ry(A)){if(!ry(N))return!1;yt=!0,Yn=!1}if(Qt&&!Yn)return Se||(Se=new _s),yt||B1(A)?D1(A,N,X,re,tt,Se):g5(A,N,Ft,X,re,tt,Se);if(!(X&o)){var Sr=Yn&&Gn.call(A,"__wrapped__"),xr=zr&&Gn.call(N,"__wrapped__");if(Sr||xr){var Ms=Sr?A.value():A,Ho=xr?N.value():N;return Se||(Se=new _s),tt(Ms,Ho,X,re,Se)}}return Qt?(Se||(Se=new _s),m5(A,N,X,re,tt,Se)):!1}function h5(A){if(!z1(A)||w5(A))return!1;var N=L1(A)?ah:ne;return N.test($i(A))}function p5(A){return Oc(A)&&F1(A.length)&&!!te[Rc(A)]}function f5(A){if(!b5(A))return vr(A);var N=[];for(var X in Object(A))Gn.call(A,X)&&X!="constructor"&&N.push(X);return N}function D1(A,N,X,re,tt,Se){var yt=X&o,Tt=A.length,Ft=N.length;if(Tt!=Ft&&!(yt&&Ft>Tt))return!1;var ct=Se.get(A);if(ct&&Se.get(N))return ct==N;var Yn=-1,zr=!0,Qt=X&s?new uh:void 0;for(Se.set(A,N),Se.set(N,A);++Yn<Tt;){var Sr=A[Yn],xr=N[Yn];if(re)var Ms=yt?re(xr,Sr,Yn,N,A,Se):re(Sr,xr,Yn,A,N,Se);if(Ms!==void 0){if(Ms)continue;zr=!1;break}if(Qt){if(!$r(N,function(Ho,Li){if(!ks(Qt,Li)&&(Sr===Ho||tt(Sr,Ho,X,re,Se)))return Qt.push(Li)})){zr=!1;break}}else if(!(Sr===xr||tt(Sr,xr,X,re,Se))){zr=!1;break}}return Se.delete(A),Se.delete(N),zr}function g5(A,N,X,re,tt,Se,yt){switch(X){case j:if(A.byteLength!=N.byteLength||A.byteOffset!=N.byteOffset)return!1;A=A.buffer,N=N.buffer;case R:return!(A.byteLength!=N.byteLength||!Se(new Fr(A),new Fr(N)));case u:case d:case m:return $1(+A,+N);case h:return A.name==N.name&&A.message==N.message;case P:case I:return A==N+"";case g:var Tt=Qm;case k:var Ft=re&o;if(Tt||(Tt=Zm),A.size!=N.size&&!Ft)return!1;var ct=yt.get(A);if(ct)return ct==N;re|=s,yt.set(A,N);var Yn=D1(Tt(A),Tt(N),re,tt,Se,yt);return yt.delete(A),Yn;case _:if(ny)return ny.call(A)==ny.call(N)}return!1}function m5(A,N,X,re,tt,Se){var yt=X&o,Tt=N1(A),Ft=Tt.length,ct=N1(N),Yn=ct.length;if(Ft!=Yn&&!yt)return!1;for(var zr=Ft;zr--;){var Qt=Tt[zr];if(!(yt?Qt in N:Gn.call(N,Qt)))return!1}var Sr=Se.get(A);if(Sr&&Se.get(N))return Sr==N;var xr=!0;Se.set(A,N),Se.set(N,A);for(var Ms=yt;++zr<Ft;){Qt=Tt[zr];var Ho=A[Qt],Li=N[Qt];if(re)var U1=yt?re(Li,Ho,Qt,N,A,Se):re(Ho,Li,Qt,A,N,Se);if(!(U1===void 0?Ho===Li||tt(Ho,Li,X,re,Se):U1)){xr=!1;break}Ms||(Ms=Qt=="constructor")}if(xr&&!Ms){var fh=A.constructor,gh=N.constructor;fh!=gh&&"constructor"in A&&"constructor"in N&&!(typeof fh=="function"&&fh instanceof fh&&typeof gh=="function"&&gh instanceof gh)&&(xr=!1)}return Se.delete(A),Se.delete(N),xr}function N1(A){return u5(A,I5,v5)}function hh(A,N){var X=A.__data__;return x5(N)?X[typeof N=="string"?"string":"hash"]:X.map}function ja(A,N){var X=qm(A,N);return h5(X)?X:void 0}function y5(A){var N=Gn.call(A,Me),X=A[Me];try{A[Me]=void 0;var re=!0}catch{}var tt=Mc.call(A);return re&&(N?A[Me]=X:delete A[Me]),tt}var v5=ze?function(A){return A==null?[]:(A=Object(A),mt(ze(A),function(N){return ch.call(A,N)}))}:_5,Ts=Rc;(Is&&Ts(new Is(new ArrayBuffer(1)))!=j||ji&&Ts(new ji)!=g||Jm&&Ts(Jm.resolve())!=w||ey&&Ts(new ey)!=k||ty&&Ts(new ty)!=T)&&(Ts=function(A){var N=Rc(A),X=N==x?A.constructor:void 0,re=X?$i(X):"";if(re)switch(re){case N4:return j;case $4:return g;case L4:return w;case F4:return k;case z4:return T}return N});function S5(A,N){return N=N??i,!!N&&(typeof A=="number"||me.test(A))&&A>-1&&A%1==0&&A<N}function x5(A){var N=typeof A;return N=="string"||N=="number"||N=="symbol"||N=="boolean"?A!=="__proto__":A===null}function w5(A){return!!ih&&ih in A}function b5(A){var N=A&&A.constructor,X=typeof N=="function"&&N.prototype||Lr;return A===X}function C5(A){return Mc.call(A)}function $i(A){if(A!=null){try{return Bo.call(A)}catch{}try{return A+""}catch{}}return""}function $1(A,N){return A===N||A!==A&&N!==N}var P5=O1(function(){return arguments}())?O1:function(A){return Oc(A)&&Gn.call(A,"callee")&&!ch.call(A,"callee")},ph=Array.isArray;function k5(A){return A!=null&&F1(A.length)&&!L1(A)}var ry=yr||T5;function E5(A,N){return j1(A,N)}function L1(A){if(!z1(A))return!1;var N=Rc(A);return N==f||N==y||N==c||N==C}function F1(A){return typeof A=="number"&&A>-1&&A%1==0&&A<=i}function z1(A){var N=typeof A;return A!=null&&(N=="object"||N=="function")}function Oc(A){return A!=null&&typeof A=="object"}var B1=Lt?Et(Lt):p5;function I5(A){return k5(A)?c5(A):f5(A)}function _5(){return[]}function T5(){return!1}e.exports=E5})(ag,ag.exports);var M9=ag.exports;const A9=xa(M9);function R9(e){if(e.length===0)return new Set;const t=e[0],n=e.slice(1),r=new Set;for(const o of t)n.every(s=>s.has(o))&&r.add(o);return r}function O9(e,t){const n={};for(const r of t)e.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of e)t.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function WP(e,t){for(const[n,r]of Object.entries(e)){const o=r,s=t[n];if("eq"in o&&s!==o.eq||"neq"in o&&s===o.neq||"gt"in o&&(typeof s!="number"||s<=o.gt))return!1}return!0}function GP(e,t,n){const r=Object.fromEntries(Object.keys(n).map(o=>[o,new Set]));for(const[o,s]of Object.entries(n))if("eq"in s){const a=e.index(t,o).get().get(s.eq);if(a)for(const l of a)r[o].add(l)}else if("neq"in s){const i=e.index(t,o);for(const[a,l]of i.get())if(a!==s.neq)for(const c of l)r[o].add(c)}else if("gt"in s){const i=e.index(t,o);for(const[a,l]of i.get())if(a>s.gt)for(const c of l)r[o].add(c)}return R9(Object.values(r))}class j9{constructor(t,n){S(this,"indexCache",new Map);S(this,"historyCache",new Map);this.atoms=t,this.history=n}filterHistory(t){if(this.historyCache.has(t))return this.historyCache.get(t);const n=Z("filterHistory:"+t,(r,o)=>{if(Ml(r))return this.history.get();const s=this.history.getDiffSince(o);if(s===cr)return this.history.get();const i={added:{},removed:{},updated:{}};let a=0,l=0,c=0;for(const u of s){for(const d of St(u.added))if(d.typeName===t)if(i.removed[d.id]){const h=i.removed[d.id];delete i.removed[d.id],l--,h!==d&&(i.updated[d.id]=[h,d],c++)}else i.added[d.id]=d,a++;for(const[d,h]of St(u.updated))h.typeName===t&&(i.added[h.id]?i.added[h.id]=h:i.updated[h.id]?i.updated[h.id]=[i.updated[h.id][0],h]:(i.updated[h.id]=[d,h],c++));for(const d of St(u.removed))d.typeName===t&&(i.added[d.id]?(delete i.added[d.id],a--):i.updated[d.id]?(i.removed[d.id]=i.updated[d.id][0],delete i.updated[d.id],c--,l++):(i.removed[d.id]=d,l++))}return a||l||c?pu(this.history.get(),i):r},{historyLength:100});return this.historyCache.set(t,n),n}index(t,n){const r=t+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const o=this.__uncached_createIndex(t,n);return this.indexCache.set(r,o),o}__uncached_createIndex(t,n){const r=this.filterHistory(t),o=()=>{r.get();const s=new Map;for(const i of St(this.atoms.get())){const a=i.get();if(a.typeName===t){const l=a[n];s.has(l)||s.set(l,new Set),s.get(l).add(a.id)}}return s};return Z("index:"+t+":"+n,(s,i)=>{if(Ml(s))return o();const a=r.getDiffSince(i);if(a===cr)return o();const l=new Map,c=(f,y)=>{let g=l.get(f);g||(g=new Dp(s.get(f)??new Set)),g.add(y),l.set(f,g)},u=(f,y)=>{let g=l.get(f);g||(g=new Dp(s.get(f)??new Set)),g.remove(y),l.set(f,g)};for(const f of a){for(const y of St(f.added))if(y.typeName===t){const g=y[n];c(g,y.id)}for(const[y,g]of St(f.updated))if(g.typeName===t){const m=y[n],v=g[n];m!==v&&(u(m,g.id),c(v,g.id))}for(const y of St(f.removed))if(y.typeName===t){const g=y[n];u(g,y.id)}}let d,h;for(const[f,y]of l){const g=y.get();g&&(d||(d=new Map(s)),h||(h=new Map),g.value.size===0?d.delete(f):d.set(f,g.value),h.set(f,g.diff))}return d&&h?pu(d,h):s},{historyLength:100})}record(t,n=()=>({}),r="record:"+t+(n?":"+n.toString():"")){const o=this.ids(t,n,r);return Z(r,()=>{var s;for(const i of o.get())return(s=this.atoms.get()[i])==null?void 0:s.get()})}records(t,n=()=>({}),r="records:"+t+(n?":"+n.toString():"")){const o=this.ids(t,n,"ids:"+r);return Z(r,()=>[...o.get()].map(s=>{const i=this.atoms.get()[s];if(!i)throw new Error("no atom found for record id: "+s);return i.get()}))}ids(t,n=()=>({}),r="ids:"+t+(n?":"+n.toString():"")){const o=this.filterHistory(t),s=()=>{o.get();const l=n();return Object.keys(l).length===0?new Set(St(this.atoms.get()).flatMap(c=>{const u=c.get();return u.typeName===t?u.id:[]})):GP(this,t,l)},i=l=>{const c=s(),u=O9(l,c);return u?pu(c,u):l},a=Z("ids_query:"+r,n,{isEqual:A9});return Z("query:"+r,(l,c)=>{const u=a.get();if(Ml(l))return s();if(c<a.lastChangedEpoch)return i(l);const d=o.getDiffSince(c);if(d===cr)return i(l);const h=new Dp(l);for(const y of d){for(const g of St(y.added))g.typeName===t&&WP(u,g)&&h.add(g.id);for(const[g,m]of St(y.updated))m.typeName===t&&(WP(u,m)?h.add(m.id):h.remove(m.id));for(const g of St(y.removed))g.typeName===t&&h.remove(g.id)}const f=h.get();return f?pu(f.value,f.diff):l},{historyLength:50})}exec(t,n){const r=GP(this,t,n);if(r.size===0)return ss;const o=this.atoms.get();return[...r].map(s=>o[s].get())}}class XM{constructor(t){S(this,"id",YM());S(this,"atoms",kn("store_atoms",{}));S(this,"history",kn("history",0,{historyLength:1e3}));S(this,"query",new j9(this.atoms,this.history));S(this,"listeners",new Set);S(this,"historyAccumulator",new N9);S(this,"historyReactor");S(this,"schema");S(this,"props");S(this,"scopedTypes");S(this,"onBeforeCreate");S(this,"onAfterCreate");S(this,"onBeforeChange");S(this,"onAfterChange");S(this,"onBeforeDelete");S(this,"onAfterDelete");S(this,"_runCallbacks",!0);S(this,"put",(t,n)=>{Xr(()=>{const r={},o={},s=this.atoms.__unsafe__getWithoutCapture();let i=null,a,l=!1;const c=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,u=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,d=this.isMergingRemoteChanges?"remote":"user";for(let h=0,f=t.length;h<f;h++){a=t[h];const y=(i??s)[a.id];if(y){const g=y.__unsafe__getWithoutCapture();u&&(a=u(g,a,d)),a=this.schema.validateRecord(this,a,n??"updateRecord",g),y.set(a);const m=y.__unsafe__getWithoutCapture();g!==m&&(l=!0,r[a.id]=[g,m])}else c&&(a=c(a,d)),l=!0,a=this.schema.validateRecord(this,a,n??"createRecord",null),o[a.id]=a,i||(i={...s}),i[a.id]=kn("atom:"+a.id,a)}if(i&&this.atoms.set(i),!!l&&(this.updateHistory({added:o,updated:r,removed:{}}),this._runCallbacks)){const{onAfterCreate:h,onAfterChange:f}=this;h&&Object.values(o).forEach(y=>{h(y,d)}),f&&Object.values(r).forEach(([y,g])=>{f(y,g,d)})}})});S(this,"remove",t=>{Xr(()=>{const n=[],r=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(const s of t){const i=this.atoms.__unsafe__getWithoutCapture()[s];i&&this.onBeforeDelete(i.get(),r)===!1&&n.push(s)}let o;if(this.atoms.update(s=>{let i;for(const a of t)n.includes(a)||a in s&&(i||(i={...s}),o||(o={}),delete i[a],o[a]=s[a].get());return i??s}),!!o&&(this.updateHistory({added:{},updated:{},removed:o}),this.onAfterDelete&&this._runCallbacks)){let s;for(let i=0,a=t.length;i<a;i++)s=o[t[i]],s&&this.onAfterDelete(s,r)}})});S(this,"get",t=>{var n;return(n=this.atoms.get()[t])==null?void 0:n.get()});S(this,"unsafeGetWithoutCapture",t=>{var n;return(n=this.atoms.get()[t])==null?void 0:n.__unsafe__getWithoutCapture()});S(this,"serialize",(t="document")=>{const n={};for(const[r,o]of is(this.atoms.get())){const s=o.get();(t==="all"||this.scopedTypes[t].has(s.typeName))&&(n[r]=s)}return n});S(this,"allRecords",()=>St(this.atoms.get()).map(t=>t.get()));S(this,"clear",()=>{this.remove(HP(this.atoms.get()))});S(this,"update",(t,n)=>{const r=this.atoms.get()[t];if(!r){console.error(`Record ${t} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])});S(this,"has",t=>!!this.atoms.get()[t]);S(this,"listen",(t,n)=>{this._flushHistory();const r={onHistory:t,filters:{source:(n==null?void 0:n.source)??"all",scope:(n==null?void 0:n.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});S(this,"isMergingRemoteChanges",!1);S(this,"mergeRemoteChanges",t=>{if(this.isMergingRemoteChanges)return t();try{this.isMergingRemoteChanges=!0,Xr(t)}finally{this.isMergingRemoteChanges=!1}});S(this,"createComputedCache",(t,n,r)=>{const o=new KP;return{get:s=>{const i=this.atoms.get()[s];if(i)return o.get(i,()=>{const a=r?Z(i.name+":equals",()=>i.get(),{isEqual:r}):i;return Z(t+":"+s,()=>n(a.get()))}).get()}}});S(this,"createSelectedComputedCache",(t,n,r)=>{const o=new KP;return{get:s=>{const i=this.atoms.get()[s];if(!i)return;const a=Z(t+":"+s+":selector",()=>n(i.get()));return o.get(i,()=>Z(t+":"+s,()=>r(a.get()))).get()}}});S(this,"getRecordType",t=>{const n=this.schema.types[t.typeName];if(!n)throw new Error(`Record type ${t.typeName} not found`);return n});S(this,"_integrityChecker");S(this,"_isPossiblyCorrupted",!1);const{initialData:n,schema:r}=t;this.schema=r,this.props=t.props,n&&this.atoms.set(WM(is(n).map(([o,s])=>[o,kn("atom:"+o,this.schema.validateRecord(this,s,"initialize",null))]))),this.historyReactor=o9("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:o=>I9(o)}),this.scopedTypes={document:new Set(St(this.schema.types).filter(o=>o.scope==="document").map(o=>o.typeName)),session:new Set(St(this.schema.types).filter(o=>o.scope==="session").map(o=>o.typeName)),presence:new Set(St(this.schema.types).filter(o=>o.scope==="presence").map(o=>o.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const t=this.historyAccumulator.flush();for(const{changes:n,source:r}of t){let o=null,s=null,i=null;for(const{onHistory:a,filters:l}of this.listeners)if(!(l.source!=="all"&&l.source!==r))if(l.scope!=="all")if(l.scope==="document"){if(s??(s=this.filterChangesByScope(n,"document")),!s)continue;a({changes:s,source:r})}else if(l.scope==="session"){if(o??(o=this.filterChangesByScope(n,"session")),!o)continue;a({changes:o,source:r})}else{if(i??(i=this.filterChangesByScope(n,"presence")),!i)continue;a({changes:i,source:r})}else a({changes:n,source:r})}}}filterChangesByScope(t,n){const r={added:Ly(t.added,(o,s)=>this.scopedTypes[n].has(s.typeName)),updated:Ly(t.updated,(o,s)=>this.scopedTypes[n].has(s[1].typeName)),removed:Ly(t.removed,(o,s)=>this.scopedTypes[n].has(s.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(t){this.historyAccumulator.add({changes:t,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,t)}validate(t){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,t,null))}getSnapshot(t="document"){return{store:this.serialize(t),schema:this.schema.serialize()}}migrateSnapshot(t){const n=this.schema.migrateStoreSnapshot(t);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);return{store:n.value,schema:this.schema.serialize()}}loadSnapshot(t){const n=this.schema.migrateStoreSnapshot(t);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);Xr(()=>{this.clear(),this.put(Object.values(n.value)),this.ensureStoreIsUsable()})}extractingChanges(t){const n=[],r=this.historyAccumulator.intercepting(o=>n.push(o.changes));try{return Xr(t),vm(n)}finally{r()}}applyDiff(t,n=!0){const r=this._runCallbacks;try{this._runCallbacks=n,Xr(()=>{const o=St(t.added).concat(St(t.updated).map(([i,a])=>a)),s=HP(t.removed);o.length&&this.put(o),s.length&&this.remove(s)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var t;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(t=this._integrityChecker)==null||t.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function vm(e){const t={added:{},removed:{},updated:{}};for(const n of e){for(const[r,o]of is(n.added))if(t.removed[r]){const s=t.removed[r];delete t.removed[r],s!==o&&(t.updated[r]=[s,o])}else t.added[r]=o;for(const[r,[o,s]]of is(n.updated)){if(t.added[r]){t.added[r]=s,delete t.updated[r],delete t.removed[r];continue}if(t.updated[r]){t.updated[r]=[t.updated[r][0],s],delete t.removed[r];continue}t.updated[r]=n.updated[r],delete t.removed[r]}for(const[r,o]of is(n.removed))t.added[r]?delete t.added[r]:t.updated[r]?(t.removed[r]=t.updated[r][0],delete t.updated[r]):t.removed[r]=o}return t}function D9(e){const t=[];let n=e[0],r;for(let o=1,s=e.length;o<s;o++)r=e[o],n.source!==r.source?(t.push(n),n=r):n={source:n.source,changes:vm([n.changes,r.changes])};return t.push(n),t}class N9{constructor(){S(this,"_history",[]);S(this,"_interceptors",new Set)}intercepting(t){return this._interceptors.add(t),()=>{this._interceptors.delete(t)}}add(t){this._history.push(t);for(const n of this._interceptors)n(t)}flush(){const t=D9(this._history);return this._history=[],t}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function $9(e){return typeof e=="object"&&e!==null&&"id"in e&&"typeName"in e}function Le(e){const{currentVersion:t,firstVersion:n,migrators:r={},subTypeKey:o,subTypeMigrations:s}=e;if(typeof t=="number"&&typeof n=="number"){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:n??0,currentVersion:t??0,migrators:r,subTypeKey:o,subTypeMigrations:s}}var fu=(e=>(e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e))(fu||{});function Fh({record:e,migrations:t,fromVersion:n,toVersion:r}){let o=n;if(!$9(e))throw new Error("[migrateRecord] object is not a record");const{typeName:s,id:i,...a}=e;let l=a;for(;o<r;){const c=o+1,u=t.migrators[c];if(!u)return{type:"error",reason:"target-version-too-new"};l=u.up(l),o=c}for(;o>r;){const c=o-1,u=t.migrators[o];if(!u)return{type:"error",reason:"target-version-too-old"};l=u.down(l),o=c}return{type:"success",value:{...l,id:i,typeName:s}}}function Xw({value:e,migrations:t,fromVersion:n,toVersion:r}){let o=n;for(;o<r;){const s=o+1,i=t.migrators[s];if(!i)return{type:"error",reason:"target-version-too-new"};e=i.up(e),o=s}for(;o>r;){const s=o-1,i=t.migrators[o];if(!i)return{type:"error",reason:"target-version-too-old"};e=i.down(e),o=s}return{type:"success",value:e}}class qw{constructor(t,n){this.types=t,this.options=n}static create(t,n){return new qw(t,n??{})}get currentStoreVersion(){var t;return((t=this.options.snapshotMigrations)==null?void 0:t.currentVersion)??0}validateRecord(t,n,r,o){try{const s=ca(this.types,n.typeName);if(!s)throw new Error(`Missing definition for record type ${n.typeName}`);return s.validate(n)}catch(s){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:t,record:n,phase:r,recordBefore:o,error:s});throw s}}migratePersistedRecord(t,n,r="up"){var d;const o=ca(this.types,t.typeName),s=n.recordVersions[t.typeName];if(!s||!o)return{type:"error",reason:fu.UnknownType};const i=o.migrations.currentVersion,a=s.version;if(i!==a){const h=Fh(r==="up"?{record:t,migrations:o.migrations,fromVersion:a,toVersion:i}:{record:t,migrations:o.migrations,fromVersion:i,toVersion:a});if(h.type==="error")return h;t=h.value}if(!o.migrations.subTypeKey)return{type:"success",value:t};const l=(d=o.migrations.subTypeMigrations)==null?void 0:d[t[o.migrations.subTypeKey]],c="subTypeVersions"in s?s.subTypeVersions[t[o.migrations.subTypeKey]]:void 0;if(l===void 0)return{type:"error",reason:fu.UnrecognizedSubtype};if(c===void 0)return{type:"error",reason:fu.IncompatibleSubtype};const u=Fh(r==="up"?{record:t,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:t,migrations:l,fromVersion:l.currentVersion,toVersion:c});return u.type==="error"?u:{type:"success",value:u.value}}migrateStoreSnapshot(t){let{store:n}=t;const r=this.options.snapshotMigrations;if(!r)return{type:"success",value:n};const o=r.currentVersion,s=t.schema.storeVersion??0;if(o<s)return{type:"error",reason:fu.TargetVersionTooOld};if(o>s){const a=Xw({value:n,migrations:r,fromVersion:s,toVersion:o});if(a.type==="error")return a;n=a.value}const i=[];for(const a of St(n)){const l=this.migratePersistedRecord(a,t.schema);if(l.type==="error")return l;l.value&&l.value!==a&&i.push(l.value)}if(i.length){n={...n};for(const a of i)n[a.id]=a}return{type:"success",value:n}}createIntegrityChecker(t){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,t))??void 0}serialize(){var t;return{schemaVersion:1,storeVersion:((t=this.options.snapshotMigrations)==null?void 0:t.currentVersion)??0,recordVersions:Object.fromEntries(St(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.currentVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,o])=>[r,o.currentVersion])):void 0}:{version:n.migrations.currentVersion}]))}}serializeEarliestVersion(){var t;return{schemaVersion:1,storeVersion:((t=this.options.snapshotMigrations)==null?void 0:t.firstVersion)??0,recordVersions:Object.fromEntries(St(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.firstVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,o])=>[r,o.firstVersion])):void 0}:{version:n.migrations.firstVersion}]))}}}const L9=(e,t)=>{if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return-1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return-1;for(const n of Object.keys(e.recordVersions)){const r=e.recordVersions[n],o=t.recordVersions[n];if(r.version>o.version)return 1;if(r.version<o.version)return-1;if("subTypeVersions"in r&&!("subTypeVersions"in o))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in o)return-1;if(!(!("subTypeVersions"in r)||!("subTypeVersions"in o)))for(const s of Object.keys(r.subTypeVersions)){const i=r.subTypeVersions[s],a=o.subTypeVersions[s];if(i>a)return 1;if(i<a)return-1}}return 0};function F9(e){if(!e.length)return null;let t="";for(const n of e)typeof n=="number"?t+=`.${n}`:n.startsWith("(")?t.endsWith(")")?t=`${t.slice(0,-1)}, ${n.slice(1)}`:t+=n:t+=`.${n}`;return t.startsWith(".")?t.slice(1):t}class Xe extends Error{constructor(n,r=[]){const o=F9(r),s=n.split(`
`).map((i,a)=>a===0?i:`  ${i}`).join(`
`);super(r?`At ${o}: ${s}`:s);S(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function mc(e,t){try{return t()}catch(n){throw n instanceof Xe?new Xe(n.rawMessage,[e,...n.path]):new Xe(n.toString(),[e])}}function Jl(e){if(e===null)return"null";if(Array.isArray(e))return"an array";const t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${t}`;case"object":return`an ${t}`;case"undefined":return"undefined";default:gc(t)}}class Mn{constructor(t){this.validationFn=t}validate(t){return this.validationFn(t)}isValid(t){try{return this.validate(t),!0}catch{return!1}}nullable(){return K9(this)}optional(){return QM(this)}refine(t){return new Mn(n=>t(this.validate(n)))}check(t,n){return typeof t=="string"?this.refine(r=>(mc(`(check ${t})`,()=>n(r)),r)):this.refine(r=>(t(r),r))}}class z9 extends Mn{constructor(t){super(n=>{const r=V9.validate(n);for(let o=0;o<r.length;o++)mc(o,()=>t.validate(r[o]));return r}),this.itemValidator=t}nonEmpty(){return this.check(t=>{if(t.length===0)throw new Xe("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(t=>{if(t.length<=1)throw new Xe("Expected an array with length greater than 1")})}}class lg extends Mn{constructor(t,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new Xe(`Expected object, got ${Jl(r)}`);for(const[o,s]of Object.entries(t))mc(o,()=>{s.validate(ca(r,o))});if(!n){for(const o of Object.keys(r))if(!ym(t,o))throw new Xe("Unexpected property",[o])}return r}),this.config=t,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new lg(this.config,!0)}extend(t){return new lg({...this.config,...t})}}class Qw extends Mn{constructor(t,n,r){super(o=>{if(typeof o!="object"||o===null)throw new Xe(`Expected an object, got ${Jl(o)}`,[]);const s=ca(o,t);if(typeof s!="string")throw new Xe(`Expected a string for key "${t}", got ${Jl(s)}`);const i=ym(n,s)?n[s]:void 0;return i===void 0?this.unknownValueValidation(o,s):mc(`(${t} = ${s})`,()=>i.validate(o))}),this.key=t,this.config=n,this.unknownValueValidation=r}validateUnknownVariants(t){return new Qw(this.key,this.config,t)}}class B9 extends Mn{constructor(t,n){super(r=>{if(typeof r!="object"||r===null)throw new Xe(`Expected object, got ${Jl(r)}`);for(const[o,s]of Object.entries(r))mc(o,()=>{t.validate(o),n.validate(s)});return r}),this.keyValidator=t,this.valueValidator=n}}function Zw(e){return new Mn(t=>{if(typeof t!==e)throw new Xe(`Expected ${e}, got ${Jl(t)}`);return t})}const U9=new Mn(e=>e),ve=Zw("string"),ge=Zw("number").check(e=>{if(Number.isNaN(e))throw new Xe("Expected a number, got NaN");if(!Number.isFinite(e))throw new Xe(`Expected a finite number, got ${e}`)}),Jw=ge.check(e=>{if(e<0)throw new Xe(`Expected a positive number, got ${e}`)}),Vn=ge.check(e=>{if(e<=0)throw new Xe(`Expected a non-zero positive number, got ${e}`)}),qM=ge.check(e=>{if(!Number.isInteger(e))throw new Xe(`Expected an integer, got ${e}`)}),zh=qM.check(e=>{if(e<0)throw new Xe(`Expected a positive integer, got ${e}`)}),H9=qM.check(e=>{if(e<=0)throw new Xe(`Expected a non-zero positive integer, got ${e}`)}),Ee=Zw("boolean");function Kn(e){return new Mn(t=>{if(t!==e)throw new Xe(`Expected ${e}, got ${JSON.stringify(t)}`);return e})}const V9=new Mn(e=>{if(!Array.isArray(e))throw new Xe(`Expected an array, got ${Jl(e)}`);return e});function In(e){return new z9(e)}function _e(e){return new lg(e)}function DS(e){return e===null||typeof e=="number"||typeof e=="string"||typeof e=="boolean"?!0:Array.isArray(e)?e.every(DS):typeof e=="object"?Object.values(e).every(DS):!1}const Ao=new Mn(e=>{if(DS(e))return e;throw new Xe(`Expected json serializable value, got ${typeof e}`)});function NS(e,t){return new B9(e,t)}function eb(e,t){return new Qw(e,t,(n,r)=>{throw new Xe(`Expected one of ${Object.keys(t).map(o=>JSON.stringify(o)).join(" or ")}, got ${JSON.stringify(r)}`,[e])})}function ws(e,t){return new Mn(n=>{const r=n&&typeof n=="object"&&"id"in n&&typeof n.id=="string"?`${e}(id = ${n.id})`:e;return mc(r,()=>t.validate(n))})}function jd(e){return new Mn(t=>{if(!e.has(t)){const n=Array.from(e,r=>JSON.stringify(r)).join(" or ");throw new Xe(`Expected ${n}, got ${t}`)}return t})}function QM(e){return new Mn(t=>{if(t!==void 0)return e.validate(t)})}function K9(e){return new Mn(t=>t===null?null:e.validate(t))}function ZM(...e){return jd(new Set(e))}function JM(e){try{return new URL(e)}catch{throw new Xe(`Expected a valid url, got ${JSON.stringify(e)}`)}}const W9=new Set(["http:","https:","mailto:"]),hr=ve.check(e=>{if(e==="")return;const t=JM(e);if(!W9.has(t.protocol.toLowerCase()))throw new Xe(`Expected a valid url, got ${JSON.stringify(e)} (invalid protocol)`)}),G9=new Set(["http:","https:","data:"]),yc=ve.check(e=>{if(e==="")return;const t=JM(e);if(!G9.has(t.protocol.toLowerCase()))throw new Xe(`Expected a valid url, got ${JSON.stringify(e)} (invalid protocol)`)});function ro(e){return ve.refine(t=>{if(!t.startsWith(`${e}:`))throw new Error(`${e} ID must start with "${e}:"`);return t})}const Sm=ro("asset");function tb(e,t){return _e({id:Sm,typeName:Kn("asset"),type:Kn(e),props:t,meta:Ao})}const Y9=ws("camera",_e({typeName:Kn("camera"),id:ro("camera"),x:ge,y:ge,z:ge,meta:Ao})),YP={AddMeta:1},X9=Le({currentVersion:YP.AddMeta,migrators:{[YP.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),on=xs("camera",{validator:Y9,migrations:X9,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),od=_e({x:ge,y:ge,z:ge.optional()}),_u=_e({x:ge,y:ge,w:ge,h:ge}),q9=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),eA=jd(q9),Q9=_e({type:eA,rotation:ge}),tA=ge.check(e=>{if(e<0||e>1)throw new Xe("Opacity must be between 0 and 1")}),Z9=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),J9=jd(Z9),e7=new Set(["starting","paused","active","stopping"]),nA=_e({id:ve,points:In(od),size:Jw,color:J9,opacity:ge,state:jd(e7),delay:ge,shrink:ge,taper:Ee}),sd=ro("page"),t7=ws("page",_e({typeName:Kn("page"),id:sd,name:ve,index:ve,meta:Ao})),XP={AddMeta:1},n7=Le({currentVersion:XP.AddMeta,migrators:{[XP.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),ms=xs("page",{validator:t7,migrations:n7,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function jn(e){return ms.isId(e)}ro("instance");function r7(e){const t={};for(const[r,o]of e)t[r]=QM(o);const n=ws("instance",_e({typeName:Kn("instance"),id:ro("instance"),currentPageId:sd,followingUserId:ve.nullable(),brush:_u.nullable(),opacityForNextShape:tA,stylesForNextShape:_e(t),cursor:Q9,scribbles:In(nA),isFocusMode:Ee,isDebugMode:Ee,isToolLocked:Ee,exportBackground:Ee,screenBounds:_u,zoomBrush:_u.nullable(),isPenMode:Ee,isGridMode:Ee,chatMessage:ve,isChatting:Ee,highlightedUserIds:In(ve),canMoveCamera:Ee,isFocused:Ee,devicePixelRatio:ge,isCoarsePointer:Ee,isHoveringCanvas:Ee.nullable(),openMenus:In(ve),isChangingStyle:Ee,isReadonly:Ee,meta:Ao}));return xs("instance",{migrations:o7,validator:n,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{}}))}const ut={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22},o7=Le({currentVersion:ut.AddScribbles,migrators:{[ut.AddTransparentExportBgs]:{up:e=>({...e,exportBackground:!0}),down:({exportBackground:e,...t})=>t},[ut.RemoveDialog]:{up:({dialog:e,...t})=>t,down:e=>({...e,dialog:null})},[ut.AddToolLockMode]:{up:e=>({...e,isToolLocked:!1}),down:({isToolLocked:e,...t})=>t},[ut.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:Object.fromEntries(Object.entries(e).filter(([n])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(n)))}),down:e=>e},[ut.AddLabelColor]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:{...e,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:{...n}}}},[ut.AddFollowingUserId]:{up:e=>({...e,followingUserId:null}),down:({followingUserId:e,...t})=>t},[ut.RemoveAlignJustify]:{up:e=>{let t=e.propsForNextShape.align;return t==="justify"&&(t="start"),{...e,propsForNextShape:{...e.propsForNextShape,align:t}}},down:e=>({...e})},[ut.AddZoom]:{up:e=>({...e,zoomBrush:null}),down:({zoomBrush:e,...t})=>t},[ut.AddVerticalAlign]:{up:e=>({...e,propsForNextShape:{...e.propsForNextShape,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:n}}},[ut.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[ut.RemoveUserId]:{up:({userId:e,...t})=>t,down:e=>({...e,userId:"user:none"})},[ut.AddIsPenModeAndIsGridMode]:{up:e=>({...e,isPenMode:!1,isGridMode:!1}),down:({isPenMode:e,isGridMode:t,...n})=>n},[ut.HoistOpacity]:{up:({propsForNextShape:{opacity:e,...t},...n})=>({...n,opacityForNextShape:Number(e??"1"),propsForNextShape:t}),down:({opacityForNextShape:e,...t})=>({...t,propsForNextShape:{...t.propsForNextShape,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},[ut.AddChat]:{up:e=>({...e,chatMessage:"",isChatting:!1}),down:({chatMessage:e,isChatting:t,...n})=>n},[ut.AddHighlightedUserIds]:{up:e=>({...e,highlightedUserIds:[]}),down:({highlightedUserIds:e,...t})=>t},[ut.ReplacePropsForNextShapeWithStylesForNextShape]:{up:({propsForNextShape:e,...t})=>({...t,stylesForNextShape:{}}),down:({stylesForNextShape:e,...t})=>({...t,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})},[ut.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},[ut.RemoveCursorColor]:{up:e=>{const{color:t,...n}=e.cursor;return{...e,cursor:n}},down:e=>({...e,cursor:{...e.cursor,color:"black"}})},[ut.AddLonelyProperties]:{up:e=>({...e,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1}),down:({canMoveCamera:e,isFocused:t,devicePixelRatio:n,isCoarsePointer:r,openMenus:o,isChangingStyle:s,isReadOnly:i,...a})=>({...a})},[ut.ReadOnlyReadonly]:{up:({isReadOnly:e,...t})=>({...t,isReadonly:e}),down:({isReadonly:e,...t})=>({...t,isReadOnly:e})},[ut.AddHoveringCanvas]:{up:e=>({...e,isHoveringCanvas:null}),down:({isHoveringCanvas:e,...t})=>({...t})},[ut.AddScribbles]:{up:({scribble:e,...t})=>({...t,scribbles:[]}),down:({scribbles:e,...t})=>({...t,scribble:null})}}}),Pn="instance:instance",s7=ve.refine(e=>{if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e}),Wr=ro("shape");function i7(e,t,n){return _e({id:Wr,typeName:Kn("shape"),x:ge,y:ge,rotation:ge,index:ve,parentId:s7,type:Kn(e),isLocked:Ee,opacity:tA,props:t?_e(t):Ao,meta:n?_e(n):Ao})}const a7=ws("instance_page_state",_e({typeName:Kn("instance_page_state"),id:ro("instance_page_state"),pageId:sd,selectedShapeIds:In(Wr),hintingShapeIds:In(Wr),erasingShapeIds:In(Wr),hoveredShapeId:Wr.nullable(),editingShapeId:Wr.nullable(),croppingShapeId:Wr.nullable(),focusedGroupId:Wr.nullable(),meta:Ao})),Na={AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5},l7=Le({currentVersion:Na.RenamePropertiesAgain,migrators:{[Na.AddCroppingId]:{up(e){return{...e,croppingShapeId:null}},down({croppingShapeId:e,...t}){return t}},[Na.RemoveInstanceIdAndCameraId]:{up({instanceId:e,cameraId:t,...n}){return n},down(e){return{...e,instanceId:Pn,cameraId:on.createId("void")}}},[Na.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},[Na.RenameProperties]:{up:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i,focusedGroupId:a,...l}=e;return{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i,focusedGroupId:a,...l}},down:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i,focusedGroupId:a,...l}=e;return{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i,focusedGroupId:a,...l}}},[Na.RenamePropertiesAgain]:{up:e=>{const{selectedIds:t,hintingIds:n,erasingIds:r,hoveredId:o,editingId:s,croppingShapeId:i,croppingId:a,focusLayerId:l,...c}=e;return{...c,selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i??a??null,focusedGroupId:l}},down:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:s,croppingShapeId:i,focusedGroupId:a,...l}=e;return{...l,selectedIds:t,hintingIds:n,erasingIds:r,hoveredId:o,editingId:s,croppingId:i,focusLayerId:a}}}}}),sn=xs("instance_page_state",{migrations:l7,validator:a7,scope:"session"}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),c7=ws("pointer",_e({typeName:Kn("pointer"),id:ro("pointer"),x:ge,y:ge,lastActivityTimestamp:ge,meta:Ao})),qP={AddMeta:1},u7=Le({currentVersion:qP.AddMeta,migrators:{[qP.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),nb=xs("pointer",{validator:c7,migrations:u7,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),cg=nb.createId("pointer"),d7=ws("instance_presence",_e({typeName:Kn("instance_presence"),id:ro("instance_presence"),userId:ve,userName:ve,lastActivityTimestamp:ge,followingUserId:ve.nullable(),cursor:_e({x:ge,y:ge,type:eA,rotation:ge}),color:ve,camera:_e({x:ge,y:ge,z:ge}),screenBounds:_u,selectedShapeIds:In(ro("shape")),currentPageId:ro("page"),brush:_u.nullable(),scribbles:In(nA),chatMessage:ve,meta:Ao})),$a={AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5},h7=Le({currentVersion:$a.RenameSelectedShapeIds,migrators:{[$a.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[$a.RemoveInstanceId]:{up:({instanceId:e,...t})=>t,down:e=>({...e,instanceId:Pn})},[$a.AddChatMessage]:{up:e=>({...e,chatMessage:""}),down:({chatMessage:e,...t})=>t},[$a.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},[$a.RenameSelectedShapeIds]:{up:e=>{const{selectedShapeIds:t,...n}=e;return{selectedShapeIds:t,...n}},down:e=>{const{selectedShapeIds:t,...n}=e;return{selectedShapeIds:t,...n}}}}}),p7=xs("instance_presence",{migrations:h7,validator:d7,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),f7=ws("document",_e({typeName:Kn("document"),id:Kn("document:document"),gridSize:ge,name:ve,meta:Ao})),zy={AddName:1,AddMeta:2},g7=Le({currentVersion:zy.AddMeta,migrators:{[zy.AddName]:{up:e=>({...e,name:""}),down:({name:e,...t})=>t},[zy.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),rb=xs("document",{migrations:g7,validator:f7,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),$S=rb.createId("document");function m7(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function QP(e){e.typeName==="asset"&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}const y7=({error:e,phase:t,record:n,recordBefore:r})=>{throw Gw(e,{tags:{origin:"store.validateRecord",storePhase:t,isExistingValidationIssue:t==="initialize"},extras:{recordBefore:r?QP(ui(r)):void 0,recordAfter:QP(ui(n))}}),e};function v7(){return[ms.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function S7(e){const t=e.query.ids("page"),n=()=>{if(!e.has($S))return e.put([rb.create({id:$S,name:e.props.defaultName})]),n();if(!e.has(cg))return e.put([nb.create({id:cg})]),n();const r=t.get();if(r.size===0)return e.put(v7()),n();const o=()=>[...r].map(l=>e.get(l)).sort(m7)[0].id,s=e.get(Pn);if(s){if(!r.has(s.currentPageId))return e.put([{...s,currentPageId:o()}]),n()}else return e.put([e.schema.types.instance.create({id:Pn,currentPageId:o(),exportBackground:!0})]),n();const i=new Set,a=new Set;for(const l of r){const c=sn.createId(l);e.has(c)||i.add(c);const u=on.createId(l);e.has(u)||a.add(u)}i.size>0&&e.put([...i].map(l=>sn.create({id:l,pageId:sn.parseId(l)}))),a.size>0&&e.put([...a].map(l=>on.create({id:l})))};return n}const x7=tb("bookmark",_e({title:ve,description:ve,image:ve,src:yc.nullable()})),ZP={MakeUrlsValid:1},w7=Le({currentVersion:ZP.MakeUrlsValid,migrators:{[ZP.MakeUrlsValid]:{up:e=>{const t=e.props.src;return t&&!yc.isValid(t)?{...e,props:{...e.props,src:""}}:e},down:e=>e}}}),b7=tb("image",_e({w:ge,h:ge,name:ve,isAnimated:Ee,mimeType:ve.nullable(),src:yc.nullable()})),Bh={AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3},C7=Le({currentVersion:Bh.MakeUrlsValid,migrators:{[Bh.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},[Bh.RenameWidthHeight]:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}},[Bh.MakeUrlsValid]:{up:e=>{const t=e.props.src;return t&&!yc.isValid(t)?{...e,props:{...e.props,src:""}}:e},down:e=>e}}}),P7=tb("video",_e({w:ge,h:ge,name:ve,isAnimated:Ee,mimeType:ve.nullable(),src:yc.nullable()})),Uh={AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3},k7=Le({currentVersion:Uh.MakeUrlsValid,migrators:{[Uh.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},[Uh.RenameWidthHeight]:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}},[Uh.MakeUrlsValid]:{up:e=>{const t=e.props.src;return t&&!yc.isValid(t)?{...e,props:{...e.props,src:""}}:e},down:e=>e}}}),E7=ws("asset",eb("type",{image:b7,video:P7,bookmark:x7})),JP={AddMeta:1},I7=Le({subTypeKey:"type",subTypeMigrations:{image:C7,video:k7,bookmark:w7},currentVersion:JP.AddMeta,migrators:{[JP.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),Zi=xs("asset",{migrations:I7,validator:E7,scope:"document"}).withDefaultProperties(()=>({meta:{}}));let _7=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");class gn{constructor(t,n,r){this.id=t,this.defaultValue=n,this.type=r}static define(t,n){const{defaultValue:r,type:o=U9}=n;return new gn(t,r,o)}static defineEnum(t,n){const{defaultValue:r,values:o}=n;return new T7(t,r,o)}validate(t){return this.type.validate(t)}}class T7 extends gn{constructor(t,n,r){super(t,n,ZM(...r)),this.values=r}}const Hh={AddIsLocked:1,HoistOpacity:2,AddMeta:3},By=Le({currentVersion:Hh.AddMeta,migrators:{[Hh.AddIsLocked]:{up:e=>({...e,isLocked:!1}),down:e=>{const{isLocked:t,...n}=e;return{...n}}},[Hh.HoistOpacity]:{up:({props:{opacity:e,...t},...n})=>({...n,opacity:Number(e??"1"),props:t}),down:({opacity:e,...t})=>({...t,props:{...t.props,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},[Hh.AddMeta]:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}});function Ji(e){return e?e.typeName==="shape":!1}function Pr(e){return e?e.startsWith("shape:"):!1}function Je(e){return`shape:${e??_7()}`}function rA(e){const t=new Map;for(const[n,r]of Object.entries(e))if(r instanceof gn){if(t.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);t.set(r,n)}return t}function M7(e){return xs("shape",{migrations:Le({currentVersion:By.currentVersion,firstVersion:By.firstVersion,migrators:By.migrators,subTypeKey:"type",subTypeMigrations:VP(e,(t,n)=>n.migrations??Le({}))}),scope:"document",validator:ws("shape",eb("type",VP(e,(t,{props:n,meta:r})=>i7(t,n,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}const Vc={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},A7=Le({currentVersion:Vc.RemoveUserDocument,migrators:{[Vc.RemoveCodeAndIconShapeTypes]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="shape"||n.type!=="icon"&&n.type!=="code")),down:e=>e},[Vc.AddInstancePresenceType]:{up:e=>e,down:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="instance_presence"))},[Vc.RemoveTLUserAndPresenceAndAddPointer]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>!n.typeName.match(/^(user|user_presence)$/))),down:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="pointer"))},[Vc.RemoveUserDocument]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>!n.typeName.match("user_document"))),down:e=>e}}});function R7({shapes:e}){const t=new Map;for(const o of St(e))for(const s of rA(o.props??{}).keys()){if(t.has(s.id)&&t.get(s.id)!==s)throw new Error(`Multiple StyleProp instances with the same id: ${s.id}`);t.set(s.id,s)}const n=M7(e),r=r7(t);return qw.create({asset:Zi,camera:on,document:rb,instance:r,instance_page_state:sn,page:ms,shape:n,instance_presence:p7,pointer:nb},{snapshotMigrations:A7,onValidationFailure:y7,createIntegrityChecker:S7})}const oA=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],ug={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{id:"dark",text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function Wn(e){return e.isDarkMode?ug.darkMode:ug.lightMode}const jr=gn.defineEnum("tldraw:color",{defaultValue:"black",values:oA}),sA=gn.defineEnum("tldraw:labelColor",{defaultValue:"black",values:oA}),ma=gn.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),ec=gn.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),Ro=gn.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),Dd={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},Oo=gn.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),iA=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],dg=gn.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:iA}),hg=gn.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:iA}),ek=eb("type",{binding:_e({type:Kn("binding"),boundShapeId:Wr,normalizedAnchor:od,isExact:Ee,isPrecise:Ee}),point:_e({type:Kn("point"),x:ge,y:ge})}),O7={labelColor:sA,color:jr,fill:ec,dash:ma,size:Oo,arrowheadStart:dg,arrowheadEnd:hg,font:Ro,start:ek,end:ek,bend:ge,text:ve},Uy={AddLabelColor:1,AddIsPrecise:2},j7=Le({currentVersion:Uy.AddIsPrecise,migrators:{[Uy.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}},[Uy.AddIsPrecise]:{up:e=>{const{start:t,end:n}=e.props;return{...e,props:{...e.props,start:t.type==="binding"?{...t,isPrecise:!(t.normalizedAnchor.x===.5&&t.normalizedAnchor.y===.5)}:t,end:n.type==="binding"?{...n,isPrecise:!(n.normalizedAnchor.x===.5&&n.normalizedAnchor.y===.5)}:n}}},down:e=>{const{start:t,end:n}=e.props,r={...t},o={...n};return r.type==="binding"&&(r.isPrecise||(r.normalizedAnchor={x:.5,y:.5}),delete r.isPrecise),o.type==="binding"&&(o.isPrecise||(o.normalizedAnchor={x:.5,y:.5}),delete o.isPrecise),{...e,props:{...e.props,start:r,end:o}}}}}}),D7={w:Vn,h:Vn,assetId:Sm.nullable(),url:hr},Hy={NullAssetId:1,MakeUrlsValid:2},N7=Le({currentVersion:Hy.MakeUrlsValid,migrators:{[Hy.NullAssetId]:{up:e=>e.props.assetId===void 0?{...e,props:{...e.props,assetId:null}}:e,down:e=>{if(e.props.assetId===null){const{assetId:t,...n}=e.props;return{...e,props:n}}return e}},[Hy.MakeUrlsValid]:{up:e=>e.props.url!==""&&!hr.isValid(e.props.url)?{...e,props:{...e.props,url:""}}:e,down:e=>e}}}),aA=_e({type:ZM("free","straight"),points:In(od)}),$7={color:jr,fill:ec,dash:ma,size:Oo,segments:In(aA),isComplete:Ee,isClosed:Ee,isPen:Ee},tk={AddInPen:1},L7=Le({currentVersion:tk.AddInPen,migrators:{[tk.AddInPen]:{up:e=>{const{points:t}=e.props.segments[0];if(t.length===0)return{...e,props:{...e.props,isPen:!1}};let n=!(t[0].z===0||t[0].z===.5);return t[1]&&(n=n&&!(t[1].z===0||t[1].z===.5)),{...e,props:{...e.props,isPen:n}}},down:e=>{const{isPen:t,...n}=e.props;return{...e,props:{...n}}}}}});var F7={};const nk=/(^\/r\/[^/]+\/?$)/,Ke=e=>{try{return new URL(e)}catch{return}},tc=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(nk))return e},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(nk))return e}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${e}`},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/embed\/?$/)){const n=t.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{if(e.includes("/maps/")){const t=e.match(/@(.*),(.*),(.*)z/);let n;if(t){const[,r,o,s]=t;n=`https://${new URL(e).host.replace("www.","")}/maps/embed/v1/view?key=${F7.NEXT_PUBLIC_GC_API_KEY}&center=${r},${o}&zoom=${s}`}else n="";return n}},fromEmbedUrl:e=>{const t=Ke(e);if(!t)return;if(t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom")){const r=t.searchParams.get("zoom"),[o,s]=t.searchParams.get("center").split(",");return`https://www.google.com/maps/@${o},${s},${r}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e),n=t&&t.pathname.match(/\/v\/([^/]+)\/?/);if(n)return`https://www.val.town/embed/${n[1]}`},fromEmbedUrl:e=>{const t=Ke(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:e=>{const t=Ke(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=e.match(t);if(n){const[r,o,s]=n;return`https://codepen.io/${o}/embed/${s}`}},fromEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=e.match(t);if(n){const[r,o,s]=n;return`https://codepen.io/${o}/pen/${s}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:e=>{const t=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=e.match(t);if(n){const[r,o]=n;return`https://scratch.mit.edu/projects/embed/${o}`}},fromEmbedUrl:e=>{const t=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=e.match(t);if(n){const[r,o]=n;return`https://scratch.mit.edu/projects/${o}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Ke(e);if(!t)return;const n=t.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${t.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&t.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${t.searchParams.get("v")}`},fromEmbedUrl:e=>{const t=Ke(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="youtube.com"){const r=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:e=>{const t=Ke(e),n=t==null?void 0:t.searchParams.get("cid");if(t!=null&&t.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";const r=Array.from(t.searchParams.keys());for(const o of r)t.searchParams.delete(o);return t.searchParams.set("src",n),t.href}},fromEmbedUrl:e=>{const t=Ke(e),n=t==null?void 0:t.searchParams.get("src");if(t!=null&&t.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";const r=Array.from(t.searchParams.keys());for(const o of r)t.searchParams.delete(o);return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/pub\/?$/))){t.pathname=t.pathname.replace(/\/pub$/,"/embed");const n=Array.from(t.searchParams.keys());for(const r of n)t.searchParams.delete(r);return t.href}},fromEmbedUrl:e=>{const t=Ke(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/embed\/?$/))){t.pathname=t.pathname.replace(/\/embed$/,"/pub");const n=Array.from(t.searchParams.keys());for(const r of n)t.searchParams.delete(r);return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e.split("/").pop()?e:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${e}?embed=true`},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.hostname==="vimeo.com"&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.hostname==="player.vimeo.com"){const n=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=Ke(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}/embed${t.pathname}?cell=*`;if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=t.pathname.replace(/^\/d/,"");return`${t.origin}/embed${n}?cell=*`}},fromEmbedUrl:e=>{const t=Ke(e);if(t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}${t.pathname.replace("/embed","")}#cell-*`;if(t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${t.origin}${t.pathname.replace("/embed","/d")}#cell-*`}}],z7={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},B7={w:Vn,h:Vn,url:ve},Kc={GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4},U7=Le({currentVersion:Kc.RemovePermissionOverrides,migrators:{[Kc.GenOriginalUrlInEmbed]:{up:e=>{const t=e.props.url,n=new URL(t).host.replace("www.","");let r;for(const o of tc)if(o.hostnames.includes(n))try{r=o.fromEmbedUrl(t)}catch(s){console.warn(s)}return{...e,props:{...e.props,tmpOldUrl:e.props.url,url:r??""}}},down:e=>{let t=e.props.tmpOldUrl;if(!t||t===""){const o=e.props.url,s=new URL(o).host.replace("www.","");for(const i of tc)if(i.hostnames.includes(s))try{t=i.toEmbedUrl(o)}catch(a){console.warn(a)}}const{tmpOldUrl:n,...r}=e.props;return{...e,props:{...r,url:t??""}}}},[Kc.RemoveDoesResize]:{up:e=>{const{doesResize:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props,doesResize:!0}})},[Kc.RemoveTmpOldUrl]:{up:e=>{const{tmpOldUrl:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})},[Kc.RemovePermissionOverrides]:{up:e=>{const{overridePermissions:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})}}}),H7={w:Vn,h:Vn,name:ve},V7=Le({}),id=gn.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),pg=gn.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),To=gn.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),K7={geo:To,labelColor:sA,color:jr,fill:ec,dash:ma,size:Oo,font:Ro,align:id,verticalAlign:pg,url:hr,w:Vn,h:Vn,growY:Jw,text:ve},Ko={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8},W7=Le({currentVersion:Ko.MakeUrlsValid,migrators:{[Ko.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[Ko.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}},[Ko.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[Ko.AddCheckBox]:{up:e=>({...e}),down:e=>({...e,props:{...e.props,geo:e.props.geo==="check-box"?"rectangle":e.props.geo}})},[Ko.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}},[Ko.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy";break}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},[Ko.AddCloud]:{up:e=>e,down:e=>{if(e.props.geo==="cloud")return{...e,props:{...e.props,geo:"rectangle"}}}},[Ko.MakeUrlsValid]:{up:e=>e.props.url!==""&&!hr.isValid(e.props.url)?{...e,props:{...e.props,url:""}}:e,down:e=>e}}}),G7={},Y7=Le({}),X7={color:jr,size:Oo,segments:In(aA),isComplete:Ee,isPen:Ee},q7=Le({}),Q7=_e({topLeft:od,bottomRight:od}),Z7={w:Vn,h:Vn,playing:Ee,url:hr,assetId:Sm.nullable(),crop:Q7.nullable()},Vh={AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3},J7=Le({currentVersion:Vh.MakeUrlsValid,migrators:{[Vh.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[Vh.AddCropProp]:{up:e=>({...e,props:{...e.props,crop:null}}),down:e=>{const{crop:t,...n}=e.props;return{...e,props:n}}},[Vh.MakeUrlsValid]:{up:e=>e.props.url!==""&&!hr.isValid(e.props.url)?{...e,props:{...e.props,url:""}}:e,down:e=>e}}}),eB=new Set(["vertex","virtual","create"]),tB=_e({id:ve,type:jd(eB),canBind:Ee.optional(),canSnap:Ee.optional(),index:ve,x:ge,y:ge}),fg=gn.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),nB={color:jr,dash:ma,size:Oo,spline:fg,handles:NS(ve,tB)},rk={AddSnapHandles:1},rB=Le({currentVersion:rk.AddSnapHandles,migrators:{[rk.AddSnapHandles]:{up:e=>{const t=hn(e.props.handles);for(const n in t)t[n].canSnap=!0;return{...e,props:{...e.props,handles:t}}},down:e=>{const t=hn(e.props.handles);for(const n in t)delete t[n].canSnap;return{...e,props:{...e.props,handles:t}}}}}}),oB={color:jr,size:Oo,font:Ro,align:id,verticalAlign:pg,growY:Jw,url:hr,text:ve},La={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5},sB=Le({currentVersion:La.MakeUrlsValid,migrators:{[La.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[La.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[La.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy";break}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},[La.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}},[La.MakeUrlsValid]:{up:e=>e.props.url!==""&&!hr.isValid(e.props.url)?{...e,props:{...e.props,url:""}}:e,down:e=>e}}}),iB={color:jr,size:Oo,font:Ro,align:id,w:Vn,text:ve,scale:Vn,autoSize:Ee},ok={RemoveJustify:1},aB=Le({currentVersion:ok.RemoveJustify,migrators:{[ok.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})}}}),lB={w:Vn,h:Vn,time:ge,playing:Ee,url:hr,assetId:Sm.nullable()},Vy={AddUrlProp:1,MakeUrlsValid:2},cB=Le({currentVersion:Vy.MakeUrlsValid,migrators:{[Vy.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[Vy.MakeUrlsValid]:{up:e=>e.props.url!==""&&!hr.isValid(e.props.url)?{...e,props:{...e.props,url:""}}:e,down:e=>e}}}),ad=[{locale:"ar",label:""},{locale:"ca",label:"Catal"},{locale:"cs",label:"etina"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espaol"},{locale:"fa",label:""},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Franais"},{locale:"gl",label:"Galego"},{locale:"he",label:""},{locale:"it",label:"Italiano"},{locale:"ja",label:""},{locale:"ko-kr",label:""},{locale:"ku",label:""},{locale:"hi-in",label:""},{locale:"hu",label:"Magyar"},{locale:"my",label:""},{locale:"ne",label:""},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugus - Brasil"},{locale:"pt-pt",label:"Portugus - Europeu"},{locale:"ro",label:"Romn"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:""},{locale:"th",label:""},{locale:"tr",label:"Trke"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ting Vit"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:" ()"}];function uB(){const e=typeof window<"u"?window.navigator.languages??["en"]:["en"];return dB(e)}function dB(e){for(const t of e){const n=hB(t);if(n)return n}return"en"}const sk={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function hB(e){const t=ad.find(o=>o.locale===e.toLowerCase());if(t)return t.locale;const[n,r]=e.split(/[-_]/).map(o=>o.toLowerCase());if(r){const o=ad.find(s=>s.locale===n);if(o)return o.locale}return n in sk?sk[n]:null}var lA={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var s="",i=0;i<arguments.length;i++){var a=arguments[i];a&&(s=o(s,r(a)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return n.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var i="";for(var a in s)t.call(s,a)&&s[a]&&(i=o(i,a));return i}function o(s,i){return i?s?s+" "+i:s+i:s}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(lA);var pB=lA.exports;const fe=xa(pB);var Ky={};const fB={},qe={preventDefaultLogging:Xn("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:Xn("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:Xn("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:Xn("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:Xn("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:Xn("debugSvg",{defaults:{all:!1}}),throwToBlob:Xn("throwToBlob",{defaults:{all:!1}}),logMessages:Xn("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:Xn("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:Xn("debugCursors",{defaults:{all:!1}}),forceSrgb:Xn("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:Xn("debugGeometry",{defaults:{all:!1}}),hideShapes:Xn("hideShapes",{defaults:{all:!1}})};typeof window<"u"&&(window.tldrawLog=e=>{qe.logMessages.set(qe.logMessages.get().concat(e))});if(typeof Element<"u"){const e=Element.prototype.removeChild;Od("element removal logging",()=>{qe.elementRemovalLogging.get()?Element.prototype.removeChild=function(t){return console.warn("[tldraw] removing child:",t),e.call(this,t)}:Element.prototype.removeChild=e})}function Xn(e,{defaults:t,shouldStoreForSession:n=!0}){return gB({name:e,defaults:t,shouldStoreForSession:n})}function gB(e){const t=yB(e),n=e.shouldStoreForSession?mB(e.name):null,r=kn(`debug:${e.name}`,n??t);return typeof window<"u"&&(e.shouldStoreForSession&&Od(`debug:${e.name}`,()=>{const o=r.get();try{o===t?window.sessionStorage.removeItem(`tldraw_debug:${e.name}`):window.sessionStorage.setItem(`tldraw_debug:${e.name}`,JSON.stringify(o))}catch{}}),Object.defineProperty(window,`tldraw${e.name.replace(/^[a-z]/,o=>o.toUpperCase())}`,{get(){return r.get()},set(o){r.set(o)},configurable:!0})),Object.assign(r,e)}function mB(e){try{return JSON.parse((window==null?void 0:window.sessionStorage.getItem(`tldraw_debug:${e}`))??"null")}catch{return null}}function Wy(e){try{return e()}catch{return null}}function yB(e){switch(Wy(()=>Ky.TLDRAW_ENV)??Wy(()=>Ky.VERCEL_PUBLIC_TLDRAW_ENV)??Wy(()=>Ky.NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return e.defaults.production??e.defaults.all;case"preview":case"staging":return e.defaults.staging??e.defaults.all;default:return e.defaults.development??e.defaults.all}}function gg(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return gg(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Re(e){e.preventDefault(),qe.preventDefaultLogging.get()&&console.warn("preventDefault called on event:",e)}function Nd(e,t){if(e.setPointerCapture(t.pointerId),qe.pointerCaptureTracking.get()){const n=qe.pointerCaptureTrackingObject.get();n.set(e,(n.get(e)??0)+1)}qe.pointerCaptureLogging.get()&&console.warn("setPointerCapture called on element:",e,t)}function $d(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),qe.pointerCaptureTracking.get()){const n=qe.pointerCaptureTrackingObject.get();n.get(e)===1?n.delete(e):n.has(e)?n.set(e,n.get(e)-1):console.warn("Release without capture")}qe.pointerCaptureLogging.get()&&console.warn("releasePointerCapture called on element:",e,t)}}const Ot=e=>e.stopPropagation();function Fn(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:e.pointerType==="pen"}}const ob=H.createContext({});function W(){return H.useContext(ob)}function vB(){const e=W();return b.useMemo(function(){let r,o;function s(g){if(!g.isKilled){if(g.button===2){e.dispatch({type:"pointer",target:"canvas",name:"right_click",...Fn(g)});return}g.button!==0&&g.button!==1&&g.button!==5||(Nd(g.currentTarget,g),e.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...Fn(g)}),e.getOpenMenus().length>0&&(e.updateInstanceState({openMenus:[]}),document.body.click(),e.getContainer().focus()))}}function i(g){g.isKilled||g.clientX===r&&g.clientY===o||(r=g.clientX,o=g.clientY,e.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...Fn(g)}))}function a(g){g.isKilled||g.button!==0&&g.button!==1&&g.button!==2&&g.button!==5||(r=g.clientX,o=g.clientY,$d(g.currentTarget,g),e.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...Fn(g)}))}function l(g){if(g.isKilled||e.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const m=g.pointerType==="mouse"||g.pointerType==="pen";e.updateInstanceState({isHoveringCanvas:m?!0:null})}function c(g){if(g.isKilled||e.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const m=g.pointerType==="mouse"||g.pointerType==="pen";e.updateInstanceState({isHoveringCanvas:m?!1:null})}function u(g){g.isKilled=!0,document.body.click(),Re(g)}function d(g){g.isKilled=!0,g.target.tagName!=="A"&&g.target.tagName!=="TEXTAREA"&&Re(g)}function h(g){Re(g)}async function f(g){var v,x;if(Re(g),!((x=(v=g.dataTransfer)==null?void 0:v.files)!=null&&x.length))return;const m=Array.from(g.dataTransfer.files);await e.putExternalContent({type:"files",files:m,point:e.screenToPage({x:g.clientX,y:g.clientY}),ignoreParent:!1})}function y(g){Ot(g)}return{onPointerDown:s,onPointerMove:i,onPointerUp:a,onPointerEnter:l,onPointerLeave:c,onDragOver:h,onDrop:f,onTouchStart:u,onTouchEnd:d,onClick:y}},[e])}function SB(){const e=W();b.useEffect(()=>{if(e.environment.isFirefox&&!e.environment.isAndroid&&!e.environment.isIos){e.updateInstanceState({isCoarsePointer:!1});return}if(window.matchMedia){const t=window.matchMedia("(pointer: coarse)"),n=()=>{e.updateInstanceState({isCoarsePointer:!!t.matches})};if(n(),t)return t.addEventListener("change",n),()=>t.removeEventListener("change",n)}},[e])}const cA=b.createContext(null);function xB({container:e,children:t}){return p.jsx(cA.Provider,{value:e,children:t})}function mn(){return w9(b.useContext(cA),"useContainer used outside of <Tldraw />")}function wB(){const e=W(),t=mn(),n=q("isFocused",()=>e.getInstanceState().isFocused,[e]);b.useEffect(()=>{if(typeof matchMedia===void 0)return;let r=null;const o=()=>{r!=null&&r();const s=`(resolution: ${window.devicePixelRatio}dppx)`,i=matchMedia(s),a=l=>{l.type==="change"&&o()};i.addEventListener?i.addEventListener("change",o):i.addListener&&i.addListener(a),r=()=>{i.removeEventListener?i.removeEventListener("change",o):i.removeListener&&i.removeListener(a)},e.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return o(),()=>{r==null||r()}},[e]),b.useEffect(()=>{if(!n)return;const r=a=>{if(a.altKey&&(e.isIn("zoom")||!e.getPath().endsWith(".idle"))&&!Wc()&&Re(a),a.isKilled)return;switch(a.isKilled=!0,a.key){case"=":case"-":case"0":{if(a.metaKey||a.ctrlKey){Re(a);return}break}case"Tab":{if(Wc()||e.getIsMenuOpen())return;break}case",":{if(!Wc()&&(Re(a),!e.inputs.keys.has("Comma"))){const{x:c,y:u,z:d}=e.inputs.currentScreenPoint;e.inputs.keys.add("Comma");const h={type:"pointer",name:"pointer_down",point:{x:c,y:u,z:d},shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey,pointerId:0,button:0,isPen:e.getInstanceState().isPenMode,target:"canvas"};e.dispatch(h);return}break}case"Escape":{if((e.getEditingShape()||e.getSelectedShapeIds().length>0)&&a.preventDefault(),e.getOpenMenus().length>0)return;e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),t.focus());return}default:if(Wc()||e.getIsMenuOpen())return}const l={type:"keyboard",name:a.repeat?"key_repeat":"key_down",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};e.dispatch(l)},o=a=>{var c;if(a.isKilled||(a.isKilled=!0,Wc()||e.getIsMenuOpen()))return;if(a.key===","&&((c=document.activeElement)!=null&&c.ELEMENT_NODE&&Re(a),e.inputs.keys.has(a.code))){const{x:u,y:d,z:h}=e.inputs.currentScreenPoint;e.inputs.keys.delete(a.code);const f={type:"pointer",name:"pointer_up",point:{x:u,y:d,z:h},shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey,pointerId:0,button:0,isPen:e.getInstanceState().isPenMode,target:"canvas"};e.dispatch(f);return}const l={type:"keyboard",name:"key_up",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};e.dispatch(l)};function s(a){var l,c;if(t.contains(a.target)){const u=a.touches[0].pageX,d=a.touches[0].radiusX||0;(u-d<10||u+d>e.getViewportScreenBounds().width-10)&&(((l=a.target)==null?void 0:l.tagName)==="BUTTON"&&((c=a.target)==null||c.click()),Re(a))}}const i=a=>{t.contains(a.target)&&(a.ctrlKey||a.metaKey)&&Re(a)};return t.addEventListener("touchstart",s,{passive:!1}),t.addEventListener("wheel",i,{passive:!1}),document.addEventListener("gesturestart",Re),document.addEventListener("gesturechange",Re),document.addEventListener("gestureend",Re),t.addEventListener("keydown",r),t.addEventListener("keyup",o),()=>{t.removeEventListener("touchstart",s),t.removeEventListener("wheel",i),document.removeEventListener("gesturestart",Re),document.removeEventListener("gesturechange",Re),document.removeEventListener("gestureend",Re),t.removeEventListener("keydown",r),t.removeEventListener("keyup",o)}},[e,t,n])}const bB=["input","select","button","textarea"];function Wc(){const{activeElement:e}=document;return!!(e&&(e.getAttribute("contenteditable")||bB.indexOf(e.tagName.toLowerCase())>-1))}const CB={error:null};class uA extends b.Component{constructor(){super(...arguments);S(this,"state",CB)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,o;(o=(r=this.props).onError)==null||o.call(r,n)}render(){const{error:n}=this.state;if(n!==null){const{fallback:r}=this.props;return p.jsx(r,{error:n})}return this.props.children}}function ld({children:e,fallback:t,...n}){return t===null?p.jsx(p.Fragment,{children:e}):p.jsx(uA,{fallback:t,...n,children:e})}class PB{constructor(t){this.shape=t}equals(t){var n,r,o,s,i,a;return((n=this.shape)==null?void 0:n.isLocked)===((r=t==null?void 0:t.shape)==null?void 0:r.isLocked)&&((o=this.shape)==null?void 0:o.props)===((s=t==null?void 0:t.shape)==null?void 0:s.props)&&((i=this.shape)==null?void 0:i.meta)===((a=t==null?void 0:t.shape)==null?void 0:a.meta)}}const kB=({shape:e,util:t})=>mm("Indicator:"+e.type,()=>t.indicator(e)),EB=({editor:e,id:t})=>{const n=q("shape",()=>new PB(e.store.get(t)),[e,t]),{ShapeIndicatorErrorFallback:r}=jt();return!n.shape||n.shape.isLocked?null:p.jsx(ld,{fallback:r,onError:o=>e.annotateError(o,{origin:"react.shapeIndicator",willCrashApp:!1}),children:p.jsx(kB,{shape:n.shape,util:e.getShapeUtil(n.shape)},n.shape.id)})},IB=({id:e,className:t,color:n,opacity:r})=>{const o=W(),s=q("transform",()=>{const i=o.getShapePageTransform(e);return i?i.toCssString():""},[o,e]);return p.jsx("svg",{className:fe("tl-overlays__item",t),children:p.jsx("g",{className:"tl-shape-indicator",transform:s,stroke:n??"var(--color-selected)",opacity:r,children:p.jsx(EB,{editor:o,id:e})})})},Ld=b.memo(IB);function _B(){return p.jsx("div",{className:"tl-background"})}function vc(e,t,n,r,o,s){b.useLayoutEffect(()=>{const i=e.current;if(!i||t===void 0)return;let a=`translate(${t}px, ${n}px)`;r!==void 0&&(a+=` scale(${r})`),o!==void 0&&(a+=` rotate(${o}rad)`),s&&(a+=` translate(${s.x}px, ${s.y}px)`),i.style.transform=a})}const dn={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>e<=0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e>=1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2};class E{constructor(t=0,n=0,r=1){this.x=t,this.y=n,this.z=r}get pressure(){return this.z}set(t=this.x,n=this.y,r=this.z){return this.x=t,this.y=n,this.z=r,this}setTo({x:t=0,y:n=0,z:r=1}){return this.x=t,this.y=n,this.z=r,this}rot(t){if(t===0)return this;const{x:n,y:r}=this,o=Math.sin(t),s=Math.cos(t);return this.x=n*s-r*o,this.y=n*o+r*s,this}rotWith(t,n){if(n===0)return this;const r=this.x-t.x,o=this.y-t.y,s=Math.sin(n),i=Math.cos(n);return this.x=t.x+(r*i-o*s),this.y=t.y+(r*s+o*i),this}clone(){const{x:t,y:n,z:r}=this;return new E(t,n,r)}sub(t){return this.x-=t.x,this.y-=t.y,this}subXY(t,n){return this.x-=t,this.y-=n,this}subScalar(t){return this.x-=t,this.y-=t,this}add(t){return this.x+=t.x,this.y+=t.y,this}addXY(t,n){return this.x+=t,this.y+=n,this}addScalar(t){return this.x+=t,this.y+=t,this}clamp(t,n){return this.x=Math.max(this.x,t),this.y=Math.max(this.y,t),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(t){return this.x/=t,this.y/=t,this}divV(t){return this.x/=t.x,this.y/=t.y,this}mul(t){return this.x*=t,this.y*=t,this}mulV(t){return this.x*=t.x,this.y*=t.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(t,n){const r=E.Tan(t,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(t){return this.x=this.y*t.z-this.z*t.y,this.y=this.z*t.x-this.x*t.z,this}dpr(t){return E.Dpr(this,t)}cpr(t){return E.Cpr(this,t)}len2(){return E.Len2(this)}len(){return E.Len(this)}pry(t){return E.Pry(this,t)}per(){const{x:t,y:n}=this;return this.x=n,this.y=-t,this}uni(){return E.Uni(this)}tan(t){return E.Tan(this,t)}dist(t){return E.Dist(this,t)}distanceToLineSegment(t,n){return E.DistanceToLineSegment(t,n,this)}slope(t){return E.Slope(this,t)}snapToGrid(t){return this.x=Math.round(this.x/t)*t,this.y=Math.round(this.y/t)*t,this}angle(t){return E.Angle(this,t)}toAngle(){return E.ToAngle(this)}lrp(t,n){return this.x=this.x+(t.x-this.x)*n,this.y=this.y+(t.y-this.y)*n,this}equals(t){return E.Equals(this,t)}equalsXY(t,n){return E.EqualsXY(this,t,n)}norm(){const t=this.len();return this.x=t===0?0:this.x/t,this.y=t===0?0:this.y/t,this}toFixed(){return E.ToFixed(this)}toString(){return E.ToString(E.ToFixed(this))}toJson(){return E.ToJson(this)}toArray(){return E.ToArray(this)}static Add(t,n){return new E(t.x+n.x,t.y+n.y)}static AddXY(t,n,r){return new E(t.x+n,t.y+r)}static Sub(t,n){return new E(t.x-n.x,t.y-n.y)}static SubXY(t,n,r){return new E(t.x-n,t.y-r)}static AddScalar(t,n){return new E(t.x+n,t.y+n)}static SubScalar(t,n){return new E(t.x-n,t.y-n)}static Div(t,n){return new E(t.x/n,t.y/n)}static Mul(t,n){return new E(t.x*n,t.y*n)}static DivV(t,n){return new E(t.x/n.x,t.y/n.y)}static MulV(t,n){return new E(t.x*n.x,t.y*n.y)}static Neg(t){return new E(-t.x,-t.y)}static Per(t){return new E(t.y,-t.x)}static Dist2(t,n){return E.Sub(t,n).len2()}static Abs(t){return new E(Math.abs(t.x),Math.abs(t.y))}static Dist(t,n){return Math.hypot(t.y-n.y,t.x-n.x)}static Dpr(t,n){return t.x*n.x+t.y*n.y}static Cross(t,n){return new E(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z)}static Cpr(t,n){return t.x*n.y-n.x*t.y}static Len2(t){return t.x*t.x+t.y*t.y}static Len(t){return Math.hypot(t.x,t.y)}static Pry(t,n){return E.Dpr(t,n)/E.Len(n)}static Uni(t){return E.Div(t,E.Len(t))}static Tan(t,n){return E.Uni(E.Sub(t,n))}static Min(t,n){return new E(Math.min(t.x,n.x),Math.min(t.y,n.y))}static Max(t,n){return new E(Math.max(t.x,n.x),Math.max(t.y,n.y))}static From({x:t,y:n,z:r=1}){return new E(t,n,r)}static FromArray(t){return new E(t[0],t[1])}static Rot(t,n=0){const r=Math.sin(n),o=Math.cos(n);return new E(t.x*o-t.y*r,t.x*r+t.y*o)}static RotWith(t,n,r){const o=t.x-n.x,s=t.y-n.y,i=Math.sin(r),a=Math.cos(r);return new E(n.x+(o*a-s*i),n.y+(o*i+s*a))}static NearestPointOnLineThroughPoint(t,n,r){return E.Mul(n,E.Sub(r,t).pry(n)).add(t)}static NearestPointOnLineSegment(t,n,r,o=!0){const s=E.Tan(n,t),i=E.Add(t,E.Mul(s,E.Sub(r,t).pry(s)));if(o){if(i.x<Math.min(t.x,n.x))return E.Cast(t.x<n.x?t:n);if(i.x>Math.max(t.x,n.x))return E.Cast(t.x>n.x?t:n);if(i.y<Math.min(t.y,n.y))return E.Cast(t.y<n.y?t:n);if(i.y>Math.max(t.y,n.y))return E.Cast(t.y>n.y?t:n)}return i}static DistanceToLineThroughPoint(t,n,r){return E.Dist(r,E.NearestPointOnLineThroughPoint(t,n,r))}static DistanceToLineSegment(t,n,r,o=!0){return E.Dist(r,E.NearestPointOnLineSegment(t,n,r,o))}static Snap(t,n=1){return new E(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}static Cast(t){return t instanceof E?t:E.From(t)}static Slope(t,n){return t.x===n.y?NaN:(t.y-n.y)/(t.x-n.x)}static Angle(t,n){return Math.atan2(n.y-t.y,n.x-t.x)}static Lrp(t,n,r){return E.Sub(n,t).mul(r).add(t)}static Med(t,n){return new E((t.x+n.x)/2,(t.y+n.y)/2)}static Equals(t,n){return Math.abs(t.x-n.x)<1e-4&&Math.abs(t.y-n.y)<1e-4}static EqualsXY(t,n,r){return t.x===n&&t.y===r}static Clockwise(t,n,r){return(r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y)<0}static Rescale(t,n){const r=E.Len(t);return new E(n*t.x/r,n*t.y/r)}static ScaleWithOrigin(t,n,r){return E.Sub(t,r).mul(n).add(r)}static ToFixed(t,n=2){return new E(+t.x.toFixed(n),+t.y.toFixed(n),+t.z.toFixed(n))}static Nudge(t,n,r){return E.Add(t,E.Tan(n,t).mul(r))}static ToString(t){return`${t.x}, ${t.y}`}static ToAngle(t){let n=Math.atan2(t.y,t.x);return n<0&&(n+=Math.PI*2),n}static FromAngle(t,n=1){return new E(Math.cos(t)*n,Math.sin(t)*n)}static ToArray(t){return[t.x,t.y,t.z]}static ToJson(t){const{x:n,y:r,z:o}=t;return{x:n,y:r,z:o}}static Average(t){const n=t.length,r=new E(0,0);for(let o=0;o<n;o++)r.add(t[o]);return r.div(n)}static Clamp(t,n,r){return r===void 0?new E(Math.min(Math.max(t.x,n)),Math.min(Math.max(t.y,n))):new E(Math.min(Math.max(t.x,n),r),Math.min(Math.max(t.y,n),r))}static PointsBetween(t,n,r=6){const o=[];for(let s=0;s<r;s++){const i=dn.easeInQuad(s/(r-1)),a=E.Lrp(t,n,i);a.z=Math.min(1,.5+Math.abs(.5-TB(i))*.65),o.push(a)}return o}static SnapToGrid(t,n=8){return new E(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}}const TB=e=>e<.5?2*e*e:-1+(4-2*e)*e;function Ht(e){return`${O(e.x)},${O(e.y)} `}function $n(e,t){return`${O((e.x+t.x)/2)},${O((e.y+t.y)/2)} `}const $e=Math.PI,Ze=$e/2,Ue=$e*2,MB=Math.sin;function wo(e,t,n){return Math.max(t,typeof n<"u"?Math.min(e,n):e)}function Kh(e,t=1e10){return e?Math.round(e*t)/t:0}function Tu(e,t,n=1e-6){return Math.abs(e-t)<=n}function cd(e,t){const n=Math.pow(e-t,2)/Math.pow(e+t,2);return $e*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function oo(e){return e=e%Ue,e<0?e=e+Ue:e===0&&(e=0),e}function xm(e,t){return e=oo(e),t=oo(t),e>t&&(t+=Ue),t-e}function AB(e,t){return Ue-xm(e,t)}function Mu(e,t){const n=(t-e)%Ue;return 2*n%Ue-n}function LS(e){return(Ue+e)%Ue}function mg(e,t){const n=Ue/t;let r=Math.floor((LS(e)+n/2)/n)*n%Ue;return r<$e&&(r+=Ue),r>$e&&(r-=Ue),r}function dA(e,t){return e===t||Tu(e%(Math.PI/2)-t%(Math.PI/2),0)}function RB(e){return e*$e/180}function OB(e){return e*180/$e}function hA(e,t,n,r){return new E(e+n*Math.cos(r),t+n*Math.sin(r))}function Gy(e,t,n){const r=e/2,o=t/2,s=[];let i=1/0,a=-1/0,l=1/0,c=-1/0;for(let y=0;y<n;y++){const g=Ue/n,m=-Ze+y*g,v=r+r*Math.cos(m),x=o+o*Math.sin(m);v<i&&(i=v),x<l&&(l=x),v>a&&(a=v),x>c&&(c=x),s.push(new E(v,x))}const u=a-i,d=c-l,h=e-u,f=t-d;if(h!==0||f!==0)for(let y=0;y<s.length;y++){const g=s[y];g.x=(g.x-i)/u*e,g.y=(g.y-l)/d*t}return s}function Gc(e,t,n,r){return e<r&&n<t}function Gr(e,t,n,r){const o=Math.max(e,n),s=Math.min(t,r);return o<=s?[o,s]:null}function ik(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function jo(e,t){let n=0,r,o;for(let s=0;s<t.length;s++){if(r=t[s],r.x===e.x&&r.y===e.y||(o=t[(s+1)%t.length],E.Dist(e,r)+E.Dist(e,o)===E.Dist(r,o)))return!0;r.y<=e.y?o.y>e.y&&ik(r,o,e)>0&&(n+=1):o.y<=e.y&&ik(r,o,e)<0&&(n-=1)}return n!==0}function O(e){return+e.toFixed(4)}function yg(e){return+e.toFixed(2)}const ak=e=>Math.abs(e)<Number.MAX_SAFE_INTEGER,Wh=({brush:e,color:t,opacity:n,className:r})=>{const o=b.useRef(null);vc(o,e.x,e.y);const s=O(Math.max(1,e.w)),i=O(Math.max(1,e.h));return p.jsx("svg",{className:"tl-overlays__item",ref:o,children:t?p.jsxs("g",{className:"tl-brush",opacity:n,children:[p.jsx("rect",{width:s,height:i,fill:t,opacity:.75}),p.jsx("rect",{width:s,height:i,fill:"none",stroke:t,opacity:.1})]}):p.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:s,height:i})})},jB=({className:e,zoom:t,point:n,color:r,viewport:o,opacity:s=1})=>{const i=b.useRef(null);return vc(i,wo(n.x,o.minX+5/t,o.maxX-5/t),wo(n.y,o.minY+5/t,o.maxY-5/t),1/t,E.Angle(o.center,n)),p.jsxs("svg",{ref:i,className:fe("tl-overlays__item",e),children:[p.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),p.jsx("use",{href:"#cursor_hint",color:r,opacity:s})]})},DB=({className:e,zoom:t,point:n,color:r,name:o,chatMessage:s})=>{const i=b.useRef(null);return vc(i,n==null?void 0:n.x,n==null?void 0:n.y,1/t),n?p.jsxs("div",{ref:i,className:fe("tl-overlays__item",e),children:[p.jsx("svg",{className:"tl-cursor",children:p.jsx("use",{href:"#cursor",color:r})}),s?p.jsxs(p.Fragment,{children:[o&&p.jsx("div",{className:"tl-nametag-title",style:{color:r},children:o}),p.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:r},children:s})]}):o&&p.jsx("div",{className:"tl-nametag",style:{backgroundColor:r},children:o})]}):null},lk=b.memo(DB),sb={openWindow:(e,t)=>window.open(e,t,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var e;return await((e=window.__tldraw__hardReset)==null?void 0:e.call(window))}};function pA(){sb.hardReset()}function NB(){sb.refreshPage()}const $B="https://github.com/tldraw/tldraw/issues/new";function LB(){}const fA=({error:e,editor:t})=>{const n=b.useRef(null),[r,o]=b.useState(!1),[s,i]=b.useState(!1),[a,l]=b.useState(!1),c=e instanceof Error?e.message:String(e),u=e instanceof Error?e.stack:null,d=q("isDarkMode",()=>{try{if(t)return t.user.getIsDarkMode()}catch{}return null},[t]),[h,f]=b.useState(null);b.useLayoutEffect(()=>{var C;d!==null&&f(d);let x=(C=n.current)==null?void 0:C.parentElement,w=!1;for(;x;){if(x.classList.contains("tl-theme__dark")||x.classList.contains("tl-theme__light")){w=!0;break}x=x.parentElement}if(w){f(null);return}f(window.matchMedia("(prefers-color-scheme: dark)").matches)},[d]),b.useEffect(()=>{if(s){const x=setTimeout(()=>{i(!1)},2e3);return()=>clearTimeout(x)}},[s]);const y=()=>{const x=document.createElement("textarea");x.value=u??c,document.body.appendChild(x),x.select(),document.execCommand("copy"),x.remove(),i(!0)},g=()=>{NB()},m=async()=>{pA()},v=new URL($B);return v.searchParams.set("title",c),v.searchParams.set("labels","bug"),v.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${u??c}
\`\`\`

My browser: ${navigator.userAgent}`),p.jsxs("div",{ref:n,className:fe("tl-container tl-error-boundary",h===null?"":h?"tl-theme__dark":"tl-theme__light"),children:[p.jsx("div",{className:"tl-error-boundary__overlay"}),t&&p.jsx(uA,{onError:LB,fallback:()=>null,children:p.jsx(ob.Provider,{value:t,children:p.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:p.jsx(db,{})})})}),p.jsx("div",{className:fe("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?p.jsxs(p.Fragment,{children:[p.jsx("h2",{children:"Are you sure?"}),p.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),p.jsxs("div",{className:"tl-error-boundary__content__actions",children:[p.jsx("button",{onClick:()=>l(!1),children:"Cancel"}),p.jsx("button",{className:"tl-error-boundary__reset",onClick:m,children:"Reset data"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx("h2",{children:"Something's gone wrong."}),p.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",p.jsx("a",{href:v.toString(),children:"create a GitHub issue"})," or"," ",p.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&p.jsxs("div",{className:"tl-error-boundary__content__error",children:[p.jsx("pre",{children:p.jsx("code",{children:u??c})}),p.jsx("button",{onClick:y,children:s?"Copied!":"Copy"})]}),p.jsxs("div",{className:"tl-error-boundary__content__actions",children:[p.jsx("button",{onClick:()=>o(!r),children:r?"Hide details":"Show details"}),p.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[p.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),p.jsx("button",{className:"tl-error-boundary__refresh",onClick:g,children:"Refresh Page"})]})]})]})})]})},Go=2e3,vg=40,es=320,Fa=[.1,.25,.5,1,2,4,8],Yc=.1,Us=8,FB=.5,zB=.1,BB=.2,UB=.005,HB=.05,VB=450,KB=200,FS=6,ud=4,WB=32,Sg={};for(let e=1;e<=Math.ceil(Us);e++)Sg[e+"_dark"]=`hash_pattern_zoom_${e}_dark`,Sg[e+"_light"]=`hash_pattern_zoom_${e}_light`;const GB={duration:0,easing:dn.easeInOutCubic},$p=.09,ck=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],YB=6e4,gA=3e3,XB=1200,uk={CAMERA_MOVE:-10},qB=64,QB=620,co=8,ZB=20,za=32,JB=({x:e,y:t,z:n,size:r})=>p.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("defs",{children:ck.map(({min:o,mid:s,step:i},a)=>{const l=i*r*n,c=.5+e*n,u=.5+t*n,d=c>0?c%l:l+c%l,h=u>0?u%l:l+u%l,f=n<s?sg(n,[o,s],[0,1]):1;return p.jsx("pattern",{id:`grid-${i}`,width:l,height:l,patternUnits:"userSpaceOnUse",children:p.jsx("circle",{className:"tl-grid-dot",cx:d,cy:h,r:1,opacity:f})},`grid-pattern-${a}`)})}),ck.map(({step:o},s)=>p.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${o})`},`grid-rect-${s}`))]}),eU=({handle:e,isCoarse:t,className:n,zoom:r})=>{const o=(t?20:12)/r,s=(e.type==="create"&&t?3:4)/r;return p.jsxs("g",{className:fe("tl-handle",{"tl-handle__virtual":e.type==="virtual","tl-handle__create":e.type==="create"},n),children:[p.jsx("circle",{className:"tl-handle__bg",r:o}),p.jsx("circle",{className:"tl-handle__fg",r:s})]})},tU=({children:e})=>p.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:e}),nU=({shapeId:e})=>p.jsx(Ld,{className:"tl-user-indicator__hovered",id:e});function Fd(e,t=!0){const n=e.length;if(n<2)return"";let r=e[0],o=e[1];if(n===2)return`M${Ht(r)}L${Ht(o)}`;let s="";for(let i=2,a=n-1;i<a;i++)r=e[i],o=e[i+1],s+=$n(r,o);return t?`M${$n(e[0],e[1])}Q${Ht(e[1])}${$n(e[1],e[2])}T${s}${$n(e[n-1],e[0])}${$n(e[0],e[1])}Z`:`M${Ht(e[0])}Q${Ht(e[1])}${$n(e[1],e[2])}${e.length>3?"T":""}${s}L${Ht(e[n-1])}`}const dk=({scribble:e,zoom:t,color:n,opacity:r,className:o})=>e.points.length?p.jsx("svg",{className:o&&fe("tl-overlays__item",o),children:p.jsx("path",{className:"tl-scribble",d:Fd(e.points,!1),stroke:n??`var(--color-${e.color})`,fill:"none",strokeWidth:8/t,opacity:r??e.opacity})}):null,mA=({bounds:e,rotation:t})=>{const n=b.useRef(null);return vc(n,e.x,e.y,1,t),b.useLayoutEffect(()=>{const r=n.current;r&&(r.style.width=O(Math.max(1,e.width))+"px",r.style.height=O(Math.max(1,e.height))+"px")},[e.width,e.height]),p.jsx("div",{ref:n,className:"tl-selection__bg",draggable:!1})},rU=({bounds:e,rotation:t})=>{const n=W(),r=b.useRef(null),o=q("only selected shape",()=>n.getOnlySelectedShape(),[n]),s=o?n.getShapeUtil(o).expandSelectionOutlinePx(o):0;return vc(r,e==null?void 0:e.x,e==null?void 0:e.y,1,t,{x:-s,y:-s}),e=e.clone().expandBy(s).zeroFix(),p.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:p.jsx("rect",{className:fe("tl-selection__fg__outline"),width:O(e.width),height:O(e.height)})})},oU=()=>p.jsx("div",{className:"tl-shape-error-boundary"}),sU=()=>p.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function iU({points:e,zoom:t}){const n=2.5/t,r=e.reduce((h,f)=>Math.min(h,f.x),1/0),o=e.reduce((h,f)=>Math.max(h,f.x),-1/0),s=e.reduce((h,f)=>Math.min(h,f.y),1/0),i=e.reduce((h,f)=>Math.max(h,f.y),-1/0),a=e.some(h=>h.x===r&&h.y===s);let l,c,u,d;return a?(l=r,c=s,u=o,d=i):(l=r,c=i,u=o,d=s),p.jsxs("g",{className:"tl-snap-line",children:[p.jsx("line",{x1:l,y1:c,x2:u,y2:d}),e.map((h,f)=>p.jsx("g",{transform:`translate(${h.x},${h.y})`,children:p.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},f))]})}function aU({gaps:e,direction:t,zoom:n}){const r=3.5/n;let o=[-1/0,1/0],s=null;const i=t==="horizontal";for(const l of e){if(s=Gr(o[0],o[1],i?l.startEdge[0].y:l.startEdge[0].x,i?l.startEdge[1].y:l.startEdge[1].x),s)o=s;else continue;if(s=Gr(o[0],o[1],i?l.endEdge[0].y:l.endEdge[0].x,i?l.endEdge[1].y:l.endEdge[1].x),s)o=s;else continue}if(o===null)return null;const a=(o[0]+o[1])/2;return p.jsx("g",{className:"tl-snap-line",children:e.map(({startEdge:l,endEdge:c},u)=>p.jsx(b.Fragment,{children:i?p.jsxs(p.Fragment,{children:[p.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),p.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),p.jsx("line",{x1:l[0].x,y1:a,x2:c[0].x,y2:a}),p.jsx("line",{x1:(l[0].x+c[0].x)/2,y1:a-r,x2:(l[0].x+c[0].x)/2,y2:a+r})]}):p.jsxs(p.Fragment,{children:[p.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),p.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),p.jsx("line",{x1:a,y1:l[0].y,x2:a,y2:c[0].y}),p.jsx("line",{x1:a-r,y1:(l[0].y+c[0].y)/2,x2:a+r,y2:(l[0].y+c[0].y)/2})]})},u))})}const lU=({className:e,line:t,zoom:n})=>p.jsx("svg",{className:fe("tl-overlays__item",e),children:t.type==="points"?p.jsx(iU,{...t,zoom:n}):t.type==="gaps"?p.jsx(aU,{...t,zoom:n}):null}),cU=()=>p.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:p.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[p.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),p.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:p.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),uU=()=>null,yA=b.createContext({});function dU({overrides:e,children:t}){return p.jsx(yA.Provider,{value:b.useMemo(()=>({Background:_B,SvgDefs:uU,Brush:Wh,ZoomBrush:Wh,ScreenshotBrush:Wh,CollaboratorBrush:Wh,Cursor:lk,CollaboratorCursor:lk,CollaboratorHint:jB,CollaboratorShapeIndicator:Ld,Grid:JB,Scribble:dk,SnapLine:lU,Handles:tU,Handle:eU,CollaboratorScribble:dk,ErrorFallback:fA,ShapeErrorFallback:oU,ShapeIndicatorErrorFallback:sU,Spinner:cU,SelectionBackground:mA,SelectionForeground:rU,HoveredShapeIndicator:nU,OnTheCanvas:null,InFrontOfTheCanvas:null,...e}),[e]),children:t})}function jt(){return b.useContext(yA)}const hU=["textarea","input"];function pU(e){const t=W();b.useEffect(()=>{const n=e.current;if(!n)return;const r=o=>{var s;if(o instanceof PointerEvent&&o.pointerType==="pen"){o.isKilled=!0;const{target:i}=o;if(hU.includes((s=i.tagName)==null?void 0:s.toLocaleLowerCase())||t.isIn("select.editing_shape"))return;Re(o)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.removeEventListener("touchend",r)}},[t,e])}function fU(e,t,n){return Math.max(t,Math.min(e,n))}const Wt={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function hk(e,t,n){return t===0||Math.abs(t)===1/0?Math.pow(e,n*5):e*t*n/(t+n*e)}function pk(e,t,n,r=.15){return r===0?fU(e,t,n):e<t?-hk(t-e,n-t,r)+t:e>n?+hk(e-n,n-t,r)+n:e}function gU(e,[t,n],[r,o]){const[[s,i],[a,l]]=e;return[pk(t,s,i,r),pk(n,a,l,o)]}function mU(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yU(e){var t=mU(e,"string");return typeof t=="symbol"?t:String(t)}function rn(e,t,n){return t=yU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fk(Object(n),!0).forEach(function(r){rn(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const vA={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function gk(e){return e?e[0].toUpperCase()+e.slice(1):""}const vU=["enter","leave"];function SU(e=!1,t){return e&&!vU.includes(t)}function xU(e,t="",n=!1){const r=vA[e],o=r&&r[t]||t;return"on"+gk(e)+gk(o)+(SU(n,o)?"Capture":"")}const wU=["gotpointercapture","lostpointercapture"];function bU(e){let t=e.substring(2).toLowerCase();const n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));const r=wU.includes(t)?"capturecapture":"capture",o=!!~t.indexOf(r);return o&&(t=t.replace("capture","")),{device:t,capture:o,passive:n}}function CU(e,t=""){const n=vA[e],r=n&&n[t]||t;return e+r}function SA(e){return"touches"in e}function PU(e){return SA(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function kU(e){return Array.from(e.touches).filter(t=>{var n,r;return t.target===e.currentTarget||((n=e.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,t.target))})}function zS(e,t){try{const n=t.clientX-e.clientX,r=t.clientY-e.clientY,o=(t.clientX+e.clientX)/2,s=(t.clientY+e.clientY)/2,i=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:i,origin:[o,s]}}catch{}return null}function EU(e){return kU(e).map(t=>t.identifier)}function mk(e,t){const[n,r]=Array.from(e.touches).filter(o=>t.includes(o.identifier));return zS(n,r)}const yk=40,vk=800;function xA(e){let{deltaX:t,deltaY:n,deltaMode:r}=e;return r===1?(t*=yk,n*=yk):r===2&&(t*=vk,n*=vk),[t,n]}function IU(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:n,altKey:r,metaKey:o,ctrlKey:s}=e;Object.assign(t,{shiftKey:n,altKey:r,metaKey:o,ctrlKey:s})}return t}function xg(e,...t){return typeof e=="function"?e(...t):e}function _U(){}function TU(...e){return e.length===0?_U:e.length===1?e[0]:function(){let t;for(const n of e)t=n.apply(this,arguments)||t;return t}}function Sk(e,t){return Object.assign({},t,e||{})}const MU=32;class wA{constructor(t,n,r){this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:n,ingKey:r,args:o}=this;n[r]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=o,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=t.target,n.currentTarget=t.currentTarget,n.lastOffset=r.from?xg(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=t.timeStamp)}computeValues(t){const n=this.state;n._values=t,n.values=this.config.transform(t)}computeInitial(){const t=this.state;t._initial=t._values,t.initial=t.values}compute(t){const{state:n,config:r,shared:o}=this;n.args=this.args;let s=0;if(t&&(n.event=t,r.preventDefault&&t.cancelable&&n.event.preventDefault(),n.type=t.type,o.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,o.locked=!!document.pointerLockElement,Object.assign(o,IU(t)),o.down=o.pressed=o.buttons%2===1||o.touches>0,s=t.timeStamp-n.timeStamp,n.timeStamp=t.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const k=n._delta.map(Math.abs);Wt.addTo(n._distance,k)}this.axisIntent&&this.axisIntent(t);const[i,a]=n._movement,[l,c]=r.threshold,{_step:u,values:d}=n;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(i)>=l&&d[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&d[1])):(u[0]===!1&&(u[0]=Math.abs(i)>=l&&Math.sign(i)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[k,I]=d;h[0]=u[0]!==!1?k-u[0]:0,h[1]=u[1]!==!1?I-u[1]:0}else h[0]=u[0]!==!1?i-u[0]:0,h[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(h);const f=n.offset,y=n._active&&!n._blocked||n.active;y&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=o[this.ingKey]=n._active,t&&(n.first&&("bounds"in r&&(n._bounds=xg(r.bounds,n)),this.setup&&this.setup()),n.movement=h,this.computeOffset()));const[g,m]=n.offset,[[v,x],[w,C]]=n._bounds;n.overflow=[g<v?-1:g>x?1:0,m<w?-1:m>C?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const P=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=gU(n._bounds,n.offset,P),n.delta=Wt.sub(n.offset,f),this.computeMovement(),y&&(!n.last||s>MU)){n.delta=Wt.sub(n.offset,f);const k=n.delta.map(Math.abs);Wt.addTo(n.distance,k),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&s>0&&(n.velocity=[k[0]/s,k[1]/s],n.timeDelta=s)}}emit(){const t=this.state,n=this.shared,r=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!r.triggerAllEvents)return;const o=this.handler(ht(ht(ht({},n),t),{},{[this.aliasKey]:t.values}));o!==void 0&&(t.memo=o)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function AU([e,t],n){const r=Math.abs(e),o=Math.abs(t);if(r>o&&r>n)return"x";if(o>r&&o>n)return"y"}class RU extends wA{constructor(...t){super(...t),rn(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Wt.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Wt.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){const n=this.state,r=this.config;if(!n.axis&&t){const o=typeof r.axisThreshold=="object"?r.axisThreshold[PU(t)]:r.axisThreshold;n.axis=AU(n._movement,o)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0;break}}}const OU=e=>e,xk=.15,bA={enabled(e=!0){return e},eventOptions(e,t,n){return ht(ht({},n.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[xk,xk];case!1:return[0,0];default:return Wt.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return Wt.toVector(e)},transform(e,t,n){const r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||OU},threshold(e){return Wt.toVector(e,0)}},jU=0,zd=ht(ht({},bA),{},{axis(e,t,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(e=jU){return e},bounds(e={}){if(typeof e=="function")return s=>zd.bounds(e(s));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:n=1/0,top:r=-1/0,bottom:o=1/0}=e;return[[t,n],[r,o]]}}),Bd=typeof window<"u"&&window.document&&window.document.createElement;function CA(){return Bd&&"ontouchstart"in window}function DU(){return CA()||Bd&&window.navigator.maxTouchPoints>1}function NU(){return Bd&&"onpointerdown"in window}function $U(){return Bd&&"exitPointerLock"in window.document}function LU(){try{return"constructor"in GestureEvent}catch{return!1}}const Ir={isBrowser:Bd,gesture:LU(),touch:CA(),touchscreen:DU(),pointer:NU(),pointerLock:$U()},FU=250,zU=180,BU=.5,UU=50,HU=250,VU=10,wk={mouse:0,touch:0,pen:8};ht(ht({},zd),{},{device(e,t,{pointer:{touch:n=!1,lock:r=!1,mouse:o=!1}={}}){return this.pointerLock=r&&Ir.pointerLock,Ir.touch&&n?"touch":this.pointerLock?"mouse":Ir.pointer&&!o?"pointer":Ir.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&e?FU:void 0,!(!Ir.touchscreen||n===!1))return e||(n!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:r=1,keys:o=!0}={}}){return this.pointerButtons=r,this.keys=o,!this.pointerLock&&this.device==="pointer"&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:r=3,axis:o=void 0}){const s=Wt.toVector(e,n?r:o?1:0);return this.filterTaps=n,this.tapsThreshold=r,s},swipe({velocity:e=BU,distance:t=UU,duration:n=HU}={}){return{velocity:this.transform(Wt.toVector(e)),distance:this.transform(Wt.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return zU;case!1:return 0;default:return e}},axisThreshold(e){return e?ht(ht({},wk),e):wk},keyboardDisplacement(e=VU){return e}});function PA(e){const[t,n]=e.overflow,[r,o]=e._delta,[s,i]=e._direction;(t<0&&r>0&&s<0||t>0&&r<0&&s>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&o>0&&i<0||n>0&&o<0&&i>0)&&(e._movement[1]=e._movementBound[1])}const KU=30,WU=100;class GU extends wA{constructor(...t){super(...t),rn(this,"ingKey","pinching"),rn(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const t=this.state;t._touchIds=[],t.canceled=!1,t.cancel=this.cancel.bind(this),t.turns=0}computeOffset(){const{type:t,movement:n,lastOffset:r}=this.state;t==="wheel"?this.state.offset=Wt.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:t,lastOffset:n}=this.state;this.state.movement=[t[0]/n[0],t[1]-n[1]]}axisIntent(){const t=this.state,[n,r]=t._movement;if(!t.axis){const o=Math.abs(n)*KU-Math.abs(r);o<0?t.axis="angle":o>0&&(t.axis="scale")}}restrictToAxis(t){this.config.lockDirection&&(this.state.axis==="scale"?t[1]=0:this.state.axis==="angle"&&(t[0]=0))}cancel(){const t=this.state;t.canceled||setTimeout(()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()},0)}touchStart(t){this.ctrl.setEventIds(t);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(s=>r.has(s))||r.size<2)return;this.start(t),n._touchIds=Array.from(r).slice(0,2);const o=mk(t,n._touchIds);o&&this.pinchStart(t,o)}pointerStart(t){if(t.buttons!=null&&t.buttons%2!==1)return;this.ctrl.setEventIds(t),t.target.setPointerCapture(t.pointerId);const n=this.state,r=n._pointerEvents,o=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(i=>o.has(i))||(r.size<2&&r.set(t.pointerId,t),n._pointerEvents.size<2))return;this.start(t);const s=zS(...Array.from(r.values()));s&&this.pinchStart(t,s)}pinchStart(t,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(t),this.emit()}touchMove(t){if(!this.state._active)return;const n=mk(t,this.state._touchIds);n&&this.pinchMove(t,n)}pointerMove(t){const n=this.state._pointerEvents;if(n.has(t.pointerId)&&n.set(t.pointerId,t),!this.state._active)return;const r=zS(...Array.from(n.values()));r&&this.pinchMove(t,r)}pinchMove(t,n){const r=this.state,o=r._values[1],s=n.angle-o;let i=0;Math.abs(s)>270&&(i+=Math.sign(s)),this.computeValues([n.distance,n.angle-360*i]),r.origin=n.origin,r.turns=i,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(t),this.emit()}touchEnd(t){this.ctrl.setEventIds(t),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(t),this.emit())}pointerEnd(t){const n=this.state;this.ctrl.setEventIds(t);try{t.target.releasePointerCapture(t.pointerId)}catch{}n._pointerEvents.has(t.pointerId)&&n._pointerEvents.delete(t.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(t),this.emit())}gestureStart(t){t.cancelable&&t.preventDefault();const n=this.state;n._active||(this.start(t),this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY],this.compute(t),this.emit())}gestureMove(t){if(t.cancelable&&t.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY];const r=n._movement;n._movement=[t.scale-1,t.rotation],n._delta=Wt.sub(n._movement,r),this.compute(t),this.emit()}gestureEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}wheel(t){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>t[r]):!t[n])||(this.state._active?this.wheelChange(t):this.wheelStart(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(t){this.start(t),this.wheelChange(t)}wheelChange(t){"uv"in t||t.cancelable&&t.preventDefault();const r=this.state;r._delta=[-xA(t)[1]/WU*r.offset[0],0],Wt.addTo(r._movement,r._delta),PA(r),this.state.origin=[t.clientX,t.clientY],this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){const n=this.config.device;n&&(t(n,"start",this[n+"Start"].bind(this)),t(n,"change",this[n+"Move"].bind(this)),t(n,"end",this[n+"End"].bind(this)),t(n,"cancel",this[n+"End"].bind(this)),t("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&t("wheel","",this.wheel.bind(this),{passive:!1})}}const YU=ht(ht({},bA),{},{device(e,t,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Ir.touch&&Ir.gesture)return"gesture";if(Ir.touch&&r)return"touch";if(Ir.touchscreen){if(Ir.pointer)return"pointer";if(Ir.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:r={}}){const o=i=>{const a=Sk(xg(n,i),{min:-1/0,max:1/0});return[a.min,a.max]},s=i=>{const a=Sk(xg(r,i),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[o(),s()]:i=>[o(i),s(i)]},threshold(e,t,n){return this.lockDirection=n.axis==="lock",Wt.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}});ht(ht({},zd),{},{mouseOnly:(e=!0)=>e});class XU extends RU{constructor(...t){super(...t),rn(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){const n=this.state;n._delta=xA(t),Wt.addTo(n._movement,n._delta),PA(n),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}}const qU=zd;ht(ht({},zd),{},{mouseOnly:(e=!0)=>e});const ib=new Map,BS=new Map;function QU(e){ib.set(e.key,e.engine),BS.set(e.key,e.resolver)}const ZU={key:"pinch",engine:GU,resolver:YU},JU={key:"wheel",engine:XU,resolver:qU};function eH(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,s;for(s=0;s<r.length;s++)o=r[s],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function tH(e,t){if(e==null)return{};var n=eH(e,t),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const nH={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Ir.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},rH=["target","eventOptions","window","enabled","transform"];function Lp(e={},t){const n={};for(const[r,o]of Object.entries(t))switch(typeof o){case"function":n[r]=o.call(n,e[r],r,e);break;case"object":n[r]=Lp(e[r],o);break;case"boolean":o&&(n[r]=e[r]);break}return n}function oH(e,t,n={}){const r=e,{target:o,eventOptions:s,window:i,enabled:a,transform:l}=r,c=tH(r,rH);if(n.shared=Lp({target:o,eventOptions:s,window:i,enabled:a,transform:l},nH),t){const u=BS.get(t);n[t]=Lp(ht({shared:n.shared},c),u)}else for(const u in c){const d=BS.get(u);d&&(n[u]=Lp(ht({shared:n.shared},c[u]),d))}return n}class kA{constructor(t,n){rn(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}add(t,n,r,o,s){const i=this._listeners,a=CU(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=ht(ht({},l),s);t.addEventListener(a,o,c);const u=()=>{t.removeEventListener(a,o,c),i.delete(u)};return i.add(u),u}clean(){this._listeners.forEach(t=>t()),this._listeners.clear()}}class sH{constructor(){rn(this,"_timeouts",new Map)}add(t,n,r=140,...o){this.remove(t),this._timeouts.set(t,window.setTimeout(n,r,...o))}remove(t){const n=this._timeouts.get(t);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(t=>void window.clearTimeout(t)),this._timeouts.clear()}}class iH{constructor(t){rn(this,"gestures",new Set),rn(this,"_targetEventStore",new kA(this)),rn(this,"gestureEventStores",{}),rn(this,"gestureTimeoutStores",{}),rn(this,"handlers",{}),rn(this,"config",{}),rn(this,"pointerIds",new Set),rn(this,"touchIds",new Set),rn(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),aH(this,t)}setEventIds(t){if(SA(t))return this.touchIds=new Set(EU(t)),this.touchIds;if("pointerId"in t)return t.type==="pointerup"||t.type==="pointercancel"?this.pointerIds.delete(t.pointerId):t.type==="pointerdown"&&this.pointerIds.add(t.pointerId),this.pointerIds}applyHandlers(t,n){this.handlers=t,this.nativeHandlers=n}applyConfig(t,n){this.config=oH(t,n,this.config)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const n=this.config.shared,r={};let o;if(!(n.target&&(o=n.target(),!o))){if(n.enabled){for(const i of this.gestures){const a=this.config[i],l=bk(r,a.eventOptions,!!o);if(a.enabled){const c=ib.get(i);new c(this,t,i).bind(l)}}const s=bk(r,n.eventOptions,!!o);for(const i in this.nativeHandlers)s(i,"",a=>this.nativeHandlers[i](ht(ht({},this.state.shared),{},{event:a,args:t})),void 0,!0)}for(const s in r)r[s]=TU(...r[s]);if(!o)return r;for(const s in r){const{device:i,capture:a,passive:l}=bU(s);this._targetEventStore.add(o,i,"",r[s],{capture:a,passive:l})}}}}function Ba(e,t){e.gestures.add(t),e.gestureEventStores[t]=new kA(e,t),e.gestureTimeoutStores[t]=new sH}function aH(e,t){t.drag&&Ba(e,"drag"),t.wheel&&Ba(e,"wheel"),t.scroll&&Ba(e,"scroll"),t.move&&Ba(e,"move"),t.pinch&&Ba(e,"pinch"),t.hover&&Ba(e,"hover")}const bk=(e,t,n)=>(r,o,s,i={},a=!1)=>{var l,c;const u=(l=i.capture)!==null&&l!==void 0?l:t.capture,d=(c=i.passive)!==null&&c!==void 0?c:t.passive;let h=a?r:xU(r,o,u);n&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(s)},lH=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function cH(e){const t={},n={},r=new Set;for(let o in e)lH.test(o)?(r.add(RegExp.lastMatch),n[o]=e[o]):t[o]=e[o];return[n,t,r]}function Ua(e,t,n,r,o,s){if(!e.has(n)||!ib.has(r))return;const i=n+"Start",a=n+"End",l=c=>{let u;return c.first&&i in t&&t[i](c),n in t&&(u=t[n](c)),c.last&&a in t&&t[a](c),u};o[r]=l,s[r]=s[r]||{}}function uH(e,t){const[n,r,o]=cH(e),s={};return Ua(o,n,"onDrag","drag",s,t),Ua(o,n,"onWheel","wheel",s,t),Ua(o,n,"onScroll","scroll",s,t),Ua(o,n,"onPinch","pinch",s,t),Ua(o,n,"onMove","move",s,t),Ua(o,n,"onHover","hover",s,t),{handlers:s,config:t,nativeHandlers:r}}function dH(e,t={},n,r){const o=H.useMemo(()=>new iH(e),[]);if(o.applyHandlers(e,r),o.applyConfig(t,n),H.useEffect(o.effect.bind(o)),H.useEffect(()=>o.clean.bind(o),[]),t.target===void 0)return o.bind.bind(o)}function hH(e){return e.forEach(QU),function(n,r){const{handlers:o,nativeHandlers:s,config:i}=uH(n,r||{});return dH(o,i,void 0,s)}}const Ck=10,pH=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function EA(e){let{deltaY:t,deltaX:n}=e,r=0;if(e.ctrlKey||e.altKey||e.metaKey){const o=Math.sign(e.deltaY),s=Math.abs(e.deltaY);let i=t;s>Ck&&(i=Ck*o),r=i/100}else e.shiftKey&&!pH&&(n=t,t=0);return{x:-n,y:-t,z:-r}}const fH=hH([JU,ZU]);let Ha;const gH=e=>Ha===void 0?(Ha=e,!1):e-Ha>120&&e-Ha<160?(Ha=e,!0):(Ha=e,!1);function mH(e){const t=W(),n=b.useMemo(()=>{let r="not sure";const o=({event:g})=>{if(!t.getInstanceState().isFocused||(r="not sure",gH(Date.now())))return;const m=t.getEditingShapeId();if(m){const C=t.getShape(m);if(C&&t.getShapeUtil(C).canScroll(C)){const k=t.getShapePageBounds(m);if(k!=null&&k.containsPoint(t.inputs.currentPagePoint))return}}Re(g);const v=EA(g);if(v.x===0&&v.y===0)return;const x=t.getContainer().getBoundingClientRect(),w={type:"wheel",name:"wheel",delta:v,point:new E(g.clientX,g.clientY).sub({x:x.left,y:x.top}),shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey};t.dispatch(w)};let s=1,i=1,a=1,l=0;const c=new E,u=new E,d=g=>{const m=e.current;r="not sure";const{event:v,origin:x,da:w}=g;v instanceof WheelEvent||(v.target===m||m!=null&&m.contains(v.target))&&(u.x=x[0],u.y=x[1],c.x=x[0],c.y=x[1],s=w[0],i=t.getZoomLevel(),t.dispatch({type:"pinch",name:"pinch_start",point:{x:x[0],y:x[1],z:t.getZoomLevel()},delta:{x:0,y:0},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey}))},h=g=>{if(g&&(r="zooming"),r==="zooming")return;const m=Math.abs(l-s),v=E.Dist(c,u);switch(r){case"not sure":{m>24?r="zooming":v>16&&(r="panning");break}case"panning":{m>64&&(r="zooming");break}}};return{onWheel:o,onPinchStart:d,onPinchEnd:g=>{const m=e.current,{event:v,origin:x,offset:w}=g;if(v instanceof WheelEvent||!(v.target===m||m!=null&&m.contains(v.target)))return;const C=w[0];r="not sure",requestAnimationFrame(()=>{t.dispatch({type:"pinch",name:"pinch_end",point:{x:x[0],y:x[1],z:C},delta:{x:x[0],y:x[1]},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey})})},onPinch:g=>{const m=e.current,{event:v,origin:x,offset:w,da:C}=g;if(v instanceof WheelEvent||!(v.target===m||m!=null&&m.contains(v.target)))return;const P=g.type==="gesturechange"||g.type==="gestureend";l=C[0];const k=x[0]-u.x,I=x[1]-u.y;switch(u.x=x[0],u.y=x[1],h(P),r){case"zooming":{a=w[0],t.dispatch({type:"pinch",name:"pinch",point:{x:x[0],y:x[1],z:a},delta:{x:k,y:I},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey});break}case"panning":{t.dispatch({type:"pinch",name:"pinch",point:{x:x[0],y:x[1],z:i},delta:{x:k,y:I},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey});break}}}}},[t,e]);fH(n,{target:e,eventOptions:{passive:!1},pinch:{from:()=>[t.getZoomLevel(),0],scaleBounds:()=>({from:t.getZoomLevel(),max:8,min:.05})}})}function Yy(e,t,n){const r=e.getShape(t),o=e.getShapeHandles(r);return{shape:r,handle:o.find(s=>s.id===n)}}function yH(e,t){const n=W();return b.useMemo(()=>{const r=l=>{if(l.isKilled)return;const c=gg(l.currentTarget);Nd(c,l);const{shape:u,handle:d}=Yy(n,e,t);d&&n.dispatch({type:"pointer",target:"handle",handle:d,shape:u,name:"pointer_down",...Fn(l)})};let o,s;return{onPointerDown:r,onPointerMove:l=>{if(l.isKilled||l.clientX===o&&l.clientY===s)return;o=l.clientX,s=l.clientY;const{shape:c,handle:u}=Yy(n,e,t);u&&n.dispatch({type:"pointer",target:"handle",handle:u,shape:c,name:"pointer_move",...Fn(l)})},onPointerUp:l=>{if(l.isKilled)return;const c=gg(l.currentTarget);$d(c,l);const{shape:u,handle:d}=Yy(n,e,t);d&&n.dispatch({type:"pointer",target:"handle",handle:d,shape:u,name:"pointer_up",...Fn(l)})}}},[n,e,t])}var IA="Expected a function",Pk=NaN,vH="[object Symbol]",SH=/^\s+|\s+$/g,xH=/^[-+]0x[0-9a-f]+$/i,wH=/^0b[01]+$/i,bH=/^0o[0-7]+$/i,CH=parseInt,PH=typeof Kt=="object"&&Kt&&Kt.Object===Object&&Kt,kH=typeof self=="object"&&self&&self.Object===Object&&self,EH=PH||kH||Function("return this")(),IH=Object.prototype,_H=IH.toString,TH=Math.max,MH=Math.min,Xy=function(){return EH.Date.now()};function AH(e,t,n){var r,o,s,i,a,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(IA);t=kk(t)||0,wg(n)&&(u=!!n.leading,d="maxWait"in n,s=d?TH(kk(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function f(k){var I=r,_=o;return r=o=void 0,c=k,i=e.apply(_,I),i}function y(k){return c=k,a=setTimeout(v,t),u?f(k):i}function g(k){var I=k-l,_=k-c,M=t-I;return d?MH(M,s-_):M}function m(k){var I=k-l,_=k-c;return l===void 0||I>=t||I<0||d&&_>=s}function v(){var k=Xy();if(m(k))return x(k);a=setTimeout(v,g(k))}function x(k){return a=void 0,h&&r?f(k):(r=o=void 0,i)}function w(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function C(){return a===void 0?i:x(Xy())}function P(){var k=Xy(),I=m(k);if(r=arguments,o=this,l=k,I){if(a===void 0)return y(l);if(d)return a=setTimeout(v,t),f(l)}return a===void 0&&(a=setTimeout(v,t)),i}return P.cancel=w,P.flush=C,P}function RH(e,t,n){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(IA);return wg(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),AH(e,t,{leading:r,maxWait:t,trailing:o})}function wg(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function OH(e){return!!e&&typeof e=="object"}function jH(e){return typeof e=="symbol"||OH(e)&&_H.call(e)==vH}function kk(e){if(typeof e=="number")return e;if(jH(e))return Pk;if(wg(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=wg(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(SH,"");var n=wH.test(e);return n||bH.test(e)?CH(e.slice(2),n?2:8):xH.test(e)?Pk:+e}var DH=RH;const NH=xa(DH);function $H(){const e=W();b.useLayoutEffect(()=>{const t=NH(()=>{e.updateViewportScreenBounds()},200,{trailing:!0});e.updateViewportScreenBounds();const n=setInterval(t,1e3);return window.addEventListener("resize",t),window.addEventListener("scroll",t),()=>{clearInterval(n),window.removeEventListener("resize",t),window.removeEventListener("scroll",t)}},[e])}const it=class it{constructor(t=0,n=0,r=0,o=0){S(this,"x",0);S(this,"y",0);S(this,"w",0);S(this,"h",0);this.x=t,this.y=n,this.w=r,this.h=o}get point(){return new E(this.x,this.y)}set point(t){this.x=t.x,this.y=t.y}get minX(){return this.x}set minX(t){this.x=t}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(t){this.y=t}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(t){this.w=t}get height(){return this.h}set height(t){this.h=t}get aspectRatio(){return this.width/this.height}get center(){return new E(this.midX,this.midY)}set center(t){this.minX=t.x-this.width/2,this.minY=t.y-this.height/2}get corners(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY)]}get snapPoints(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY),this.center]}get sides(){const{corners:t}=this;return[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]]}get size(){return new E(this.w,this.h)}toFixed(){return this.x=Kh(this.x),this.y=Kh(this.y),this.w=Kh(this.w),this.h=Kh(this.h),this}setTo(t){return this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this}set(t=0,n=0,r=0,o=0){return this.x=t,this.y=n,this.w=r,this.h=o,this}expand(t){const n=Math.min(this.minX,t.minX),r=Math.min(this.minY,t.minY),o=Math.max(this.maxX,t.maxX),s=Math.max(this.maxY,t.maxY);return this.x=n,this.y=r,this.w=o-n,this.h=s-r,this}expandBy(t){return this.x-=t,this.y-=t,this.w+=t*2,this.h+=t*2,this}scale(t){return this.x/=t,this.y/=t,this.w/=t,this.h/=t,this}clone(){const{x:t,y:n,w:r,h:o}=this;return new it(t,n,r,o)}translate(t){return this.x+=t.x,this.y+=t.y,this}snapToGrid(t){const n=Math.round(this.minX/t)*t,r=Math.round(this.minY/t)*t,o=Math.round(this.maxX/t)*t,s=Math.round(this.maxY/t)*t;this.minX=n,this.minY=r,this.width=Math.max(1,o-n),this.height=Math.max(1,s-r)}collides(t){return it.Collides(this,t)}contains(t){return it.Contains(this,t)}includes(t){return it.Includes(this,t)}containsPoint(t,n=0){return it.ContainsPoint(this,t,n)}getHandlePoint(t){switch(t){case"top_left":return new E(this.minX,this.minY);case"top_right":return new E(this.maxX,this.minY);case"bottom_left":return new E(this.minX,this.maxY);case"bottom_right":return new E(this.maxX,this.maxY);case"top":return new E(this.midX,this.minY);case"right":return new E(this.maxX,this.midY);case"bottom":return new E(this.midX,this.maxY);case"left":return new E(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(t,n,r){const{minX:o,minY:s,maxX:i,maxY:a}=this;let{minX:l,minY:c,maxX:u,maxY:d}=this;switch(t){case"left":case"top_left":case"bottom_left":{l+=n;break}case"right":case"top_right":case"bottom_right":{u+=n;break}}switch(t){case"top":case"top_left":case"top_right":{c+=r;break}case"bottom":case"bottom_left":case"bottom_right":{d+=r;break}}const h=(u-l)/(i-o),f=(d-c)/(a-s),y=h<0,g=f<0;if(y){const m=u;u=l,l=m}if(g){const m=d;d=c,c=m}this.minX=l,this.minY=c,this.width=Math.abs(u-l),this.height=Math.abs(d-c)}union(t){const n=Math.min(this.minX,t.x),r=Math.min(this.minY,t.y),o=Math.max(this.maxX,t.w+t.x),s=Math.max(this.maxY,t.h+t.y);return this.x=n,this.y=r,this.width=o-n,this.height=s-r,this}static From(t){return new it(t.x,t.y,t.w,t.h)}static FromPoints(t){if(t.length===0)return new it;let n=1/0,r=1/0,o=-1/0,s=-1/0,i;for(let a=0,l=t.length;a<l;a++)i=t[a],n=Math.min(i.x,n),r=Math.min(i.y,r),o=Math.max(i.x,o),s=Math.max(i.y,s);return new it(n,r,o-n,s-r)}static Expand(t,n){const r=Math.min(n.minX,t.minX),o=Math.min(n.minY,t.minY),s=Math.max(n.maxX,t.maxX),i=Math.max(n.maxY,t.maxY);return new it(r,o,s-r,i-o)}static ExpandBy(t,n){return new it(t.minX-n,t.minY-n,t.width+n*2,t.height+n*2)}static Resize(t,n,r,o,s=!1){const{minX:i,minY:a,maxX:l,maxY:c}=t;let{minX:u,minY:d,maxX:h,maxY:f}=t;switch(n){case"left":case"top_left":case"bottom_left":{u+=r;break}case"right":case"top_right":case"bottom_right":{h+=r;break}}switch(n){case"top":case"top_left":case"top_right":{d+=o;break}case"bottom":case"bottom_left":case"bottom_right":{f+=o;break}}const y=(h-u)/(l-i),g=(f-d)/(c-a),m=y<0,v=g<0;if(s){const w=(l-i)/(c-a),C=Math.abs(h-u),P=Math.abs(f-d),k=C*(g<0?1:-1)*(1/w),I=P*(y<0?1:-1)*w,_=w<C/P;switch(n){case"top_left":{_?d=f+k:u=h+I;break}case"top_right":{_?d=f+k:h=u-I;break}case"bottom_right":{_?f=d-k:h=u-I;break}case"bottom_left":{_?f=d-k:u=h+I;break}case"bottom":case"top":{const M=(u+h)/2,T=P*w;u=M-T/2,h=M+T/2;break}case"left":case"right":{const M=(d+f)/2,T=C/w;d=M-T/2,f=M+T/2;break}}}if(m){const w=h;h=u,u=w}if(v){const w=f;f=d,d=w}const x=new it(u,d,Math.abs(h-u),Math.abs(f-d));return{box:x,scaleX:+(x.width/t.width*(y>0?1:-1)).toFixed(5),scaleY:+(x.height/t.height*(g>0?1:-1)).toFixed(5)}}equals(t){return it.Equals(this,t)}static Equals(t,n){return n.x===t.x&&n.y===t.y&&n.w===t.w&&n.h===t.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(t){return new it(t.x,t.y,Math.max(1,t.w),Math.max(1,t.h))}};S(it,"Collides",(t,n)=>!(t.maxX<n.minX||t.minX>n.maxX||t.maxY<n.minY||t.minY>n.maxY)),S(it,"Contains",(t,n)=>t.minX<n.minX&&t.minY<n.minY&&t.maxY>n.maxY&&t.maxX>n.maxX),S(it,"Includes",(t,n)=>it.Collides(t,n)||it.Contains(t,n)),S(it,"ContainsPoint",(t,n,r=0)=>!(n.x<t.minX-r||n.y<t.minY-r||n.x>t.maxX+r||n.y>t.maxY+r)),S(it,"Common",t=>{let n=1/0,r=1/0,o=-1/0,s=-1/0;for(let i=0;i<t.length;i++){const a=t[i];n=Math.min(n,a.minX),r=Math.min(r,a.minY),o=Math.max(o,a.maxX),s=Math.max(s,a.maxY)}return new it(n,r,o-n,s-r)}),S(it,"Sides",(t,n=0)=>{const{corners:r}=t;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let le=it;function LH(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}function FH(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}function zH(e){return e==="top_left"||e==="top_right"||e==="bottom_right"||e==="bottom_left"}const Ne=class Ne{constructor(t,n,r,o,s,i){S(this,"a",1);S(this,"b",0);S(this,"c",0);S(this,"d",1);S(this,"e",0);S(this,"f",0);this.a=t,this.b=n,this.c=r,this.d=o,this.e=s,this.f=i}equals(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(t){const n=t,{a:r,b:o,c:s,d:i,e:a,f:l}=this;return this.a=r*n.a+s*n.b,this.c=r*n.c+s*n.d,this.e=r*n.e+s*n.f+a,this.b=o*n.a+i*n.b,this.d=o*n.c+i*n.d,this.f=o*n.e+i*n.f+l,this}rotate(t,n,r){return t===0?this:n===void 0?this.multiply(Ne.Rotate(t)):this.translate(n,r).multiply(Ne.Rotate(t)).translate(-n,-r)}translate(t,n){return this.multiply(Ne.Translate(t,n))}scale(t,n){return this.multiply(Ne.Scale(t,n))}invert(){const{a:t,b:n,c:r,d:o,e:s,f:i}=this,a=t*o-n*r;return this.a=o/a,this.b=n/-a,this.c=r/-a,this.d=t/a,this.e=(o*s-r*i)/-a,this.f=(n*s-t*i)/a,this}applyToPoint(t){return Ne.applyToPoint(this,t)}applyToPoints(t){return Ne.applyToPoints(this,t)}rotation(){return Ne.Rotation(this)}point(){return Ne.Point(this)}decomposed(){return Ne.Decompose(this)}toCssString(){return Ne.toCssString(this)}setTo(t){return Object.assign(this,t),this}decompose(){return Ne.Decompose(this)}clone(){return new Ne(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new Ne(1,0,0,1,0,0)}static Translate(t,n){return new Ne(1,0,0,1,t,n)}static Rotate(t,n,r){if(t===0)return Ne.Identity();const o=Math.cos(t),s=Math.sin(t),i=new Ne(o,s,-s,o,0,0);return n===void 0?i:Ne.Compose(Ne.Translate(n,r),i,Ne.Translate(-n,-r))}static Multiply(t,n){return{a:t.a*n.a+t.c*n.b,c:t.a*n.c+t.c*n.d,e:t.a*n.e+t.c*n.f+t.e,b:t.b*n.a+t.d*n.b,d:t.b*n.c+t.d*n.d,f:t.b*n.e+t.d*n.f+t.f}}static Inverse(t){const n=t.a*t.d-t.b*t.c;return{a:t.d/n,b:t.b/-n,c:t.c/-n,d:t.a/n,e:(t.d*t.e-t.c*t.f)/-n,f:(t.b*t.e-t.a*t.f)/n}}static Absolute(t){const n=t.a*t.d-t.b*t.c;return{a:t.d/n,b:t.b/-n,c:t.c/-n,d:t.a/n,e:(t.d*t.e-t.c*t.f)/n,f:(t.b*t.e-t.a*t.f)/-n}}static Compose(...t){const n=Ne.Identity();for(let r=0,o=t.length;r<o;r++)n.multiply(t[r]);return n}static Point(t){return new E(t.e,t.f)}static Rotation(t){let n;if(t.a!==0||t.c!==0){const r=Math.hypot(t.a,t.c);n=Math.acos(t.a/r)*(t.c>0?-1:1)}else if(t.b!==0||t.d!==0){const r=Math.hypot(t.b,t.d);n=Ze+Math.acos(t.b/r)*(t.d>0?-1:1)}else n=0;return LS(n)}static Decompose(t){let n,r,o;if(t.a!==0||t.c!==0){const s=Math.hypot(t.a,t.c);n=s,r=(t.a*t.d-t.b*t.c)/s,o=Math.acos(t.a/s)*(t.c>0?-1:1)}else if(t.b!==0||t.d!==0){const s=Math.hypot(t.b,t.d);n=(t.a*t.d-t.b*t.c)/s,r=s,o=Ze+Math.acos(t.b/s)*(t.d>0?-1:1)}else n=0,r=0,o=0;return{x:t.e,y:t.f,scaleX:n,scaleY:r,rotation:LS(o)}}static Smooth(t,n=1e10){return t.a=Math.round(t.a*n)/n,t.b=Math.round(t.b*n)/n,t.c=Math.round(t.c*n)/n,t.d=Math.round(t.d*n)/n,t.e=Math.round(t.e*n)/n,t.f=Math.round(t.f*n)/n,t}static toCssString(t){return`matrix(${O(t.a)}, ${O(t.b)}, ${O(t.c)}, ${O(t.d)}, ${O(t.e)}, ${O(t.f)})`}static applyToPoint(t,n){return new E(t.a*n.x+t.c*n.y+t.e,t.b*n.x+t.d*n.y+t.f,n.z)}static applyToXY(t,n,r){return[t.a*n+t.c*r+t.e,t.b*n+t.d*r+t.f]}static applyToPoints(t,n){return n.map(r=>new E(t.a*r.x+t.c*r.y+t.e,t.b*r.x+t.d*r.y+t.f,r.z))}static applyToBounds(t,n){return new le(t.e+n.minX,t.f+n.minY,n.width,n.height)}static From(t){return new Ne(t.a,t.b,t.c,t.d,t.e,t.f)}static Cast(t){return t instanceof Ne?t:Ne.From(t)}};S(Ne,"Scale",(t,n,r,o)=>{const s=new Ne(t,0,0,n,0,0);return r===void 0?s:Ne.Compose(Ne.Translate(r,o),s,Ne.Translate(-r,-o))});let se=Ne;function BH(e=!0){const[t,n]=b.useState(0),r=W();b.useEffect(()=>{if(!e)return;const o=()=>n(s=>s+1);return r.on("tick",o),()=>{r.off("tick",o)}},[r,e])}const UH=Ve(function({showStroke:t=!0,showVertices:n=!0,showClosestPointOnOutline:r=!0}){const o=W();BH(r);const s=o.getZoomLevel(),i=o.getRenderingShapes(),{inputs:{currentPagePoint:a}}=o;return p.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:i.map(l=>{const c=o.getShape(l.id);if(c.type==="group")return null;const u=o.getShapeGeometry(c),d=o.getShapePageTransform(c),h=o.getPointInShapeSpace(c,a),f=u.nearestPoint(h),y=u.distanceToPoint(h,!0),g=Math.abs(y)*s,m=y<0,{vertices:v}=u;return p.jsxs("g",{transform:d.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[t&&p.jsx("path",{stroke:"red",strokeWidth:"2",fill:"none",opacity:"1",d:u.toSimpleSvgPath()}),n&&v.map((x,w)=>p.jsx("circle",{cx:x.x,cy:x.y,r:"2",fill:`hsl(${sg(w,[0,v.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${w}`)),r&&g<150&&p.jsx("line",{x1:f.x,y1:f.y,x2:h.x,y2:h.y,opacity:1-g/150,stroke:m?"goldenrod":"dodgerblue",strokeWidth:"2"})]},l.id+"_outline")})})});var HH=200,ab="__lodash_hash_undefined__",VH=1/0,KH="[object Function]",WH="[object GeneratorFunction]",GH=/[\\^$.*+?()[\]{}|]/g,YH=/^\[object .+?Constructor\]$/,XH=typeof Kt=="object"&&Kt&&Kt.Object===Object&&Kt,qH=typeof self=="object"&&self&&self.Object===Object&&self,lb=XH||qH||Function("return this")();function QH(e,t){var n=e?e.length:0;return!!n&&JH(e,t,0)>-1}function ZH(e,t,n,r){for(var o=e.length,s=n+-1;++s<o;)if(t(e[s],s,e))return s;return-1}function JH(e,t,n){if(t!==t)return ZH(e,eV,n);for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function eV(e){return e!==e}function tV(e,t){return e.has(t)}function nV(e,t){return e==null?void 0:e[t]}function rV(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function _A(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var oV=Array.prototype,sV=Function.prototype,TA=Object.prototype,qy=lb["__core-js_shared__"],Ek=function(){var e=/[^.]+$/.exec(qy&&qy.keys&&qy.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),MA=sV.toString,cb=TA.hasOwnProperty,iV=TA.toString,aV=RegExp("^"+MA.call(cb).replace(GH,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lV=oV.splice,cV=ub(lb,"Map"),Qy=ub(lb,"Set"),dd=ub(Object,"create");function ya(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function uV(){this.__data__=dd?dd(null):{}}function dV(e){return this.has(e)&&delete this.__data__[e]}function hV(e){var t=this.__data__;if(dd){var n=t[e];return n===ab?void 0:n}return cb.call(t,e)?t[e]:void 0}function pV(e){var t=this.__data__;return dd?t[e]!==void 0:cb.call(t,e)}function fV(e,t){var n=this.__data__;return n[e]=dd&&t===void 0?ab:t,this}ya.prototype.clear=uV;ya.prototype.delete=dV;ya.prototype.get=hV;ya.prototype.has=pV;ya.prototype.set=fV;function Sc(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function gV(){this.__data__=[]}function mV(e){var t=this.__data__,n=wm(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():lV.call(t,n,1),!0}function yV(e){var t=this.__data__,n=wm(t,e);return n<0?void 0:t[n][1]}function vV(e){return wm(this.__data__,e)>-1}function SV(e,t){var n=this.__data__,r=wm(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}Sc.prototype.clear=gV;Sc.prototype.delete=mV;Sc.prototype.get=yV;Sc.prototype.has=vV;Sc.prototype.set=SV;function xc(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function xV(){this.__data__={hash:new ya,map:new(cV||Sc),string:new ya}}function wV(e){return bm(this,e).delete(e)}function bV(e){return bm(this,e).get(e)}function CV(e){return bm(this,e).has(e)}function PV(e,t){return bm(this,e).set(e,t),this}xc.prototype.clear=xV;xc.prototype.delete=wV;xc.prototype.get=bV;xc.prototype.has=CV;xc.prototype.set=PV;function bg(e){var t=-1,n=e?e.length:0;for(this.__data__=new xc;++t<n;)this.add(e[t])}function kV(e){return this.__data__.set(e,ab),this}function EV(e){return this.__data__.has(e)}bg.prototype.add=bg.prototype.push=kV;bg.prototype.has=EV;function wm(e,t){for(var n=e.length;n--;)if(jV(e[n][0],t))return n;return-1}function IV(e){if(!AA(e)||AV(e))return!1;var t=DV(e)||rV(e)?aV:YH;return t.test(RV(e))}function _V(e,t,n){var r=-1,o=QH,s=e.length,i=!0,a=[],l=a;if(s>=HH){var c=TV(e);if(c)return _A(c);i=!1,o=tV,l=new bg}else l=a;e:for(;++r<s;){var u=e[r],d=u;if(u=u!==0?u:0,i&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;a.push(u)}else o(l,d,n)||(l!==a&&l.push(d),a.push(u))}return a}var TV=Qy&&1/_A(new Qy([,-0]))[1]==VH?function(e){return new Qy(e)}:NV;function bm(e,t){var n=e.__data__;return MV(t)?n[typeof t=="string"?"string":"hash"]:n.map}function ub(e,t){var n=nV(e,t);return IV(n)?n:void 0}function MV(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function AV(e){return!!Ek&&Ek in e}function RV(e){if(e!=null){try{return MA.call(e)}catch{}try{return e+""}catch{}}return""}function OV(e){return e&&e.length?_V(e):[]}function jV(e,t){return e===t||e!==e&&t!==t}function DV(e){var t=AA(e)?iV.call(e):"";return t==KH||t==WH}function AA(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function NV(){}var $V=OV;const LV=xa($V);function RA(e){return LV(e)}function FV(){const e=W(),t=b.useMemo(()=>e.store.query.records("instance_presence",()=>({userId:{neq:e.user.getId()}})),[e]),n=HM("userIds",()=>RA(t.get().map(r=>r.userId)).sort(),{isEqual:(r,o)=>{var s;return r.join(",")===((s=o.join)==null?void 0:s.call(o,","))}},[t]);return q(n)}function OA(e){const t=W(),n=b.useMemo(()=>t.store.query.records("instance_presence",()=>({userId:{eq:e}})),[t,e]);return q(`latestPresence:${e}`,()=>n.get().slice().sort((o,s)=>s.lastActivityTimestamp-o.lastActivityTimestamp)[0],[])??null}const zV=Ve(function(){const t=FV();return p.jsx(p.Fragment,{children:t.map(n=>p.jsx(BV,{collaboratorId:n},n))})}),BV=Ve(function({collaboratorId:t}){const n=W(),r=OA(t),o=HV(r);if(!(r&&r.currentPageId===n.getCurrentPageId()))return null;switch(o){case"inactive":{const{followingUserId:s,highlightedUserIds:i}=n.getInstanceState();if(!(s===r.userId||i.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:s}=n.getInstanceState();if(r.followingUserId===n.user.getId()&&!(r.chatMessage||s.includes(r.userId)))return null;break}}return p.jsx(UV,{latestPresence:r})}),UV=Ve(function({latestPresence:t}){const n=W(),{CollaboratorBrush:r,CollaboratorScribble:o,CollaboratorCursor:s,CollaboratorHint:i,CollaboratorShapeIndicator:a}=jt(),l=n.getZoomLevel(),c=n.getViewportPageBounds(),{userId:u,chatMessage:d,brush:h,scribbles:f,selectedShapeIds:y,userName:g,cursor:m,color:v}=t,x=!(m.x<c.minX-12/l||m.y<c.minY-16/l||m.x>c.maxX-12/l||m.y>c.maxY-16/l);return p.jsxs(p.Fragment,{children:[h&&r?p.jsx(r,{className:"tl-collaborator__brush",brush:h,color:v,opacity:.1},u+"_brush"):null,x&&s?p.jsx(s,{className:"tl-collaborator__cursor",point:m,color:v,zoom:l,name:g!=="New User"?g:null,chatMessage:d},u+"_cursor"):i?p.jsx(i,{className:"tl-collaborator__cursor-hint",point:m,color:v,zoom:l,viewport:c},u+"_cursor_hint"):null,o&&f.length?p.jsx(p.Fragment,{children:f.map(w=>p.jsx(o,{className:"tl-collaborator__scribble",scribble:w,color:v,zoom:l,opacity:w.color==="laser"?.5:.1},u+"_scribble_"+w.id))}):null,a&&y.map(w=>p.jsx(a,{className:"tl-collaborator__shape-indicator",id:w,color:v,opacity:.5},u+"_"+w))]})});function Ik(e){return e>YB?"inactive":e>gA?"idle":"active"}function HV(e){const t=b.useRef((e==null?void 0:e.lastActivityTimestamp)??-1),[n,r]=b.useState(()=>Ik(Date.now()-t.current));return b.useEffect(()=>{const o=setInterval(()=>{r(Ik(Date.now()-t.current))},XB);return()=>clearInterval(o)},[]),e&&(t.current=e.lastActivityTimestamp),n}function jA(e,t){return t===0?e:jA(t,e%t)}function DA(e){const t=e.toString().split(".")[1];if(!t)return 1;const n=Math.pow(10,t.length),r=parseInt(t,10);return n/jA(r,n)}function VV(){const e=W(),t=mn();b.useEffect(()=>Od("useDPRMultiple",()=>{const n=e.getInstanceState().devicePixelRatio;t.style.setProperty("--tl-dpr-multiple",DA(n).toString())}),[e,t])}const NA=Ve(function({id:t,shape:n,util:r,index:o,backgroundIndex:s,opacity:i,isCulled:a}){const l=W(),{ShapeErrorFallback:c}=jt(),u=b.useRef(null),d=b.useRef(null),h=b.useCallback((y,g)=>{var m,v;(m=u.current)==null||m.style.setProperty(y,g),(v=d.current)==null||v.style.setProperty(y,g)},[]);aa("set shape container transform position",()=>{if(!l.getShape(t))return;const g=l.getShapePageTransform(t),m=se.toCssString(g);h("transform",m)},[l,h]),aa("set shape container clip path",()=>{if(!l.getShape(t))return null;const g=l.getShapeClipPath(t);h("clip-path",g??"none")},[l,h]),aa("set shape height and width",()=>{const y=l.getShape(t);if(!y)return null;const g=l.getShapeGeometry(y).bounds,m=Math.floor(l.getInstanceState().devicePixelRatio*100)/100,v=DA(m),x=g.w%v,w=x===0?g.w:g.w+(v-x),C=g.h%v,P=C===0?g.h:g.h+(v-C);h("width",Math.max(w,v)+"px"),h("height",Math.max(P,v)+"px")},[l]),b.useLayoutEffect(()=>{var y,g;h("opacity",i+""),(y=u.current)==null||y.style.setProperty("z-index",o+""),(g=d.current)==null||g.style.setProperty("z-index",s+"")},[i,o,s,h]);const f=b.useCallback(y=>{l.annotateError(y,{origin:"react.shape",willCrashApp:!1})},[l]);return n?p.jsxs(p.Fragment,{children:[r.backgroundComponent&&p.jsx("div",{ref:d,className:"tl-shape tl-shape-background","data-shape-type":n.type,draggable:!1,children:!a&&p.jsx(ld,{fallback:c,onError:f,children:p.jsx(WV,{shape:n,util:r})})}),p.jsx("div",{ref:u,className:"tl-shape","data-shape-type":n.type,draggable:!1,children:a?p.jsx(GV,{shape:n}):p.jsx(ld,{fallback:c,onError:f,children:p.jsx(KV,{shape:n,util:r})})})]}):null}),KV=b.memo(function({shape:t,util:n}){return mm("InnerShape:"+t.type,()=>n.component(t))},(e,t)=>e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta&&e.util===t.util),WV=b.memo(function({shape:t,util:n}){return mm("InnerShape:"+t.type,()=>{var r;return(r=n.backgroundComponent)==null?void 0:r.call(n,t)})},(e,t)=>e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta),GV=b.memo(function({shape:t}){const r=W().getShapeGeometry(t).bounds;return p.jsx("div",{className:"tl-shape__culled",style:{transform:`translate(${O(r.minX)}px, ${O(r.minY)}px)`,width:Math.max(1,O(r.width)),height:Math.max(1,O(r.height))}})},()=>!0);function db({className:e}){const t=W(),{Background:n,SvgDefs:r}=jt(),o=H.useRef(null),s=H.useRef(null),i=H.useRef(null);$H(),wB(),SB(),mH(o),pU(o),aa("position layers",()=>{const h=s.current;if(!h)return;const f=i.current;if(!f)return;const{x:y,y:g,z:m}=t.getCamera(),v=m>=1?sg(m,[1,8],[.125,.5],!0):sg(m,[.1,1],[-2,.125],!0),x=`scale(${O(m)}) translate(${O(y+v)}px,${O(g+v)}px)`;h.style.setProperty("transform",x),f.style.setProperty("transform",x)},[t]);const a=vB(),l=q("shapeSvgDefs",()=>{const h=new Map;for(const f of St(t.shapeUtils)){if(!f)return;const y=f.getCanvasSvgDefs();for(const{key:g,component:m}of y)h.has(g)||h.set(g,p.jsx(m,{},g))}return[...h.values()]},[t]),c=q("debug_shapes",()=>qe.hideShapes.get(),[qe]),u=q("debug_svg",()=>qe.debugSvg.get(),[qe]),d=q("debug_geometry",()=>qe.debugGeometry.get(),[qe]);return p.jsxs("div",{ref:o,draggable:!1,className:fe("tl-canvas",e),"data-testid":"canvas",...a,children:[n&&p.jsx(n,{}),p.jsx(YV,{}),p.jsx(dK,{}),p.jsx("svg",{className:"tl-svg-context",children:p.jsxs("defs",{children:[l,_k&&p.jsx(_k,{}),p.jsx(aK,{}),p.jsx(lK,{}),p.jsx(cK,{}),r&&p.jsx(r,{})]})}),p.jsxs("div",{ref:s,className:"tl-html-layer tl-shapes",draggable:!1,children:[p.jsx(fK,{}),p.jsx(pK,{}),c?null:u?p.jsx(nK,{}):p.jsx(rK,{})]}),p.jsxs("div",{className:"tl-fixed-layer tl-overlays",children:[p.jsxs("div",{ref:i,className:"tl-html-layer",children:[d?p.jsx(UH,{}):null,p.jsx(eK,{}),p.jsx(qV,{}),p.jsx(XV,{}),p.jsx(QV,{}),p.jsx(oK,{}),p.jsx(sK,{}),p.jsx(iK,{}),p.jsx(ZV,{}),p.jsx(hK,{}),p.jsx(zV,{})]}),p.jsx(gK,{})]})]})}function YV(){const e=W(),t=q("gridSize",()=>e.getDocumentSettings().gridSize,[e]),{x:n,y:r,z:o}=q("camera",()=>e.getCamera(),[e]),s=q("isGridMode",()=>e.getInstanceState().isGridMode,[e]),{Grid:i}=jt();return i&&s?p.jsx(i,{x:n,y:r,z:o,size:t}):null}function XV(){const e=W(),t=q("scribbles",()=>e.getInstanceState().scribbles,[e]),n=q("zoomLevel",()=>e.getZoomLevel(),[e]),{Scribble:r}=jt();return r&&t.length?p.jsx(p.Fragment,{children:t.map(o=>p.jsx(r,{className:"tl-user-scribble",scribble:o,zoom:n},o.id))}):null}function qV(){const e=W(),t=q("brush",()=>e.getInstanceState().brush,[e]),{Brush:n}=jt();return n&&t?p.jsx(n,{className:"tl-user-brush",brush:t}):null}function QV(){const e=W(),t=q("zoomBrush",()=>e.getInstanceState().zoomBrush,[e]),{ZoomBrush:n}=jt();return n&&t?p.jsx(n,{className:"tl-user-brush tl-zoom-brush",brush:t}):null}function ZV(){const e=W(),t=q("snapLines",()=>e.snaps.getLines(),[e]),n=q("zoomLevel",()=>e.getZoomLevel(),[e]),{SnapLine:r}=jt();return r&&t.length>0?p.jsx(p.Fragment,{children:t.map(o=>p.jsx(r,{className:"tl-user-snapline",line:o,zoom:n},o.id))}):null}const JV=48;function eK(){const e=W(),{Handles:t}=jt(),n=q("zoomLevel",()=>e.getZoomLevel(),[e]),r=q("coarse pointer",()=>e.getInstanceState().isCoarsePointer,[e]),o=q("onlySelectedShape",()=>e.getOnlySelectedShape(),[e]),s=q("isChangingStyle",()=>e.getInstanceState().isChangingStyle,[e]),i=q("isChangingStyle",()=>e.getInstanceState().isReadonly,[e]),a=q("handles",()=>{const u=e.getOnlySelectedShape();if(u)return e.getShapeHandles(u)},[e]),l=q("transform",()=>{const u=e.getOnlySelectedShape();if(u)return e.getShapePageTransform(u)},[e]);if(!t||!o||s||i||!a||!l)return null;const c=[];for(let u=0,d=a[u];u<a.length;u++,d=a[u]){if(d.type!=="vertex"){const h=a[u-1],f=a[u+1];if(h&&f&&Math.hypot(h.y-f.y,h.x-f.x)<JV/n)continue}c.push(d)}return c.sort(u=>u.type==="vertex"?1:-1),p.jsx(t,{children:p.jsx("g",{transform:se.toCssString(l),children:c.map(u=>p.jsx(tK,{shapeId:o.id,handle:u,zoom:n,isCoarse:r},u.id))})})}function tK({shapeId:e,handle:t,zoom:n,isCoarse:r}){const o=yH(e,t.id),{Handle:s}=jt();return s?p.jsx("g",{"aria-label":"handle",transform:`translate(${t.x}, ${t.y})`,...o,children:p.jsx(s,{shapeId:e,handle:t,zoom:n,isCoarse:r})}):null}function nK(){const e=W(),t=q("rendering shapes",()=>e.getRenderingShapes(),[e]);return p.jsx(p.Fragment,{children:t.map(n=>p.jsxs(H.Fragment,{children:[p.jsx(NA,{...n}),p.jsx(uK,{id:n.id})]},n.id+"_fragment"))})}function rK(){const e=W(),t=q("rendering shapes",()=>e.getRenderingShapes(),[e]);return p.jsx(p.Fragment,{children:t.map(n=>p.jsx(NA,{...n},n.id+"_shape"))})}function oK(){const e=W(),t=q("selectedShapeIds",()=>e.getCurrentPageState().selectedShapeIds,[e]);return q("should display selected ids",()=>e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.getInstanceState().isChangingStyle,[e])?p.jsx(p.Fragment,{children:t.map(r=>p.jsx(Ld,{className:"tl-user-indicator__selected",id:r},r+"_indicator"))}):null}const sK=function(){const t=W(),{HoveredShapeIndicator:n}=jt(),r=q("coarse pointer",()=>t.getInstanceState().isCoarsePointer,[t]),o=q("hovering canvas",()=>t.getInstanceState().isHoveringCanvas,[t]),s=q("hovered id",()=>t.getCurrentPageState().hoveredShapeId,[t]);return r||!o||!s||!n?null:p.jsx(n,{shapeId:s})},iK=Ve(function(){const t=W(),n=og(t.getHintingShapeIds());return n.length?p.jsx(p.Fragment,{children:n.map(r=>p.jsx(Ld,{className:"tl-user-indicator__hint",id:r},r+"_hinting"))}):null});function _k(){return p.jsxs("g",{id:"cursor",children:[p.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[p.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),p.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),p.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[p.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),p.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),p.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[p.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),p.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function aK(){return p.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function lK(){return p.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:p.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function cK(){return p.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[p.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),p.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const uK=Ve(function({id:t}){const n=W(),r=n.getShape(t),[o,s]=H.useState(""),i=(r==null?void 0:r.parentId)===n.getCurrentPageId();return H.useEffect(()=>{if(!i)return;let a=null;const l=Od("shape to svg",async()=>{const c=Math.random();a=c;const u=n.getShapePageBounds(t),d=await n.getSvg([t],{padding:0});d&&u&&a===c&&(d.style.setProperty("overflow","visible"),d.setAttribute("preserveAspectRatio","xMidYMin slice"),d.style.setProperty("transform",`translate(${u.x}px, ${u.y+u.h+12}px)`),d.style.setProperty("border","1px solid black"),s(d==null?void 0:d.outerHTML))});return()=>{a=null,l()}},[n,t,i]),i?p.jsx("div",{style:{paddingTop:12,position:"absolute"},children:p.jsx("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:o}})}):null});function dK(){const e=q("debugging ui log",()=>qe.logMessages.get(),[qe]);return e.length?p.jsx("div",{className:"debug__ui-logger",children:e.map((t,n)=>{const r=typeof t=="string"?t:JSON.stringify(t);return p.jsx("div",{className:"debug__ui-logger__line",children:r},n)})}):null}function hK(){const e=W(),t=q("selection rotation",()=>e.getSelectionRotation(),[e]),n=q("selection bounds",()=>e.getSelectionRotatedPageBounds(),[e]),{SelectionForeground:r}=jt();return!n||!r?null:p.jsx(r,{bounds:n,rotation:t})}function pK(){const e=W(),t=q("selection rotation",()=>e.getSelectionRotation(),[e]),n=q("selection bounds",()=>e.getSelectionRotatedPageBounds(),[e]),{SelectionBackground:r}=jt();return!n||!r?null:p.jsx(r,{bounds:n,rotation:t})}function fK(){const{OnTheCanvas:e}=jt();return e?p.jsx(e,{}):null}function gK(){const{InFrontOfTheCanvas:e}=jt();return e?p.jsx(e,{}):null}const mK=()=>p.jsx(iR,{children:"Connecting..."});let yK=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");function Ge(){return yK()}const $A="TLDRAW_USER_DATA_v3",LA=_e({id:ve,name:ve.nullable().optional(),locale:ve.nullable().optional(),color:ve.nullable().optional(),isDarkMode:Ee.nullable().optional(),animationSpeed:ge.nullable().optional(),edgeScrollSpeed:ge.nullable().optional(),isSnapMode:Ee.nullable().optional()}),Xc={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4},Cg=Le({currentVersion:Xc.AddEdgeScrollSpeed,migrators:{[Xc.AddAnimationSpeed]:{up:e=>({...e,animationSpeed:1}),down:({animationSpeed:e,...t})=>t},[Xc.AddIsSnapMode]:{up:e=>({...e,isSnapMode:!1}),down:({isSnapMode:e,...t})=>t},[Xc.MakeFieldsNullable]:{up:e=>e,down:e=>({id:e.id,name:e.name??_r.name,locale:e.locale??_r.locale,color:e.color??_r.color,isDarkMode:e.isDarkMode??_r.isDarkMode,animationSpeed:e.animationSpeed??_r.animationSpeed,isSnapMode:e.isSnapMode??_r.isSnapMode})},[Xc.AddEdgeScrollSpeed]:{up:e=>({...e,edgeScrollSpeed:1}),down:({edgeScrollSpeed:e,...t})=>t}}}),Tk=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function vK(){return Tk[Math.floor(Math.random()*Tk.length)]}function SK(){var e,t;return typeof window>"u"?!1:((t=(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-color-scheme: dark)"))==null?void 0:t.matches)??!1}function xK(){var e,t;return typeof window>"u"?!1:((t=(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:t.matches)??!1}const _r=Object.freeze({name:"New User",locale:uB(),color:vK(),isDarkMode:!1,edgeScrollSpeed:1,animationSpeed:xK()?0:1,isSnapMode:!1});function Gh(){return{id:Ge()}}function FA(e){if(e===null||typeof e!="object"||!("version"in e)||!("user"in e)||typeof e.version!="number")return Gh();const t=Xw({value:e.user,fromVersion:e.version,toVersion:Cg.currentVersion??0,migrations:Cg});if(t.type==="error")return Gh();try{LA.validate(t.value)}catch{return Gh()}return t.value}function wK(){var t;const e=typeof window>"u"?null:JSON.parse(((t=window==null?void 0:window.localStorage)==null?void 0:t.getItem($A))||"null")??null;return FA(e)}const Ud=kn("globalUserData",wK());function bK(){typeof window<"u"&&window.localStorage&&window.localStorage.setItem($A,JSON.stringify({version:Cg.currentVersion,user:Ud.get()}))}function CK(e){LA.validate(e),Ud.set(e),bK(),kK()}const PK=typeof process<"u"&&!1,Al=typeof BroadcastChannel<"u"&&!PK?new BroadcastChannel("tldraw-user-sync"):null;Al==null||Al.addEventListener("message",e=>{const t=e.data;(t==null?void 0:t.type)===BA&&(t==null?void 0:t.origin)!==zA&&Ud.set(FA(t.data))});const zA=Ge(),BA="tldraw-user-preferences-change";function kK(){Al==null||Al.postMessage({type:BA,origin:zA,data:{user:Ud.get(),version:Cg.currentVersion}})}function EK(){return Ud.get()}function UA(e={}){return{derivePresenceState:e.derivePresenceState??(()=>Z("presence",()=>null)),userPreferences:e.userPreferences??Z("userPreferences",()=>EK()),setUserPreferences:e.setUserPreferences??CK}}var HA={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new o(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],f]:l._events[y].push(f):(l._events[y]=f,l._eventsCount++),l}function i(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,y=new Array(f);h<f;h++)y[h]=d[h].fn;return y},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,y){var g=n?n+c:c;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,x,w;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,h),!0;case 5:return m.fn.call(m.context,u,d,h,f),!0;case 6:return m.fn.call(m.context,u,d,h,f,y),!0}for(w=1,x=new Array(v-1);w<v;w++)x[w-1]=arguments[w];m.fn.apply(m.context,x)}else{var C=m.length,P;for(w=0;w<C;w++)switch(m[w].once&&this.removeListener(c,m[w].fn,void 0,!0),v){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,u);break;case 3:m[w].fn.call(m[w].context,u,d);break;case 4:m[w].fn.call(m[w].context,u,d,h);break;default:if(!x)for(P=1,x=new Array(v-1);P<v;P++)x[P-1]=arguments[P];m[w].fn.apply(m[w].context,x)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return i(this,f),this;var y=this._events[f];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&i(this,f);else{for(var g=0,m=[],v=y.length;g<v;g++)(y[g].fn!==u||h&&!y[g].once||d&&y[g].context!==d)&&m.push(y[g]);m.length?this._events[f]=m.length===1?m[0]:m:i(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&i(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(HA);var IK=HA.exports;function rr({children:e,className:t="",...n}){return p.jsx("svg",{...n,className:`tl-svg-container ${t}`,children:e})}class Ca{constructor(t){S(this,"isFilled",!1);S(this,"isClosed",!0);S(this,"isLabel",!1);S(this,"isSnappable",!0);S(this,"_vertices");S(this,"_bounds");S(this,"_snapPoints");S(this,"_area");this.isFilled=t.isFilled,this.isClosed=t.isClosed,this.isSnappable=t.isSnappable??!1,this.isLabel=t.isLabel??!1}hitTestPoint(t,n=0,r=!1){return this.distanceToPoint(t,r)<=n}distanceToPoint(t,n=!1){const r=t.dist(this.nearestPoint(t));return this.isClosed&&(this.isFilled||n)&&jo(t,this.vertices)?-r:r}distanceToLineSegment(t,n){const r=this.nearestPointOnLineSegment(t,n),o=E.DistanceToLineSegment(t,n,r);return this.isClosed&&this.isFilled&&jo(r,this.vertices)?-o:o}hitTestLineSegment(t,n,r=0){return this.distanceToLineSegment(t,n)<=r}nearestPointOnLineSegment(t,n){let r=1/0,o;for(let s=0;s<this.vertices.length;s++){const i=this.vertices[s],a=E.DistanceToLineSegment(t,n,i);a<r&&(r=a,o=i)}if(!o)throw Error("nearest point not found");return o}isPointInBounds(t,n=0){const{bounds:r}=this;return!(t.x<r.minX-n||t.y<r.minY-n||t.x>r.maxX+n||t.y>r.maxY+n)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return le.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get snapPoints(){return this._snapPoints||(this._snapPoints=this.bounds.snapPoints),this._snapPoints}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:t}=this;let n=0;for(let r=0,o=t.length;r<o;r++){const s=t[r],i=t[(r+1)%o];n+=s.x*i.y-i.x*s.y}return n/2}toSimpleSvgPath(){let t="";const{vertices:n}=this,r=n.length;if(r===0)return t;t+=`M${n[0].x},${n[0].y}`;for(let o=1;o<r;o++)t+=`L${n[o].x},${n[o].y}`;return this.isClosed&&(t+="Z"),t}}class Qs extends Ca{constructor(n){super({...n,isClosed:!0,isFilled:!1});S(this,"children");const{children:r}=n;if(r.length===0)throw Error("Group2d must have at least one child");this.children=r}getVertices(){return this.children.filter(n=>!n.isLabel).flatMap(n=>n.vertices)}nearestPoint(n){let r=1/0,o;const{children:s}=this;if(s.length===0)throw Error("no children");for(const i of s){const a=i.nearestPoint(n),l=a.dist(n);l<r&&(r=l,o=a)}if(!o)throw Error("nearest point not found");return o}distanceToPoint(n,r=!1){return Math.min(...this.children.map((o,s)=>o.distanceToPoint(n,r||s>0)))}hitTestPoint(n,r,o){return!!this.children.filter(s=>!s.isLabel).find(s=>s.hitTestPoint(n,r,o))}hitTestLineSegment(n,r,o){return!!this.children.filter(s=>!s.isLabel).find(s=>s.hitTestLineSegment(n,r,o))}getArea(){return this.children[0].area}toSimpleSvgPath(){let n="";for(const o of this.children)n+=o.toSimpleSvgPath();const r=le.FromPoints(this.vertices).corners;for(let o=0,s=r.length;o<s;o++){const i=r[o],a=r[(o-1+s)%s],l=i.dist(a),c=r[(o+1)%s],u=i.dist(c),d=i.clone().lrp(a,4/l),h=i,f=i.clone().lrp(c,4/u);n+=`M${d.x},${d.y} L${h.x},${h.y} L${f.x},${f.y} `}return n}}function hb(e,t,n,r){const o=e.x-n.x,s=e.y-n.y,i=r.x-n.x,a=r.y-n.y,l=t.x-e.x,c=t.y-e.y,u=i*s-a*o,d=l*s-c*o,h=a*l-i*c;if(u===0||d===0||h===0)return null;if(h!==0){const f=u/h,y=d/h;if(0<=f&&f<=1&&0<=y&&y<=1)return E.AddXY(e,f*l,f*c)}return null}function Cm(e,t,n,r){const o=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),s=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),i=n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r,a=s*s-4*o*i;if(a<0||a===0)return null;const l=Math.sqrt(a),c=(-s+l)/(2*o),u=(-s-l)/(2*o);if((c<0||c>1)&&(u<0||u>1))return null;const d=[];return 0<=c&&c<=1&&d.push(E.Lrp(e,t,c)),0<=u&&u<=1&&d.push(E.Lrp(e,t,u)),d.length===0?null:d}function VA(e,t,n){const r=[];let o;for(let s=0,i=n.length-1;s<i;s++)o=hb(e,t,n[s],n[s+1]),o&&r.push(o);return r.length===0?null:r}function _K(e,t,n){const r=[];let o;for(let s=1,i=n.length;s<i+1;s++)o=hb(e,t,n[s-1],n[s%n.length]),o&&r.push(o);return r.length===0?null:r}function TK(e,t,n,r){let o=n.x-e.x,s=n.y-e.y;const i=Math.sqrt(o*o+s*s),a=(i*i-r*r+t*t)/(2*i),l=Math.sqrt(t*t-a*a);return o/=i,s/=i,[new E(e.x+o*a-s*l,e.y+s*a+o*l),new E(e.x+o*a+s*l,e.y+s*a-o*l)]}function Mk(e,t,n){const r=[];let o,s,i;for(let a=0,l=n.length;a<l;a++)o=n[a],s=n[(a+1)%n.length],i=Cm(o,s,e,t),i&&r.push(...i);return r.length===0?null:r}function Ak(e,t,n){const r=[];let o,s,i;for(let a=1,l=n.length;a<l;a++)o=n[a-1],s=n[a],i=Cm(o,s,e,t),i&&r.push(...i);return r.length===0?null:r}function Yh(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function KA(e,t,n,r){return Yh(e,n,r)!==Yh(t,n,r)&&Yh(e,t,n)!==Yh(e,t,r)}function US(e,t){const n=new Map;let r,o,s,i;for(let a=0,l=e.length;a<l;a++)if(r=e[a],jo(r,t)){const c=Zy(r);n.has(c)||n.set(c,r)}for(let a=0,l=t.length;a<l;a++)if(r=t[a],jo(r,e)){const c=Zy(r);n.has(c)||n.set(c,r)}for(let a=0,l=e.length;a<l;a++){r=e[a],o=e[(a+1)%e.length];for(let c=0,u=t.length;c<u;c++){s=t[c],i=t[(c+1)%t.length];const d=hb(r,o,s,i);if(d!==null){const h=Zy(d);n.has(h)||n.set(h,d)}}}return n.size===0?null:MK([...n.values()])}function Zy(e){return`${e.x},${e.y}`}function MK(e){const t=E.Average(e);return e.sort((n,r)=>E.Angle(t,n)-E.Angle(t,r))}function AK(e,t){let n,r,o,s;for(let i=0,a=e.length;i<a;i++){n=e[i],r=e[(i+1)%a];for(let l=0,c=t.length;l<c;l++)if(o=t[l],s=t[(l+1)%c],KA(n,r,o,s))return!0}return!1}class Pg extends Ca{constructor(n){super({...n,isClosed:!1,isFilled:!1});S(this,"start");S(this,"end");S(this,"d");S(this,"u");S(this,"ul");S(this,"_length");const{start:r,end:o}=n;this.start=r,this.end=o,this.d=r.clone().sub(o),this.u=this.d.clone().uni(),this.ul=this.u.len()}get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(n){const{start:r,end:o,u:s,ul:i}=this;if(i===0)return r;const a=E.Sub(n,r).dpr(s)/i,l=r.x+s.x*a;if(l<Math.min(r.x,o.x))return r.x<o.x?r:o;if(l>Math.max(r.x,o.x))return r.x>o.x?r:o;const c=r.y+s.y*a;return c<Math.min(r.y,o.y)?r.y<o.y?r:o:c>Math.max(r.y,o.y)?r.y>o.y?r:o:new E(l,c)}hitTestLineSegment(n,r,o){return KA(n,r,this.start,this.end)}}class Pa extends Ca{constructor(n){super({isClosed:!1,isFilled:!1,...n});S(this,"points");S(this,"_segments");S(this,"_length");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:n}=this;for(let r=0,o=n.length-1;r<o;r++){const s=n[r],i=n[r+1];this._segments.push(new Pg({start:s,end:i}))}this.isClosed&&this._segments.push(new Pg({start:n[n.length-1],end:n[0]}))}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((n,r)=>n+r.length,0)),this._length}getVertices(){return this.points}nearestPoint(n){const{segments:r}=this;let o=this.points[0],s=1/0,i,a;for(let l=0;l<r.length;l++)i=r[l].nearestPoint(n),a=i.dist(n),a<s&&(o=i,s=a);return o}hitTestLineSegment(n,r,o){return this.segments.some(s=>s.hitTestLineSegment(n,r,o))}}class Mt extends Pa{constructor(t){super({...t}),this.isClosed=!0}}class xi extends Mt{constructor(n){const{x:r=0,y:o=0,width:s,height:i}=n;super({...n,points:[new E(r,o),new E(r+s,o),new E(r+s,o+i),new E(r,o+i)]});S(this,"x");S(this,"y");S(this,"w");S(this,"h");this.x=r,this.y=o,this.w=s,this.h=i}getBounds(){return new le(this.x,this.y,this.w,this.h)}}class so{constructor(t){S(this,"canSnap",()=>!0);S(this,"canScroll",()=>!1);S(this,"canUnmount",()=>!0);S(this,"canBind",(t,n)=>!0);S(this,"canEdit",()=>!1);S(this,"canResize",()=>!0);S(this,"canEditInReadOnly",()=>!1);S(this,"canCrop",()=>!1);S(this,"hideResizeHandles",()=>!1);S(this,"hideRotateHandle",()=>!1);S(this,"hideSelectionBoundsBg",()=>!1);S(this,"hideSelectionBoundsFg",()=>!1);S(this,"isAspectRatioLocked",()=>!1);S(this,"onBeforeCreate");S(this,"onBeforeUpdate");S(this,"onDragShapesOver");S(this,"onDragShapesOut");S(this,"onDropShapesOver");S(this,"onResizeStart");S(this,"onResize");S(this,"onResizeEnd");S(this,"onTranslateStart");S(this,"onTranslate");S(this,"onTranslateEnd");S(this,"onRotateStart");S(this,"onRotate");S(this,"onRotateEnd");S(this,"onHandleChange");S(this,"onBindingChange");S(this,"onChildrenChange");S(this,"onDoubleClickHandle");S(this,"onDoubleClickEdge");S(this,"onDoubleClick");S(this,"onClick");S(this,"onEditEnd");this.editor=t}providesBackgroundForChildren(t){return!1}getOutlineSegments(t){return[this.editor.getShapeGeometry(t).vertices]}canReceiveNewChildrenOfType(t,n){return!1}canDropShapes(t,n){return!1}expandSelectionOutlinePx(t){return 0}getCanvasSvgDefs(){return[]}}S(so,"props"),S(so,"migrations"),S(so,"type");function RK(e,t,n={}){const{closed:r=!1,snap:o=1,start:s="outset",end:i="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,u=0,d=1,h=0,f=0;switch(l){case"dashed":{d=1,c=Math.min(t*a,e/4);break}case"dotted":{d=100,c=t/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(s==="outset"?(e+=c/2,f+=c/2):s==="skip"&&(e-=c,f-=c),i==="outset"?e+=c/2:i==="skip"&&(e-=c)),u=Math.floor(e/c/(2*d)),u-=u%o,u<3&&l==="dashed"?e/t<5?(c=e,u=1,h=0):(c=e*.333,h=e*.333):(u=Math.max(u,3),c=e/u/(2*d),r?(f=c/2,h=(e-u*c)/u):h=(e-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:f.toString()}}function Rk({bounds:e,className:t}){const n=W(),r=q("zoom level",()=>n.getZoomLevel(),[n]);return p.jsx("g",{className:t,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.sides.map((o,s)=>{const{strokeDasharray:i,strokeDashoffset:a}=RK(o[0].dist(o[1]),1/r,{style:"dashed",lengthRatio:4});return p.jsx("line",{x1:o[0].x,y1:o[0].y,x2:o[1].x,y2:o[1].y,strokeDasharray:i,strokeDashoffset:a},s)})})}class Fp extends so{constructor(){super(...arguments);S(this,"hideSelectionBoundsFg",()=>!0);S(this,"canBind",()=>!1);S(this,"onChildrenChange",n=>{const r=this.editor.getSortedChildIdsForParent(n.id);if(r.length===0){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([n.id]);return}else if(r.length===1){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(r,n.parentId),this.editor.deleteShapes([n.id]);return}})}getDefaultProps(){return{}}getGeometry(n){const r=this.editor.getSortedChildIdsForParent(n.id);return r.length===0?new xi({width:1,height:1,isFilled:!1}):new Qs({children:r.map(o=>{const s=this.editor.getShape(o),i=this.editor.getShapeGeometry(o),a=this.editor.getShapeLocalTransform(s).applyToPoints(i.vertices);return i.isClosed?new Mt({points:a,isFilled:!0}):new Pa({points:a})})})}component(n){const r=this.editor.getErasingShapeIds().includes(n.id),{hintingShapeIds:o}=this.editor.getCurrentPageState(),s=o.length>0&&o.some(l=>l!==n.id&&this.editor.isShapeOfType(this.editor.getShape(l),"group")),i=this.editor.getCurrentPageState().focusedGroupId!==n.id;if(!r&&(i||s))return null;const a=this.editor.getShapeGeometry(n).bounds;return p.jsx(rr,{id:n.id,children:p.jsx(Rk,{className:"tl-group",bounds:a})})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return p.jsx(Rk,{className:"",bounds:r})}}S(Fp,"type","group"),S(Fp,"props",G7),S(Fp,"migrations",Y7);const WA=[Fp],OK=new Set(WA.map(e=>e.type));function GA(e){const t=[...WA],n=new Set;for(const r of e){if(OK.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);t.push(r),n.add(r.type)}return t}function Ok(e,t){if(!t)return!1;switch(e.type){case"mixed":return t.type==="mixed";case"shared":return t.type==="shared"&&e.value===t.value;default:throw gc(e)}}class jK{constructor(t){S(this,"map");this.map=new Map(t)}get(t){return this.map.get(t)}getAsKnownValue(t){const n=this.get(t);if(n&&n.type!=="mixed")return n.value}get size(){return this.map.size}equals(t){if(this.size!==t.size)return!1;const n=new Set;for(const[r,o]of this){if(!Ok(o,t.get(r)))return!1;n.add(r)}for(const[r,o]of t)if(!n.has(r)&&!Ok(o,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class HS extends jK{set(t,n){this.map.set(t,n)}applyValue(t,n){const r=this.get(t);if(!r){this.set(t,{type:"shared",value:n});return}switch(r.type){case"mixed":return;case"shared":r.value!==n&&this.set(t,{type:"mixed"});return;default:gc(r,"type")}}}class pb{constructor(){S(this,"items",new WeakMap)}get(t,n){return this.items.has(t)||this.items.set(t,n(t)),this.items.get(t)}access(t){return this.items.get(t)}set(t,n){this.items.set(t,n)}has(t){return this.items.has(t)}invalidate(t){this.items.delete(t)}bust(){this.items=new WeakMap}}function DK(e,t,n){return fetch(e).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],t,{type:n})})}function NK(e,t){var o;let n=e;const r=new Set(t);for(;r.has(n);)n=(o=/^.*(\d+)$/.exec(n))!=null&&o[1]?n.replace(/(\d+)(?=\D?)$/,s=>(+s+1).toString()):`${n} 1`;return n}const sr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",$K="a0",YA="A00000000000000000000000000";function XA(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function qA(e){if(e.length!==XA(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function jk(e){if(e===void 0)throw Error("n is undefined")}function Dk(e){qA(e);const[t,...n]=e.split("");let r=!0;for(let o=n.length-1;r&&o>=0;o--){const s=sr.indexOf(n[o])+1;s===sr.length?n[o]="0":(n[o]=sr.charAt(s),r=!1)}if(r){if(t==="Z")return"a0";if(t==="z")return;const o=String.fromCharCode(t.charCodeAt(0)+1);return o>"a"?n.push("0"):n.pop(),o+n.join("")}else return t+n.join("")}function LK(e){qA(e);const[t,...n]=e.split("");let r=!0;for(let o=n.length-1;r&&o>=0;o--){const s=sr.indexOf(n[o])-1;s===-1?n[o]=sr.slice(-1):(n[o]=sr.charAt(s),r=!1)}if(r){if(t==="a")return"Z"+sr.slice(-1);if(t==="A")return;const o=String.fromCharCode(t.charCodeAt(0)-1);return o<"Z"?n.push(sr.slice(-1)):n.pop(),o+n.join("")}else return t+n.join("")}function pl(e,t){if(t!==void 0&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)==="0"||t&&t.slice(-1)==="0")throw new Error("trailing zero");if(t){let o=0;for(;(e.charAt(o)||"0")===t.charAt(o);)o++;if(o>0)return t.slice(0,o)+pl(e.slice(o),t.slice(o))}const n=e?sr.indexOf(e.charAt(0)):0,r=t!==void 0?sr.indexOf(t.charAt(0)):sr.length;if(r-n>1){const o=Math.round(.5*(n+r));return sr.charAt(o)}else return t&&t.length>1?t.slice(0,1):sr.charAt(n)+pl(e.slice(1),void 0)}function gu(e){const t=XA(e.charAt(0));if(t>e.length)throw new Error("invalid index: "+e);return e.slice(0,t)}function Nk(e){if(e===YA)throw new Error("invalid index: "+e);const t=gu(e);if(e.slice(t.length).slice(-1)==="0")throw new Error("invalid index: "+e)}function Va(e,t){if(e!==void 0&&Nk(e),t!==void 0&&Nk(t),e!==void 0&&t!==void 0&&e>=t)throw new Error(e+" >= "+t);if(e===void 0&&t===void 0)return $K;if(e===void 0){if(t===void 0)throw Error("b is undefined");const a=gu(t),l=t.slice(a.length);if(a===YA)return a+pl("",l);if(a<t)return a;const c=LK(a);return jk(c),c}if(t===void 0){const a=gu(e),l=e.slice(a.length),c=Dk(a);return c===void 0?a+pl(l,void 0):c}const n=gu(e),r=e.slice(n.length),o=gu(t),s=t.slice(o.length);if(n===o)return n+pl(r,s);const i=Dk(n);return jk(i),i<t?i:n+pl(r,void 0)}function wi(e,t,n){if(n===0)return[];if(n===1)return[Va(e,t)];if(t===void 0){let s=Va(e,t);const i=[s];for(let a=0;a<n-1;a++)s=Va(s,t),i.push(s);return i}if(e===void 0){let s=Va(e,t);const i=[s];for(let a=0;a<n-1;a++)s=Va(e,s),i.push(s);return i.reverse(),i}const r=Math.floor(n/2),o=Va(e,t);return[...wi(e,o,r),o,...wi(o,t,n-r-1)]}function nc(e,t,n){return wi(e,t,n)}function Jy(e,t){return wi(e,void 0,t)}function Au(e,t){return wi(e,t,1)[0]}function Zo(e){return wi(e,void 0,1)[0]}function FK(e){return wi(void 0,e,1)[0]}function QA(e,t="a1"){return[t,...wi(t,void 0,e)]}function ln(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function Xh(e,t,n){if(n.length===0)return[];const r=new Map;for(const s of pe(n.map(i=>e.getShape(i)))){const{parentId:i}=s;r.has(i)||r.set(i,{children:pe(e.getSortedChildIdsForParent(i).map(a=>e.getShape(a))),moving:new Set}),r.get(i).moving.add(s)}const o=[];switch(t){case"toBack":{r.forEach(({moving:s,children:i})=>zK(s,i,o));break}case"toFront":{r.forEach(({moving:s,children:i})=>BK(s,i,o));break}case"forward":{r.forEach(({moving:s,children:i})=>UK(s,i,o));break}case"backward":{r.forEach(({moving:s,children:i})=>HK(s,i,o));break}}return o}function zK(e,t,n){const r=t.length;if(e.size===r)return;let o,s;for(let i=0;i<r;i++){const a=t[i];if(e.has(a))o=a.index,e.delete(a);else{s=a.index;break}}if(e.size!==0){const i=nc(o,s,e.size);n.push(...Array.from(e.values()).sort(ln).map((a,l)=>({...a,index:i[l]})))}}function BK(e,t,n){const r=t.length;if(e.size===r)return;let o,s;for(let i=r-1;i>-1;i--){const a=t[i];if(e.has(a))s=a.index,e.delete(a);else{o=a.index;break}}if(e.size!==0){const i=nc(o,s,e.size);n.push(...Array.from(e.values()).sort(ln).map((a,l)=>({...a,index:i[l]})))}}function UK(e,t,n){var s;const r=t.length;if(e.size===r)return;let o={name:"skipping"};for(let i=0;i<r;i++){const a=e.has(t[i]);switch(o.name){case"skipping":{if(!a)continue;o={name:"selecting",selectIndex:i};break}case"selecting":{if(a)continue;const{selectIndex:l}=o;nc(t[i].index,(s=t[i+1])==null?void 0:s.index,i-l).forEach((c,u)=>n.push({...t[l+u],index:c})),o={name:"skipping"};break}}}}function HK(e,t,n){var s;const r=t.length;if(e.size===r)return;let o={name:"skipping"};for(let i=r-1;i>-1;i--){const a=e.has(t[i]);switch(o.name){case"skipping":{if(!a)continue;o={name:"selecting",selectIndex:i};break}case"selecting":{if(a)continue;nc((s=t[i-1])==null?void 0:s.index,t[i].index,o.selectIndex-i).forEach((l,c)=>{n.push({...t[i+c+1],index:l})}),o={name:"skipping"};break}}}}function ZA({editor:e}){const t=e.getSelectedShapes(),n=e.getSelectionRotation(),r=e.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:o}}=e;if(!r)return null;const s=r.center.clone().rotWith(r.point,n);return{selectionPageCenter:s,initialCursorAngle:s.angle(o),initialSelectionRotation:n,shapeSnapshots:t.map(i=>({shape:ui(i),initialPagePoint:e.getShapePageTransform(i.id).point()}))}}function zp({delta:e,editor:t,snapshot:n,stage:r}){const{selectionPageCenter:o,shapeSnapshots:s}=n;t.updateShapes(s.map(({shape:a,initialPagePoint:l})=>{const c=Pr(a.parentId)?t.getShapePageTransform(a.parentId):se.Identity(),u=E.RotWith(l,o,e),d=se.applyToPoint(se.Inverse(c),u),h=oo(a.rotation+e);return{id:a.id,type:a.type,x:d.x,y:d.y,rotation:h}}));const i=[];s.forEach(({shape:a})=>{var d,h,f;const l=t.getShape(a.id);if(!l)return;const c=t.getShapeUtil(a);if(r==="start"||r==="one-off"){const y=(d=c.onRotateStart)==null?void 0:d.call(c,a);y&&i.push(y)}const u=(h=c.onRotate)==null?void 0:h.call(c,a,l);if(u&&i.push(u),r==="end"||r==="one-off"){const y=(f=c.onRotateEnd)==null?void 0:f.call(c,a,l);y&&i.push(y)}}),i.length>0&&t.updateShapes(i)}const VK=e=>{const{store:t}=e,n=t.query.filterHistory("shape"),r=t.query.records("shape",()=>({type:{eq:"arrow"}}));function o(){const s=r.get(),i={};for(const a of s){const{start:l,end:c}=a.props;if(l.type==="binding"){const u=i[l.boundShapeId];u?u.push({arrowId:a.id,handleId:"start"}):i[l.boundShapeId]=[{arrowId:a.id,handleId:"start"}]}if(c.type==="binding"){const u=i[c.boundShapeId];u?u.push({arrowId:a.id,handleId:"end"}):i[c.boundShapeId]=[{arrowId:a.id,handleId:"end"}]}}return i}return Z("arrowBindingsIndex",(s,i)=>{if(Ml(s))return o();const a=s,l=n.getDiffSince(i);if(l===cr)return o();let c;function u(f){c||(c={...a}),c[f]?c[f]===a[f]&&(c[f]=[...c[f]]):c[f]=[]}function d(f,y,g){u(f),c[f]=c[f].filter(m=>m.arrowId!==y||m.handleId!==g),c[f].length===0&&delete c[f]}function h(f,y,g){u(f),c[f].push({arrowId:y,handleId:g})}for(const f of l){for(const y of Object.values(f.added))if(e.isShapeOfType(y,"arrow")){const{start:g,end:m}=y.props;g.type==="binding"&&h(g.boundShapeId,y.id,"start"),m.type==="binding"&&h(m.boundShapeId,y.id,"end")}for(const[y,g]of Object.values(f.updated))if(!(!e.isShapeOfType(y,"arrow")||!e.isShapeOfType(g,"arrow")))for(const m of["start","end"]){const v=y.props[m],x=g.props[m];v.type==="binding"&&x.type==="point"?d(v.boundShapeId,y.id,m):v.type==="point"&&x.type==="binding"?h(x.boundShapeId,g.id,m):v.type==="binding"&&x.type==="binding"&&v.boundShapeId!==x.boundShapeId&&(d(v.boundShapeId,y.id,m),h(x.boundShapeId,g.id,m))}for(const y of Object.values(f.removed))if(e.isShapeOfType(y,"arrow")){const{start:g,end:m}=y.props;g.type==="binding"&&d(g.boundShapeId,y.id,"start"),m.type==="binding"&&d(m.boundShapeId,y.id,"end")}}return c??a})},KK=e=>{const t=e.query.ids("shape");function n(){const r={},o=t.get(),s=Array(o.size);return o.forEach(i=>s.push(e.get(i))),s.sort(ln),s.forEach(i=>{r[i.parentId]||(r[i.parentId]=[]),r[i.parentId].push(i.id)}),r}return Z("parentsToChildrenWithIndexes",(r,o)=>{if(Ml(r))return n();const s=e.history.getDiffSince(o);if(s===cr)return n();if(s.length===0)return r;let i=null;const a=u=>{i||(i={...r}),i[u]?i[u]===r[u]&&(i[u]=[...i[u]]):i[u]=[]},l=new Set;let c;for(let u=0,d=s.length;u<d;u++){c=s[u];for(const h of Object.values(c.added))Ji(h)&&(a(h.parentId),i[h.parentId].push(h.id),l.add(i[h.parentId]));for(const[h,f]of Object.values(c.updated))if(Ji(f)&&Ji(h)){if(h.parentId!==f.parentId)a(h.parentId),a(f.parentId),i[h.parentId].splice(i[h.parentId].indexOf(f.id),1),i[f.parentId].push(f.id),l.add(i[f.parentId]);else if(h.index!==f.index){a(f.parentId);const y=i[f.parentId].indexOf(f.id);i[f.parentId][y]=f.id,l.add(i[f.parentId])}}for(const h of Object.values(c.removed))Ji(h)&&(a(h.parentId),i[h.parentId].splice(i[h.parentId].indexOf(h.id),1))}for(const u of l){const d=pe(u.map(h=>e.get(h)));d.sort(ln),u.splice(0,u.length,...d.map(h=>h.id))}return i??r})},ev=(e,t,n)=>{for(;!jn(n.parentId);){const r=e.get(n.parentId);if(!r)return!1;n=r}return n.parentId===t},WK=(e,t)=>{const n=e.query.ids("shape");let r=null;function o(){const s=t();return r=s,new Set([...n.get()].filter(i=>ev(e,s,e.get(i))))}return Z("_shapeIdsInCurrentPage",(s,i)=>{if(Ml(s))return o();const a=t();if(a!==r)return o();const l=e.history.getDiffSince(i);if(l===cr)return o();const c=new Dp(s);for(const d of l){for(const h of Object.values(d.added))Ji(h)&&ev(e,a,h)&&c.add(h.id);for(const[h,f]of Object.values(d.updated))Ji(f)&&(ev(e,a,f)?c.add(f.id):c.remove(f.id));for(const h of Object.keys(d.removed))Pr(h)&&c.remove(h)}const u=c.get();return u?pu(u.value,u.diff):s})},GK=40;class YK{constructor(t){S(this,"_clickId","");S(this,"_clickTimeout");S(this,"_clickScreenPoint");S(this,"_previousScreenPoint");S(this,"_getClickTimeout",(t,n=Ge())=>{this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===t&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},t==="idle"||t==="pendingDouble"?VB:KB)});S(this,"_clickState","idle");S(this,"lastPointerInfo",{});S(this,"transformPointerDownEvent",t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=E.From(t.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>GK&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=t,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),t;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),t;default:return this._clickTimeout=this._getClickTimeout(this._clickState),t}});S(this,"transformPointerUpEvent",t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=E.From(t.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return t}});S(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});S(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?FS:ud)&&this.cancelDoubleClickTimeout()});this.editor=t}get clickState(){return this._clickState}}class XK{constructor(t){S(this,"isSafari");S(this,"isIos");S(this,"isChromeForIos");S(this,"isFirefox");S(this,"isAndroid");this.editor=t,typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}}function Fi(e){return QK}class qK{constructor(){S(this,"length",0);S(this,"head",null);S(this,"tail",this)}push(t){return new fb(t,this)}toArray(){return ss}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const QK=new qK;class fb{constructor(t,n){S(this,"length");this.head=t,this.tail=n,this.length=n.length+1}push(t){return new fb(t,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let t=this;return{next(){if(t.length){const n=t.head;return t=t.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class ZK{constructor(t,n){S(this,"_undos",kn("HistoryManager.undos",Fi()));S(this,"_redos",kn("HistoryManager.redos",Fi()));S(this,"_batchDepth",0);S(this,"onBatchComplete",()=>{});S(this,"_commands",{});S(this,"createCommand",(t,n,r)=>{if(this._commands[t])throw new Error(`Duplicate command: ${t}`);this._commands[t]=r;const o=(...s)=>{if(!this._batchDepth)return this.batch(()=>o(...s)),this.ctx;const i=n(...s);if(!i)return this.ctx;const{data:a,ephemeral:l,squashing:c,preservesRedoStack:u}=i;if(this.ignoringUpdates((d,h)=>(r.do(a),{undos:d,redos:h})),!l){const d=this._undos.get().head;c&&d&&d.type==="command"&&d.name===t&&d.preservesRedoStack===u?this._undos.update(h=>h.tail.push({...d,id:Ge(),data:r.squash(d.data,a)})):this._undos.update(h=>h.push({type:"command",name:t,data:a,id:Ge(),preservesRedoStack:u})),i.preservesRedoStack||this._redos.set(Fi()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return o});S(this,"batch",t=>{try{this._batchDepth++,this._batchDepth===1?Xr(()=>{var r,o;const n=(r=this._undos.get().head)==null?void 0:r.id;t(),n!==((o=this._undos.get().head)==null?void 0:o.id)&&this.onBatchComplete()}):t()}catch(n){throw this.annotateError(n),n}finally{this._batchDepth--}return this});S(this,"ignoringUpdates",t=>{let n=this._undos.get(),r=this._redos.get();this._undos.set(Fi()),this._redos.set(Fi());try{({undos:n,redos:r}=Xr(()=>t(n,r)))}finally{this._undos.set(n),this._redos.set(r)}});S(this,"_undo",({pushToRedoStack:t,toMark:n=void 0})=>(this.ignoringUpdates((r,o)=>{var s;if(r.length===0)return{undos:r,redos:o};for(;((s=r.head)==null?void 0:s.type)==="STOP";){const i=r.head;if(r=r.tail,t&&(o=o.push(i)),i.id===n)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}if(r.length===0)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o};for(;r.head;){const i=r.head;if(r=r.tail,t&&(o=o.push(i)),i.type==="STOP"){if(i.onUndo&&(!n||i.id===n))return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}else this._commands[i.name].undo(i.data)}return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}),this));S(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));S(this,"redo",()=>(this.ignoringUpdates((t,n)=>{var r;if(n.length===0)return{undos:t,redos:n};for(;((r=n.head)==null?void 0:r.type)==="STOP";)t=t.push(n.head),n=n.tail;if(n.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:n};for(;n.head;){const o=n.head;if(t=t.push(n.head),n=n.tail,o.type==="STOP"){if(o.onRedo)break}else{const s=this._commands[o.name];s.redo?s.redo(o.data):s.do(o.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:n}}),this));S(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));S(this,"bailToMark",t=>(this._undo({pushToRedoStack:!1,toMark:t}),this));S(this,"mark",(t=Ge(),n=!0,r=!0)=>{const o=this._undos.get().head;return o&&o.type==="STOP"&&o.id===t&&o.onUndo===n&&o.onRedo===r?o.id:(this._undos.update(s=>s.push({type:"STOP",id:t,onUndo:n,onRedo:r})),this.ctx.emit("mark-history",{id:t}),t)});this.ctx=t,this.annotateError=n}getNumUndos(){return this._undos.get().length}getNumRedos(){return this._redos.get().length}clear(){this._undos.set(Fi()),this._redos.set(Fi())}}class JK{constructor(t){S(this,"scribbleItems",new Map);S(this,"state","paused");S(this,"addScribble",(t,n=Ge())=>{const r={id:n,scribble:{id:n,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...t,state:"starting"},timeoutMs:0,delayRemaining:t.delay??0,prev:null,next:null};return this.scribbleItems.set(n,r),this.state==="paused"&&this.resume(),r});S(this,"stop",t=>{const n=this.scribbleItems.get(t);if(!n)throw Error(`Scribble with id ${t} not found`);return n.delayRemaining=Math.min(n.delayRemaining,200),n.scribble.state="stopping",n});S(this,"addPoint",(t,n,r)=>{const o=this.scribbleItems.get(t);if(!o)throw Error(`Scribble with id ${t} not found`);const{prev:s}=o,i={x:n,y:r,z:.5};return(!s||E.Dist(s,i)>=1)&&(o.next=i),o});S(this,"tick",t=>{this.editor.batch(()=>{this.scribbleItems.forEach(n=>{if(n.scribble.state==="starting"){const{next:l,prev:c}=n;l&&l!==c&&(n.prev=l,n.scribble.points.push(l)),n.scribble.points.length>8&&(n.scribble.state="active");return}n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-t)),n.timeoutMs+=t,n.timeoutMs>=16&&(n.timeoutMs=0);const{delayRemaining:r,timeoutMs:o,prev:s,next:i,scribble:a}=n;switch(a.state){case"active":{i&&i!==s?(n.prev=i,a.points.push(i),r===0&&a.points.length>8&&a.points.shift()):o===0&&(a.points.length>1?a.points.shift():n.delayRemaining=a.delay);break}case"stopping":{if(n.delayRemaining===0&&o===0){if(a.points.length===1){this.scribbleItems.delete(n.id);return}a.shrink&&(a.size=Math.max(1,a.size*(1-a.shrink))),a.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:n})=>({...n,points:[...n.points]})).slice(-5)}),this.scribbleItems.size===0&&this.pause()})});this.editor=t}resume(){this.state="running",this.editor.addListener("tick",this.tick)}pause(){this.editor.removeListener("tick",this.tick),this.state="paused"}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear(),this.pause()}}class eW{constructor(t){S(this,"_beforeCreateHandlers",{});S(this,"_afterCreateHandlers",{});S(this,"_beforeChangeHandlers",{});S(this,"_afterChangeHandlers",{});S(this,"_beforeDeleteHandlers",{});S(this,"_afterDeleteHandlers",{});S(this,"_batchCompleteHandlers",[]);this.editor=t,t.store.onBeforeCreate=(r,o)=>{const s=this._beforeCreateHandlers[r.typeName];if(s){let i=r;for(const a of s)i=a(i,o);return i}return r},t.store.onAfterCreate=(r,o)=>{const s=this._afterCreateHandlers[r.typeName];if(s)for(const i of s)i(r,o)},t.store.onBeforeChange=(r,o,s)=>{const i=this._beforeChangeHandlers[o.typeName];if(i){let a=o;for(const l of i)a=l(r,a,s);return a}return o};let n=0;t.store.onAfterChange=(r,o,s)=>{if(n++,n>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{const i=this._afterChangeHandlers[o.typeName];if(i)for(const a of i)a(r,o,s)}n--},t.store.onBeforeDelete=(r,o)=>{const s=this._beforeDeleteHandlers[r.typeName];if(s){for(const i of s)if(i(r,o)===!1)return!1}},t.store.onAfterDelete=(r,o)=>{const s=this._afterDeleteHandlers[r.typeName];if(s)for(const i of s)i(r,o)},t.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach(r=>r())}}registerBeforeCreateHandler(t,n){return this._beforeCreateHandlers[t]||(this._beforeCreateHandlers[t]=[]),this._beforeCreateHandlers[t].push(n),()=>zi(this._beforeCreateHandlers[t],n)}registerAfterCreateHandler(t,n){return this._afterCreateHandlers[t]||(this._afterCreateHandlers[t]=[]),this._afterCreateHandlers[t].push(n),()=>zi(this._afterCreateHandlers[t],n)}registerBeforeChangeHandler(t,n){return this._beforeChangeHandlers[t]||(this._beforeChangeHandlers[t]=[]),this._beforeChangeHandlers[t].push(n),()=>zi(this._beforeChangeHandlers[t],n)}registerAfterChangeHandler(t,n){return this._afterChangeHandlers[t]||(this._afterChangeHandlers[t]=[]),this._afterChangeHandlers[t].push(n),()=>zi(this._afterChangeHandlers[t],n)}registerBeforeDeleteHandler(t,n){return this._beforeDeleteHandlers[t]||(this._beforeDeleteHandlers[t]=[]),this._beforeDeleteHandlers[t].push(n),()=>zi(this._beforeDeleteHandlers[t],n)}registerAfterDeleteHandler(t,n){return this._afterDeleteHandlers[t]||(this._afterDeleteHandlers[t]=[]),this._afterDeleteHandlers[t].push(n),()=>zi(this._afterDeleteHandlers[t],n)}registerBatchCompleteHandler(t){return this._batchCompleteHandlers.push(t),()=>zi(this._batchCompleteHandlers,t)}}function zi(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}var tW=Object.defineProperty,nW=Object.getOwnPropertyDescriptor,ka=(e,t,n,r)=>{for(var o=nW(t,n),s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=i(t,n,o)||o);return o&&tW(t,n,o),o};const he=e=>Math.round(e*10**8)/10**8;function Yo(e,t,n,r,o){const s=e.filter(a=>(r==="forward"?a.startNode.id===t:a.endNode.id===t)&&he(a.length)===he(n)&&Gr(a.breadthIntersection[0],a.breadthIntersection[1],o[0],o[1]));if(s.length===0)return[];const i=new Set;return s.forEach(a=>{const l=r==="forward"?a.endNode.id:a.startNode.id;if(!i.has(l)){i.add(l);const c=Yo(e,l,n,r,Gr(a.breadthIntersection[0],a.breadthIntersection[1],o[0],o[1]));s.push(...c)}}),s}function rW(e){e.sort((t,n)=>n.gaps.length-t.gaps.length);for(let t=e.length-1;t>0;t--){const n=e[t];for(let r=t-1;r>=0;r--){const o=e[r];if(o.direction===n.direction&&n.gaps.every(s=>o.gaps.some(i=>he(s.startEdge[0].x)===he(i.startEdge[0].x)&&he(s.startEdge[0].y)===he(i.startEdge[0].y)&&he(s.startEdge[1].x)===he(i.startEdge[1].x)&&he(s.startEdge[1].y)===he(i.startEdge[1].y))&&o.gaps.some(i=>he(s.endEdge[0].x)===he(i.endEdge[0].x)&&he(s.endEdge[0].y)===he(i.endEdge[0].y)&&he(s.endEdge[1].x)===he(i.endEdge[1].x)&&he(s.endEdge[1].y)===he(i.endEdge[1].y)))){e.splice(t,1);break}}}}class _i{constructor(t){S(this,"_snapLines",kn("snapLines",void 0));this.editor=t}getLines(){return this._snapLines.get()??ss}clear(){this.getLines().length&&this._snapLines.set(void 0)}setLines(t){this._snapLines.set(t)}getSnapPointsCache(){const{editor:t}=this;return t.store.createComputedCache("snapPoints",n=>{const r=t.getShapePageTransform(n.id);return r?this.editor.getShapeGeometry(n).snapPoints.map((s,i)=>{const{x:a,y:l}=se.applyToPoint(r,s);return{x:a,y:l,id:`${n.id}:${i}`}}):void 0})}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:t}=this,n=t.getRenderingBounds(),r=t.getSelectedShapeIds(),o=[],s=i=>{const a=t.getSortedChildIdsForParent(i);for(const l of a){if(r.includes(l))continue;const c=t.getShape(l);if(!c||!t.getShapeUtil(c).canSnap(c))continue;const d=t.getShapePageBounds(l);if(d&&n.includes(d)){if(t.isShapeOfType(c,"group")){s(l);continue}o.push({id:l,pageBounds:d,isClosed:t.getShapeGeometry(c).isClosed})}}};return s(this.getCurrentCommonAncestor()??t.getCurrentPageId()),o}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}getSnappablePoints(){const t=this.getSnapPointsCache(),n=this.getSnappableShapes(),r=[];return n.forEach(o=>{const s=t.get(o.id);s&&r.push(...s)}),r}getVisibleGaps(){const t=[],n=[];let r,o;const s=this.getSnappableShapes().sort((a,l)=>a.pageBounds.minX-l.pageBounds.minX);for(let a=0;a<s.length;a++){r=s[a];for(let l=a+1;l<s.length;l++)o=s[l],r.pageBounds.maxX<o.pageBounds.minX&&Gc(r.pageBounds.minY,r.pageBounds.maxY,o.pageBounds.minY,o.pageBounds.maxY)&&t.push({startNode:r,endNode:o,startEdge:[new E(r.pageBounds.maxX,r.pageBounds.minY),new E(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new E(o.pageBounds.minX,o.pageBounds.minY),new E(o.pageBounds.minX,o.pageBounds.maxY)],length:o.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:Gr(r.pageBounds.minY,r.pageBounds.maxY,o.pageBounds.minY,o.pageBounds.maxY)})}const i=s.sort((a,l)=>a.pageBounds.minY-l.pageBounds.minY);for(let a=0;a<i.length;a++){r=i[a];for(let l=a+1;l<i.length;l++)o=i[l],r.pageBounds.maxY<o.pageBounds.minY&&Gc(r.pageBounds.minX,r.pageBounds.maxX,o.pageBounds.minX,o.pageBounds.maxX)&&n.push({startNode:r,endNode:o,startEdge:[new E(r.pageBounds.minX,r.pageBounds.maxY),new E(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new E(o.pageBounds.minX,o.pageBounds.minY),new E(o.pageBounds.maxX,o.pageBounds.minY)],length:o.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:Gr(r.pageBounds.minX,r.pageBounds.maxX,o.pageBounds.minX,o.pageBounds.maxX)})}return{horizontal:t,vertical:n}}snapTranslate({lockedAxis:t,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:o}){var m,v;const s=this.getSnapThreshold(),i=this.getSnappablePoints(),a=n.clone().translate(o),l=r.map(({x,y:w},C)=>({id:"selection:"+C,x:x+o.x,y:w+o.y})),c=i,u=[],d=[],h=new E(s,s);this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const f=new E(t==="x"?0:((m=u[0])==null?void 0:m.nudge)??0,t==="y"?0:((v=d[0])==null?void 0:v.nudge)??0);h.x=0,h.y=0,u.length=0,d.length=0,l.forEach(x=>{x.x+=f.x,x.y+=f.y}),a.translate(f),this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const y=this.getPointSnapLines({nearestSnapsX:u,nearestSnapsY:d}),g=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d});return this._snapLines.set([...g,...y]),{nudge:f}}getOutlinesInPageSpace(){return this.getSnappableShapes().map(({id:t,isClosed:n})=>{const r=hn(this.editor.getShapeGeometry(t).vertices);n&&r.push(r[0]);const o=this.editor.getShapePageTransform(t);if(!o)throw Error("No page transform");return se.applyToPoints(o,r)})}getSnappingHandleDelta({handlePoint:t,additionalSegments:n}){const r=this.getSnapThreshold(),o=this.getOutlinesInPageSpace();let s=r,i=null,a,l,c,u;const d=[...o,...n];for(const h of d)for(let f=0;f<h.length-1;f++)a=h[f],l=h[f+1],c=E.NearestPointOnLineSegment(a,l,t),u=E.Dist(t,c),!isNaN(u)&&u<s&&(s=u,i=c);return i?(this._snapLines.set([{id:Ge(),type:"points",points:[i]}]),E.Sub(i,t)):null}snapResize({initialSelectionPageBounds:t,dragDelta:n,handle:r,isAspectRatioLocked:o,isResizingFromCenter:s}){var I,_;const i=this.getSnapThreshold(),{box:a,scaleX:l,scaleY:c}=le.Resize(t,r,s?n.x*2:n.x,s?n.y*2:n.y,o);let u=r;l<0&&(u=FH(u)),c<0&&(u=LH(u)),s&&(a.center=t.center);const d=u==="top"||u==="bottom",h=u==="left"||u==="right",f=$k(u,a),y=this.getSnappablePoints(),g=[],m=[],v=new E(i,i);this.collectPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:y,selectionSnapPoints:f});const x=new E(d?0:((I=g[0])==null?void 0:I.nudge)??0,h?0:((_=m[0])==null?void 0:_.nudge)??0);if(o&&zH(u)&&x.len()!==0){const M=g.length&&m.length?Math.abs(x.x)<Math.abs(x.y)?"x":"y":g.length?"x":"y",T=t.aspectRatio;M==="x"?(m.length=0,x.y=x.x/T,(u==="bottom_left"||u==="top_right")&&(x.y=-x.y)):(g.length=0,x.x=x.y*T,(u==="bottom_left"||u==="top_right")&&(x.x=-x.x))}const w=E.Add(n,x),{box:C}=le.Resize(t,r,s?w.x*2:w.x,s?w.y*2:w.y,o);s&&(C.center=t.center);const P=$k("any",C);g.length=0,m.length=0,v.x=0,v.y=0,this.collectPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:y,selectionSnapPoints:P});const k=this.getPointSnapLines({nearestSnapsX:g,nearestSnapsY:m});return this._snapLines.set([...k]),{nudge:x}}collectPointSnaps({selectionSnapPoints:t,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:o,nearestSnapsY:s}){for(const i of t)for(const a of n){const l=E.Sub(i,a),c=Math.abs(l.x),u=Math.abs(l.y);he(c)<=he(r.x)&&(he(c)<he(r.x)&&(o.length=0),o.push({type:"points",points:{thisPoint:i,otherPoint:a},nudge:a.x-i.x}),r.x=c),he(u)<=he(r.y)&&(he(u)<he(r.y)&&(s.length=0),s.push({type:"points",points:{thisPoint:i,otherPoint:a},nudge:a.y-i.y}),r.y=u)}}collectGapSnaps({selectionPageBounds:t,minOffset:n,nearestSnapsX:r,nearestSnapsY:o}){const{horizontal:s,vertical:i}=this.getVisibleGaps();for(const a of s){if(!Gc(a.breadthIntersection[0],a.breadthIntersection[1],t.minY,t.maxY))continue;const c=a.startEdge[0].x+a.length/2-t.center.x;if(a.length>t.width&&he(Math.abs(c))<=he(n.x)){he(Math.abs(c))<he(n.x)&&(r.length=0),n.x=Math.abs(c);const v={type:"gap_center",gap:a,nudge:c},x=r.find(({type:C})=>C==="gap_center"),w=x&&Gr(a.breadthIntersection[0],a.breadthIntersection[1],x.gap.breadthIntersection[0],x.gap.breadthIntersection[1]);x&&x.gap.length>a.length&&w?r[r.indexOf(x)]=v:(!x||!w)&&r.push(v)}const d=a.startNode.pageBounds.minX-a.length,h=t.maxX,f=d-h;he(Math.abs(f))<=he(n.x)&&(he(Math.abs(f))<he(n.x)&&(r.length=0),n.x=Math.abs(f),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"left",nudge:f}));const y=a.endNode.pageBounds.maxX+a.length,g=t.minX,m=y-g;he(Math.abs(m))<=he(n.x)&&(he(Math.abs(m))<he(n.x)&&(r.length=0),n.x=Math.abs(m),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"right",nudge:m}))}for(const a of i){if(!Gc(a.breadthIntersection[0],a.breadthIntersection[1],t.minX,t.maxX))continue;const c=a.startEdge[0].y+a.length/2-t.center.y;if(a.length>t.height&&he(Math.abs(c))<=he(n.y)){he(Math.abs(c))<he(n.y)&&(o.length=0),n.y=Math.abs(c);const v={type:"gap_center",gap:a,nudge:c},x=o.find(({type:C})=>C==="gap_center"),w=x&&Gc(x.gap.breadthIntersection[0],x.gap.breadthIntersection[1],a.breadthIntersection[0],a.breadthIntersection[1]);x&&x.gap.length>a.length&&w?o[o.indexOf(x)]=v:(!x||!w)&&o.push(v);continue}const d=a.startNode.pageBounds.minY-a.length,h=t.maxY,f=d-h;he(Math.abs(f))<=he(n.y)&&(he(Math.abs(f))<he(n.y)&&(o.length=0),n.y=Math.abs(f),o.push({type:"gap_duplicate",gap:a,protrusionDirection:"top",nudge:f}));const y=a.endNode.pageBounds.maxY+a.length,g=t.minY,m=y-g;he(Math.abs(m))<=he(n.y)&&(he(Math.abs(m))<he(n.y)&&(o.length=0),n.y=Math.abs(m),o.push({type:"gap_duplicate",gap:a,protrusionDirection:"bottom",nudge:m}))}}getPointSnapLines({nearestSnapsX:t,nearestSnapsY:n}){const r={},o={};if(t.length>0){for(const s of t)if(s.type==="points"){const i=he(s.points.otherPoint.x);r[i]||(r[i]=[]),r[i].push(s.points)}}if(n.length>0){for(const s of n)if(s.type==="points"){const i=he(s.points.otherPoint.y);o[i]||(o[i]=[]),o[i].push(s.points)}}return Object.values(r).concat(Object.values(o)).map(s=>({id:Ge(),type:"points",points:og(s.map(i=>E.From(i.otherPoint)).concat(s.map(i=>E.From(i.thisPoint))),(i,a)=>i.equals(a))}))}getGapSnapLines({selectionPageBounds:t,nearestSnapsX:n,nearestSnapsY:r}){const{vertical:o,horizontal:s}=this.getVisibleGaps(),i={top:t.sides[0],right:t.sides[1],bottom:[t.corners[3],t.corners[2]],left:[t.corners[0],t.corners[3]]},a=[];if(n.length>0)for(const l of n){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:d,endNode:h,length:f,endEdge:y}}=l;switch(l.type){case"gap_center":{const g=(f-t.width)/2,m=Gr(c[0],c[1],t.minY,t.maxY);a.push({type:"gaps",direction:"horizontal",id:Ge(),gaps:[...Yo(s,d.id,g,"backward",m),{startEdge:u,endEdge:i.left},{startEdge:i.right,endEdge:y},...Yo(s,h.id,g,"forward",m)]});break}case"gap_duplicate":{const g=Gr(c[0],c[1],t.minY,t.maxY);a.push({type:"gaps",direction:"horizontal",id:Ge(),gaps:l.protrusionDirection==="left"?[{startEdge:i.right,endEdge:u.map(m=>m.clone().addXY(-d.pageBounds.width,0))},{startEdge:u,endEdge:y},...Yo(s,h.id,f,"forward",g)]:[...Yo(s,d.id,f,"backward",g),{startEdge:u,endEdge:y},{startEdge:y.map(m=>m.clone().addXY(l.gap.endNode.pageBounds.width,0)),endEdge:i.left}]});break}}}if(r.length>0)for(const l of r){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:d,endNode:h,length:f,endEdge:y}}=l;switch(l.type){case"gap_center":{const g=(f-t.height)/2,m=Gr(c[0],c[1],t.minX,t.maxX);a.push({type:"gaps",direction:"vertical",id:Ge(),gaps:[...Yo(o,d.id,g,"backward",m),{startEdge:u,endEdge:i.top},{startEdge:i.bottom,endEdge:y},...Yo(o,l.gap.endNode.id,g,"forward",m)]});break}case"gap_duplicate":{const g=Gr(c[0],c[1],t.minX,t.maxX);a.push({type:"gaps",direction:"vertical",id:Ge(),gaps:l.protrusionDirection==="top"?[{startEdge:i.bottom,endEdge:u.map(m=>m.clone().addXY(0,-d.pageBounds.height))},{startEdge:u,endEdge:y},...Yo(o,h.id,f,"forward",g)]:[...Yo(o,d.id,f,"backward",g),{startEdge:u,endEdge:y},{startEdge:y.map(m=>m.clone().addXY(0,h.pageBounds.height)),endEdge:i.top}]})}break}}return rW(a),a}}ka([Z],_i.prototype,"getSnapPointsCache");ka([Z],_i.prototype,"getSnapThreshold");ka([Z],_i.prototype,"getSnappableShapes");ka([Z],_i.prototype,"getCurrentCommonAncestor");ka([Z],_i.prototype,"getSnappablePoints");ka([Z],_i.prototype,"getVisibleGaps");ka([Z],_i.prototype,"getOutlinesInPageSpace");function $k(e,t){const{minX:n,maxX:r,minY:o,maxY:s}=t,i=[];switch(e){case"top":case"left":case"top_left":case"any":i.push({id:"top_left",handle:"top_left",x:n,y:o})}switch(e){case"top":case"right":case"top_right":case"any":i.push({id:"top_right",handle:"top_right",x:r,y:o})}switch(e){case"bottom":case"right":case"bottom_right":case"any":i.push({id:"bottom_right",handle:"bottom_right",x:r,y:s})}switch(e){case"bottom":case"left":case"bottom_left":case"any":i.push({id:"bottom_left",handle:"bottom_left",x:n,y:s})}return i}const oW=/\r?\n|\r/g;function Lk(e){return e.replace(oW,`
`).split(`
`).map(t=>t||" ").join(`
`)}const sW={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},iW=/\s/;class aW{constructor(t){S(this,"measureText",(t,n)=>{const r=this.getTextElement();r.setAttribute("dir","ltr"),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-style",n.fontStyle),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("font-size",n.fontSize+"px"),r.style.setProperty("line-height",n.lineHeight*n.fontSize+"px"),r.style.setProperty("max-width",n.maxWidth===null?null:n.maxWidth+"px"),r.style.setProperty("min-width",n.minWidth??null),r.style.setProperty("padding",n.padding),r.textContent=Lk(t);const o=r.getBoundingClientRect();return{x:0,y:0,w:o.width,h:o.height}});this.editor=t}getTextElement(){const t=document.querySelector(".tl-text-measure");t==null||t.remove();const n=document.createElement("div");return this.editor.getContainer().appendChild(n),n.id=`__textMeasure_${Ge()}`,n.classList.add("tl-text"),n.classList.add("tl-text-measure"),n.tabIndex=-1,n}measureElementTextNodeSpans(t,{shouldTruncateToFirstLine:n=!1}={}){const r=[],o=t.getBoundingClientRect(),s=-o.left,i=-o.top,a=new Range,l=t.childNodes[0];let c=0,u=null,d=null,h=0,f=!1;for(const y of t.childNodes)if(y.nodeType===Node.TEXT_NODE)for(const g of y.textContent??""){a.setStart(l,c),a.setEnd(l,c+g.length);const m=a.getClientRects(),v=m[m.length-1],x=v.top+i,w=v.left+s,C=v.right+s,P=iW.test(g);if(P!==d||x!==h||!u){if(u){if(n&&x!==h){f=!0;break}r.push(u)}u={box:{x:w,y:x,w:v.width,h:v.height},text:g}}else u.box.w=C-u.box.x,u.text+=g;d=P,h=x,c+=g.length}return u&&r.push(u),{spans:r,didTruncate:f}}measureTextSpans(t,n){if(t==="")return[];const r=n.overflow==="truncate-ellipsis"||n.overflow==="truncate-clip",o=this.getTextElement(),s=Math.ceil(n.width-n.padding*2);o.style.setProperty("width",`${s}px`),o.style.setProperty("height","min-content"),o.style.setProperty("dir","ltr"),o.style.setProperty("font-size",`${n.fontSize}px`),o.style.setProperty("font-family",n.fontFamily),o.style.setProperty("font-weight",n.fontWeight),o.style.setProperty("line-height",`${n.lineHeight*n.fontSize}px`),o.style.setProperty("text-align",sW[n.textAlign]),r&&(o.style.setProperty("overflow-wrap","anywhere"),o.style.setProperty("word-break","break-all")),t=Lk(t),o.textContent=t;const{spans:i,didTruncate:a}=this.measureElementTextNodeSpans(o,{shouldTruncateToFirstLine:r});if(n.overflow==="truncate-ellipsis"&&a){o.textContent="";const l=Math.ceil(this.measureElementTextNodeSpans(o).spans[0].box.w);o.style.setProperty("width",`${s-l}px`),o.textContent=t;const c=this.measureElementTextNodeSpans(o,{shouldTruncateToFirstLine:!0}).spans,u=c[c.length-1];return c.push({text:"",box:{x:Math.min(u.box.x+u.box.w,n.width-n.padding-l),y:u.box.y,w:l,h:u.box.h}}),c}return o.remove(),i}}class lW{constructor(t){S(this,"raf");S(this,"isPaused",!0);S(this,"last",0);S(this,"t",0);S(this,"start",()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()});S(this,"tick",()=>{if(this.isPaused)return;const t=Date.now(),n=t-this.last;if(this.last=t,this.t+=n,this.editor.emit("frame",n),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(n),this.editor.emit("tick",n),this.raf=requestAnimationFrame(this.tick)});S(this,"dispose",()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)});S(this,"prevPoint",new E);S(this,"updatePointerVelocity",t=>{const{prevPoint:n,editor:{inputs:{currentScreenPoint:r,pointerVelocity:o}}}=this;if(t===0)return;const s=E.Sub(r,n);this.prevPoint=r.clone();const i=s.len(),a=i?s.div(i):new E(0,0),l=o.clone().lrp(a.mul(i/t),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),o.equals(l)||(this.editor.inputs.pointerVelocity=l)});this.editor=t,this.editor.disposables.add(this.dispose),this.start()}}var cW=Object.defineProperty,uW=Object.getOwnPropertyDescriptor,bs=(e,t,n,r)=>{for(var o=uW(t,n),s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=i(t,n,o)||o);return o&&cW(t,n,o),o};class Fo{constructor(t,n){S(this,"updateUserPreferences",t=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...t})});this.user=t,this.inferDarkMode=n}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),isDarkMode:this.getIsDarkMode(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode()}}getIsDarkMode(){return this.user.userPreferences.get().isDarkMode??(this.inferDarkMode?SK():!1)}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??_r.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??_r.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??_r.name}getLocale(){return this.user.userPreferences.get().locale??_r.locale}getColor(){return this.user.userPreferences.get().color??_r.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??_r.isSnapMode}}bs([Z],Fo.prototype,"getUserPreferences");bs([Z],Fo.prototype,"getIsDarkMode");bs([Z],Fo.prototype,"getEdgeScrollSpeed");bs([Z],Fo.prototype,"getAnimationSpeed");bs([Z],Fo.prototype,"getId");bs([Z],Fo.prototype,"getName");bs([Z],Fo.prototype,"getLocale");bs([Z],Fo.prototype,"getColor");bs([Z],Fo.prototype,"getIsSnapMode");function qc(e){return Math.abs(e.props.bend)<8}function kg(e,t){if(t.type==="point")return;const n=e.getShape(t.boundShapeId),r=e.getShapePageTransform(n),o=e.getShapeGeometry(n),s=o instanceof Qs?o.children[0].vertices:o.vertices;return{shape:n,transform:r,isClosed:o.isClosed,isExact:t.isExact,didIntersect:!1,outline:s}}function Fk(e,t,n,r){if(n.type==="point")return E.From(n);const o=e.getShape(n.boundShapeId);if(o){const{point:s,size:i}=e.getShapeGeometry(o).bounds,a=E.Add(s,E.MulV(n.isPrecise||r?n.normalizedAnchor:{x:.5,y:.5},i)),l=se.applyToPoint(e.getShapePageTransform(o),a);return se.applyToPoint(se.Inverse(t),l)}else return new E(0,0)}function Qr(e,t){const n=e.getShapePageTransform(t);let r,o;t.props.start.type==="binding"&&t.props.end.type==="binding"&&(r=t.props.start.boundShapeId,o=t.props.end.boundShapeId);const s=gb(e,r,o),i=Fk(e,n,t.props.start,s==="double-bound"||s==="start-contains-end"),a=Fk(e,n,t.props.end,s==="double-bound"||s==="end-contains-start");return{start:i,end:a}}const fl=10,Eg=10,dW=10,Zs={s:2,m:3.5,l:5,xl:10};function gb(e,t,n){if(!t||!n)return"safe";if(t===n)return"double-bound";const r=e.getShapePageBounds(t),o=e.getShapePageBounds(n);if(r&&o){if(r.contains(o))return"start-contains-end";if(o.contains(r))return"end-contains-start"}return"safe"}function Ru(e,t){const{start:n,end:r,arrowheadStart:o,arrowheadEnd:s}=t.props,i=Qr(e,t),a=i.start.clone(),l=i.end.clone(),c=E.Med(a,l);if(E.Equals(a,l))return{isStraight:!0,start:{handle:a,point:a,arrowhead:t.props.arrowheadStart},end:{handle:l,point:l,arrowhead:t.props.arrowheadEnd},middle:c,isValid:!1,length:0};const u=E.Sub(l,a).uni(),d=kg(e,n),h=kg(e,r),f=e.getShapePageTransform(t);zk(l,i.start,f,h),zk(a,i.end,f,d);let y=0,g=0,m=0,v=0,x=fl;const w=d&&h&&d.shape===h.shape,C=d&&h?gb(e,d.shape.id,h.shape.id):"safe";C==="safe"&&d&&h&&!w&&!d.isExact&&!h.isExact&&(h.didIntersect&&!d.didIntersect?d.isClosed&&a.setTo(l.clone().add(u.clone().mul(fl))):h.didIntersect||h.isClosed&&l.setTo(a.clone().sub(u.clone().mul(fl))));const P=E.Sub(l,a).uni(),k=!E.Equals(P,u);w||(C!=="start-contains-end"&&d&&o!=="none"&&!d.isExact&&(m=Zs[t.props.size]/2+("size"in d.shape.props?Zs[d.shape.props.size]/2:0),y=Eg+m,x+=m),C!=="end-contains-start"&&h&&s!=="none"&&!h.isExact&&(v=Zs[t.props.size]/2+("size"in h.shape.props?Zs[h.shape.props.size]/2:0),g=Eg+v,x+=v));const I=a.clone().add(P.clone().mul(y*(k?-1:1))),_=l.clone().sub(P.clone().mul(g*(k?-1:1)));E.Dist(I,_)<x&&(y!==0&&g!==0?(y*=-1.5,g*=-1.5):y!==0?y*=-1:g!==0&&(g*=-1)),a.add(P.clone().mul(y*(k?-1:1))),l.sub(P.clone().mul(g*(k?-1:1))),k?(d&&h&&l.setTo(E.Add(a,P.clone().mul(-fl))),c.setTo(E.Med(i.start,i.end))):c.setTo(E.Med(a,l));const T=E.Dist(a,l);return{isStraight:!0,start:{handle:i.start,point:a,arrowhead:t.props.arrowheadStart},end:{handle:i.end,point:l,arrowhead:t.props.arrowheadEnd},middle:c,isValid:T>0,length:T}}function zk(e,t,n,r){if(r===void 0||r.isExact)return;const o=se.applyToPoint(n,t),s=se.applyToPoint(n,e),i=se.applyToPoint(se.Inverse(r.transform),o),a=se.applyToPoint(se.Inverse(r.transform),s),l=r.isClosed,u=(l?_K:VA)(i,a,r.outline);let d;if(u!==null&&(d=u.sort((y,g)=>E.Dist(y,i)-E.Dist(g,i))[0]??(l?void 0:a)),d===void 0)return;const h=se.applyToPoint(r.transform,d),f=se.applyToPoint(se.Inverse(n),h);e.setTo(f),r.didIntersect=!0}function tv(e,t,n=0){const{arrowheadEnd:r,arrowheadStart:o}=t.props,s=t.props.bend+n;if(Math.abs(s)>Math.abs(t.props.bend*dW))return Ru(e,t);const i=Qr(e,t),a=E.Med(i.start,i.end),l=E.Sub(i.end,i.start).uni(),c=E.Add(a,l.per().mul(-s)),u=kg(e,t.props.start),d=kg(e,t.props.end),h=i.start.clone(),f=i.end.clone(),y=c.clone();if(E.Equals(h,f))return{isStraight:!0,start:{handle:h,point:h,arrowhead:t.props.arrowheadStart},end:{handle:f,point:f,arrowhead:t.props.arrowheadEnd},middle:y,isValid:!1,length:0};const g=t.props.bend<0,m=g?xm:AB,v=Bk(h,f,y),x=E.Angle(v.center,h),w=E.Angle(v.center,f),C=m(x,w);if(v.length===0||v.size===0||!ak(v.length)||!ak(v.size))return Ru(e,t);const P=h.clone(),k=f.clone(),I=y.clone(),_=e.getShapePageTransform(t);let M=0,T=0,R=fl;if(u&&!u.isExact){const V=se.applyToPoint(_,P),K=se.applyToPoint(_,v.center),J=se.applyToPoint(_,k),ne=se.Inverse(u.transform),me=se.applyToPoint(ne,V),te=se.applyToPoint(ne,K),de=se.applyToPoint(ne,J),{isClosed:Te}=u,Oe=Te?Mk:Ak;let Pe,Fe=Oe(te,v.radius,u.outline);if(Fe){const je=te.angle(me),$t=te.angle(de),kt=m(je,$t);Fe=Fe.filter(mt=>m(je,te.angle(mt))<=kt);const Lt=kt*.25;Fe.sort(Te?(mt,et)=>Math.abs(m(je,te.angle(mt))-Lt)<Math.abs(m(je,te.angle(et))-Lt)?-1:1:(mt,et)=>m(je,te.angle(mt))<m(je,te.angle(et))?-1:1),Pe=Fe[0]??(Te?void 0:me)}else Pe=Te?void 0:me;if(Pe&&(P.setTo(e.getPointInShapeSpace(t,se.applyToPoint(u.transform,Pe))),u.didIntersect=!0,o!=="none")){const je=Zs[t.props.size]/2+("size"in u.shape.props?Zs[u.shape.props.size]/2:0);M=Eg+je,R+=je}}if(d&&!d.isExact){const V=se.applyToPoint(_,P),K=se.applyToPoint(_,k),J=se.applyToPoint(_,v.center),ne=se.Inverse(d.transform),me=se.applyToPoint(ne,V),te=se.applyToPoint(ne,J),de=se.applyToPoint(ne,K),Te=d.isClosed,Oe=Te?Mk:Ak;let Pe,Fe=Oe(te,v.radius,d.outline);if(Fe){const je=te.angle(me),$t=te.angle(de),kt=m(je,$t),Lt=kt*.75;Fe=Fe.filter(mt=>m(je,te.angle(mt))<=kt),Fe.sort(Te?(mt,et)=>Math.abs(m(je,te.angle(mt))-Lt)<Math.abs(m(je,te.angle(et))-Lt)?-1:1:(mt,et)=>m(je,te.angle(mt))<m(je,te.angle(et))?-1:1),Fe[0]?Pe=Fe[0]:Pe=Te?void 0:de}else Pe=Te?void 0:de;if(Pe&&(k.setTo(e.getPointInShapeSpace(t,se.applyToPoint(d.transform,Pe))),d.didIntersect=!0,r!=="none")){const je=Zs[t.props.size]/2+("size"in d.shape.props?Zs[d.shape.props.size]/2:0);T=Eg+je,R+=je}}let j=E.Angle(v.center,P),$=E.Angle(v.center,k),L=m(j,$),U=L*v.radius;const F=P.clone(),G=k.clone();if(M!==0){const V=M/U*(g?1:-1),K=E.FromAngle(j+L*V);F.setTo(v.center).add(K.mul(v.radius))}if(T!==0){const V=T/U*(g?-1:1),K=E.FromAngle($+L*V);G.setTo(v.center).add(K.mul(v.radius))}if(E.Dist(F,G)<R&&(M!==0&&T!==0?(M*=-1.5,T*=-1.5):M!==0?M*=-2:T!==0&&(T*=-2)),M!==0){const V=M/U*(g?1:-1),K=E.FromAngle(j+L*V);P.setTo(v.center).add(K.mul(v.radius))}if(T!==0){const V=T/U*(g?-1:1),K=E.FromAngle($+L*V);k.setTo(v.center).add(K.mul(v.radius))}if(u&&d&&!u.isExact&&!d.isExact){j=E.Angle(v.center,P),$=E.Angle(v.center,k),L=m(j,$),U=L*v.radius;const V=gb(e,u.shape.id,d.shape.id);if(V==="double-bound"&&U<30)P.setTo(h),k.setTo(f),I.setTo(y);else if(V==="safe"&&(u&&!u.didIntersect&&P.setTo(h),d&&!d.didIntersect||m(x,j)>m(x,$))){const K=Math.min(.9,fl/U)*(g?1:-1),J=E.FromAngle(j+L*K);k.setTo(v.center).add(J.mul(v.radius))}}hW(v.center,v.radius,P,k,I,C,g),P.equals(k)&&(P.setTo(I.clone().addXY(1,1)),k.setTo(I.clone().subXY(1,1))),h.setTo(P),f.setTo(k),y.setTo(I);const z=Bk(h,f,y);return{isStraight:!1,start:{point:h,handle:i.start,arrowhead:t.props.arrowheadStart},end:{point:f,handle:i.end,arrowhead:t.props.arrowheadEnd},middle:y,handleArc:v,bodyArc:z,isValid:z.length!==0&&isFinite(z.center.x)&&isFinite(z.center.y)}}function Bk(e,t,n){const r=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),o={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/r},s=E.Dist(o,e),i=+E.Clockwise(e,n,t),a=Math.hypot(e.y-t.y,e.x-t.x),l=Math.hypot(t.y-n.y,t.x-n.x),c=Math.hypot(n.y-e.y,n.x-e.x),u=Math.acos((l*l+c*c-a*a)/(2*l*c))*2,d=+($e>u),h=(Ue-u)*(i?1:-1),f=h*s;return{center:o,radius:s,size:h,length:f,largeArcFlag:d,sweepFlag:i}}function hW(e,t,n,r,o,s,i){const a=E.Angle(e,n),l=E.Angle(e,r);let c=xm(a,l);i||(c=Ue-c);const u=.5*(i?1:-1),d=E.FromAngle(a+c*u);if(o.setTo(e).add(d.mul(t)),c>s){o.rotWith(e,$e);const h=r.clone();r.setTo(n),n.setTo(h)}}const pW={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"};class ie{constructor(t,n){S(this,"id");S(this,"type");S(this,"shapeType");S(this,"initial");S(this,"children");S(this,"parent");S(this,"_path");S(this,"_current");S(this,"_isActive");S(this,"transition",(t,n={})=>{var s;const r=t.split(".");let o=this;for(let i=0;i<r.length;i++){const a=r[i],l=o.getCurrent(),c=(s=o.children)==null?void 0:s[a];if(!c)throw Error(`${o.id} - no child state exists with the id ${a}.`);if((l==null?void 0:l.id)!==c.id&&(l==null||l.exit(n,a),o._current.set(c),c.enter(n,(l==null?void 0:l.id)||"initial"),!c.getIsActive()))break;o=c}return this});S(this,"handleEvent",t=>{var o;const n=pW[t.name],r=this.getCurrent();(o=this[n])==null||o.call(this,t),this.getCurrent()===r&&this.getIsActive()&&(r==null||r.handleEvent(t))});S(this,"enter",(t,n)=>{var r;if(this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,t,n),this.onTick&&this.editor.on("tick",this.onTick),this.children&&this.initial&&this.getIsActive()){const o=this.children[this.initial];this._current.set(o),o.enter(t,n)}});S(this,"exit",(t,n)=>{var r,o;this._isActive.set(!1),this.onTick&&this.editor.off("tick",this.onTick),(r=this.onExit)==null||r.call(this,t,n),this.getIsActive()||(o=this.getCurrent())==null||o.exit(t,n)});S(this,"_currentToolIdMask",kn("curent tool id mask",void 0));S(this,"onWheel");S(this,"onPointerDown");S(this,"onPointerMove");S(this,"onPointerUp");S(this,"onDoubleClick");S(this,"onTripleClick");S(this,"onQuadrupleClick");S(this,"onRightClick");S(this,"onMiddleClick");S(this,"onKeyDown");S(this,"onKeyUp");S(this,"onKeyRepeat");S(this,"onCancel");S(this,"onComplete");S(this,"onInterrupt");S(this,"onEnter");S(this,"onExit");S(this,"onTick");this.editor=t;const{id:r,children:o,initial:s}=this.constructor;this.id=r,this._isActive=kn("toolIsActive"+this.id,!1),this._current=kn("toolState"+this.id,void 0),this._path=Z("toolPath"+this.id,()=>{const i=this.getCurrent();return this.id+(i?`.${i.getPath()}`:"")}),this.parent=n??{},this.parent?o&&s?(this.type="branch",this.initial=s,this.children=Object.fromEntries(o().map(i=>[i.id,new i(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",o&&s&&(this.initial=s,this.children=Object.fromEntries(o().map(i=>[i.id,new i(this.editor,this)])),this._current.set(this.children[this.initial])))}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(t){this._currentToolIdMask.set(t)}}S(ie,"id"),S(ie,"initial"),S(ie,"children");class Bp extends ie{constructor(){super(...arguments);S(this,"onKeyDown",n=>{var r;switch(n.code){case"KeyZ":{if(!(n.shiftKey||n.ctrlKey)){const o=this.getCurrent();o&&((r=o.getCurrent())==null?void 0:r.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...n,onInteractionEnd:o.id})}break}}})}}S(Bp,"id","root"),S(Bp,"initial",""),S(Bp,"children",()=>[]);var fW=Object.defineProperty,gW=Object.getOwnPropertyDescriptor,ue=(e,t,n,r)=>{for(var o=gW(t,n),s=e.length-1,i;s>=0;s--)(i=e[s])&&(o=i(t,n,o)||o);return o&&fW(t,n,o),o};class ce extends IK.EventEmitter{constructor({store:n,user:r,shapeUtils:o,tools:s,getContainer:i,initialState:a,inferDarkMode:l}){super();S(this,"store");S(this,"root");S(this,"disposables",new Set);S(this,"_tickManager",new lW(this));S(this,"snaps");S(this,"user");S(this,"textMeasure");S(this,"environment");S(this,"scribbles");S(this,"getContainer");S(this,"sideEffects");S(this,"shapeUtils");S(this,"styleProps");S(this,"history",new ZK(this,n=>{this.annotateError(n,{origin:"history.batch",willCrashApp:!0}),this.crash(n)}));S(this,"_crashingError",null);S(this,"_updateInstanceState",this.history.createCommand("updateInstanceState",(n,r)=>{const o=this.store.get(this.getInstanceState().id),s={...o,...n};return{data:{prev:o,next:s},ephemeral:!1,squashing:!1,...r}},{do:({next:n})=>{this.store.put([n])},undo:({prev:n})=>{this.store.put([n])},squash({prev:n},{next:r}){return{prev:n,next:r}}}));S(this,"_isChangingStyleTimeout",-1);S(this,"setCursor",n=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...n}},{ephemeral:!0}),this));S(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(n,r)=>({data:{prev:this.store.get(n.id??this.getCurrentPageState().id),partial:n},...r}),{do:({prev:n,partial:r})=>{this.store.update(n.id,o=>({...o,...r}))},undo:({prev:n})=>{this.store.update(n.id,()=>n)}}));S(this,"_setSelectedShapes",this.history.createCommand("setSelectedShapes",(n,r)=>{const{selectedShapeIds:o}=this.getCurrentPageState(),s=new Set(o);return n.length===s.size&&n.every(i=>s.has(i))?null:{data:{selectedShapeIds:n,prevSelectedShapeIds:o},preservesRedoStack:!0,...r}},{do:({selectedShapeIds:n})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:n}])},undo:({prevSelectedShapeIds:n})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:n}])},squash({prevSelectedShapeIds:n},{selectedShapeIds:r}){return{selectedShapeIds:r,prevSelectedShapeIds:n}}}));S(this,"_setFocusedGroupId",this.history.createCommand("setFocusedGroupId",n=>{const r=this.getCurrentPageState().focusedGroupId;if(r!==n)return{data:{prev:r,next:n},preservesRedoStack:!0,squashing:!0}},{do:({next:n})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:n}))},undo:({prev:n})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:n}))},squash({prev:n},{next:r}){return{prev:n,next:r}}}));S(this,"_viewportAnimation",null);S(this,"_willSetInitialBounds",!0);S(this,"_cameraState",kn("camera state","idle"));S(this,"_cameraStateTimeoutRemaining",0);S(this,"_lastUpdateRenderingBoundsTimestamp",Date.now());S(this,"_decayCameraStateTimeout",n=>{this._cameraStateTimeoutRemaining-=n,this._cameraStateTimeoutRemaining<=0&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"),this.updateRenderingBounds())});S(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=qB;const n=Date.now();this._cameraState.__unsafe__getWithoutCapture()==="idle"?(this._lastUpdateRenderingBoundsTimestamp=n,this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout)):n-this._lastUpdateRenderingBoundsTimestamp>QB&&this.updateRenderingBounds()});S(this,"_renderingBounds",kn("rendering viewport",new le));S(this,"_renderingBoundsExpanded",kn("rendering viewport expanded",new le));S(this,"renderingBoundsMargin",100);S(this,"_currentPageShapeIds");S(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(n,r)=>{if(!this.store.has(n)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return this.stopFollowingUser(),{data:{toId:n,fromId:this.getCurrentPageId()},squashing:!0,preservesRedoStack:!0,...r}},{do:({toId:n})=>{if(this.store.has(n)){if(!this.getPageStates().find(r=>r.pageId===n)){const r=on.create({id:on.createId(n)});this.store.put([r,sn.create({id:sn.createId(n),pageId:n})])}this.store.put([{...this.getInstanceState(),currentPageId:n}]),this.updateRenderingBounds()}},undo:({fromId:n})=>{this.store.has(n)&&(this.store.put([{...this.getInstanceState(),currentPageId:n}]),this.updateRenderingBounds())},squash:({fromId:n},{toId:r})=>({toId:r,fromId:n})}));S(this,"_updatePage",this.history.createCommand("updatePage",(n,r)=>{if(this.getInstanceState().isReadonly)return null;const o=this.getPage(n.id);return o?{data:{prev:o,partial:n},...r}:null},{do:({partial:n})=>{this.store.update(n.id,r=>({...r,...n}))},undo:({prev:n,partial:r})=>{this.store.update(r.id,()=>n)},squash(n,r){return{prev:{...n.prev,...r.prev},partial:r.partial}}}));S(this,"_createPage",this.history.createCommand("createPage",n=>{if(this.getInstanceState().isReadonly||this.getPages().length>=vg)return null;const r=this.getPages(),o=NK(n.name??"Page 1",r.map(c=>c.name));let s=n.index;(!s||r.some(c=>c.index===s))&&(s=Zo(r[r.length-1].index));const i=ms.create({meta:{},...n,name:o,index:s}),a=on.create({id:on.createId(i.id)}),l=sn.create({id:sn.createId(i.id),pageId:i.id});return{data:{newPage:i,newTabPageState:l,newCamera:a}}},{do:({newPage:n,newTabPageState:r,newCamera:o})=>{this.store.put([n,o,r])},undo:({newPage:n,newTabPageState:r,newCamera:o})=>{this.getPages().length!==1&&this.store.remove([r.id,n.id,o.id])}}));S(this,"_deletePage",this.history.createCommand("delete_page",n=>{if(this.getInstanceState().isReadonly)return null;const r=this.getPages();if(r.length===1)return null;const o=this.getPage(n),s=this.getPageStates().filter(i=>i.pageId===n);if(!o)return null;if(n===this.getCurrentPageId()){const i=r.findIndex(l=>l.id===n),a=r[i-1]??r[i+1];this.setCurrentPage(a.id)}return{data:{id:n,deletedPage:o,deletedPageStates:s}}},{do:({deletedPage:n,deletedPageStates:r})=>{const o=this.getPages();if(o.length!==1){if(n.id===this.getCurrentPageId()){const s=o.findIndex(a=>a.id===n.id),i=o[s-1]??o[s+1];this.setCurrentPage(i.id)}this.store.remove(r.map(s=>s.id)),this.store.remove([n.id]),this.updateRenderingBounds()}},undo:({deletedPage:n,deletedPageStates:r})=>{this.store.put([n]),this.store.put(r),this.updateRenderingBounds()}}));S(this,"_createAssets",this.history.createCommand("createAssets",n=>this.getInstanceState().isReadonly||n.length<=0?null:{data:{assets:n}},{do:({assets:n})=>{this.store.put(n)},undo:({assets:n})=>{this.store.remove(n.map(r=>r.id))}}));S(this,"_updateAssets",this.history.createCommand("updateAssets",n=>this.getInstanceState().isReadonly||n.length<=0?void 0:{data:{snapshots:{},assets:n}},{do:({assets:n,snapshots:r})=>{this.store.put(n.map(o=>{const s=this.store.get(o.id);return r[o.id]=s,{...s,...o}}))},undo:({snapshots:n})=>{this.store.put(Object.values(n))}}));S(this,"_deleteAssets",this.history.createCommand("deleteAssets",n=>{if(this.getInstanceState().isReadonly||n.length<=0)return;const r=pe(n.map(o=>this.store.get(o)));return{data:{ids:n,prev:r}}},{do:({ids:n})=>{this.store.remove(n)},undo:({prev:n})=>{this.store.put(n)}}));S(this,"_parentIdsToChildIds");S(this,"_childIdsCache",new pb);S(this,"_createShapes",this.history.createCommand("createShapes",n=>{if(this.getInstanceState().isReadonly||n.length<=0)return null;const r=this.getCurrentPageShapeIds();if(n.length+r.size>Go){qh(this);return}return n.length===0?null:{data:{currentPageId:this.getCurrentPageId(),partials:n.map(s=>s.id?s:{...s,id:Je()})}}},{do:({partials:n})=>{var a,l;const r=this.getFocusedGroupId(),o=this.getCurrentPageShapesSorted();n=n.map(c=>{if(!c.parentId||!(this.store.has(c.parentId)||n.some(u=>u.id===c.parentId))){let u=this.getFocusedGroupId();for(let h=o.length-1;h>=0;h--){const f=o[h];if(this.getShapeUtil(f).canReceiveNewChildrenOfType(f,c.type)&&this.isPointInShape(f,{x:c.x??0,y:c.y??0},{margin:0,hitInside:!0})){u=f.id;break}}const d=c.parentId;if(u===c.id&&(u=r),u!==d&&(c={...c},c.parentId=u,Pr(u))){const h=this.getPointInShapeSpace(this.getShape(u),{x:c.x??0,y:c.y??0});c.x=h.x,c.y=h.y,c.rotation=-this.getShapePageTransform(u).rotation()+(c.rotation??0)}}return c});const s=new Map,i=[];for(const c of n){const u=this.getShapeUtil(c);let d=c.index;if(!d){const g=c.parentId??r;s.has(g)||s.set(g,this.getHighestIndexForParent(g)),d=s.get(g),s.set(g,Zo(d))}const h=u.getDefaultProps();for(const[g,m]of this.styleProps[c.type])h[m]=this.getStyleForNextShape(g);let f=this.store.schema.types.shape.create({...c,index:d,opacity:c.opacity??this.getInstanceState().opacityForNextShape,parentId:c.parentId??r,props:"props"in c?{...h,...c.props}:h});if(f.index===void 0)throw Error("no index!");const y=(l=(a=this.getShapeUtil(f)).onBeforeCreate)==null?void 0:l.call(a,f);y&&(f=y),i.push(f)}i.forEach(c=>{c.meta={...this.getInitialMetaForShape(c),...c.meta}}),this.store.put(i)},undo:({partials:n})=>{this.store.remove(n.map(r=>r.id))}}));S(this,"animatingShapes",new Map);S(this,"_updateShapes",this.history.createCommand("updateShapes",(n,r)=>{if(this.getInstanceState().isReadonly)return null;const o=pe(n),s=Object.fromEntries(pe(o.map(({id:l})=>this.getShape(l))).map(l=>[l.id,l]));if(o.length<=0)return null;const i=pe(o.map(l=>{const c=s[l.id];if(!c)return null;let u=null;for(const[d,h]of Object.entries(l))if(h!==void 0)switch(d){case"id":case"type":continue;default:if(h!==c[d])if(u||(u={...c}),d==="props"){const f={...c.props};for(const[y,g]of Object.entries(h))g!==void 0&&(f[y]=g);u.props=f}else if(d==="meta"){const f={...c.meta};for(const[y,g]of Object.entries(h))g!==void 0&&(f[y]=g);u.meta=f}else u[d]=h}return u??c})),a=Object.fromEntries(i.map(l=>[l.id,l]));return{data:{snapshots:s,updates:a},...r}},{do:({updates:n})=>{var o,s;const r=Object.values(n);for(let i=0;i<r.length;i++){const a=r[i],l=this.store.get(a.id);if(!l)continue;const c=(s=(o=this.getShapeUtil(a)).onBeforeUpdate)==null?void 0:s.call(o,l,a);c&&(r[i]=c)}this.store.put(r)},undo:({snapshots:n})=>{this.store.put(Object.values(n))},squash(n,r){return{snapshots:{...r.snapshots,...n.snapshots},updates:{...n.updates,...r.updates}}}}));S(this,"_deleteShapes",this.history.createCommand("delete_shapes",n=>{if(this.getInstanceState().isReadonly||n.length===0)return null;const r=[...this.getCurrentPageState().selectedShapeIds],o=new Set(n);for(const c of n)this.visitDescendants(c,u=>{o.add(u)});const s=[...o],i=this._getArrowBindingsIndex().get(),a=pe(s.flatMap(c=>{const u=this.getShape(c),d=i[c];return d&&d.length>0?d.map(({arrowId:h})=>this.getShape(h)).concat(u):u})),l=r.filter(c=>!o.has(c));return{data:{deletedIds:s,snapshots:a,prevSelectedShapeIds:r,postSelectedShapeIds:l}}},{do:({deletedIds:n,postSelectedShapeIds:r})=>{this.store.remove(n),this.store.update(this.getCurrentPageState().id,o=>({...o,selectedShapeIds:r}))},undo:({snapshots:n,prevSelectedShapeIds:r})=>{this.store.put(n),this.store.update(this.getCurrentPageState().id,o=>({...o,selectedShapeIds:r}))}}));S(this,"_selectionSharedStyles",Z("_selectionSharedStyles",()=>{const n=this.getSelectedShapes(),r=new HS;for(const o of n)this._extractSharedStyles(o,r);return r}));S(this,"externalAssetContentHandlers",{file:null,url:null});S(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null});S(this,"inputs",{originPagePoint:new E,originScreenPoint:new E,previousPagePoint:new E,previousScreenPoint:new E,currentPagePoint:new E,currentScreenPoint:new E,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new E});S(this,"_clickManager",new YK(this));S(this,"_prevCursor","default");S(this,"_shiftKeyTimeout",-1);S(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});S(this,"_altKeyTimeout",-1);S(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});S(this,"_ctrlKeyTimeout",-1);S(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});S(this,"_restoreToolId","select");S(this,"_pinchStart",1);S(this,"_didPinch",!1);S(this,"_selectedShapeIdsAtPointerDown",[]);S(this,"capturedPointerId",null);S(this,"dispatch",n=>{if(this.getCrashingError())return this;const{inputs:r}=this,{type:o}=n;return this.batch(()=>{if(n.type==="misc"){(n.name==="cancel"||n.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}))),this.root.handleEvent(n);return}n.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!n.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),n.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!n.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),n.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!n.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:s,originScreenPoint:i,currentPagePoint:a,currentScreenPoint:l}=r;switch(r.isPointing||(r.isDragging=!1),o){case"pinch":{if(!this.getInstanceState().canMoveCamera)return;switch(this._updateInputsFromEvent(n),n.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds()),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{x:c,y:u,z:d=1},delta:{x:h,y:f}}=n,{x:y,y:g,z:m}=this.getCamera(),v=Math.min(Us,Math.max(Yc,d));this.setCamera({x:y+h/m-c/m+c/v,y:g+f/m-u/m+u/v,z:v});return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedShapeIdsAtPointerDown:c}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown,{squashing:!0}),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,requestAnimationFrame(()=>{this._didPinch||this.setSelectedShapes(c,{squashing:!0})}));return}}}case"wheel":{if(!this.getInstanceState().canMoveCamera)return;if(this._updateInputsFromEvent(n),!this.getIsMenuOpen()){if(r.ctrlKey){const{x:c,y:u}=this.inputs.currentScreenPoint,{x:d,y:h,z:f}=this.getCamera(),y=Math.min(Us,Math.max(Yc,f+(n.delta.z??0)*f));this.setCamera({x:d+(c/y-c)-(c/f-c),y:h+(u/y-u)-(u/f-u),z:y});return}this.pan(n.delta),!r.isDragging&&r.isPointing&&s.dist(a)>(this.getInstanceState().isCoarsePointer?FS:ud)/this.getZoomLevel()&&(r.isDragging=!0)}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(n);const{isPen:c}=n;switch(n.name){case"pointer_down":{if(this.clearOpenMenus(),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),n.button===0&&(this.capturedPointerId=n.pointerId),r.buttons.add(n.button),r.isPointing=!0,r.isDragging=!1,this.getInstanceState().isPenMode){if(!c)return}else c&&this.updateInstanceState({isPenMode:!0});if(n.button===5?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):n.button===1&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.updateInstanceState({cursor:{type:"grabbing",rotation:0}}),this;i.setTo(l),s.setTo(a);break}case"pointer_move":{if(!c&&this.getInstanceState().isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:u,previousScreenPoint:d}=this.inputs;this.pan(E.Sub(u,d));return}!r.isDragging&&r.isPointing&&s.dist(a)>(this.getInstanceState().isCoarsePointer?FS:ud)/this.getZoomLevel()&&(r.isDragging=!0);break}case"pointer_up":{if(r.buttons.delete(n.button),r.isPointing=!1,r.isDragging=!1,this.getIsMenuOpen()||!c&&this.getInstanceState().isPenMode)return;this.capturedPointerId===n.pointerId&&(this.capturedPointerId=null,n.button=0),r.isPanning?n.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:$p}),this.updateInstanceState({cursor:{type:"grab",rotation:0}})):(r.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:$p}),this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}})):n.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:$p}),this.updateInstanceState({cursor:{type:"grab",rotation:0}})):n.button===5&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(n.key==="ShiftRight"&&(n.key="ShiftLeft"),n.key==="AltRight"&&(n.key="AltLeft"),n.code==="ControlRight"&&(n.code="ControlLeft"),n.name){case"key_down":{r.keys.add(n.code),!n.ctrlKey&&n.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,this.updateInstanceState({cursor:{type:this.inputs.isPointing?"grabbing":"grab",rotation:0}}));break}case"key_up":{r.keys.delete(n.code),n.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}));break}}break}}if(n.type==="pointer"&&(n.button===1?n.name="middle_click":n.button===2&&(n.name="right_click"),n.isPen===this.getInstanceState().isPenMode))switch(n.name){case"pointer_down":{const c=this._clickManager.transformPointerDownEvent(n);if(n.name!==c.name){this.root.handleEvent(n),this.emit("event",n),this.root.handleEvent(c),this.emit("event",c);return}break}case"pointer_up":{const c=this._clickManager.transformPointerUpEvent(n);if(n.name!==c.name){this.root.handleEvent(n),this.emit("event",n),this.root.handleEvent(c),this.emit("event",c);return}break}case"pointer_move":{this._clickManager.handleMove();break}}this.root.handleEvent(n),this.emit("event",n)}),this});this.store=n,this.snaps=new _i(this),this.user=new Fo(r??UA(),l??!1),this.getContainer=i??(()=>document.body),this.textMeasure=new aW(this);class c extends Bp{}S(c,"initial",a??""),this.root=new c(this),this.root.children={};const u=GA(o),d=new Set(Object.keys(n.schema.types.shape.migrations.subTypeMigrations));for(const C of u){if(!d.has(C.type))throw Error(`Editor and store have different shapes: "${C.type}" was passed into the editor but not the schema`);d.delete(C.type)}if(d.size>0)throw Error(`Editor and store have different shapes: "${[...d][0]}" is present in the store schema but not provided to the editor`);const h={},f={},y=new Map;for(const C of u){const P=new C(this);h[C.type]=P;const k=rA(C.props??{});f[C.type]=k;for(const I of k.keys())if(!y.has(I.id))y.set(I.id,I);else if(y.get(I.id)!==I)throw Error(`Multiple style props with id "${I.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=h,this.styleProps=f;for(const C of[...s]){if(ym(this.root.children,C.id))throw Error(`Can't override tool with id "${C.id}"`);this.root.children[C.id]=new C(this,this.root)}this.environment=new XK(this),this.scribbles=new JK(this);const g=new Set,m=C=>{var D;const P=this.getShape(C);if(!P)return;const{start:k,end:I}=P.props,_=k.type==="binding"?this.getShape(k.boundShapeId):void 0,M=I.type==="binding"?this.getShape(I.boundShapeId):void 0,T=this.getAncestorPageId(P);if(!T)return;let R;if(_&&M)R=this.findCommonAncestor([_,M])??T;else if(_||M){const z=(D=_||M)==null?void 0:D.parentId;z&&z===P.parentId?R=P.parentId:R=T}else return;R&&R!==P.parentId&&this.reparentShapes([C],R);const j=this.getShape(C);if(!j)throw Error("no reparented arrow");const $=this.getShapeNearestSibling(j,_),L=this.getShapeNearestSibling(j,M);let U;if($&&L)U=$.index>L.index?$:L;else if($&&!L)U=$;else if(L&&!$)U=L;else return;let F;const G=this.getSortedChildIdsForParent(U.parentId).map(z=>this.getShape(z)).filter(z=>z.index>U.index);if(G.length){const z=G.find(V=>V.type!=="arrow");if(j.index>U.index&&(!z||j.index<z.index))return;F=Au(U.index,G[0].index)}else F=Zo(U.index);F!==j.index&&this.updateShapes([{id:C,type:"arrow",index:F}])},v=(C,P)=>{const{x:k,y:I}=Qr(this,C)[P];this.store.put([{...C,props:{...C.props,[P]:{type:"point",x:k,y:I}}}])},x=C=>{for(const P of["start","end"]){const k=C.props[P];if(k.type!=="binding")continue;const I=this.getShape(k.boundShapeId),_=this.getAncestorPageId(C)===this.getAncestorPageId(I);(!I||!_)&&v(C,P)}m(C.id)},w=(C,P)=>{let k=null;const I=C.selectedShapeIds.filter(T=>!P.has(T));I.length!==C.selectedShapeIds.length&&(k||(k={...C}),k.selectedShapeIds=I);const _=C.erasingShapeIds.filter(T=>!P.has(T));_.length!==C.erasingShapeIds.length&&(k||(k={...C}),k.erasingShapeIds=_),C.hoveredShapeId&&P.has(C.hoveredShapeId)&&(k||(k={...C}),k.hoveredShapeId=null),C.editingShapeId&&P.has(C.editingShapeId)&&(k||(k={...C}),k.editingShapeId=null);const M=C.hintingShapeIds.filter(T=>!P.has(T));return M.length!==C.hintingShapeIds.length&&(k||(k={...C}),k.hintingShapeIds=M),C.focusedGroupId&&P.has(C.focusedGroupId)&&(k||(k={...C}),k.focusedGroupId=null),k};if(this.sideEffects=new eW(this),this.sideEffects.registerBatchCompleteHandler(()=>{var C;for(const P of g){g.delete(P);const k=this.getShape(P);if(!k)continue;const I=this.getShapeUtil(k),_=(C=I.onChildrenChange)==null?void 0:C.call(I,k);_!=null&&_.length&&this.updateShapes(_,{squashing:!0})}this.emit("update")}),this.sideEffects.registerBeforeDeleteHandler("shape",C=>{C.parentId&&Pr(C.parentId)&&g.add(C.parentId);const P=this._getArrowBindingsIndex().get()[C.id];if(P!=null&&P.length)for(const{arrowId:_,handleId:M}of P){const T=this.getShape(_);T&&v(T,M)}const k=new Set([C.id]),I=pe(this.getPageStates().map(_=>w(_,k)));I.length&&this.store.put(I)}),this.sideEffects.registerBeforeDeleteHandler("page",C=>{var _;if(this.getInstanceState().currentPageId!==C.id)return;const P=(_=this.getPages().find(M=>M.id!==C.id))==null?void 0:_.id;if(!P)return;this.store.put([{...this.getInstanceState(),currentPageId:P}]);const k=on.createId(C.id),I=sn.createId(C.id);this.store.remove([k,I])}),this.sideEffects.registerAfterChangeHandler("shape",(C,P)=>{if(this.isShapeOfType(P,"arrow")&&x(P),C.parentId!==P.parentId){const k=I=>{const _=this._getArrowBindingsIndex().get()[I];if(_!=null&&_.length)for(const M of _)m(M.arrowId)};k(P.id),this.visitDescendants(P.id,k)}if(C.parentId!==P.parentId&&jn(P.parentId)){const k=new Set([C.id]);this.visitDescendants(C.id,I=>{k.add(I)});for(const I of this.getPageStates()){if(I.pageId===P.parentId)continue;const _=w(I,k);_&&this.store.put([_])}}C.parentId&&Pr(C.parentId)&&g.add(C.parentId),P.parentId!==C.parentId&&Pr(P.parentId)&&g.add(P.parentId)}),this.sideEffects.registerAfterChangeHandler("instance_page_state",(C,P)=>{if((C==null?void 0:C.selectedShapeIds)!==(P==null?void 0:P.selectedShapeIds)){const k=P.selectedShapeIds.filter(_=>{var T,R;let M=(T=this.getShape(_))==null?void 0:T.parentId;for(;Pr(M);){if(P.selectedShapeIds.includes(M))return!1;M=(R=this.getShape(M))==null?void 0:R.parentId}return!0});let I=null;if(k.length>0){const _=this.findCommonAncestor(pe(k.map(M=>this.getShape(M))),M=>this.isShapeOfType(M,"group"));_&&(I=_)}else P!=null&&P.focusedGroupId&&(I=P.focusedGroupId);(k.length!==P.selectedShapeIds.length||I!==P.focusedGroupId)&&this.store.put([{...P,selectedShapeIds:k,focusedGroupId:I??null}])}}),this.sideEffects.registerAfterCreateHandler("shape",C=>{this.isShapeOfType(C,"arrow")&&x(C)}),this.sideEffects.registerAfterCreateHandler("page",C=>{const P=on.createId(C.id),k=sn.createId(C.id);this.store.has(P)||this.store.put([on.create({id:P})]),this.store.has(k)||this.store.put([sn.create({id:k,pageId:C.id})])}),this._currentPageShapeIds=WK(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=KK(this.store),this.disposables.add(this.store.listen(C=>{this.emit("change",C)})),this.store.ensureStoreIsUsable(),this._setInstancePageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]},{ephemeral:!0}),a&&this.root.children[a]===void 0)throw Error(`No state found for initialState "${a}".`);this.root.enter(void 0,"initial"),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.updateRenderingBounds(),requestAnimationFrame(()=>{this._tickManager.start()})}dispose(){this.disposables.forEach(n=>n()),this.disposables.clear()}getShapeUtil(n){const r=typeof n=="string"?n:n.type,o=ca(this.shapeUtils,r);return la(o,`No shape util found for type "${r}"`),o}undo(){return this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this.history.redo(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(n,r,o){return this.history.mark(n,r,o),this}bail(){return this.history.bail(),this}bailToMark(n){return this.history.bailToMark(n),this}batch(n){return this.history.batch(n),this}_getArrowBindingsIndex(){return VK(this)}getArrowsBoundTo(n){return this._getArrowBindingsIndex().get()[n]||ss}getArrowInfoCache(){return this.store.createComputedCache("arrow infoCache",n=>qc(n)?Ru(this,n):tv(this,n))}getArrowInfo(n){const r=typeof n=="string"?n:n.id;return this.getArrowInfoCache().get(r)}annotateError(n,{origin:r,willCrashApp:o,tags:s,extras:i}){const a=this.createErrorAnnotations(r,o);return Gw(n,{tags:{...a.tags,...s},extras:{...a.extras,...i}}),o&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(n,r){try{const o=this.getEditingShapeId();return{tags:{origin:n,willCrashApp:r},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:o?this.getShape(o):void 0,inputs:this.inputs}}}catch{return{tags:{origin:n,willCrashApp:r},extras:{}}}}getCrashingError(){return this._crashingError}crash(n){return this._crashingError=n,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:n}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(n){const r=n.split(".").reverse();let o=this.root;for(;r.length>0;){const s=r.pop();if(!s)return!0;const i=o.getCurrent();if((i==null?void 0:i.id)===s){if(r.length===0)return!0;o=i;continue}else return!1}return!1}isInAny(...n){return n.some(r=>this.isIn(r))}setCurrentTool(n,r={}){return this.root.transition(n,r),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const n=this.getCurrentTool();return n?n.getCurrentToolIdMask()??n.id:""}getStateDescendant(n){var s;const r=n.split(".").reverse();let o=this.root;for(;r.length>0;){const i=r.pop();if(!i)return o;const a=(s=o.children)==null?void 0:s[i];if(!a)return;o=a}return o}getDocumentSettings(){return this.store.get($S)}updateDocumentSettings(n){return this.store.put([{...this.getDocumentSettings(),...n}]),this}getInstanceState(){return this.store.get(Pn)}updateInstanceState(n,r){return this._updateInstanceState(n,{ephemeral:!0,squashing:!0,...r}),n.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),n.isChangingStyle===!0&&(this._isChangingStyleTimeout=setTimeout(()=>{this.updateInstanceState({isChangingStyle:!1})},2e3))),this}getOpenMenus(){return this.getInstanceState().openMenus}addOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)||(r.add(n),this.updateInstanceState({openMenus:[...r]})),this}deleteOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)&&(r.delete(n),this.updateInstanceState({openMenus:[...r]})),this}clearOpenMenus(){return this.getOpenMenus().length&&this.updateInstanceState({openMenus:[]}),this}getIsMenuOpen(){return this.getOpenMenus().length>0}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return sn.createId(this.getCurrentPageId())}updateCurrentPageState(n,r){return this._setInstancePageState(n,r),this}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:n}=this.getCurrentPageState();return pe(n.map(r=>this.store.get(r)))}setSelectedShapes(n,r){const o=n.map(s=>typeof s=="string"?s:s.id);return this._setSelectedShapes(o,r),this}isAncestorSelected(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null,o=this.getShape(r);if(!o)return!1;const s=this.getSelectedShapeIds();return!!this.findShapeAncestor(o,i=>s.includes(i.id))}select(...n){const r=typeof n[0]=="string"?n:n.map(o=>o.id);return this.setSelectedShapes(r),this}deselect(...n){const r=typeof n[0]=="string"?n:n.map(s=>s.id),o=this.getSelectedShapeIds();return o.length>0&&r.length>0&&this.setSelectedShapes(o.filter(s=>!r.includes(s))),this}selectAll(){const n=this.getSortedChildIdsForParent(this.getCurrentPageId());return n.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(n)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShape(){const n=this.getSelectedShapes();return n.length===1?n[0]:null}getSelectionPageBounds(){const n=this.getCurrentPageState().selectedShapeIds;return n.length===0?null:le.Common(pe(n.map(r=>this.getShapePageBounds(r))))}getSelectionRotation(){const n=this.getSelectedShapeIds();if(n.length===0)return 0;if(n.length===1)return this.getShapePageTransform(this.getSelectedShapeIds()[0]).rotation();const r=n.map(o=>this.getShapePageTransform(o).rotation());return r.every(o=>Math.abs(o-r[0])<Math.PI/180)?this.getShapePageTransform(n[0]).rotation():0}getSelectionRotatedPageBounds(){const n=this.getSelectedShapeIds();if(n.length===0)return;const r=this.getSelectionRotation();if(r===0)return this.getSelectionPageBounds();if(n.length===1){const s=this.getShapeGeometry(n[0]).bounds.clone(),i=this.getShapePageTransform(n[0]);return s.point=i.applyToPoint(s.point),s}const o=le.FromPoints(this.getSelectedShapeIds().flatMap(s=>{const i=this.getShapePageTransform(s);return i?i.applyToPoints(this.getShapeGeometry(s).vertices):[]}).map(s=>E.Rot(s,-r)));return o.point=o.point.rot(r),o}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const n=this.getFocusedGroupId();return n?this.getShape(n):void 0}setFocusedGroup(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==null){const o=this.getShape(r);if(!o)throw Error(`Editor.setFocusedGroup: Shape with id ${r} does not exist`);if(!this.isShapeOfType(o,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${o.type}`)}return r===this.getFocusedGroupId()?this:(this._setFocusedGroupId(r),this)}popFocusedGroupId(){const n=this.getFocusedGroup();if(n){const r=this.findShapeAncestor(n,o=>this.isShapeOfType(o,"group"));this.setFocusedGroup((r==null?void 0:r.id)??null),this.select(n.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const n=this.getEditingShapeId();return n?this.getShape(n):void 0}setEditingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==this.getEditingShapeId()){if(r){const o=this.getShape(r);if(o&&this.getShapeUtil(o).canEdit(o))return this._setInstancePageState({editingShapeId:r}),this}this._setInstancePageState({editingShapeId:null})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const n=this.getHoveredShapeId();return n?this.getShape(n):void 0}setHoveredShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;return r===this.getHoveredShapeId()?this:(this.updateCurrentPageState({hoveredShapeId:r},{ephemeral:!0}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const n=this.getHintingShapeIds();return pe(n.map(r=>this.getShape(r)))}setHintingShapes(n){const r=typeof n[0]=="string"?n:n.map(o=>o.id);return this.updateCurrentPageState({hintingShapeIds:og(r)},{ephemeral:!0}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const n=this.getErasingShapeIds();return pe(n.map(r=>this.getShape(r)))}setErasingShapes(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);r.sort();const o=this.getErasingShapeIds();if(r.length===o.length){for(let s=0;s<r.length;s++)if(r[s]!==o[s]){this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});break}}else this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});return this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==this.getCroppingShapeId())if(!r)this.updateCurrentPageState({croppingShapeId:null});else{const o=this.getShape(r),s=this.getShapeUtil(o);o&&s.canCrop(o)&&this.updateCurrentPageState({croppingShapeId:r})}return this}getCameraId(){return on.createId(this.getCurrentPageId())}getCamera(){return this.store.get(this.getCameraId())}getZoomLevel(){return this.getCamera().z}_setCamera(n){const r=this.getCamera();return r.x===n.x&&r.y===n.y&&r.z===n.z?this:(this.batch(()=>{this.store.put([{...r,...n}]);const{currentScreenPoint:o}=this.inputs;this.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:o,pointerId:uk.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1}),this._tickCameraState()}),this)}setCamera(n,r){const o=Number.isFinite(n.x)?n.x:0,s=Number.isFinite(n.y)?n.y:0,i=Number.isFinite(n.z)?n.z:this.getZoomLevel();if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),r){const{width:a,height:l}=this.getViewportScreenBounds();return this._animateToViewport(new le(-o,-s,a/i,l/i),r)}else this._setCamera({x:o,y:s,z:i});return this}centerOnPoint(n,r){if(!this.getInstanceState().canMoveCamera)return this;const{width:o,height:s}=this.getViewportPageBounds();return this.setCamera({x:-(n.x-o/2),y:-(n.y-s/2),z:this.getCamera().z},r),this}zoomToContent(){const n=this.getSelectionPageBounds()??this.getCurrentPageBounds();return n&&this.zoomToBounds(n,Math.min(1,this.getZoomLevel()),{duration:220}),this}zoomToFit(n){if(!this.getInstanceState().canMoveCamera)return this;const r=[...this.getCurrentPageShapeIds()];if(r.length<=0)return this;const o=le.Common(pe(r.map(s=>this.getShapePageBounds(s))));return this.zoomToBounds(o,void 0,n),this}resetZoom(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:o,y:s,z:i}=this.getCamera(),{x:a,y:l}=n;return this.setCamera({x:o+(a/1-a)-(a/i-a),y:s+(l/1-l)-(l/i-l),z:1},r),this}zoomIn(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:o,y:s,z:i}=this.getCamera();let a=Us;for(let u=1;u<Fa.length;u++){const d=Fa[u-1],h=Fa[u];if(!(h-i<=(h-d)/2)){a=h;break}}const{x:l,y:c}=n;return this.setCamera({x:o+(l/a-l)-(l/i-l),y:s+(c/a-c)-(c/i-c),z:a},r),this}zoomOut(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:o,y:s,z:i}=this.getCamera();let a=Yc;for(let u=Fa.length-1;u>0;u--){const d=Fa[u-1],h=Fa[u];if(!(h-i>=(h-d)/2)){a=d;break}}const{x:l,y:c}=n;return this.setCamera({x:o+(l/a-l)-(l/i-l),y:s+(c/a-c)-(c/i-c),z:a},r),this}zoomToSelection(n){if(!this.getInstanceState().canMoveCamera)return this;const r=this.getSelectionPageBounds();return r?(this.zoomToBounds(r,Math.max(1,this.getZoomLevel()),n),this):this}panZoomIntoView(n,r){if(!this.getInstanceState().canMoveCamera)return this;if(n.length<=0)return this;const o=le.Common(pe(n.map(i=>this.getShapePageBounds(i)))),s=this.getViewportPageBounds();if(s.h<o.h||s.w<o.w)return this.zoomToBounds(o,this.getCamera().z,r),this;{const i=this.getViewportPageBounds().clone().expandBy(-32/this.getZoomLevel());let a=0,l=0;i.maxY<o.maxY?l=i.maxY-o.maxY:i.minY>o.minY&&(l=i.minY-o.minY),i.maxX<o.maxX?a=i.maxX-o.maxX:i.minX>o.minX&&(a=i.minX-o.minX);const c=this.getCamera();this.setCamera({x:c.x+a,y:c.y+l,z:c.z},r)}return this}zoomToBounds(n,r,o){if(!this.getInstanceState().canMoveCamera)return this;const s=this.getViewportScreenBounds(),i=Math.min(256,s.width*.28);let a=wo(Math.min((s.width-i)/n.width,(s.height-i)/n.height),Yc,Us);return r!==void 0&&(a=Math.min(r,a)),this.setCamera({x:-n.minX+(s.width-n.width*a)/2/a,y:-n.minY+(s.height-n.height*a)/2/a,z:a},o),this}pan(n,r){if(!this.getInstanceState().canMoveCamera)return this;const{x:o,y:s,z:i}=this.getCamera();return this.setCamera({x:o+n.x/i,y:s+n.y/i,z:i},r),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(n){if(!this._viewportAnimation)return;const r=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",r),this._viewportAnimation=null};this.once("stop-camera-animation",r),this._viewportAnimation.elapsed+=n;const{elapsed:o,easing:s,duration:i,start:a,end:l}=this._viewportAnimation;if(o>i){this._setCamera({x:-l.x,y:-l.y,z:this.getViewportScreenBounds().width/l.width}),r();return}const c=i-o,u=s(1-c/i),d=a.minX+(l.minX-a.minX)*u,h=a.minY+(l.minY-a.minY)*u,f=a.maxX+(l.maxX-a.maxX)*u;this._setCamera({x:-d,y:-h,z:this.getViewportScreenBounds().width/(f-d)})}_animateToViewport(n,r={}){const{duration:o=0,easing:s=dn.easeInOutCubic}=r,i=this.user.getAnimationSpeed(),a=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),o===0||i===0?this._setCamera({x:-n.x,y:-n.y,z:this.getViewportScreenBounds().width/n.width}):(this._viewportAnimation={elapsed:0,duration:o/i,easing:s,start:a.clone(),end:n.clone()},this.addListener("tick",this._animateViewport),this)}slideCamera(n={}){if(!this.getInstanceState().canMoveCamera)return this;if(this.stopCameraAnimation(),this.user.getAnimationSpeed()===0)return this;const{speed:o,friction:s,direction:i,speedThreshold:a=.01}=n;let l=Math.min(o,1);const c=()=>{this.removeListener("tick",u),this.removeListener("stop-camera-animation",c)};this.once("stop-camera-animation",c);const u=d=>{const{x:h,y:f,z:y}=this.getCamera(),g=E.Mul(i,l*d/y);l*=1-s,l<a?c():this._setCamera({x:h+g.x,y:f+g.y,z:y})};return this.addListener("tick",u),this}animateToUser(n){const o=[...this.store.query.records("instance_presence",()=>({userId:{eq:n}})).get()].sort((s,i)=>s.lastActivityTimestamp-i.lastActivityTimestamp).pop();return o?(this.batch(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const s=o.currentPageId===this.getCurrentPageId();s||this.setCurrentPage(o.currentPageId);const i=s?{duration:500}:void 0;this.centerOnPoint(o.cursor,i);const{highlightedUserIds:a}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...a,n]}),setTimeout(()=>{const l=[...this.getInstanceState().highlightedUserIds],c=l.indexOf(n);c<0||(l.splice(c,1),this.updateInstanceState({highlightedUserIds:l}))},gA)}),this):this}animateToShape(n,r=GB){if(!this.getInstanceState().canMoveCamera)return this;const o=this.getViewportScreenBounds().clone().expandBy(-32),s=o.width/o.height,i=this.getShapePageBounds(n);if(!i)return this;const a=i.width/i.height,l=i.clone(),c=i.width/o.width;return l.width+=(o.minX+o.maxX)*c,l.height+=(o.minY+o.maxY)*c,l.x-=o.minX*c,l.y-=o.minY*c,a>s?(l.height=i.width/s,l.y-=(l.height-i.height)/2):(l.width=i.height*s,l.x-=(l.width-i.width)/2),this._animateToViewport(l,r)}updateViewportScreenBounds(n=!1){const r=this.getContainer();if(!r)return this;const o=r.getBoundingClientRect(),s=new le(o.left||o.x,o.top||o.y,Math.max(o.width,1),Math.max(o.height,1)),i=s.equals(this.getViewportScreenBounds()),{_willSetInitialBounds:a}=this;if(i)this._willSetInitialBounds=!1;else if(a)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:s.toJson()},{squashing:!0,ephemeral:!0});else if(n&&!this.getInstanceState().followingUserId){const l=this.getViewportPageCenter();this.updateInstanceState({screenBounds:s.toJson()},{squashing:!0,ephemeral:!0}),this.centerOnPoint(l)}else this.updateInstanceState({screenBounds:s.toJson()},{squashing:!0,ephemeral:!0});return this._tickCameraState(),this.updateRenderingBounds(),this}getViewportScreenBounds(){const{x:n,y:r,w:o,h:s}=this.getInstanceState().screenBounds;return new le(n,r,o,s)}getViewportScreenCenter(){return this.getViewportScreenBounds().center}getViewportPageBounds(){const{w:n,h:r}=this.getViewportScreenBounds(),{x:o,y:s,z:i}=this.getCamera();return new le(-o,-s,n/i,r/i)}getViewportPageCenter(){return this.getViewportPageBounds().center}screenToPage(n){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Pn),{x:o,y:s,z:i=1}=this.getCamera();return{x:(n.x-r.x)/i-o,y:(n.y-r.y)/i-s,z:n.z??.5}}pageToScreen(n){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Pn),{x:o,y:s,z:i=1}=this.getCamera();return{x:(n.x+o)*i+r.x,y:(n.y+s)*i+r.y,z:n.z??.5}}startFollowingUser(n){const r=this.store.query.records("instance_presence",()=>({userId:{eq:n}})),o=this.user.getId();if(o||console.warn("You should set the userId for the current instance before following a user"),r.get().some(l=>l.followingUserId===o))return this;Xr(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:n},{ephemeral:!0})});const s=()=>{this.removeListener("frame",a),this.removeListener("stop-following",s)};let i=!1;const a=()=>{const l=[...r.get()].sort(($,L)=>$.lastActivityTimestamp-L.lastActivityTimestamp).pop();if(!l){this.stopFollowingUser();return}const c=l.currentPageId===this.getCurrentPageId(),u=c?FB:1;if(!c){this.stopFollowingUser(),this.setCurrentPage(l.currentPageId),this.startFollowingUser(n);return}const{center:d,width:h,height:f}=this.getViewportPageBounds(),y=le.From(l.screenBounds),g=y.width/l.camera.z,m=y.height/l.camera.z,v=new E(g/2-l.camera.x,m/2-l.camera.y),x=l.followingUserId===o,w=h+(g-h)*u,C=f+(m-f)*u,P=x?f/C:Math.min(h/w,f/C),k=wo(this.getCamera().z*P,Yc,Us),I=this.getViewportScreenBounds().w/k,_=this.getViewportScreenBounds().h/k,M=v.sub(d),T=E.Add(d,E.Mul(M,u)),R=E.Sub(T,d).len(),j=Math.abs(k-this.getCamera().z);if(R<zB&&j<UB){i=!0;return}i&&R<BB&&j<HB||(i=!1,this.stopCameraAnimation(),this._setCamera({x:-(T.x-I/2),y:-(T.y-_/2),z:k}))};return this.once("stop-following",s),this.addListener("frame",a),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},{ephemeral:!0}),this.emit("stop-following"),this}getCameraState(){return this._cameraState.get()}getUnorderedRenderingShapes(n){const r=[];let o=Go*2,s=Go;const i=this.getEditingShapeId(),a=this.getSelectedShapeIds(),l=this.getErasingShapeIds(),c=this.getRenderingBoundsExpanded(),u=Number.isFinite(this.renderingBoundsMargin),d=(h,f,y)=>{const g=this.getShape(h);if(!g)return;f*=g.opacity;let m=!1,v=!1;const x=this.getShapeUtil(g),w=this.getShapeMaskedPageBounds(h);n&&(v=!y&&l.includes(h),v&&(f*=.32),m=u&&x.canUnmount(g)&&i!==h&&(w===void 0||!c.includes(w)&&!a.includes(h))),r.push({id:h,shape:g,util:x,index:o,backgroundIndex:s,opacity:f,isCulled:m,maskedPageBounds:w}),o+=1,s+=1;const C=this.getSortedChildIdsForParent(h);if(!C.length)return;let P=null;x.providesBackgroundForChildren(g)&&(P=s,s=o,o+=Go);for(const k of C)d(k,f,y||v);P!==null&&(s=P)};for(const h of this.getSortedChildIdsForParent(this.getCurrentPageId()))d(h,1,!1);return r}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(_9)}getRenderingBounds(){return this._renderingBounds.get()}getRenderingBoundsExpanded(){return this._renderingBoundsExpanded.get()}updateRenderingBounds(){const n=this.getViewportPageBounds();return n.equals(this._renderingBounds.__unsafe__getWithoutCapture())?this:(this._renderingBounds.set(n.clone()),Number.isFinite(this.renderingBoundsMargin)?this._renderingBoundsExpanded.set(n.clone().expandBy(this.renderingBoundsMargin/this.getZoomLevel())):this._renderingBoundsExpanded.set(n),this)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort(ln)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(n){return this.store.get(typeof n=="string"?n:n.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getPageShapeIds(n){const r=typeof n=="string"?n:n.id,o=this.store.query.exec("shape",{parentId:{eq:r}});return this.getShapeAndDescendantIds(o.map(s=>s.id))}setCurrentPage(n,r){const o=typeof n=="string"?n:n.id;return this._setCurrentPageId(o,r),this}updatePage(n,r){return this._updatePage(n,r),this}createPage(n){return this._createPage(n),this}deletePage(n){const r=typeof n=="string"?n:n.id;return this._deletePage(r),this}duplicatePage(n,r=ms.createId()){if(this.getPages().length>=vg)return this;const o=typeof n=="string"?n:n.id,s=this.getPage(o);if(!s)return this;const i={...this.getCamera()},a=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(s.id));return this.batch(()=>{var u;const l=this.getPages(),c=Au(s.index,(u=l[l.indexOf(s)+1])==null?void 0:u.index);if(this.createPage({name:s.name+" Copy",id:r,index:c}),this.setCurrentPage(r),this.setCamera(i),a)return this.putContentOntoCurrentPage(a)}),this}renamePage(n,r,o){const s=typeof n=="string"?n:n.id;return this.getInstanceState().isReadonly?this:(this.updatePage({id:s,name:r},o),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(n){return this._createAssets(n),this}updateAssets(n){return this._updateAssets(n),this}deleteAssets(n){const r=typeof n[0]=="string"?n:n.map(o=>o.id);return this._deleteAssets(r),this}getAsset(n){return this.store.get(typeof n=="string"?n:n.id)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",n=>this.getShapeUtil(n).getGeometry(n),(n,r)=>n.props===r.props)}getShapeGeometry(n){return this._getShapeGeometryCache().get(typeof n=="string"?n:n.id)}_getShapeOutlineSegmentsCache(){return this.store.createComputedCache("outline-segments",n=>this.getShapeUtil(n).getOutlineSegments(n))}getShapeOutlineSegments(n){return this._getShapeOutlineSegmentsCache().get(typeof n=="string"?n:n.id)??ss}_getShapeHandlesCache(){return this.store.createComputedCache("handles",n=>{var r,o;return(o=(r=this.getShapeUtil(n)).getHandles)==null?void 0:o.call(r,n)})}getShapeHandles(n){return this._getShapeHandlesCache().get(typeof n=="string"?n:n.id)}getShapeLocalTransform(n){const r=typeof n=="string"?n:n.id,o=this.getShape(r);if(!o)throw Error("Editor.getTransform: shape not found");return se.Identity().translate(o.x,o.y).rotate(o.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",n=>{if(jn(n.parentId))return this.getShapeLocalTransform(n);const r=this._getShapePageTransformCache().get(n.parentId)??se.Identity();return se.Compose(r,this.getShapeLocalTransform(n))})}getShapeParentTransform(n){const r=typeof n=="string"?n:n.id,o=this.getShape(r);return!o||jn(o.parentId)?se.Identity():this._getShapePageTransformCache().get(o.parentId)??se.Identity()}getShapePageTransform(n){const r=typeof n=="string"?n:this.getShape(n).id;return this._getShapePageTransformCache().get(r)??se.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",n=>{const r=this._getShapePageTransformCache().get(n.id);return r?le.FromPoints(se.applyToPoints(r,this.getShapeGeometry(n).vertices)):new le})}getShapePageBounds(n){return this._getShapePageBoundsCache().get(typeof n=="string"?n:n.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",n=>{const r=this._getShapeMaskCache().get(n.id);if(!r)return;if(r.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const o=this._getShapePageTransformCache().get(n.id);return o?`polygon(${se.applyToPoints(se.Inverse(o),r).map(i=>`${i.x}px ${i.y}px`).join(",")})`:void 0})}getShapeClipPath(n){return this._getShapeClipPathCache().get(typeof n=="string"?n:n.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",n=>{if(jn(n.parentId))return;const r=this.getShapeAncestors(n.id).filter(s=>this.isShapeOfType(s,"frame"));return r.length===0?void 0:r.map(s=>this._getShapePageTransformCache().get(s.id).applyToPoints(this.getShapeGeometry(s).vertices)).reduce((s,i)=>{if(!(i&&s))return;const a=US(s,i);return a?a.map(E.Cast):[]})})}getShapeMask(n){return this._getShapeMaskCache().get(typeof n=="string"?n:n.id)}getShapeMaskedPageBounds(n){typeof n!="string"&&(n=n.id);const r=this._getShapePageBoundsCache().get(n);if(!r)return;const o=this._getShapeMaskCache().get(n);if(o){if(o.length===0)return;const{corners:s}=r;if(s.every((a,l)=>a&&E.Equals(a,o[l])))return r.clone();const i=US(o,s);return i?le.FromPoints(i):void 0}return r}getShapeAncestors(n,r=[]){const o=typeof n=="string"?n:n.id,s=this.getShape(o);if(!s)return r;const i=s.parentId;if(jn(i))return r.reverse(),r;const a=this.store.get(i);return a?(r.push(a),this.getShapeAncestors(a,r)):r}findShapeAncestor(n,r){const o=typeof n=="string"?n:n.id,s=this.getShape(o);if(!s)return;const i=s.parentId;if(jn(i))return;const a=this.getShape(i);if(a)return r(a)?a:this.findShapeAncestor(a,r)}hasAncestor(n,r){const o=typeof n=="string"?n:n==null?void 0:n.id,s=o&&this.getShape(o);return s?s.parentId===r?!0:this.hasAncestor(this.getShapeParent(s),r):!1}findCommonAncestor(n,r){var c;if(n.length===0)return;const o=typeof n[0]=="string"?n:n.map(u=>u.id),s=pe(o.map(u=>this.getShape(u)));if(s.length===1){const u=s[0].parentId;return jn(u)?void 0:r?(c=this.findShapeAncestor(s[0],r))==null?void 0:c.id:u}const[i,...a]=s;let l=this.getShapeParent(i);for(;l;){if(r&&!r(l)){l=this.getShapeParent(l);continue}if(a.every(u=>this.hasAncestor(u,l.id)))return l.id;l=this.getShapeParent(l)}}isShapeOrAncestorLocked(n){const r=typeof n=="string"?this.getShape(n):n;return r===void 0?!1:r.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(r))}getCurrentPageBounds(){let n;return this.getCurrentPageShapeIds().forEach(r=>{const o=this.getShapeMaskedPageBounds(r);o&&(n?n=n.expand(o):n=o.clone())}),n}getSelectedShapeAtPoint(n){const r=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(o=>o.type!=="group"&&r.includes(o.id)).reverse().find(o=>this.isPointInShape(o,n,{hitInside:!0,margin:0}))}getShapeAtPoint(n,r={}){const o=this.getZoomLevel(),s=this.getViewportPageBounds(),{filter:i,margin:a=0,hitLabels:l=!1,hitInside:c=!1,hitFrameInside:u=!1}=r;let d=1/0,h=null,f=1/0,y=null;const g=(r.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(m=>{if(this.isShapeOfType(m,"group"))return!1;const v=this.getShapeMask(m);return v&&!jo(n,v)?!1:i?i(m):!0});for(let m=g.length-1;m>=0;m--){const v=g[m],x=this.getShapeGeometry(v),w=x instanceof Qs,C=this.getPointInShapeSpace(v,n);if((this.isShapeOfType(v,"arrow")||this.isShapeOfType(v,"geo")&&v.props.fill==="none")&&v.props.text.trim()){for(const k of x.children)if(k.isLabel&&k.isPointInBounds(C))return v}if(this.isShapeOfType(v,"frame")){const k=x.distanceToPoint(C,c);if(Math.abs(k)<=a)return y||v;if(x.hitTestPoint(C,0,!0))return y||h||(u?v:void 0);continue}let P;if(w){let k=1/0;for(const I of x.children){if(I.isLabel&&!l)continue;const _=I.distanceToPoint(C,c);_<k&&(k=_)}P=k}else a===0&&(x.bounds.w<1||x.bounds.h<1)||x.bounds.containsPoint(C,a)?P=x.distanceToPoint(C,c):P=1/0;if(x.isClosed){if(P<=a){if(x.isFilled||w&&x.children[0].isFilled)return y||v;if(this.getShapePageBounds(v).contains(s))continue;if(Math.abs(P)<a)Math.abs(P)<f&&(f=Math.abs(P),y=v);else if(!y){const{area:k}=x;k<d&&(d=k,h=v)}}}else if(P<co/o)return v}return y||h||void 0}getShapesAtPoint(n,r={}){return this.getCurrentPageShapes().filter(o=>this.isPointInShape(o,n,r))}isPointInShape(n,r,o={}){const{hitInside:s=!1,margin:i=0}=o,a=typeof n=="string"?n:n.id,l=this.getShapeMask(a);return l&&!jo(r,l)?!1:this.getShapeGeometry(a).hitTestPoint(this.getPointInShapeSpace(n,r),i,s)}getPointInShapeSpace(n,r){const o=typeof n=="string"?n:n.id;return this._getShapePageTransformCache().get(o).clone().invert().applyToPoint(r)}getPointInParentSpace(n,r){const o=typeof n=="string"?n:n.id,s=this.getShape(o);if(!s)return new E(0,0);if(jn(s.parentId))return E.From(r);const i=this.getShapePageTransform(s.parentId);return i?i.clone().invert().applyToPoint(r):E.From(r)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),n=>this.store.get(n))}getCurrentPageShapesSorted(){const n=new Set(this.getCurrentPageShapes().sort(ln)),r=[];function o(s){r.push(s),n.delete(s),n.forEach(i=>{i.parentId===s.id&&o(i)})}return n.forEach(s=>{const i=this.getShape(s.parentId);Ji(i)||o(s)}),r}getCurrentPageRenderingShapesSorted(){return this.getRenderingShapes().filter(({isCulled:n})=>!n).sort((n,r)=>n.index-r.index).map(({shape:n})=>n)}isShapeOfType(n,r){return(typeof n=="string"?this.getShape(n):n).type===r}getShape(n){const r=typeof n=="string"?n:n.id;if(Pr(r))return this.store.get(r)}getShapeParent(n){const r=typeof n=="string"?n:n==null?void 0:n.id;if(!r)return;const o=this.getShape(r);if(!(o===void 0||!Pr(o.parentId)))return this.store.get(o.parentId)}getShapeNearestSibling(n,r){return r?r.parentId===n.parentId?r:this.findShapeAncestor(r,s=>s.parentId===n.parentId):void 0}isShapeInPage(n,r=this.getCurrentPageId()){const o=typeof n=="string"?n:n.id,s=this.getShape(o);if(!s)return!1;let i=!1;if(s.parentId===r)i=!0;else{let a=this.getShape(s.parentId);e:for(;a;){if(a.parentId===r){i=!0;break e}a=this.getShape(a.parentId)}}return i}getAncestorPageId(n){const r=typeof n=="string"?n:n==null?void 0:n.id,o=r&&this.getShape(r);if(o)return jn(o.parentId)?o.parentId:this.getAncestorPageId(this.getShape(o.parentId))}reparentShapes(n,r,o){const s=typeof n[0]=="string"?n:n.map(y=>y.id);if(s.length===0)return this;const i=[],a=jn(r)?se.Identity():this.getShapePageTransform(r),l=a.rotation();let c=[];const u=pe(this.getSortedChildIdsForParent(r).map(y=>this.getShape(y)));if(o){const y=u.find(g=>g.index===o);if(y){const g=u[u.indexOf(y)+1];g?c=nc(o,g.index,s.length):c=Jy(o,s.length)}else{const g=u.sort(ln).find(m=>m.index>o);g?c=nc(o,g.index,s.length):c=Jy(o,s.length)}}else{const y=u.length&&u[u.length-1];c=y?Jy(y.index,s.length):QA(s.length)}const d=a.clone().invert(),h=pe(s.map(y=>this.getShape(y))),f=h.filter(y=>y.isLocked);f.length&&this.updateShapes(f.map(({id:y,type:g})=>({id:y,type:g,isLocked:!1})));for(let y=0;y<h.length;y++){const g=h[y],m=this.getShapePageTransform(g);if(!m)continue;const v=m.point();if(!v)continue;const x=d.applyToPoint(v),w=m.rotation()-l;i.push({id:g.id,type:g.type,parentId:r,x:x.x,y:x.y,rotation:w,index:c[y],isLocked:g.isLocked})}return this.updateShapes(i),this}getHighestIndexForParent(n){const r=typeof n=="string"?n:n.id,o=this._parentIdsToChildIds.get()[r];if(!o||o.length===0)return"a1";const s=this.getShape(o[o.length-1]);return Zo(s.index)}getSortedChildIdsForParent(n){const r=typeof n=="string"?n:n.id,o=this._parentIdsToChildIds.get()[r];return o?this._childIdsCache.get(o,()=>o):ss}visitDescendants(n,r){const o=typeof n=="string"?n:n.id,s=this.getSortedChildIdsForParent(o);for(const i of s)r(i)!==!1&&this.visitDescendants(i,r);return this}getShapeAndDescendantIds(n){const r=new Set,o=[...n];for(;o.length>0;){const s=o.pop();if(!s)break;if(!r.has(s)){r.add(s);for(const i of this.getSortedChildIdsForParent(s))o.push(i)}}return r}getDroppingOverShape(n,r=[]){const o=this.getCurrentPageShapesSorted();for(let s=o.length-1;s>=0;s--){const i=o[s];if(!this.getShapeUtil(i).canDropShapes(i,r)||r.find(l=>l.id===i.id||this.hasAncestor(i,l.id)))continue;const a=this.getShapeMaskedPageBounds(i.id);if(a&&a.containsPoint(n)&&this.getShapeGeometry(i).hitTestPoint(this.getPointInShapeSpace(i,n),0,!0))return i}}getOutermostSelectableShape(n,r){const o=typeof n=="string"?n:n.id,s=this.getShape(o);let i=s,a=s;const l=this.getFocusedGroup();for(;a;){if(this.isShapeOfType(a,"group")&&(l==null?void 0:l.id)!==a.id&&!this.hasAncestor(l,a.id)&&((r==null?void 0:r(a))??!0))i=a;else if((l==null?void 0:l.id)===a.id)break;a=this.getShapeParent(a)}return i}rotateShapesBy(n,r){if((typeof n[0]=="string"?n:n.map(i=>i.id)).length<=0)return this;const s=ZA({editor:this});return s?(zp({delta:r,snapshot:s,editor:this,stage:"one-off"}),this):this}nudgeShapes(n,r,o){var a,l;const s=typeof n[0]=="string"?n:n.map(c=>c.id);if(s.length<=0)return this;const i=[];for(const c of s){const u=this.getShape(c);if(!u)throw Error(`Could not find a shape with the id ${c}.`);const d=E.Cast(r),h=this.getShapeParentTransform(u);h&&d.rot(-h.rotation());const f=(l=(a=this.getShapeUtil(u)).onTranslateStart)==null?void 0:l.call(a,u);i.push(f?{...f,x:u.x+d.x,y:u.y+d.y}:{id:c,x:u.x+d.x,y:u.y+d.y,type:u.type})}return this.updateShapes(i,{squashing:!0,...o}),this}duplicateShapes(n,r){const o=typeof n[0]=="string"?n:n.map(u=>u.id);if(o.length<=0)return this;const s=new Set(o),i=[],a=[...o];for(;a.length>0;){const u=a.pop();if(!u)break;i.push(u),this.getSortedChildIdsForParent(u).forEach(d=>a.push(d))}i.reverse();const l=new Map(i.map(u=>[u,Je()])),c=pe(i.map(u=>{const d=this.getShape(u);if(!d)return null;const h=l.get(u);let f=0,y=0;if(r&&s.has(u)){const k=this.getShapeParentTransform(d),I=new E(r.x,r.y).rot(-k.rotation());f=I.x,y=I.y}const g=d.parentId??this.getCurrentPageId(),m=this.getSortedChildIdsForParent(g),v=m.indexOf(d.id),x=m[v+1],w=x?this.getShape(x):null,C=w?Au(d.index,w.index):Zo(d.index);let P=hn(d);if(this.isShapeOfType(d,"arrow")&&this.isShapeOfType(P,"arrow")){const k=this.getArrowInfo(d);let I,_;if(d.props.start.type==="binding"&&(I=l.get(d.props.start.boundShapeId),!I))if(k!=null&&k.isValid){const{x:T,y:R}=k.start.point;P.props.start={type:"point",x:T,y:R}}else{const{start:T}=Qr(this,d);P.props.start={type:"point",x:T.x,y:T.y}}if(d.props.end.type==="binding"&&(_=l.get(d.props.end.boundShapeId),!_))if(k!=null&&k.isValid){const{x:T,y:R}=k.end.point;P.props.end={type:"point",x:T,y:R}}else{const{end:T}=Qr(this,d);P.props.start={type:"point",x:T.x,y:T.y}}const M=qc(P)?Ru(this,P):tv(this,P);if(k!=null&&k.isValid&&(M!=null&&M.isValid)&&!qc(d)){const T=E.Med(k.start.handle,k.end.handle),R=E.Dist(k.middle,T),j=E.Dist(M.middle,T);P.props.bend<0?P.props.bend+=j-R:P.props.bend-=j-R}P.props.start.type==="binding"&&I&&(P.props.start.boundShapeId=I),P.props.end.type==="binding"&&_&&(P.props.end.boundShapeId=_)}return P={...P,id:h,x:d.x+f,y:d.y+y,index:C},P}));return c.forEach(u=>{Pr(u.parentId)&&l.has(u.parentId)&&(u.parentId=l.get(u.parentId))}),this.history.batch(()=>{const u=c.length+this.getCurrentPageShapeIds().size>Go;u&&qh(this);const d=u?c.slice(0,Go-this.getCurrentPageShapeIds().size):c,h=d.map(f=>f.id);if(this.createShapes(d),this.setSelectedShapes(h),r!==void 0){const f=this.getSelectionPageBounds(),y=this.getViewportPageBounds();f&&!y.contains(f)&&this.centerOnPoint(f.center,{duration:es})}}),this}moveShapesToPage(n,r){const o=typeof n[0]=="string"?n:n.map(l=>l.id);if(o.length===0)return this;if(this.getInstanceState().isReadonly)return this;const s=this.getCurrentPageId();if(r===s)return this;if(!this.store.has(r))return this;const i=this.getContentFromCurrentPage(o);if(!i)return this;if(this.getPageShapeIds(r).size+i.shapes.length>Go)return qh(this,r),this;const a=this.getCamera().z;return this.history.batch(()=>{this.deleteShapes(o),this.setCurrentPage(r),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(i,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:a}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(n){const r=typeof n[0]=="string"?n:n.map(a=>a.id);if(this.getInstanceState().isReadonly||r.length===0)return this;let o=!0,s=!0;const i=[];for(const a of r){const l=this.getShape(a);l&&(i.push(l),l.isLocked?s=!1:o=!1)}return this.batch(()=>{s?(this.updateShapes(i.map(a=>({id:a.id,type:a.type,isLocked:!0}))),this.setSelectedShapes([])):o?this.updateShapes(i.map(a=>({id:a.id,type:a.type,isLocked:!1}))):this.updateShapes(i.map(a=>({id:a.id,type:a.type,isLocked:!0})))}),this}sendToBack(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id),o=Xh(this,"toBack",r);return o&&this.updateShapes(o),this}sendBackward(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id),o=Xh(this,"backward",r);return o&&this.updateShapes(o),this}bringForward(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id),o=Xh(this,"forward",r);return o&&this.updateShapes(o),this}bringToFront(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id),o=Xh(this,"toFront",r);return o&&this.updateShapes(o),this}flipShapes(n,r){const o=typeof n[0]=="string"?n:n.map(a=>a.id);if(this.getInstanceState().isReadonly)return this;let s=pe(o.map(a=>this.getShape(a)));if(!s.length)return this;s=pe(s.map(a=>this.isShapeOfType(a,"group")?this.getSortedChildIdsForParent(a.id).map(l=>this.getShape(l)):a).flat());const i=le.Common(pe(s.map(a=>this.getShapePageBounds(a)))).center;return this.batch(()=>{for(const a of s){const l=this.getShapeGeometry(a).bounds,c=this.getShapePageTransform(a.id);c&&this.resizeShape(a.id,{x:r==="horizontal"?-1:1,y:r==="vertical"?-1:1},{initialBounds:l,initialPageTransform:c,initialShape:a,mode:"scale_shape",scaleOrigin:i,scaleAxisRotation:0})}}),this}stackShapes(n,r,o){const s=typeof n[0]=="string"?n:n.map(m=>m.id);if(this.getInstanceState().isReadonly)return this;const i=pe(s.map(m=>this.getShape(m)).filter(m=>!(!m||this.isShapeOfType(m,"arrow")&&(m.props.start.type==="binding"||m.props.end.type==="binding")))),a=i.length;if(o===0&&a<3||a<2)return this;const l=Object.fromEntries(i.map(m=>[m.id,this.getShapePageBounds(m)]));let c,u,d,h;r==="horizontal"?(c="x",u="minX",d="maxX",h="width"):(c="y",u="minY",d="maxY",h="height");let f;if(o===0){const m=[];i.sort((x,w)=>l[x.id][u]-l[w.id][u]);for(let x=0;x<a-1;x++){const w=i[x],C=i[x+1],P=l[w.id],I=l[C.id][u]-P[d],_=m.find(M=>M.gap===I);_?_.count++:m.push({gap:I,count:1})}let v=0;m.forEach(x=>{x.count>v&&(v=x.count,f=x.gap)}),v===1&&(f=Math.max(0,m.reduce((x,w)=>x+w.gap*w.count,0)/(a-1)))}else f=o;const y=[];let g=l[i[0].id][d];return i.forEach((m,v)=>{var k,I;if(v===0)return;const x={x:0,y:0};x[c]=g+f-l[m.id][c];const w=this.getShapeParent(m),C=w?E.Rot(x,-this.getShapePageTransform(w).decompose().rotation):x,P=(I=(k=this.getShapeUtil(m)).onTranslateStart)==null?void 0:I.call(k,m);y.push(P?{...P,[c]:m[c]+C[c]}:{id:m.id,type:m.type,[c]:m[c]+C[c]}),g+=l[m.id][h]+f}),this.updateShapes(y),this}packShapes(n,r){var I,_;const o=typeof n[0]=="string"?n:n.map(M=>M.id);if(this.getInstanceState().isReadonly)return this;if(o.length<2)return this;const s=pe(o.map(M=>this.getShape(M)).filter(M=>!(!M||this.isShapeOfType(M,"arrow")&&(M.props.start.type==="binding"||M.props.end.type==="binding")))),i={},a={};let l,c,u=0;for(let M=0;M<s.length;M++)l=s[M],c=this.getShapePageBounds(l),i[l.id]=c,a[l.id]=c.clone(),u+=c.width*c.height;const d=le.Common(pe(Object.values(i))),h=d.width;s.sort((M,T)=>i[T.id].height-i[M.id].height);const f=Math.max(Math.ceil(Math.sqrt(u/.95)),h),y=[new le(d.x,d.y,f,1/0)];let g=0,m=0,v,x;for(let M=0;M<s.length;M++){l=s[M],c=a[l.id];for(let T=y.length-1;T>=0;T--)if(v=y[T],!(c.width>v.width||c.height>v.height)){c.x=v.x,c.y=v.y,m=Math.max(m,c.maxY),g=Math.max(g,c.maxX),c.width===v.width&&c.height===v.height?(x=y.pop(),T<y.length&&(y[T]=x)):c.height===v.height?(v.x+=c.width+r,v.width-=c.width+r):c.width===v.width?(v.y+=c.height+r,v.height-=c.height+r):(y.push(new le(v.x+(c.width+r),v.y,v.width-(c.width+r),c.height)),v.y+=c.height+r,v.height-=c.height+r);break}}const w=le.Common(Object.values(a)),C=E.Sub(d.center,w.center);let P;const k=[];for(let M=0;M<s.length;M++){l=s[M],c=i[l.id],P=a[l.id];const T=E.Sub(P.point,c.point).add(C),R=this.getShapeParentTransform(l);R&&T.rot(-R.rotation());const j={id:l.id,type:l.type,x:l.x+T.x,y:l.y+T.y},$=(_=(I=this.getShapeUtil(l)).onTranslateStart)==null?void 0:_.call(I,{...l,...j});$?k.push({...j,...$}):k.push(j)}return k.length&&this.updateShapes(k),this}alignShapes(n,r){const o=typeof n[0]=="string"?n:n.map(c=>c.id);if(this.getInstanceState().isReadonly)return this;if(o.length<2)return this;const s=pe(o.map(c=>this.getShape(c))),i=Object.fromEntries(s.map(c=>[c.id,this.getShapePageBounds(c)])),a=le.Common(pe(Object.values(i))),l=[];return s.forEach(c=>{var g,m;const u=i[c.id];if(!u)return;const d={x:0,y:0};switch(r){case"top":{d.y=a.minY-u.minY;break}case"center-vertical":{d.y=a.midY-u.minY-u.height/2;break}case"bottom":{d.y=a.maxY-u.minY-u.height;break}case"left":{d.x=a.minX-u.minX;break}case"center-horizontal":{d.x=a.midX-u.minX-u.width/2;break}case"right":{d.x=a.maxX-u.minX-u.width;break}}const h=this.getShapeParent(c),f=h?E.Rot(d,-this.getShapePageTransform(h).decompose().rotation):d,y=(m=(g=this.getShapeUtil(c)).onTranslateStart)==null?void 0:m.call(g,c);l.push(y?{...y,x:c.x+f.x,y:c.y+f.y}:{id:c.id,type:c.type,x:c.x+f.x,y:c.y+f.y})}),this.updateShapes(l),this}distributeShapes(n,r){const o=typeof n[0]=="string"?n:n.map(w=>w.id);if(this.getInstanceState().isReadonly)return this;if(o.length<3)return this;const s=o.length,i=pe(o.map(w=>this.getShape(w))),a=Object.fromEntries(i.map(w=>[w.id,this.getShapePageBounds(w)]));let l,c,u,d,h;r==="horizontal"?(l="x",c="minX",u="maxX",d="midX",h="width"):(l="y",c="minY",u="maxY",d="midY",h="height");const f=[],y=i.sort((w,C)=>a[w.id][c]-a[C.id][c])[0],g=i.sort((w,C)=>a[C.id][u]-a[w.id][u])[0],m=a[y.id][d],v=(a[g.id][d]-m)/(s-1),x=m+v;return i.filter(w=>w!==y&&w!==g).sort((w,C)=>a[w.id][d]-a[C.id][d]).forEach((w,C)=>{var M,T;const P={x:0,y:0};P[l]=x+v*C-a[w.id][h]/2-a[w.id][l];const k=this.getShapeParent(w),I=k?E.Rot(P,-this.getShapePageTransform(k).rotation()):P,_=(T=(M=this.getShapeUtil(w)).onTranslateStart)==null?void 0:T.call(M,w);f.push(_?{..._,[l]:w[l]+I[l]}:{id:w.id,type:w.type,[l]:w[l]+I[l]})}),this.updateShapes(f),this}stretchShapes(n,r){const o=typeof n[0]=="string"?n:n.map(c=>c.id);if(this.getInstanceState().isReadonly)return this;if(o.length<2)return this;const s=pe(o.map(c=>this.getShape(c))),i=Object.fromEntries(o.map(c=>[c,this.getShapeGeometry(c).bounds])),a=Object.fromEntries(o.map(c=>[c,this.getShapePageBounds(c)])),l=le.Common(pe(Object.values(a)));switch(r){case"vertical":{this.batch(()=>{for(const c of s){if(this.getShapePageTransform(c).rotation()%Ue)continue;const d=i[c.id],h=a[c.id],f=new E(0,l.minY-h.minY),y=this.getShapeParentTransform(c);y&&f.rot(-y.rotation());const{x:g,y:m}=E.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:g,y:m}],{squashing:!0});const v=new E(1,l.height/h.height);this.resizeShape(c.id,v,{initialBounds:d,scaleOrigin:new E(h.center.x,l.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const c of s){const u=i[c.id],d=a[c.id];if(this.getShapePageTransform(c).rotation()%Ue)continue;const f=new E(l.minX-d.minX,0),y=this.getShapeParentTransform(c);y&&f.rot(-y.rotation());const{x:g,y:m}=E.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:g,y:m}],{squashing:!0});const v=new E(l.width/d.width,1);this.resizeShape(c.id,v,{initialBounds:u,scaleOrigin:new E(l.minX,d.center.y),scaleAxisRotation:0})}});break}}return this}resizeShape(n,r,o={}){var f;const s=typeof n=="string"?n:n.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(r.x)||(r=new E(1,r.y)),Number.isFinite(r.y)||(r=new E(r.x,1));const i=o.initialShape??this.getShape(s);if(!i)return this;const a=o.scaleOrigin??((f=this.getShapePageBounds(s))==null?void 0:f.center);if(!a)return this;const l=o.initialPageTransform?se.Cast(o.initialPageTransform):this.getShapePageTransform(s);if(!l)return this;const c=l.rotation();if(c==null)return this;const u=o.scaleAxisRotation??c,d=o.initialBounds??this.getShapeGeometry(s).bounds;if(!d)return this;if(!dA(c,u))return this._resizeUnalignedShape(s,r,{...o,initialBounds:d,scaleOrigin:a,scaleAxisRotation:u,initialPageTransform:l,initialShape:i});const h=this.getShapeUtil(i);if(h.isAspectRatioLocked(i)&&(Math.abs(r.x)>Math.abs(r.y)?r=new E(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new E(Math.sign(r.x)*Math.abs(r.y),r.y)),h.onResize&&h.canResize(i)){const y=this._scalePagePoint(se.applyToPoint(l,new E(0,0)),a,r,u),g=this.getPointInParentSpace(i.id,y),m=new E(r.x,r.y),v=Tu((c-u)%Math.PI,0);m.x=v?r.x:r.y,m.y=v?r.y:r.x;const x=se.applyToPoint(l,new E),{x:w,y:C}=this.getPointInParentSpace(i.id,x);this.updateShapes([{id:s,type:i.type,x:g.x,y:g.y,...h.onResize({...i,x:w,y:C},{newPoint:g,handle:o.dragHandle??"bottom_right",mode:o.mode??"scale_shape",scaleX:m.x,scaleY:m.y,initialBounds:d,initialShape:i})}],{squashing:!0})}else{const y=se.applyToPoint(l,d.center),g=this._scalePagePoint(y,a,r,u),m=this.getPointInParentSpace(i.id,y),v=this.getPointInParentSpace(i.id,g),x=E.Sub(v,m);this.updateShapes([{id:s,type:i.type,x:i.x+x.x,y:i.y+x.y}],{squashing:!0})}return this}_scalePagePoint(n,r,o,s){const i=E.RotWith(n,r,-s).sub(r),a=E.MulV(i,o);return E.Add(a,r).rotWith(r,s)}_resizeUnalignedShape(n,r,o){const{type:s}=o.initialShape,i=new E(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?i.x=Math.sign(r.x)*Math.abs(r.y):i.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(n,i,{initialShape:o.initialShape,initialBounds:o.initialBounds}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:v}=se.Decompose(o.initialPageTransform);v-=2*v,this.updateShapes([{id:n,type:s,rotation:v}],{squashing:!0})}const a=se.applyToPoint(o.initialPageTransform,o.initialBounds.center),l=this._scalePagePoint(a,o.scaleOrigin,r,o.scaleAxisRotation),c=this.getShapePageBounds(n),u=this.getShapePageTransform(n),d=c.center,h=u.point();if(!d||!h)return this;const f=E.Sub(l,d),y=E.Add(h,f),{x:g,y:m}=this.getPointInParentSpace(n,y);return this.updateShapes([{id:n,type:s,x:g,y:m}],{squashing:!0}),this}getInitialMetaForShape(n){return{}}createShape(n){return this._createShapes([n]),this}createShapes(n){if(!Array.isArray(n))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");return this._createShapes(n),this}animateShape(n,r){return this.animateShapes([n],r)}animateShapes(n,r={}){const{duration:o=500,easing:s=dn.linear}=r,i=Ge();let a=o,l;const c=[];n.forEach(h=>{if(!h)return;const f={partial:h,values:[]},y=this.getShape(h.id);if(y){for(const g of["x","y","rotation"])h[g]!==void 0&&y[g]!==h[g]&&f.values.push({prop:g,from:y[g],to:h[g]});c.push(f),this.animatingShapes.set(y.id,i)}});let u;const d=h=>{if(a-=h,a<0){const{animatingShapes:y}=this,g=n.filter(m=>m&&y.get(m.id)===i);g.length&&this.updateShapes(g,{squashing:!1}),this.removeListener("tick",d);return}l=s(1-a/o);const{animatingShapes:f}=this;try{const y=[];for(let g=0;g<c.length;g++)u=c[g],f.get(u.partial.id)===i&&y.push({id:u.partial.id,type:u.partial.type,...u.values.reduce((m,{prop:v,from:x,to:w})=>(m[v]=x+(w-x)*l,m),{})});this._updateShapes(y,{squashing:!0})}catch{}};return this.addListener("tick",d),this}groupShapes(n,r=Je()){var f;if(!Array.isArray(n))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const o=typeof n[0]=="string"?n:n.map(y=>y.id);if(o.length<=1)return this;const s=pe(this._getUnlockedShapeIds(o).map(y=>this.getShape(y))),i=s.sort(ln).map(y=>y.id),a=le.Common(pe(s.map(y=>this.getShapePageBounds(y)))),{x:l,y:c}=a.point,u=this.findCommonAncestor(s)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const d=s.filter(y=>y.parentId===u).sort(ln),h=(f=d[d.length-1])==null?void 0:f.index;return this.batch(()=>{this.createShapes([{id:r,type:"group",parentId:u,index:h,x:l,y:c,opacity:1,props:{}}]),this.reparentShapes(i,r),this.select(r)}),this}ungroupShapes(n){const r=typeof n[0]=="string"?n:n.map(a=>a.id);if(this.getInstanceState().isReadonly)return this;if(r.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const o=new Set,s=pe(r.map(a=>this.getShape(a))),i=[];return s.forEach(a=>{this.isShapeOfType(a,"group")?i.push(a):o.add(a.id)}),i.length===0?this:(this.batch(()=>{let a;for(let l=0,c=i.length;l<c;l++){a=i[l];const u=this.getSortedChildIdsForParent(a.id);for(let d=0,h=u.length;d<h;d++)o.add(u[d]);this.reparentShapes(u,a.parentId,a.index)}this.deleteShapes(i.map(l=>l.id)),this.select(...o)}),this)}updateShape(n,r){return this.updateShapes([n],r),this}updateShapes(n,r){let o=pe(n);return this.animatingShapes.size>0&&o.forEach(s=>this.animatingShapes.delete(s.id)),o=o.filter(s=>{const i=this.getShape(s.id);return!(!i||this.isShapeOrAncestorLocked(i)&&!Object.hasOwn(s,"isLocked"))}),this._updateShapes(o,r),this}_getUnlockedShapeIds(n){return n.filter(r=>{var o;return!((o=this.getShape(r))!=null&&o.isLocked)})}deleteShapes(n){if(!Array.isArray(n))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");return this._deleteShapes(this._getUnlockedShapeIds(typeof n[0]=="string"?n:n.map(r=>r.id))),this}deleteShape(n){return this.deleteShapes([typeof n=="string"?n:n.id]),this}_extractSharedStyles(n,r){if(this.isShapeOfType(n,"group")){const o=this._parentIdsToChildIds.get()[n.id];if(!o)return;for(let s=0,i=o.length;s<i;s++)this._extractSharedStyles(this.getShape(o[s]),r)}else for(const[o,s]of this.styleProps[n.type])r.applyValue(o,ca(n.props,s))}getStyleForNextShape(n){const r=this.getInstanceState().stylesForNextShape[n.id];return r===void 0?n.defaultValue:r}getShapeStyleIfExists(n,r){const o=this.styleProps[n.type].get(r);if(o!==void 0)return ca(n.props,o)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._selectionSharedStyles.get();const n=this.root.getCurrent(),r=new HS;if(!n)return r;if(n.shapeType)for(const o of this.styleProps[n.shapeType].keys())r.applyValue(o,this.getStyleForNextShape(o));return r}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const n=[],r=s=>{const i=this.getShape(s);if(i)if(this.isShapeOfType(i,"group"))for(const a of this.getSortedChildIdsForParent(i.id))r(a);else n.push(i)};for(const s of this.getSelectedShapeIds())r(s);let o=null;for(const s of n)if(o===null)o=s.opacity;else if(o!==s.opacity)return{type:"mixed"};if(o!==null)return{type:"shared",value:o}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(n,r){return this.updateInstanceState({opacityForNextShape:n},r),this}setOpacityForSelectedShapes(n,r){const o=this.getSelectedShapes();if(o.length>0){const s=[],i=a=>{if(this.isShapeOfType(a,"group")){const l=this.getSortedChildIdsForParent(a);for(const c of l)i(this.getShape(c))}else s.push(a)};for(const a of o)i(a);this.updateShapes(s.map(a=>({id:a.id,type:a.type,opacity:n})),r)}return this}setStyleForNextShapes(n,r,o){const s=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...s,[n.id]:r}},o),this}setStyleForSelectedShapes(n,r,o){const s=this.getSelectedShapes();if(s.length>0){const i=[],a=l=>{if(this.isShapeOfType(l,"group")){const c=this.getSortedChildIdsForParent(l.id);for(const u of c)a(this.getShape(u))}else{const c=this.getShapeUtil(l),u=this.styleProps[l.type].get(n);if(u){const d={id:l.id,type:l.type,props:{[u]:r}};i.push({util:c,originalShape:l,updatePartial:d})}}};for(const l of s)a(l);this.updateShapes(i.map(({updatePartial:l})=>l),o)}return this}registerExternalAssetHandler(n,r){return this.externalAssetContentHandlers[n]=r,this}async getAssetForExternalContent(n){var r,o;return await((o=(r=this.externalAssetContentHandlers)[n.type])==null?void 0:o.call(r,n))}registerExternalContentHandler(n,r){return this.externalContentHandlers[n]=r,this}async putExternalContent(n){var r,o;return(o=(r=this.externalContentHandlers)[n.type])==null?void 0:o.call(r,n)}getContentFromCurrentPage(n){const r=typeof n[0]=="string"?n:n.map(l=>l.id);if(!r||r.length===0)return;const o={};let s=og(r.map(l=>this.getShape(l)).sort(ln).flatMap(l=>{const c=[l];return this.visitDescendants(l.id,u=>{c.push(this.getShape(u))}),c}));s=s.map(l=>{if(o[l.id]=this.getShapePageTransform(l.id),l=ui(l),this.isShapeOfType(l,"arrow")){const c=l.props.start.type==="binding"?l.props.start.boundShapeId:void 0,u=l.props.end.type==="binding"?l.props.end.boundShapeId:void 0,d=this.getArrowInfo(l);if(l.props.start.type==="binding"&&!s.some(f=>f.id===c))if(d!=null&&d.isValid){const{x:f,y}=d.start.point;l.props.start={type:"point",x:f,y}}else{const{start:f}=Qr(this,l);l.props.start={type:"point",x:f.x,y:f.y}}if(l.props.end.type==="binding"&&!s.some(f=>f.id===u))if(d!=null&&d.isValid){const{x:f,y}=d.end.point;l.props.end={type:"point",x:f,y}}else{const{end:f}=Qr(this,l);l.props.end={type:"point",x:f.x,y:f.y}}const h=qc(l)?Ru(this,l):tv(this,l);if(d!=null&&d.isValid&&(h!=null&&h.isValid)&&!qc(l)){const f=E.Med(d.start.handle,d.end.handle),y=E.Dist(d.middle,f),g=E.Dist(h.middle,f);l.props.bend<0?l.props.bend+=g-y:l.props.bend-=g-y}return l}return l});const i=[];s.forEach(l=>{if(s.find(c=>c.id===l.parentId)===void 0){const c=this.getShapePageTransform(l.id),u=c.point(),d=c.rotation();l.x=u.x,l.y=u.y,l.rotation=d,l.parentId=this.getCurrentPageId(),i.push(l.id)}});const a=new Set;return s.forEach(l=>{"assetId"in l.props&&l.props.assetId!==null&&a.add(l.props.assetId)}),{shapes:s,rootShapeIds:i,schema:this.store.schema.serialize(),assets:pe(Array.from(a).map(l=>this.getAsset(l)))}}putContentOntoCurrentPage(n,r={}){if(this.getInstanceState().isReadonly)return this;if(!n.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:o=!1,preserveIds:s=!1,preservePosition:i=!1}=r;let{point:a=void 0}=r;const l=this.getCurrentPageId(),{assets:c,shapes:u,rootShapeIds:d}=n,h=new Map(u.map(P=>[P.id,Je()]));let f=this.getCurrentPageId(),y=1/0,g=[];for(const P of this.getSelectedShapes()){if(y===0)break;const k=this.isShapeOfType(P,"frame"),I=this.getShapeAncestors(P);k&&I.push(P);const _=k?I.length+1:I.length;if(_<y)y=_,g=I,f=k?P.id:P.parentId;else if(_===y){if(g.length!==I.length)throw Error(`Ancestors: ${g.length} !== ${I.length}`);if(g.length===0){f=l;break}else{f=l;for(let M=0;M<g.length&&I[M]===g[M];M++)f=I[M].id}}}let m=!1;if(!jn(f)){const P=this.getShape(f);if(P){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(P)))f=l;else if(d.length===1){const k=u.find(I=>I.id===d[0]);this.isShapeOfType(P,"frame")&&this.isShapeOfType(k,"frame")&&k.props.w===(P==null?void 0:P.props.w)&&k.props.h===(P==null?void 0:P.props.h)&&(m=!0)}}else f=l}m||(m=h.has(f)),m&&(f=this.getShape(f).parentId);let v=this.getHighestIndexForParent(f);const x=[],w=u.map(P=>{let k;if(s)k=hn(P),h.set(P.id,P.id);else{const I=h.get(P.id);k=hn({...P,id:I})}if(d.includes(P.id)&&(k.parentId=l,x.push(k)),h.has(k.parentId)?k.parentId=h.get(P.parentId):(d.push(k.id),k.index=v,v=Zo(v)),this.isShapeOfType(k,"arrow")){if(k.props.start.type==="binding"){const I=h.get(k.props.start.boundShapeId);k.props.start=I?{...k.props.start,boundShapeId:I}:{type:"point",x:0,y:0}}if(k.props.end.type==="binding"){const I=h.get(k.props.end.boundShapeId);k.props.end=I?{...k.props.end,boundShapeId:I}:{type:"point",x:0,y:0}}}return k});if(w.length+this.getCurrentPageShapeIds().size>Go)return qh(this),this;let C=[];if(c){for(let k=0;k<c.length;k++){const I=c[k],_=this.store.schema.migratePersistedRecord(I,n.schema);if(_.type==="success")c[k]=_.value;else throw Error(`Could not put content:
could not migrate content for asset:
${I.id}
${I.type}
reason:${_.reason}`)}const P=[];C=c.filter(k=>!this.store.has(k.id)).map(k=>{var I;return(k.type==="image"||k.type==="video")&&(k.props.src&&((I=k.props.src)!=null&&I.startsWith("data:image"))?(P.push(ui(k)),k.props.src=null):P.push(ui(k))),k}),Promise.allSettled(P.map(async k=>{const I=await DK(k.props.src,k.props.name,k.props.mimeType??"image/png"),_=await this.getAssetForExternalContent({type:"file",file:I});return _?[k,_]:null})).then(k=>{this.updateAssets(pe(k.map(I=>I.status==="fulfilled"&&I.value?{...I.value[1],id:I.value[0].id}:void 0)))})}for(let P=0;P<w.length;P++){const k=w[P],I=this.store.schema.migratePersistedRecord(k,n.schema);if(I.type==="success")w[P]=I.value;else throw Error(`Could not put content:
could not migrate content for shape:
${k.id}, ${k.type}
reason:${I.reason}`)}return this.batch(()=>{C.length>0&&this.createAssets(C),this.createShapes(w),o&&this.select(...x.map(M=>M.id)),f!==l&&this.reparentShapes(x.map(M=>M.id),f);const P=w.map(M=>this.getShape(M.id)),k=le.Common(P.map(M=>this.getShapePageBounds(M)));if(a===void 0)if(jn(f)){const M=this.getViewportPageBounds();i||M.includes(le.From(k))?a=k.center:a=M.center}else{const M=this.getShape(f);a=se.applyToPoint(this.getShapePageTransform(M),this.getShapeGeometry(M).bounds.center)}if(x.length===1){const M=x[0];if(this.isShapeOfType(M,"frame"))for(;this.getShapesAtPoint(a).some(T=>this.isShapeOfType(T,"frame")&&T.props.w===M.props.w&&T.props.h===M.props.h);)a.x+=k.w+16}const I=le.Common(pe(x.map(({id:M})=>this.getShapePageBounds(M)))).center,_=E.Sub(a,I);this.updateShapes(x.map(({id:M})=>{const T=this.getShape(M),R=this.getShapeParentTransform(M).decompose().rotation,j=E.Rot(_,-R);return{id:T.id,type:T.type,x:T.x+j.x,y:T.y+j.y}}))}),this}async getSvg(n,r={}){var P,k;const o=typeof n[0]=="string"?n:n.map(I=>I.id);if(o.length===0)return;if(!window.document)throw Error("No document");const{scale:s=1,background:i=!1,padding:a=WB,preserveAspectRatio:l=!1}=r,c=Wn({isDarkMode:this.user.getIsDarkMode()}),u=this.getShapeAndDescendantIds(o),d=this.getUnorderedRenderingShapes(!1).filter(({id:I})=>u.has(I));let h=null;if(r.bounds)h=r.bounds;else for(const{maskedPageBounds:I}of d)I&&(h?h.union(I):h=I.clone());if(!h)return;const f=o.length===1&&this.isShapeOfType(this.getShape(o[0]),"frame")?o[0]:null;f||h.expandBy(a);const y=h.width*s,g=h.height*s,m=window.document.createElementNS("http://www.w3.org/2000/svg","svg");l&&m.setAttribute("preserveAspectRatio",l),m.setAttribute("direction","ltr"),m.setAttribute("width",y+""),m.setAttribute("height",g+""),m.setAttribute("viewBox",`${h.minX} ${h.minY} ${h.width} ${h.height}`),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),i?f?m.style.setProperty("background",c.solid):m.style.setProperty("background-color",c.background):m.style.setProperty("background-color","transparent");try{(k=(P=document.body).focus)==null||k.call(P)}catch{}const v=window.document.createElementNS("http://www.w3.org/2000/svg","defs");m.append(v);const x=new Map,w={addExportDef:I=>{if(x.has(I.key))return;const _=(async()=>{const M=await I.getElement();if(!M)return;const T=document.createComment(`def: ${I.key}`);v.appendChild(T);for(const R of Array.isArray(M)?M:[M])v.appendChild(R)})();x.set(I.key,_)}},C=(await Promise.all(d.map(async({id:I,opacity:_,index:M,backgroundIndex:T})=>{var D,z;if(I===f)return[];const R=this.getShape(I);if(this.isShapeOfType(R,"group"))return[];const j=this.getShapeUtil(R);let $=await((D=j.toSvg)==null?void 0:D.call(j,R,w)),L=await((z=j.toBackgroundSvg)==null?void 0:z.call(j,R,w));if($){const V=document.createElementNS("http://www.w3.org/2000/svg","g");V.appendChild($),$=V}if(L){const V=document.createElementNS("http://www.w3.org/2000/svg","g");V.appendChild(L),L=V}if(!$&&!L){const V=this.getShapePageBounds(R),K=window.document.createElementNS("http://www.w3.org/2000/svg","rect");K.setAttribute("width",V.width+""),K.setAttribute("height",V.height+""),K.setAttribute("fill",c.solid),K.setAttribute("stroke",c.grey.pattern),K.setAttribute("stroke-width","1"),$=K}let U=this.getShapePageTransform(R).toCssString();"scale"in R.props&&R.props.scale!==1&&(U=`${U} scale(${R.props.scale}, ${R.props.scale})`),$==null||$.setAttribute("transform",U),L==null||L.setAttribute("transform",U),$==null||$.setAttribute("opacity",_+""),L==null||L.setAttribute("opacity",_+"");const F=this.getShapeMask(R.id);if(F){const V=document.createElementNS("http://www.w3.org/2000/svg","clipPath");v.appendChild(V);const K=Ge();V.id=K;const J=document.createElementNS("http://www.w3.org/2000/svg","path");if(J.setAttribute("d",`M${F.map(({x:ne,y:me})=>`${ne},${me}`).join("L")}Z`),V.appendChild(J),$){const ne=document.createElementNS("http://www.w3.org/2000/svg","g");ne.setAttribute("clip-path",`url(#${K})`),ne.appendChild($),$=ne}if(L){const ne=document.createElementNS("http://www.w3.org/2000/svg","g");ne.setAttribute("clip-path",`url(#${K})`),ne.appendChild(L),L=ne}}const G=[];return $&&G.push({zIndex:M,element:$}),L&&G.push({zIndex:T,element:L}),G}))).flat();await Promise.all(x.values());for(const{element:I}of C.sort((_,M)=>_.zIndex-M.zIndex))m.appendChild(I);return m}_updateInputsFromEvent(n){var y;const{previousScreenPoint:r,previousPagePoint:o,currentScreenPoint:s,currentPagePoint:i}=this.inputs,{screenBounds:a}=this.store.unsafeGetWithoutCapture(Pn),{x:l,y:c,z:u}=n.point,{x:d,y:h,z:f}=this.getCamera();r.setTo(s),o.setTo(i),s.set(l,c),i.set((l-a.x)/f-d,(c-a.y)/f-h,u??.5),this.inputs.isPen=n.type==="pointer"&&n.isPen,n.name==="pointer_down"&&this.inputs.pointerVelocity.set(0,0),this.store.put([{id:cg,typeName:"pointer",x:i.x,y:i.y,lastActivityTimestamp:n.type==="pointer"&&n.pointerId===uk.CAMERA_MOVE?((y=this.store.get(cg))==null?void 0:y.lastActivityTimestamp)??Date.now():Date.now(),meta:{}}])}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}}ue([Z],ce.prototype,"getCanUndo");ue([Z],ce.prototype,"getCanRedo");ue([Z],ce.prototype,"_getArrowBindingsIndex");ue([Z],ce.prototype,"getArrowInfoCache");ue([Z],ce.prototype,"getPath");ue([Z],ce.prototype,"getCurrentTool");ue([Z],ce.prototype,"getCurrentToolId");ue([Z],ce.prototype,"getDocumentSettings");ue([Z],ce.prototype,"getInstanceState");ue([Z],ce.prototype,"getOpenMenus");ue([Z],ce.prototype,"getIsMenuOpen");ue([Z],ce.prototype,"getPageStates");ue([Z],ce.prototype,"_getPageStatesQuery");ue([Z],ce.prototype,"getCurrentPageState");ue([Z],ce.prototype,"_getCurrentPageStateId");ue([Z],ce.prototype,"getSelectedShapeIds");ue([Z],ce.prototype,"getSelectedShapes");ue([Z],ce.prototype,"getOnlySelectedShape");ue([Z],ce.prototype,"getSelectionPageBounds");ue([Z],ce.prototype,"getSelectionRotation");ue([Z],ce.prototype,"getSelectionRotatedPageBounds");ue([Z],ce.prototype,"getFocusedGroupId");ue([Z],ce.prototype,"getFocusedGroup");ue([Z],ce.prototype,"getEditingShapeId");ue([Z],ce.prototype,"getEditingShape");ue([Z],ce.prototype,"getHoveredShapeId");ue([Z],ce.prototype,"getHoveredShape");ue([Z],ce.prototype,"getHintingShapeIds");ue([Z],ce.prototype,"getHintingShape");ue([Z],ce.prototype,"getErasingShapeIds");ue([Z],ce.prototype,"getErasingShapes");ue([Z],ce.prototype,"getCameraId");ue([Z],ce.prototype,"getCamera");ue([Z],ce.prototype,"getZoomLevel");ue([Z],ce.prototype,"getViewportScreenBounds");ue([Z],ce.prototype,"getViewportScreenCenter");ue([Z],ce.prototype,"getViewportPageBounds");ue([Z],ce.prototype,"getViewportPageCenter");ue([Z],ce.prototype,"getRenderingShapes");ue([Z],ce.prototype,"_getAllPagesQuery");ue([Z],ce.prototype,"getPages");ue([Z],ce.prototype,"_getAllAssetsQuery");ue([Z],ce.prototype,"_getShapeGeometryCache");ue([Z],ce.prototype,"_getShapeOutlineSegmentsCache");ue([Z],ce.prototype,"_getShapeHandlesCache");ue([Z],ce.prototype,"_getShapePageTransformCache");ue([Z],ce.prototype,"_getShapePageBoundsCache");ue([Z],ce.prototype,"_getShapeClipPathCache");ue([Z],ce.prototype,"_getShapeMaskCache");ue([Z],ce.prototype,"getCurrentPageBounds");ue([Z],ce.prototype,"getCurrentPageShapes");ue([Z],ce.prototype,"getCurrentPageShapesSorted");ue([Z],ce.prototype,"getCurrentPageRenderingShapesSorted");ue([Z({isEqual:(e,t)=>e.equals(t)})],ce.prototype,"getSharedStyles");ue([Z],ce.prototype,"getSharedOpacity");function qh(e,t=e.getCurrentPageId()){const n=e.getPage(t).name;e.emit("max-shapes",{name:n,pageId:t,count:Go})}function Pm(){const e=W();return q("isDarkMode",()=>e.user.getIsDarkMode(),[e])}const mW='<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',yW='<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',vW='<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',SW='<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',Uk="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",Hk="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Qh='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>',xW='<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',wW="<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",bW='<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',CW='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',PW='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>';function zt(e,t,n,r,o,s=16,i=16){const a=(-n-t)*($e/180),l=Math.sin(a),c=Math.cos(a),u=1*c-1*l,d=1*l+1*c;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${o};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${u}' dy='${d}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${t+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replaceAll('"',"'")+`</g></svg>") ${s} ${i}, pointer`}const kW={none:()=>"none",default:(e,t,n)=>zt(mW,e,0,t,n,12,8),pointer:(e,t,n)=>zt(yW,e,0,t,n,14,10),cross:(e,t,n)=>zt(vW,e,0,t,n),move:(e,t,n)=>zt(SW,e,0,t,n),grab:(e,t,n)=>zt(bW,e,0,t,n),grabbing:(e,t,n)=>zt(wW,e,0,t,n),text:(e,t,n)=>zt(xW,e,0,t,n,4,10),"ew-resize":(e,t,n)=>zt(Hk,e,0,t,n),"ns-resize":(e,t,n)=>zt(Hk,e,90,t,n),"nesw-resize":(e,t,n)=>zt(Uk,e,0,t,n),"nwse-resize":(e,t,n)=>zt(Uk,e,90,t,n),"nwse-rotate":(e,t,n)=>zt(Qh,e,0,t,n),"nesw-rotate":(e,t,n)=>zt(Qh,e,90,t,n),"senw-rotate":(e,t,n)=>zt(Qh,e,180,t,n),"swne-rotate":(e,t,n)=>zt(Qh,e,270,t,n),"zoom-in":(e,t,n)=>zt(CW,e,0,t,n),"zoom-out":(e,t,n)=>zt(PW,e,0,t,n)};function qn(e,t=0,n="black"){return kW[e](OB(t),!1,n)}const EW=["default","pointer","cross","move","grab","grabbing","text"];function IW(){const e=W(),t=mn(),n=Pm();aa("useCursor",()=>{const{type:r,rotation:o}=e.getInstanceState().cursor;if(EW.includes(r)){t.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}t.style.setProperty("--tl-cursor",qn(r,o,n?"white":"black"))},[e,t,n])}function _W(){const e=W(),t=mn(),n=Pm(),r=q(qe.forceSrgb);H.useEffect(()=>{n?(t.setAttribute("data-color-mode","dark"),t.classList.remove("tl-theme__light"),t.classList.add("tl-theme__dark")):(t.setAttribute("data-color-mode","light"),t.classList.remove("tl-theme__dark"),t.classList.add("tl-theme__light")),r?t.classList.add("tl-theme__force-sRGB"):t.classList.remove("tl-theme__force-sRGB")},[e,t,r,n])}function TW(e){const t=b.useRef();return b.useLayoutEffect(()=>{t.current=e}),b.useDebugValue(e),b.useCallback((...n)=>{const r=t.current;return la(r,"fn does not exist"),r(...n)},[])}function MW(e){const t=W(),n=mn();b.useLayoutEffect(()=>{e?(t.getInstanceState().isFocused||t.updateInstanceState({isFocused:!0}),t.getContainer().focus()):t.getInstanceState().isFocused&&t.updateInstanceState({isFocused:!1})},[t,n,e])}function AW(){const[e,t]=b.useState(0);b.useEffect(()=>t(n=>n+1),[])}const Rl="TLDRAW_TAB_ID_v2",Vt=globalThis.window;function RW(){return Vt?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(Vt.navigator.platform)||Vt.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const Ig=(Vt==null?void 0:Vt[Rl])??(Vt==null?void 0:Vt.sessionStorage[Rl])??"TLDRAW_INSTANCE_STATE_V1_"+Ge();Vt&&(Vt[Rl]=Ig,RW()?Vt.sessionStorage[Rl]=Ig:delete Vt.sessionStorage[Rl]);Vt==null||Vt.addEventListener("beforeunload",()=>{Vt.sessionStorage[Rl]=Ig});const OW={Initial:0},hd=OW.Initial,JA=_e({version:ge,currentPageId:sd,isFocusMode:Ee,exportBackground:Ee,isDebugMode:Ee,isToolLocked:Ee,isGridMode:Ee,pageStates:In(_e({pageId:sd,camera:_e({x:ge,y:ge,z:ge}),selectedShapeIds:In(Wr),focusedGroupId:Wr.nullable()}))}),jW=Le({currentVersion:hd});function DW(e){if(!e||typeof e!="object")return console.warn("Invalid instance state"),null;if(!("version"in e)||typeof e.version!="number")return console.warn("No version in instance state"),null;const t=Xw({value:e,fromVersion:e.version,toVersion:hd,migrations:jW});if(t.type==="error")return console.warn(t.reason),null;const n={...t.value,version:hd};try{JA.validate(n)}catch(r){return console.warn(r),null}return n}function NW(e){const t=e.query.ids("page");return Z("sessionStateSnapshot",()=>{const n=e.get(Pn);if(!n)return null;const r=[...t.get()];return{version:hd,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(o=>{const s=e.get(sn.createId(o)),i=e.get(on.createId(o));return{pageId:o,camera:{x:(i==null?void 0:i.x)??0,y:(i==null?void 0:i.y)??0,z:(i==null?void 0:i.z)??1},selectedShapeIds:(s==null?void 0:s.selectedShapeIds)??[],focusedGroupId:(s==null?void 0:s.focusedGroupId)??null}})}})}function $W(e,t){const n=DW(t);if(!n)return;const r=e.allRecords().filter(i=>i.typeName==="instance_page_state"||i.typeName==="camera"),o={added:{},updated:{},removed:{...WM(r.map(i=>[i.id,i]))}};e.has(Pn)&&(o.removed[Pn]=e.get(Pn));const s={removed:{},updated:{},added:{[Pn]:e.schema.types.instance.create({id:Pn,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground})}};for(const i of n.pageStates){const a=on.createId(i.pageId),l=sn.createId(i.pageId);s.added[a]=on.create({id:on.createId(i.pageId),x:i.camera.x,y:i.camera.y,z:i.camera.z}),s.added[l]=sn.create({id:sn.createId(i.pageId),pageId:i.pageId,selectedShapeIds:i.selectedShapeIds,focusedGroupId:i.focusedGroupId})}Xr(()=>{e.applyDiff(vm([o,s])),e.ensureStoreIsUsable()})}function LW(e){var o;const t=[];for(const s of Object.values(e))(o=s.typeName)!=null&&o.match(/^(instance.*|pointer|camera)$/)&&t.push(s);const n=t.filter(s=>s.typeName==="instance"&&s.id!==Pn)[0];if(!n)return null;const r={version:hd,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:t.filter(s=>s.typeName==="instance_page_state"&&s.instanceId===n.id).map(s=>{const i=e[s.cameraId]??{x:0,y:0,z:1};return{pageId:s.pageId,camera:{x:i.x,y:i.y,z:i.z},selectedShapeIds:s.selectedShapeIds,focusedGroupId:s.focusedGroupId}})};try{return JA.validate(r),r}catch{return null}}function FW(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
 If your hard disk is full, try clearing up some space and then reload the page.`)}function zW(){window.alert(`Oops! We could not access your browser's storageand the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const BW=(e,t)=>t.some(n=>e instanceof n);let Vk,Kk;function UW(){return Vk||(Vk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HW(){return Kk||(Kk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eR=new WeakMap,VS=new WeakMap,tR=new WeakMap,nv=new WeakMap,mb=new WeakMap;function VW(e){const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{n(as(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(n=>{n instanceof IDBCursor&&eR.set(n,e)}).catch(()=>{}),mb.set(t,e),t}function KW(e){if(VS.has(e))return;const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{n(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});VS.set(e,t)}let KS={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return VS.get(e);if(t==="objectStoreNames")return e.objectStoreNames||tR.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return as(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function WW(e){KS=e(KS)}function GW(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(rv(this),t,...n);return tR.set(r,t.sort?t.sort():[t]),as(r)}:HW().includes(e)?function(...t){return e.apply(rv(this),t),as(eR.get(this))}:function(...t){return as(e.apply(rv(this),t))}}function YW(e){return typeof e=="function"?GW(e):(e instanceof IDBTransaction&&KW(e),BW(e,UW())?new Proxy(e,KS):e)}function as(e){if(e instanceof IDBRequest)return VW(e);if(nv.has(e))return nv.get(e);const t=YW(e);return t!==e&&(nv.set(e,t),mb.set(t,e)),t}const rv=e=>mb.get(e);function XW(e,t,{blocked:n,upgrade:r,blocking:o,terminated:s}={}){const i=indexedDB.open(e,t),a=as(i);return r&&i.addEventListener("upgradeneeded",l=>{r(as(i.result),l.oldVersion,l.newVersion,as(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),o&&l.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function qW(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",r=>t(r.oldVersion,r)),as(n).then(()=>{})}const QW=["get","getKey","getAll","getAllKeys","count"],ZW=["put","add","delete","clear"],ov=new Map;function Wk(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ov.get(t))return ov.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=ZW.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||QW.includes(n)))return;const s=async function(i,...a){const l=this.transaction(i,o?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),o&&l.done]))[0]};return ov.set(t,s),s}WW(e=>({...e,get:(t,n,r)=>Wk(t,n)||e.get(t,n,r),has:(t,n)=>!!Wk(t,n)||e.has(t,n)}));const km="TLDRAW_DOCUMENT_v2",nR="TLDRAW_DB_NAME_INDEX_v2",Be={Records:"records",Schema:"schema",SessionState:"session_state"};async function Em(e,t){rG(e);const n=await XW(e,3,{upgrade(r){r.objectStoreNames.contains(Be.Records)||r.createObjectStore(Be.Records),r.objectStoreNames.contains(Be.Schema)||r.createObjectStore(Be.Schema),r.objectStoreNames.contains(Be.SessionState)||r.createObjectStore(Be.SessionState)}});try{return await t(n)}finally{n.close()}}async function JW({persistenceKey:e,sessionId:t,didCancel:n}){const r=km+e;if(yb().includes(r))return await nG({persistenceKey:e,didCancel:n}),await Em(r,async o=>{var d,h;if(n!=null&&n())return;const s=o.transaction([Be.Records,Be.Schema,Be.SessionState],"readonly"),i=s.objectStore(Be.Records),a=s.objectStore(Be.Schema),l=s.objectStore(Be.SessionState);let c=t?(d=await l.get(t))==null?void 0:d.snapshot:null;c||(c=(h=(await l.getAll()).sort((y,g)=>y.updatedAt-g.updatedAt).pop())==null?void 0:h.snapshot);const u={records:await i.getAll(),schema:await a.get(Be.Schema),sessionStateSnapshot:c};if(n!=null&&n()){s.abort();return}return await s.done,u})}async function eG({persistenceKey:e,schema:t,changes:n,sessionId:r,sessionStateSnapshot:o,didCancel:s}){const i=km+e;await Em(i,async a=>{const l=a.transaction([Be.Records,Be.Schema,Be.SessionState],"readwrite"),c=l.objectStore(Be.Records),u=l.objectStore(Be.Schema),d=l.objectStore(Be.SessionState);for(const[h,f]of Object.entries(n.added))await c.put(f,h);for(const[h,f]of Object.values(n.updated))await c.put(f,f.id);for(const h of Object.keys(n.removed))await c.delete(h);if(u.put(t.serialize(),Be.Schema),o&&r?d.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),s!=null&&s())return l.abort();await l.done})}async function tG({persistenceKey:e,schema:t,snapshot:n,sessionId:r,sessionStateSnapshot:o,didCancel:s}){const i=km+e;await Em(i,async a=>{const l=a.transaction([Be.Records,Be.Schema,Be.SessionState],"readwrite"),c=l.objectStore(Be.Records),u=l.objectStore(Be.Schema),d=l.objectStore(Be.SessionState);await c.clear();for(const[h,f]of Object.entries(n))await c.put(f,h);if(u.put(t.serialize(),Be.Schema),o&&r?d.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),s!=null&&s())return l.abort();await l.done})}async function nG({persistenceKey:e,didCancel:t}){await Em(km+e,async n=>{const r=n.transaction([Be.SessionState],"readwrite"),o=r.objectStore(Be.SessionState),s=(await o.getAll()).sort((a,l)=>a.updatedAt-l.updatedAt);if(s.length<10){await r.done;return}const i=s.slice(0,s.length-10);for(const{id:a}of i)await o.delete(a);if(t!=null&&t())return r.abort();await r.done})}function yb(){const e=JSON.parse((window==null?void 0:window.localStorage.getItem(nR))||"[]")??[];return Array.isArray(e)?e:[]}function rG(e){const t=new Set(yb());t.add(e),window==null||window.localStorage.setItem(nR,JSON.stringify([...t]))}const oG=350,sG=1e4,Gk=Symbol("UPDATE_INSTANCE_STATE"),iG=e=>e;class aG{constructor(t){S(this,"onmessage")}postMessage(t){}close(){}}const lG=typeof BroadcastChannel>"u"?aG:BroadcastChannel;class cG{constructor(t,{persistenceKey:n,sessionId:r=Ig,onLoad:o,onLoadError:s},i=new lG(`tldraw-tab-sync-${n}`)){S(this,"disposables",new Set);S(this,"diffQueue",[]);S(this,"didDispose",!1);S(this,"shouldDoFullDBWrite",!0);S(this,"isReloading",!1);S(this,"persistenceKey");S(this,"sessionId");S(this,"serializedSchema");S(this,"isDebugging",!1);S(this,"documentTypes");S(this,"$sessionStateSnapshot");S(this,"initTime",Date.now());S(this,"isPersisting",!1);S(this,"didLastWriteError",!1);S(this,"scheduledPersistTimeout",null);this.store=t,this.channel=i,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=n,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=NW(this.store),this.disposables.add(t.listen(({changes:a})=>{this.diffQueue.push(a),this.channel.postMessage(iG({type:"diff",storeId:this.store.id,changes:a,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(t.listen(()=>{this.diffQueue.push(Gk),this.schedulePersist()},{scope:"session"})),this.connect(o,s),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(a=>a.scope==="document").map(a=>a.typeName))}debug(...t){this.isDebugging&&console.debug(...t)}async connect(t,n){this.debug("connecting");let r;try{r=await JW({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(o){n(o),zW(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const o=Object.fromEntries(r.records.map(a=>[a.id,a])),s=r.sessionStateSnapshot??LW(o),i=this.store.schema.migrateStoreSnapshot({store:o,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(i.type==="error"){console.error("failed to migrate store",i),n(new Error(`Failed to migrate store: ${i.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(i.value).filter(a=>this.documentTypes.has(a.typeName)),"initialize")}),s&&$W(this.store,s)}this.channel.onmessage=({data:o})=>{var a,l;this.debug("got message",o);const s=o,i=L9(this.serializedSchema,s.schema??this.store.schema.serializeEarliestVersion());if(i===-1){if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(l=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||l.call(a);return}else if(i===1){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}s.type==="diff"&&(this.debug("applying diff"),Xr(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(s.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),t(this)}catch(o){if(this.debug("error loading data from store",o),this.didDispose)return;n(o);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(t=>t())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?sG:oG))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){la(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const t=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await tG({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const n=vm(t.filter(r=>r!==Gk));await eG({persistenceKey:this.persistenceKey,changes:n,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),FW(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function uG({initialData:e,defaultName:t="",...n}){const r="schema"in n&&n.schema?n.schema:R7({shapes:dG(GA("shapeUtils"in n&&n.shapeUtils?n.shapeUtils:[]))});return new XM({schema:r,initialData:e,props:{defaultName:t}})}function dG(e){return Object.fromEntries(e.map(t=>[t.type,{props:t.props,migrations:t.migrations}]))}function Yk(e){const t=uG(e);return e.snapshot&&t.loadSnapshot(e.snapshot),{store:t,opts:e}}function hG(e){const[t,n]=b.useState(()=>Yk(e));if(!GM(t.opts,e)){const r=Yk(e);return n(r),r.store}return t.store}function pG({persistenceKey:e,sessionId:t,...n}){const[r,o]=b.useState(null),s=hG(n);return b.useEffect(()=>{const i=Ge();if(!e){o({id:i,storeWithStatus:{status:"not-synced",store:s}});return}o({id:i,storeWithStatus:{status:"loading"}});const a=c=>{o(u=>(u==null?void 0:u.id)===i?{id:i,storeWithStatus:c}:u)},l=new cG(s,{sessionId:t,persistenceKey:e,onLoad(){a({store:s,status:"synced-local"})},onLoadError(c){a({status:"error",error:c})}});return()=>{o(c=>(c==null?void 0:c.id)===i?null:c),l.close()}},[e,s,t]),(r==null?void 0:r.storeWithStatus)??{status:"loading"}}let rR=!1;if(typeof window<"u"){const e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i);rR=t&&n&&!e.match(/CriOS/i)}function fG(){const e=W();b.useEffect(()=>{if(!rR)return;function t(n){(n.target instanceof HTMLInputElement&&n.target.type==="text"||n.target instanceof HTMLTextAreaElement)&&e.complete()}return document.addEventListener("focusout",t),()=>document.removeEventListener("focusout",t)},[e])}function gG(){const e=W(),t=mn();b.useEffect(()=>{const n=s=>t.style.setProperty("--tl-zoom",s.toString()),r=KM(n,100),o=new fc("useZoomCss",()=>{e.getCurrentPageShapeIds().size<300?n(e.getZoomLevel()):r(e.getZoomLevel())});return o.attach(),o.execute(),()=>{o.detach()}},[e,t])}const mG=[],yG=[],vG=b.memo(function({store:t,components:n,className:r,user:o,...s}){const[i,a]=H.useState(null),l=b.useMemo(()=>o??UA(),[o]),c=(n==null?void 0:n.ErrorFallback)===void 0?fA:n==null?void 0:n.ErrorFallback,u={...s,shapeUtils:s.shapeUtils??mG,tools:s.tools??yG,components:n};return p.jsx("div",{ref:a,draggable:!1,className:fe("tl-container tl-theme__light",r),onPointerDown:Ot,tabIndex:-1,children:p.jsx(ld,{fallback:c,onError:d=>Gw(d,{tags:{origin:"react.tldraw-before-app"}}),children:i&&p.jsx(xB,{container:i,children:p.jsx(dU,{overrides:n,children:t?t instanceof XM?p.jsx(sR,{...u,store:t,user:l}):p.jsx(oR,{...u,store:t,user:l}):p.jsx(SG,{...u,store:t,user:l})})})})})});function SG(e){const{defaultName:t,snapshot:n,initialData:r,shapeUtils:o,persistenceKey:s,sessionId:i,user:a}=e,l=pG({shapeUtils:o,initialData:r,persistenceKey:s,sessionId:i,defaultName:t,snapshot:n});return p.jsx(oR,{...e,store:l,user:a})}const oR=b.memo(function({store:t,user:n,...r}){var s;const o=mn();switch(b.useLayoutEffect(()=>{n.userPreferences.get().isDarkMode&&(o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark"))},[o,n]),t.status){case"error":throw t.error;case"loading":{const i=((s=r.components)==null?void 0:s.LoadingScreen)??mK;return p.jsx(i,{})}}return p.jsx(sR,{...r,store:t.store,user:n})});function sR({onMount:e,children:t,store:n,tools:r,shapeUtils:o,user:s,initialState:i,autoFocus:a=!0,inferDarkMode:l}){const{ErrorFallback:c}=jt(),u=mn(),[d,h]=b.useState(null);b.useLayoutEffect(()=>{const y=new ce({store:n,shapeUtils:o,tools:r,getContainer:()=>u,user:s,initialState:i,inferDarkMode:l});return window.app=y,window.editor=y,h(y),()=>{y.dispose()}},[u,o,r,n,s,i,l]);const f=b.useSyncExternalStore(b.useCallback(y=>d?(d.on("crash",y),()=>d.off("crash",y)):()=>{},[d]),()=>(d==null?void 0:d.getCrashingError())??null);return d?p.jsx(ld,{fallback:c,onError:y=>d.annotateError(y,{origin:"react.tldraw",willCrashApp:!0}),children:f?p.jsx(wG,{crashingError:f}):p.jsx(ob.Provider,{value:d,children:p.jsx(xG,{autoFocus:a,onMount:e,children:t})})}):null}function xG({children:e,onMount:t,autoFocus:n}){return gG(),IW(),_W(),fG(),AW(),MW(n),CG(t),VV(),W().updateViewportScreenBounds(),e??p.jsx(db,{})}function wG({crashingError:e}){throw e}function iR({children:e}){const{Spinner:t}=jt();return p.jsxs("div",{className:"tl-loading",children:[t?p.jsx(t,{}):null,e]})}function bG({children:e}){return p.jsx("div",{className:"tl-loading",children:e})}function CG(e){const t=W(),n=TW(r=>{const o=e==null?void 0:e(r);return r.emit("mount"),window.tldrawReady=!0,o});H.useLayoutEffect(()=>{if(t)return n==null?void 0:n(t)},[t,n])}function va({children:e,className:t="",...n}){return p.jsx("div",{...n,className:`tl-html-container ${t}`,children:e})}Ve(function({x:t=0,y:n=0,rotation:r=0,...o}){const s=W(),i=b.useRef(null),a=s.getCamera();return b.useLayoutEffect(()=>{const{x:l,y:c,z:u}=s.getCamera(),d=i.current;d&&l!==void 0&&(d.style.transform=`translate(${l}px, ${c}px) scale(${u}) rotate(${r}rad) translate(${t}px, ${n}px)`)},[a,s,t,n,r]),p.jsx("div",{ref:i,...o,className:fe("tl-positioned",o.className)})});function aR(e,t,n={}){const{newPoint:r,handle:o,scaleX:s,scaleY:i}=t,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=n;let d=e.props.w*s,h=e.props.h*i;const f=new E(0,0);if(d>0){if(d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=h-c;break}case"right":case"left":{f.y=(h-c)/2;break}default:f.y=0}h=c}}else if(f.y=h,h=-h,h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-c}h=c}const{x:y,y:g}=f.rot(e.rotation).add(r);return{x:y,y:g,props:{w:Math.min(l,d),h:Math.min(u,h)}}}class wc extends so{constructor(){super(...arguments);S(this,"onResize",(n,r)=>aR(n,r))}getGeometry(n){return new xi({width:n.props.w,height:n.props.h,isFilled:!0})}}var t0;let PG=(t0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(t0,"id","idle"),t0);var n0;let kG=(n0=class extends ie{constructor(){super(...arguments);S(this,"markId","");S(this,"wasFocusedOnEnter",!1);S(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()});S(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,o=this.parent.shapeType,s=Je();this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:o,x:r.x,y:r.y,props:{w:1,h:1}}]).select(s),this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:this.parent.onCreate})}});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType,o=Je();this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:r,x:n.x,y:n.y}]);const s=this.editor.getShape(o),{w:i,h:a}=this.editor.getShapeUtil(s).getDefaultProps(),l=new E(i/2,a/2),c=this.editor.getShapeParentTransform(s);c&&l.rot(-c.rotation()),this.editor.updateShapes([{id:o,type:r,x:s.x-l.x,y:s.y-l.y}]),this.editor.setSelectedShapes([o]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},S(n0,"id","pointing"),n0);class Up extends ie{constructor(){super(...arguments);S(this,"onCreate")}}S(Up,"id","box"),S(Up,"initial","idle"),S(Up,"children",()=>[PG,kG]);function lR(e,t){const n=b.useRef(e);return t(e,n.current)?n.current:(n.current=e,e)}function Xk(e){return lR(e,x9)}function EG(e){return lR(e,GM)}function qk(e){const t=W();return q("isCropping",()=>t.getCroppingShapeId()===e,[t,e])}function Im(e){const t=W();return q("isEditing",()=>t.getEditingShapeId()===e,[t,e])}function mo(e){const t=W();return b.useMemo(function(){const o=c=>{if(c.isKilled)return;if(c.button===2){t.dispatch({type:"pointer",target:"selection",handle:e,name:"right_click",...Fn(c)});return}if(c.button!==0)return;const u=gg(c.currentTarget);function d(){u.removeEventListener("pointerup",d),$d(u,c)}Nd(u,c),u.addEventListener("pointerup",d),t.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:e,...Fn(c)}),Ot(c)};let s,i;function a(c){c.isKilled||c.button===0&&(c.clientX===s&&c.clientY===i||(s=c.clientX,i=c.clientY,t.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:e,...Fn(c)})))}return{onPointerDown:o,onPointerMove:a,onPointerUp:c=>{c.isKilled||c.button===0&&t.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:e,...Fn(c)})}}},[t,e])}const IG=20,_G=8;function vb(e,t=IG){return Math.max(_G,Math.ceil(e/t))}class TG extends Ca{constructor(n){super({...n,isFilled:!1,isClosed:!1});S(this,"_center");S(this,"radius");S(this,"start");S(this,"end");S(this,"measure");S(this,"length");S(this,"angleStart");S(this,"angleEnd");const{center:r,radius:o,sweepFlag:s,largeArcFlag:i,start:a,end:l}=n;if(a.equals(l))throw Error("Arc must have different start and end points.");this.angleStart=E.Angle(r,a),this.angleEnd=E.Angle(r,l),this.measure=MG(this.angleStart,this.angleEnd,s,i),this.length=this.measure*o,this.start=a,this.end=l,this._center=r,this.radius=o}nearestPoint(n){const{_center:r,measure:o,radius:s,angleEnd:i,angleStart:a,start:l,end:c}=this,u=Qk(o,a,i,r.angle(n));if(u<=0)return l;if(u>=1)return c;const d=r.clone().add(n.clone().sub(r).uni().mul(s));let h=1/0,f;for(const y of[l,c,d])n.dist(y)<h&&(f=y,h=n.dist(y));if(!f)throw Error("nearest point not found");return f}hitTestLineSegment(n,r,o){const{_center:s,radius:i,measure:a,angleStart:l,angleEnd:c}=this,u=Cm(n,r,s,i);return u===null?!1:u.some(d=>{const h=Qk(a,l,c,s.angle(d));return h>=0&&h<=1})}getVertices(){const{_center:n,measure:r,length:o,radius:s,angleStart:i}=this,a=[];for(let l=0,c=vb(Math.abs(o));l<c+1;l++){const u=l/c*r,d=i+u;a.push(n.clone().add(new E(Math.cos(d),Math.sin(d)).mul(s)))}return a}}function Qk(e,t,n,r){let o;if(Math.abs(e)>$e){o=Mu(t,r);const s=Mu(r,n);return Math.abs(o)<Math.abs(s)?o/e:(e-s)/e}else return o=Mu(t,r),o/e}function MG(e,t,n,r){const o=2*((t-e)%Ue)%Ue-(t-e)%Ue;return r?(Ue-Math.abs(o))*(n?1:-1):o}class cR extends Ca{constructor(n){super({isClosed:!0,...n});S(this,"_center");S(this,"radius");S(this,"x");S(this,"y");this.config=n;const{x:r=0,y:o=0,radius:s}=n;this.x=r,this.y=o,this._center=new E(s+r,s+o),this.radius=s}getBounds(){return new le(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:n,radius:r}=this,o=Ue*r,s=[];for(let i=0,a=vb(o);i<a;i++){const l=i/a*Ue;s.push(n.clone().add(E.FromAngle(l).mul(r)))}return s}nearestPoint(n){const{_center:r,radius:o}=this;return r.equals(n)?E.AddXY(r,o,0):r.clone().add(n.clone().sub(r).uni().mul(o))}hitTestLineSegment(n,r,o){const{_center:s,radius:i}=this;return Cm(n,r,s,i)!==null}}class AG extends Pa{constructor(n){const{start:r,cp1:o,cp2:s,end:i}=n;super({...n,points:[r,i]});S(this,"a");S(this,"b");S(this,"c");S(this,"d");this.a=r,this.b=o,this.c=s,this.d=i}getVertices(){const n=[],{a:r,b:o,c:s,d:i}=this;for(let a=0,l=10;a<=l;a++){const c=a/l;n.push(new E((1-c)*(1-c)*(1-c)*r.x+3*((1-c)*(1-c))*c*o.x+3*(1-c)*(c*c)*s.x+c*c*c*i.x,(1-c)*(1-c)*(1-c)*r.y+3*((1-c)*(1-c))*c*o.y+3*(1-c)*(c*c)*s.y+c*c*c*i.y))}return n}midPoint(){return RG(this,.5)}nearestPoint(n){let r,o=1/0;for(const s of this.segments){const i=s.nearestPoint(n),a=i.dist(n);a<o&&(r=i,o=a)}if(!r)throw Error("nearest point not found");return r}}function RG(e,t){const{a:n,b:r,c:o,d:s}=e;return new E((1-t)*(1-t)*(1-t)*n.x+3*((1-t)*(1-t))*t*r.x+3*(1-t)*(t*t)*o.x+t*t*t*s.x,(1-t)*(1-t)*(1-t)*n.y+3*((1-t)*(1-t))*t*r.y+3*(1-t)*(t*t)*o.y+t*t*t*s.y)}class Hp extends Ca{constructor(n){super({...n,isClosed:!1,isFilled:!1});S(this,"points");S(this,"_segments");S(this,"_length");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:n}=this,r=n.length,o=r-2,s=1.25;for(let i=0;i<r-1;i++){const a=i===0?n[0]:n[i-1],l=n[i],c=n[i+1],u=i===o?c:n[i+2],d=l,h=i===0?a:new E(l.x+(c.x-a.x)/6*s,l.y+(c.y-a.y)/6*s),f=i===o?c:new E(c.x-(u.x-l.x)/6*s,c.y-(u.y-l.y)/6*s),y=c;this._segments.push(new AG({start:d,cp1:h,cp2:f,end:y}))}}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((n,r)=>n+r.length,0)),this._length}getVertices(){const n=this.segments.reduce((r,o)=>r.concat(o.vertices),[]);return n.push(this.points[this.points.length-1]),n}nearestPoint(n){let r,o=1/0;for(const s of this.segments){const i=s.nearestPoint(n),a=i.dist(n);a<o&&(r=i,o=a)}if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r,o){return this.segments.some(s=>s.hitTestLineSegment(n,r,o))}}class uR extends Ca{constructor(n){super({...n,isClosed:!0});S(this,"w");S(this,"h");S(this,"_edges");this.config=n;const{width:r,height:o}=n;this.w=r,this.h=o}get edges(){if(!this._edges){const{vertices:n}=this;this._edges=[];for(let r=0,o=n.length;r<o;r++){const s=n[r],i=n[(r+1)%o];this._edges.push(new Pg({start:s,end:i}))}}return this._edges}getVertices(){const n=Math.max(1,this.w),r=Math.max(1,this.h),o=n/2,s=r/2,i=Math.pow(o-s,2)/Math.pow(o+s,2),a=$e*(o+s)*(1+3*i/(10+Math.sqrt(4-3*i))),l=vb(a),c=Ue/l,u=Math.cos(c),d=Math.sin(c);let h=0,f=1,y=0,g=1;const m=Array(l);for(let v=0;v<l;v++)m[v]=new E(o+o*f,s+s*h),y=d*f+u*h,g=u*f-d*h,h=y,f=g;return m}nearestPoint(n){let r,o=1/0;for(const s of this.edges){const i=s.nearestPoint(n),a=i.dist(n);a<o&&(r=i,o=a)}if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r,o){return this.edges.some(s=>s.hitTestLineSegment(n,r,o))}getBounds(){return new le(0,0,this.w,this.h)}}class OG extends uR{constructor(t){super({...t}),this.config=t}getVertices(){const t=Math.max(1,this.w),n=Math.max(1,this.h),r=t/2,o=n/2,s=10,i=Array(s*2-2);if(n>t)for(let a=0;a<s-1;a++){const l=-$e+$e*a/(s-2),c=$e*a/(s-2);i[a]=new E(r+r*Math.cos(l),r+r*Math.sin(l)),i[a+(s-1)]=new E(r+r*Math.cos(c),n-r+r*Math.sin(c))}else for(let a=0;a<s-1;a++){const l=-Ze+$e*a/(s-2),c=Ze+$e*-a/(s-2);i[a]=new E(t-o+o*Math.cos(l),n-o+o*Math.sin(l)),i[a+(s-1)]=new E(o-o*Math.cos(c),n-o+o*Math.sin(c))}return i}}function Zk(e,t){return e<0?1:e>t?-1:e<za?(za-e)/za:e>t-za?-(za-t+e)/za:0}function Sb(e){if(!e.inputs.isDragging||e.inputs.isPanning)return;const{inputs:{currentScreenPoint:{x:t,y:n}}}=e,r=e.getZoomLevel(),o=e.getViewportScreenBounds(),s=o.w<1e3?.612:1,i=o.h<1e3?.612:1,a=Zk(t-o.x,o.w),l=Zk(n-o.y,o.h);if(a===0&&l===0)return;const c=e.user.getEdgeScrollSpeed()*ZB,u=c*a*s/r,d=c*l*i/r,h=e.getCamera();e.setCamera({x:h.x+u,y:h.y+d})}async function jG({shouldReload:e=!0}={}){sessionStorage.clear(),await Promise.all(yb().map(t=>qW(t))),localStorage.clear(),e&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=jG);function DG(e,t="_blank"){sb.openWindow(e,t)}var Qc=function(e){return e&&e.Math===Math&&e},An=Qc(typeof globalThis=="object"&&globalThis)||Qc(typeof window=="object"&&window)||Qc(typeof self=="object"&&self)||Qc(typeof Kt=="object"&&Kt)||Qc(typeof Kt=="object"&&Kt)||function(){return this}()||Function("return this")(),xb={},Rn=function(e){try{return!!e()}catch{return!0}},NG=Rn,Ti=!NG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),$G=Rn,_m=!$G(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),LG=_m,Zh=Function.prototype.call,Cs=LG?Zh.bind(Zh):function(){return Zh.apply(Zh,arguments)},dR={},hR={}.propertyIsEnumerable,pR=Object.getOwnPropertyDescriptor,FG=pR&&!hR.call({1:2},1);dR.f=FG?function(t){var n=pR(this,t);return!!n&&n.enumerable}:hR;var fR=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},gR=_m,mR=Function.prototype,WS=mR.call,zG=gR&&mR.bind.bind(WS,WS),Dt=gR?zG:function(e){return function(){return WS.apply(e,arguments)}},yR=Dt,BG=yR({}.toString),UG=yR("".slice),bc=function(e){return UG(BG(e),8,-1)},HG=Dt,VG=Rn,KG=bc,sv=Object,WG=HG("".split),GG=VG(function(){return!sv("z").propertyIsEnumerable(0)})?function(e){return KG(e)==="String"?WG(e,""):sv(e)}:sv,Tm=function(e){return e==null},YG=Tm,XG=TypeError,Cc=function(e){if(YG(e))throw new XG("Can't call method on "+e);return e},qG=GG,QG=Cc,Mm=function(e){return qG(QG(e))},iv=typeof document=="object"&&document.all,On=typeof iv>"u"&&iv!==void 0?function(e){return typeof e=="function"||e===iv}:function(e){return typeof e=="function"},ZG=On,Ea=function(e){return typeof e=="object"?e!==null:ZG(e)},av=An,JG=On,eY=function(e){return JG(e)?e:void 0},Am=function(e,t){return arguments.length<2?eY(av[e]):av[e]&&av[e][t]},tY=Dt,vR=tY({}.isPrototypeOf),nY=An,Jk=nY.navigator,eE=Jk&&Jk.userAgent,rY=eE?String(eE):"",SR=An,lv=rY,tE=SR.process,nE=SR.Deno,rE=tE&&tE.versions||nE&&nE.version,oE=rE&&rE.v8,qr,_g;oE&&(qr=oE.split("."),_g=qr[0]>0&&qr[0]<4?1:+(qr[0]+qr[1]));!_g&&lv&&(qr=lv.match(/Edge\/(\d+)/),(!qr||qr[1]>=74)&&(qr=lv.match(/Chrome\/(\d+)/),qr&&(_g=+qr[1])));var oY=_g,sE=oY,sY=Rn,iY=An,aY=iY.String,xR=!!Object.getOwnPropertySymbols&&!sY(function(){var e=Symbol("symbol detection");return!aY(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&sE&&sE<41}),lY=xR,wR=lY&&!Symbol.sham&&typeof Symbol.iterator=="symbol",cY=Am,uY=On,dY=vR,hY=wR,pY=Object,bR=hY?function(e){return typeof e=="symbol"}:function(e){var t=cY("Symbol");return uY(t)&&dY(t.prototype,pY(e))},fY=String,gY=function(e){try{return fY(e)}catch{return"Object"}},mY=On,yY=gY,vY=TypeError,wb=function(e){if(mY(e))return e;throw new vY(yY(e)+" is not a function")},SY=wb,xY=Tm,bb=function(e,t){var n=e[t];return xY(n)?void 0:SY(n)},cv=Cs,uv=On,dv=Ea,wY=TypeError,bY=function(e,t){var n,r;if(t==="string"&&uv(n=e.toString)&&!dv(r=cv(n,e))||uv(n=e.valueOf)&&!dv(r=cv(n,e))||t!=="string"&&uv(n=e.toString)&&!dv(r=cv(n,e)))return r;throw new wY("Can't convert object to primitive value")},CR={exports:{}},iE=An,CY=Object.defineProperty,Cb=function(e,t){try{CY(iE,e,{value:t,configurable:!0,writable:!0})}catch{iE[e]=t}return t},PY=An,kY=Cb,aE="__core-js_shared__",lE=CR.exports=PY[aE]||kY(aE,{});(lE.versions||(lE.versions=[])).push({version:"3.41.0",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Pb=CR.exports,cE=Pb,kb=function(e,t){return cE[e]||(cE[e]=t||{})},EY=Cc,IY=Object,Hd=function(e){return IY(EY(e))},_Y=Dt,TY=Hd,MY=_Y({}.hasOwnProperty),Mi=Object.hasOwn||function(t,n){return MY(TY(t),n)},AY=Dt,RY=0,OY=Math.random(),jY=AY(1 .toString),PR=function(e){return"Symbol("+(e===void 0?"":e)+")_"+jY(++RY+OY,36)},DY=An,NY=kb,uE=Mi,$Y=PR,LY=xR,FY=wR,gl=DY.Symbol,hv=NY("wks"),zY=FY?gl.for||gl:gl&&gl.withoutSetter||$Y,Ps=function(e){return uE(hv,e)||(hv[e]=LY&&uE(gl,e)?gl[e]:zY("Symbol."+e)),hv[e]},BY=Cs,dE=Ea,hE=bR,UY=bb,HY=bY,VY=Ps,KY=TypeError,WY=VY("toPrimitive"),GY=function(e,t){if(!dE(e)||hE(e))return e;var n=UY(e,WY),r;if(n){if(t===void 0&&(t="default"),r=BY(n,e,t),!dE(r)||hE(r))return r;throw new KY("Can't convert object to primitive value")}return t===void 0&&(t="number"),HY(e,t)},YY=GY,XY=bR,kR=function(e){var t=YY(e,"string");return XY(t)?t:t+""},qY=An,pE=Ea,GS=qY.document,QY=pE(GS)&&pE(GS.createElement),ER=function(e){return QY?GS.createElement(e):{}},ZY=Ti,JY=Rn,eX=ER,IR=!ZY&&!JY(function(){return Object.defineProperty(eX("div"),"a",{get:function(){return 7}}).a!==7}),tX=Ti,nX=Cs,rX=dR,oX=fR,sX=Mm,iX=kR,aX=Mi,lX=IR,fE=Object.getOwnPropertyDescriptor;xb.f=tX?fE:function(t,n){if(t=sX(t),n=iX(n),lX)try{return fE(t,n)}catch{}if(aX(t,n))return oX(!nX(rX.f,t,n),t[n])};var Pc={},cX=Ti,uX=Rn,_R=cX&&uX(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),dX=Ea,hX=String,pX=TypeError,Ia=function(e){if(dX(e))return e;throw new pX(hX(e)+" is not an object")},fX=Ti,gX=IR,mX=_R,Jh=Ia,gE=kR,yX=TypeError,pv=Object.defineProperty,vX=Object.getOwnPropertyDescriptor,fv="enumerable",gv="configurable",mv="writable";Pc.f=fX?mX?function(t,n,r){if(Jh(t),n=gE(n),Jh(r),typeof t=="function"&&n==="prototype"&&"value"in r&&mv in r&&!r[mv]){var o=vX(t,n);o&&o[mv]&&(t[n]=r.value,r={configurable:gv in r?r[gv]:o[gv],enumerable:fv in r?r[fv]:o[fv],writable:!1})}return pv(t,n,r)}:pv:function(t,n,r){if(Jh(t),n=gE(n),Jh(r),gX)try{return pv(t,n,r)}catch{}if("get"in r||"set"in r)throw new yX("Accessors not supported");return"value"in r&&(t[n]=r.value),t};var SX=Ti,xX=Pc,wX=fR,Eb=SX?function(e,t,n){return xX.f(e,t,wX(1,n))}:function(e,t,n){return e[t]=n,e},TR={exports:{}},YS=Ti,bX=Mi,MR=Function.prototype,CX=YS&&Object.getOwnPropertyDescriptor,Ib=bX(MR,"name"),PX=Ib&&(function(){}).name==="something",kX=Ib&&(!YS||YS&&CX(MR,"name").configurable),EX={EXISTS:Ib,PROPER:PX,CONFIGURABLE:kX},IX=Dt,_X=On,XS=Pb,TX=IX(Function.toString);_X(XS.inspectSource)||(XS.inspectSource=function(e){return TX(e)});var AR=XS.inspectSource,MX=An,AX=On,mE=MX.WeakMap,RX=AX(mE)&&/native code/.test(String(mE)),OX=kb,jX=PR,yE=OX("keys"),RR=function(e){return yE[e]||(yE[e]=jX(e))},_b={},DX=RX,OR=An,NX=Ea,$X=Eb,yv=Mi,vv=Pb,LX=RR,FX=_b,vE="Object already initialized",qS=OR.TypeError,zX=OR.WeakMap,Tg,pd,Mg,BX=function(e){return Mg(e)?pd(e):Tg(e,{})},UX=function(e){return function(t){var n;if(!NX(t)||(n=pd(t)).type!==e)throw new qS("Incompatible receiver, "+e+" required");return n}};if(DX||vv.state){var fo=vv.state||(vv.state=new zX);fo.get=fo.get,fo.has=fo.has,fo.set=fo.set,Tg=function(e,t){if(fo.has(e))throw new qS(vE);return t.facade=e,fo.set(e,t),t},pd=function(e){return fo.get(e)||{}},Mg=function(e){return fo.has(e)}}else{var Ka=LX("state");FX[Ka]=!0,Tg=function(e,t){if(yv(e,Ka))throw new qS(vE);return t.facade=e,$X(e,Ka,t),t},pd=function(e){return yv(e,Ka)?e[Ka]:{}},Mg=function(e){return yv(e,Ka)}}var jR={set:Tg,get:pd,has:Mg,enforce:BX,getterFor:UX},Tb=Dt,HX=Rn,VX=On,ep=Mi,QS=Ti,KX=EX.CONFIGURABLE,WX=AR,DR=jR,GX=DR.enforce,YX=DR.get,SE=String,Vp=Object.defineProperty,XX=Tb("".slice),qX=Tb("".replace),QX=Tb([].join),ZX=QS&&!HX(function(){return Vp(function(){},"length",{value:8}).length!==8}),JX=String(String).split("String"),eq=TR.exports=function(e,t,n){XX(SE(t),0,7)==="Symbol("&&(t="["+qX(SE(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!ep(e,"name")||KX&&e.name!==t)&&(QS?Vp(e,"name",{value:t,configurable:!0}):e.name=t),ZX&&n&&ep(n,"arity")&&e.length!==n.arity&&Vp(e,"length",{value:n.arity});try{n&&ep(n,"constructor")&&n.constructor?QS&&Vp(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var r=GX(e);return ep(r,"source")||(r.source=QX(JX,typeof t=="string"?t:"")),e};Function.prototype.toString=eq(function(){return VX(this)&&YX(this).source||WX(this)},"toString");var tq=TR.exports,nq=On,rq=Pc,oq=tq,sq=Cb,NR=function(e,t,n,r){r||(r={});var o=r.enumerable,s=r.name!==void 0?r.name:t;if(nq(n)&&oq(n,s,r),r.global)o?e[t]=n:sq(t,n);else{try{r.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=n:rq.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},$R={},iq=Math.ceil,aq=Math.floor,lq=Math.trunc||function(t){var n=+t;return(n>0?aq:iq)(n)},cq=lq,_a=function(e){var t=+e;return t!==t||t===0?0:cq(t)},uq=_a,dq=Math.max,hq=Math.min,pq=function(e,t){var n=uq(e);return n<0?dq(n+t,0):hq(n,t)},fq=_a,gq=Math.min,LR=function(e){var t=fq(e);return t>0?gq(t,9007199254740991):0},mq=LR,Vd=function(e){return mq(e.length)},yq=Mm,vq=pq,Sq=Vd,xE=function(e){return function(t,n,r){var o=yq(t),s=Sq(o);if(s===0)return!e&&-1;var i=vq(r,s),a;if(e&&n!==n){for(;s>i;)if(a=o[i++],a!==a)return!0}else for(;s>i;i++)if((e||i in o)&&o[i]===n)return e||i||0;return!e&&-1}},xq={includes:xE(!0),indexOf:xE(!1)},wq=Dt,Sv=Mi,bq=Mm,Cq=xq.indexOf,Pq=_b,wE=wq([].push),FR=function(e,t){var n=bq(e),r=0,o=[],s;for(s in n)!Sv(Pq,s)&&Sv(n,s)&&wE(o,s);for(;t.length>r;)Sv(n,s=t[r++])&&(~Cq(o,s)||wE(o,s));return o},Mb=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],kq=FR,Eq=Mb,Iq=Eq.concat("length","prototype");$R.f=Object.getOwnPropertyNames||function(t){return kq(t,Iq)};var zR={};zR.f=Object.getOwnPropertySymbols;var _q=Am,Tq=Dt,Mq=$R,Aq=zR,Rq=Ia,Oq=Tq([].concat),jq=_q("Reflect","ownKeys")||function(t){var n=Mq.f(Rq(t)),r=Aq.f;return r?Oq(n,r(t)):n},bE=Mi,Dq=jq,Nq=xb,$q=Pc,Lq=function(e,t,n){for(var r=Dq(t),o=$q.f,s=Nq.f,i=0;i<r.length;i++){var a=r[i];!bE(e,a)&&!(n&&bE(n,a))&&o(e,a,s(t,a))}},Fq=Rn,zq=On,Bq=/#|\.prototype\./,Kd=function(e,t){var n=Hq[Uq(e)];return n===Kq?!0:n===Vq?!1:zq(t)?Fq(t):!!t},Uq=Kd.normalize=function(e){return String(e).replace(Bq,".").toLowerCase()},Hq=Kd.data={},Vq=Kd.NATIVE="N",Kq=Kd.POLYFILL="P",Wq=Kd,tp=An,Gq=xb.f,Yq=Eb,Xq=NR,qq=Cb,Qq=Lq,Zq=Wq,kc=function(e,t){var n=e.target,r=e.global,o=e.stat,s,i,a,l,c,u;if(r?i=tp:o?i=tp[n]||qq(n,{}):i=tp[n]&&tp[n].prototype,i)for(a in t){if(c=t[a],e.dontCallGetSet?(u=Gq(i,a),l=u&&u.value):l=i[a],s=Zq(r?a:n+(o?".":"#")+a,e.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;Qq(c,l)}(e.sham||l&&l.sham)&&Yq(c,"sham",!0),Xq(i,a,c,e)}},BR={},Jq=FR,eQ=Mb,tQ=Object.keys||function(t){return Jq(t,eQ)},nQ=Ti,rQ=_R,oQ=Pc,sQ=Ia,iQ=Mm,aQ=tQ;BR.f=nQ&&!rQ?Object.defineProperties:function(t,n){sQ(t);for(var r=iQ(n),o=aQ(n),s=o.length,i=0,a;s>i;)oQ.f(t,a=o[i++],r[a]);return t};var lQ=Am,cQ=lQ("document","documentElement"),uQ=Ia,dQ=BR,CE=Mb,hQ=_b,pQ=cQ,fQ=ER,gQ=RR,PE=">",kE="<",ZS="prototype",JS="script",UR=gQ("IE_PROTO"),xv=function(){},HR=function(e){return kE+JS+PE+e+kE+"/"+JS+PE},EE=function(e){e.write(HR("")),e.close();var t=e.parentWindow.Object;return e=null,t},mQ=function(){var e=fQ("iframe"),t="java"+JS+":",n;return e.style.display="none",pQ.appendChild(e),e.src=String(t),n=e.contentWindow.document,n.open(),n.write(HR("document.F=Object")),n.close(),n.F},np,Kp=function(){try{np=new ActiveXObject("htmlfile")}catch{}Kp=typeof document<"u"?document.domain&&np?EE(np):mQ():EE(np);for(var e=CE.length;e--;)delete Kp[ZS][CE[e]];return Kp()};hQ[UR]=!0;var VR=Object.create||function(t,n){var r;return t!==null?(xv[ZS]=uQ(t),r=new xv,xv[ZS]=null,r[UR]=t):r=Kp(),n===void 0?r:dQ.f(r,n)},yQ=Ps,vQ=VR,SQ=Pc.f,ex=yQ("unscopables"),tx=Array.prototype;tx[ex]===void 0&&SQ(tx,ex,{configurable:!0,value:vQ(null)});var Ab=function(e){tx[ex][e]=!0},xQ=kc,wQ=Hd,bQ=Vd,CQ=_a,PQ=Ab;xQ({target:"Array",proto:!0},{at:function(t){var n=wQ(this),r=bQ(n),o=CQ(t),s=o>=0?o:r+o;return s<0||s>=r?void 0:n[s]}});PQ("at");var kQ=An,EQ=Dt,Wd=function(e,t){return EQ(kQ[e].prototype[t])},IQ=Wd;IQ("Array","at");var _Q=bc,KR=Array.isArray||function(t){return _Q(t)==="Array"},TQ=TypeError,MQ=9007199254740991,AQ=function(e){if(e>MQ)throw TQ("Maximum allowed index exceeded");return e},RQ=bc,OQ=Dt,jQ=function(e){if(RQ(e)==="Function")return OQ(e)},IE=jQ,DQ=wb,NQ=_m,$Q=IE(IE.bind),LQ=function(e,t){return DQ(e),t===void 0?e:NQ?$Q(e,t):function(){return e.apply(t,arguments)}},FQ=KR,zQ=Vd,BQ=AQ,UQ=LQ,WR=function(e,t,n,r,o,s,i,a){for(var l=o,c=0,u=i?UQ(i,a):!1,d,h;c<r;)c in n&&(d=u?u(n[c],c,t):n[c],s>0&&FQ(d)?(h=zQ(d),l=WR(e,t,d,h,l,s-1)-1):(BQ(l+1),e[l]=d),l++),c++;return l},GR=WR,HQ=Ps,VQ=HQ("toStringTag"),YR={};YR[VQ]="z";var KQ=String(YR)==="[object z]",WQ=KQ,GQ=On,Wp=bc,YQ=Ps,XQ=YQ("toStringTag"),qQ=Object,QQ=Wp(function(){return arguments}())==="Arguments",ZQ=function(e,t){try{return e[t]}catch{}},XR=WQ?Wp:function(e){var t,n,r;return e===void 0?"Undefined":e===null?"Null":typeof(n=ZQ(t=qQ(e),XQ))=="string"?n:QQ?Wp(t):(r=Wp(t))==="Object"&&GQ(t.callee)?"Arguments":r},JQ=Dt,eZ=Rn,qR=On,tZ=XR,nZ=Am,rZ=AR,QR=function(){},ZR=nZ("Reflect","construct"),Rb=/^\s*(?:class|function)\b/,oZ=JQ(Rb.exec),sZ=!Rb.test(QR),Zc=function(t){if(!qR(t))return!1;try{return ZR(QR,[],t),!0}catch{return!1}},JR=function(t){if(!qR(t))return!1;switch(tZ(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return sZ||!!oZ(Rb,rZ(t))}catch{return!0}};JR.sham=!0;var iZ=!ZR||eZ(function(){var e;return Zc(Zc.call)||!Zc(Object)||!Zc(function(){e=!0})||e})?JR:Zc,_E=KR,aZ=iZ,lZ=Ea,cZ=Ps,uZ=cZ("species"),TE=Array,dZ=function(e){var t;return _E(e)&&(t=e.constructor,aZ(t)&&(t===TE||_E(t.prototype))?t=void 0:lZ(t)&&(t=t[uZ],t===null&&(t=void 0))),t===void 0?TE:t},hZ=dZ,eO=function(e,t){return new(hZ(e))(t===0?0:t)},pZ=kc,fZ=GR,gZ=Hd,mZ=Vd,yZ=_a,vZ=eO;pZ({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,n=gZ(this),r=mZ(n),o=vZ(n,0);return o.length=fZ(o,n,n,r,0,t===void 0?1:yZ(t)),o}});var SZ=Ab;SZ("flat");var xZ=Wd;xZ("Array","flat");var wZ=kc,bZ=GR,CZ=wb,PZ=Hd,kZ=Vd,EZ=eO;wZ({target:"Array",proto:!0},{flatMap:function(t){var n=PZ(this),r=kZ(n),o;return CZ(t),o=EZ(n,0),o.length=bZ(o,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),o}});var IZ=Ab;IZ("flatMap");var _Z=Wd;_Z("Array","flatMap");var TZ=XR,MZ=String,Gd=function(e){if(TZ(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return MZ(e)},AZ=kc,RZ=Dt,OZ=Cc,jZ=_a,DZ=Gd,NZ=Rn,$Z=RZ("".charAt),LZ=NZ(function(){return"".at(-2)!=="\uD842"});AZ({target:"String",proto:!0,forced:LZ},{at:function(t){var n=DZ(OZ(this)),r=n.length,o=jZ(t),s=o>=0?o:r+o;return s<0||s>=r?void 0:$Z(n,s)}});var FZ=Wd;FZ("String","at");var zZ=Ia,tO=function(){var e=zZ(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Ob=Rn,BZ=An,jb=BZ.RegExp,Db=Ob(function(){var e=jb("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),UZ=Db||Ob(function(){return!jb("a","y").sticky}),HZ=Db||Ob(function(){var e=jb("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),VZ={BROKEN_CARET:HZ,MISSED_STICKY:UZ,UNSUPPORTED_Y:Db},KZ=Rn,WZ=An,GZ=WZ.RegExp,YZ=KZ(function(){var e=GZ(".","s");return!(e.dotAll&&e.test(`
`)&&e.flags==="s")}),XZ=Rn,qZ=An,QZ=qZ.RegExp,ZZ=XZ(function(){var e=QZ("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ml=Cs,Rm=Dt,JZ=Gd,eJ=tO,tJ=VZ,nJ=kb,rJ=VR,oJ=jR.get,sJ=YZ,iJ=ZZ,aJ=nJ("native-string-replace",String.prototype.replace),Ag=RegExp.prototype.exec,nx=Ag,lJ=Rm("".charAt),cJ=Rm("".indexOf),uJ=Rm("".replace),wv=Rm("".slice),rx=function(){var e=/a/,t=/b*/g;return ml(Ag,e,"a"),ml(Ag,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),nO=tJ.BROKEN_CARET,ox=/()??/.exec("")[1]!==void 0,dJ=rx||ox||nO||sJ||iJ;dJ&&(nx=function(t){var n=this,r=oJ(n),o=JZ(t),s=r.raw,i,a,l,c,u,d,h;if(s)return s.lastIndex=n.lastIndex,i=ml(nx,s,o),n.lastIndex=s.lastIndex,i;var f=r.groups,y=nO&&n.sticky,g=ml(eJ,n),m=n.source,v=0,x=o;if(y&&(g=uJ(g,"y",""),cJ(g,"g")===-1&&(g+="g"),x=wv(o,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&lJ(o,n.lastIndex-1)!==`
`)&&(m="(?: "+m+")",x=" "+x,v++),a=new RegExp("^(?:"+m+")",g)),ox&&(a=new RegExp("^"+m+"$(?!\\s)",g)),rx&&(l=n.lastIndex),c=ml(Ag,y?a:n,x),y?c?(c.input=wv(c.input,v),c[0]=wv(c[0],v),c.index=n.lastIndex,n.lastIndex+=c[0].length):n.lastIndex=0:rx&&c&&(n.lastIndex=n.global?c.index+c[0].length:l),ox&&c&&c.length>1&&ml(aJ,c[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&f)for(c.groups=d=rJ(null),u=0;u<f.length;u++)h=f[u],d[h[0]]=c[h[1]];return c});var Nb=nx,hJ=kc,ME=Nb;hJ({target:"RegExp",proto:!0,forced:/./.exec!==ME},{exec:ME});var pJ=_m,rO=Function.prototype,AE=rO.apply,RE=rO.call,fJ=typeof Reflect=="object"&&Reflect.apply||(pJ?RE.bind(AE):function(){return RE.apply(AE,arguments)}),OE=Cs,jE=NR,gJ=Nb,DE=Rn,oO=Ps,mJ=Eb,yJ=oO("species"),bv=RegExp.prototype,vJ=function(e,t,n,r){var o=oO(e),s=!DE(function(){var c={};return c[o]=function(){return 7},""[e](c)!==7}),i=s&&!DE(function(){var c=!1,u=/a/;return e==="split"&&(u={},u.constructor={},u.constructor[yJ]=function(){return u},u.flags="",u[o]=/./[o]),u.exec=function(){return c=!0,null},u[o](""),!c});if(!s||!i||n){var a=/./[o],l=t(o,""[e],function(c,u,d,h,f){var y=u.exec;return y===gJ||y===bv.exec?s&&!f?{done:!0,value:OE(a,u,d,h)}:{done:!0,value:OE(c,d,u,h)}:{done:!1}});jE(String.prototype,e,l[0]),jE(bv,o,l[1])}r&&mJ(bv[o],"sham",!0)},$b=Dt,SJ=_a,xJ=Gd,wJ=Cc,bJ=$b("".charAt),NE=$b("".charCodeAt),CJ=$b("".slice),$E=function(e){return function(t,n){var r=xJ(wJ(t)),o=SJ(n),s=r.length,i,a;return o<0||o>=s?e?"":void 0:(i=NE(r,o),i<55296||i>56319||o+1===s||(a=NE(r,o+1))<56320||a>57343?e?bJ(r,o):i:e?CJ(r,o,o+2):(i-55296<<10)+(a-56320)+65536)}},PJ={codeAt:$E(!1),charAt:$E(!0)},kJ=PJ.charAt,EJ=function(e,t,n){return t+(n?kJ(e,t).length:1)},Lb=Dt,IJ=Hd,_J=Math.floor,Cv=Lb("".charAt),TJ=Lb("".replace),Pv=Lb("".slice),MJ=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,AJ=/\$([$&'`]|\d{1,2})/g,sO=function(e,t,n,r,o,s){var i=n+e.length,a=r.length,l=AJ;return o!==void 0&&(o=IJ(o),l=MJ),TJ(s,l,function(c,u){var d;switch(Cv(u,0)){case"$":return"$";case"&":return e;case"`":return Pv(t,0,n);case"'":return Pv(t,i);case"<":d=o[Pv(u,1,-1)];break;default:var h=+u;if(h===0)return c;if(h>a){var f=_J(h/10);return f===0?c:f<=a?r[f-1]===void 0?Cv(u,1):r[f-1]+Cv(u,1):c}d=r[h-1]}return d===void 0?"":d})},LE=Cs,RJ=Ia,OJ=On,jJ=bc,DJ=Nb,NJ=TypeError,$J=function(e,t){var n=e.exec;if(OJ(n)){var r=LE(n,e,t);return r!==null&&RJ(r),r}if(jJ(e)==="RegExp")return LE(DJ,e,t);throw new NJ("RegExp#exec called on incompatible receiver")},LJ=fJ,FE=Cs,Om=Dt,FJ=vJ,zJ=Rn,BJ=Ia,UJ=On,HJ=Tm,VJ=_a,KJ=LR,Wa=Gd,WJ=Cc,GJ=EJ,YJ=bb,XJ=sO,qJ=$J,QJ=Ps,sx=QJ("replace"),ZJ=Math.max,JJ=Math.min,eee=Om([].concat),kv=Om([].push),zE=Om("".indexOf),BE=Om("".slice),tee=function(e){return e===void 0?e:String(e)},nee=function(){return"a".replace(/./,"$0")==="$0"}(),UE=function(){return/./[sx]?/./[sx]("a","$0")==="":!1}(),ree=!zJ(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});FJ("replace",function(e,t,n){var r=UE?"$":"$0";return[function(s,i){var a=WJ(this),l=HJ(s)?void 0:YJ(s,sx);return l?FE(l,s,a,i):FE(t,Wa(a),s,i)},function(o,s){var i=BJ(this),a=Wa(o);if(typeof s=="string"&&zE(s,r)===-1&&zE(s,"$<")===-1){var l=n(t,i,a,s);if(l.done)return l.value}var c=UJ(s);c||(s=Wa(s));var u=i.global,d;u&&(d=i.unicode,i.lastIndex=0);for(var h=[],f;f=qJ(i,a),!(f===null||(kv(h,f),!u));){var y=Wa(f[0]);y===""&&(i.lastIndex=GJ(a,KJ(i.lastIndex),d))}for(var g="",m=0,v=0;v<h.length;v++){f=h[v];for(var x=Wa(f[0]),w=ZJ(JJ(VJ(f.index),a.length),0),C=[],P,k=1;k<f.length;k++)kv(C,tee(f[k]));var I=f.groups;if(c){var _=eee([x],C,w,a);I!==void 0&&kv(_,I),P=Wa(LJ(s,void 0,_))}else P=XJ(x,a,w,C,I,s);w>=m&&(g+=BE(a,m,w)+P,m=w+x.length)}return g+BE(a,m)}]},!ree||!nee||UE);var oee=Ea,see=bc,iee=Ps,aee=iee("match"),lee=function(e){var t;return oee(e)&&((t=e[aee])!==void 0?!!t:see(e)==="RegExp")},cee=Cs,uee=Mi,dee=vR,hee=tO,HE=RegExp.prototype,pee=function(e){var t=e.flags;return t===void 0&&!("flags"in HE)&&!uee(e,"flags")&&dee(HE,e)?cee(hee,e):t},fee=kc,gee=Cs,Fb=Dt,VE=Cc,mee=On,yee=Tm,vee=lee,Jc=Gd,See=bb,xee=pee,wee=sO,bee=Ps,Cee=bee("replace"),Pee=TypeError,Ev=Fb("".indexOf);Fb("".replace);var KE=Fb("".slice),kee=Math.max;fee({target:"String",proto:!0},{replaceAll:function(t,n){var r=VE(this),o,s,i,a,l,c,u,d,h,f,y=0,g="";if(!yee(t)){if(o=vee(t),o&&(s=Jc(VE(xee(t))),!~Ev(s,"g")))throw new Pee("`.replaceAll` does not allow non-global regexes");if(i=See(t,Cee),i)return gee(i,t,r,n)}for(a=Jc(r),l=Jc(t),c=mee(n),c||(n=Jc(n)),u=l.length,d=kee(1,u),h=Ev(a,l);h!==-1;)f=c?Jc(n(l,h,a)):wee(l,a,h,[],void 0,n),g+=KE(a,y,h)+f,y=h+u,h=h+d>a.length?-1:Ev(a,l,h+d);return y<a.length&&(g+=KE(a,y)),g}});var Eee=Wd;Eee("String","replaceAll");const Iee=({children:e})=>{const t=W();return q("shouldDisplayHandles",()=>t.isInAny("select.idle","select.pointing_handle"),[t])?p.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:e}):null},_ee=({shapeId:e})=>{const t=W();return q("show hovered",()=>t.isIn("select.editing_shape")?t.getHoveredShapeId()!==t.getEditingShapeId():t.isInAny("select.idle"),[t])?p.jsx(Ld,{className:"tl-user-indicator__hovered",id:e}):null},{PI:Tee}=Math,Ol=Tee+1e-4;function iO(e,t={}){const{size:n=16,smoothing:r=.5}=t;if(e.length===0||n<=0)return{left:[],right:[]};const o=e[0],s=e[e.length-1],i=s.runningLength,a=Math.pow(n*r,2),l=[],c=[];let u=e[0].vector,d=e[0].point,h=d,f=d,y=h,g=!1,m;for(let v=0;v<e.length;v++){m=e[v];const{point:x,vector:w}=e[v],C=m.vector.dpr(u),P=(v<e.length-1?e[v+1]:e[v]).vector,k=v<e.length-1?P.dpr(m.vector):1,I=C<0&&!g,_=k!==null&&k<.2;if(I||_){if(k>-.62&&i-m.runningLength>m.radius){const T=u.clone().mul(m.radius);u.clone().cpr(P)<0?(f=E.Add(x,T),y=E.Sub(x,T)):(f=E.Sub(x,T),y=E.Add(x,T)),l.push(f),c.push(y)}else{const T=u.clone().mul(m.radius).per(),R=E.Sub(m.input,T);for(let j=1/13,$=0;$<1;$+=j)f=E.RotWith(R,m.input,Ol*$),l.push(f),y=E.RotWith(R,m.input,Ol+Ol*-$),c.push(y)}d=f,h=y,_&&(g=!0);continue}if(g=!1,m===o||m===s){const T=E.Per(w).mul(m.radius);l.push(E.Sub(x,T)),c.push(E.Add(x,T));continue}const M=E.Lrp(P,w,k).per().mul(m.radius);f=E.Sub(x,M),(v<=1||E.Dist2(d,f)>a)&&(l.push(f),d=f),y=E.Add(x,M),(v<=1||E.Dist2(h,y)>a)&&(c.push(y),h=y),u=w}return{left:l,right:c}}function Yd(e,t={}){const{size:n=16,start:r={},end:o={},last:s=!1}=t,{cap:i=!0}=r,{cap:a=!0}=o;if(e.length===0||n<=0)return[];const l=e[0],c=e[e.length-1],u=c.runningLength,d=r.taper===!1?0:r.taper===!0?Math.max(n,u):r.taper,h=o.taper===!1?0:o.taper===!0?Math.max(n,u):o.taper,{left:f,right:y}=iO(e,t),g=l.point,m=e.length>1?e[e.length-1].point:E.AddXY(l.point,1,1);if(e.length===1&&(!(d||h)||s)){const C=E.Add(g,E.Sub(g,m).uni().per().mul(-l.radius)),P=[];for(let k=1/13,I=k;I<=1;I+=k)P.push(E.RotWith(C,g,Ol*2*I));return P}const v=[];if(!(d||h&&e.length===1))if(i)for(let C=1/8,P=C;P<=1;P+=C){const k=E.RotWith(y[0],g,Ol*P);v.push(k)}else{const C=E.Sub(f[0],y[0]),P=E.Mul(C,.5),k=E.Mul(C,.51);v.push(E.Sub(g,P),E.Sub(g,k),E.Add(g,k),E.Add(g,P))}const x=[],w=c.vector.clone().per().neg();if(h||d&&e.length===1)x.push(m);else if(a){const C=E.Add(m,E.Mul(w,c.radius));for(let P=1/29,k=P;k<1;k+=P)x.push(E.RotWith(C,m,Ol*3*k))}else x.push(E.Add(m,E.Mul(w,c.radius)),E.Add(m,E.Mul(w,c.radius*.99)),E.Sub(m,E.Mul(w,c.radius*.99)),E.Sub(m,E.Mul(w,c.radius)));return f.concat(x,y.reverse(),v)}const Mee=.025,Aee=.01;function Zr(e,t={}){var m;const{streamline:n=.5,size:r=16,simulatePressure:o=!1}=t;if(e.length===0)return[];const s=.15+(1-n)*.85;let i=e.map(E.From),a=0;if(!o){let v=i[0];for(;v&&!(v.z>=Mee);)i.shift(),v=i[0]}if(!o){let v=i[i.length-1];for(;v&&!(v.z>=Aee);)i.pop(),v=i[i.length-1]}if(i.length===0)return[{point:E.From(e[0]),input:E.From(e[0]),pressure:o?.5:.15,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let l=i[1];for(;l&&!(E.Dist(l,i[0])>r/3);)i[0].z=Math.max(i[0].z,l.z),i.splice(1,1),l=i[1];const c=i.pop();for(l=i[i.length-1];l&&!(E.Dist(l,c)>r/3);)i.pop(),l=i[i.length-1],a++;i.push(c);const u=t.last||!t.simulatePressure||i.length>1&&E.Dist(i[i.length-1],i[i.length-2])<r||a>0;if(i.length===2&&t.simulatePressure){const v=i[1];i=i.slice(0,-1);for(let x=1;x<5;x++){const w=E.Lrp(i[0],v,x/4);w.z=(i[0].z+(v.z-i[0].z))*x/4,i.push(w)}}const d=[{point:i[0],input:i[0],pressure:o?.5:i[0].z,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let h=0,f=d[0],y,g;u&&n>0&&i.push(i[i.length-1].clone());for(let v=1,x=i.length;v<x;v++)y=!s||t.last&&v===x-1?i[v].clone():i[v].clone().lrp(f.point,1-s),!f.point.equals(y)&&(g=E.Dist(y,f.point),h+=g,!(v<4&&h<r)&&(f={input:i[v],point:y,pressure:o?.5:i[v].z,vector:E.Sub(f.point,y).uni(),distance:g,runningLength:h,radius:1},d.push(f)));if((m=d[1])!=null&&m.vector&&(d[0].vector=d[1].vector.clone()),h<1){const v=Math.max(.5,...d.map(x=>x.pressure));d.forEach(x=>x.pressure=v)}return d}const{min:js}=Math,Iv=.275;function Ec(e,t){const{size:n=16,thinning:r=.5,simulatePressure:o=!0,easing:s=m=>m,start:i={},end:a={}}=t,{easing:l=dn.easeOutQuad}=i,{easing:c=dn.easeOutCubic}=a,u=e[e.length-1].runningLength;let d,h=e[0].pressure,f;if(!o&&u<n){const m=e.reduce((v,x)=>Math.max(v,x.pressure),.5);return e.forEach(v=>{v.pressure=m,v.radius=n*s(.5-r*(.5-v.pressure))}),e}else{let m;for(let v=0,x=e.length;v<x&&(f=e[v],!(f.runningLength>n*5));v++){const w=js(1,f.distance/n);if(o){const C=js(1,1-w);m=js(1,h+(C-h)*(w*Iv))}else m=js(1,h+(f.pressure-h)*.5);h=h+(m-h)*.5}for(let v=0;v<e.length;v++){if(f=e[v],r){let{pressure:x}=f;const w=js(1,f.distance/n);if(o){const C=js(1,1-w);x=js(1,h+(C-h)*(w*Iv))}else x=js(1,h+(x-h)*(w*Iv));f.radius=n*s(.5-r*(.5-x)),h=x}else f.radius=n/2;d===void 0&&(d=f.radius)}}const y=i.taper===!1?0:i.taper===!0?Math.max(n,u):i.taper,g=a.taper===!1?0:a.taper===!0?Math.max(n,u):a.taper;if(y||g)for(let m=0;m<e.length;m++){f=e[m];const{runningLength:v}=f,x=v<y?l(v/y):1,w=u-v<g?c((u-v)/g):1;f.radius=Math.max(.01,f.radius*Math.min(x,w))}return e}function Ree(e,t={}){return Yd(Ec(Zr(e,t),t),t)}const WE=({scribble:e,zoom:t,color:n,opacity:r,className:o})=>{if(!e.points.length)return null;const s=Ree(e.points,{size:e.size/t,start:{taper:e.taper,easing:dn.linear},last:e.state==="stopping",simulatePressure:!1,streamline:.32});let i;if(s.length<4){const a=e.size/t/2,{x:l,y:c}=e.points[e.points.length-1];i=`M ${l-a},${c} a ${a},${a} 0 1,0 ${a*2},0 a ${a},${a} 0 1,0 ${-a*2},0`}else i=Fd(s);return p.jsx("svg",{className:o&&fe("tl-overlays__item",o),children:p.jsx("path",{className:"tl-scribble",d:i,fill:n??`var(--color-${e.color})`,opacity:r??e.opacity})})},Oee=({bounds:e,rotation:t})=>{const n=W();return q("should display",()=>n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[n])?p.jsx(mA,{bounds:e,rotation:t}):null};function Dr(){const e=W();return q("isReadonlyMode",()=>e.getInstanceState().isReadonly,[e])}function jee({size:e,width:t,height:n,hideAlternateHandles:r}){const o=O(e/3),s=o/2;return p.jsxs("svg",{className:"tl-overlays__item",children:[p.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${O(0-s)},${O(e)} 
						${O(0-s)},${O(0-s)} 
						${O(e)},${O(0-s)}`,strokeWidth:o,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),p.jsx("line",{className:fe("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:O(t/2-e),y1:O(0-s),x2:O(t/2+e),y2:O(0-s),strokeWidth:o,"data-testid":"selection.crop.top","aria-label":"top handle"}),p.jsx("polyline",{className:fe("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${O(t-e)},${O(0-s)} 
						${O(t+s)},${O(0-s)} 
						${O(t+s)},${O(e)}`,strokeWidth:o,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),p.jsx("line",{className:fe("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:O(t+s),y1:O(n/2-e),x2:O(t+s),y2:O(n/2+e),strokeWidth:o,"data-testid":"selection.crop.right","aria-label":"right handle"}),p.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${O(t+s)},${O(n-e)} 
						${O(t+s)},${O(n+s)}
						${O(t-e)},${O(n+s)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),p.jsx("line",{className:fe("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:O(t/2-e),y1:O(n+s),x2:O(t/2+e),y2:O(n+s),strokeWidth:o,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),p.jsx("polyline",{className:fe("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${O(0+e)},${O(n+s)} 
						${O(0-s)},${O(n+s)}
						${O(0-s)},${O(n-e)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),p.jsx("line",{className:fe("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:O(0-s),y1:O(n/2-e),x2:O(0-s),y2:O(n/2+e),strokeWidth:o,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const Dee=Ve(function({bounds:t,rotation:n}){const r=W(),o=b.useRef(null),s=Dr(),i=mo("top"),a=mo("right"),l=mo("bottom"),c=mo("left"),u=mo("top_left"),d=mo("top_right"),h=mo("bottom_right"),f=mo("bottom_left"),y=!r.getIsMenuOpen()&&r.getInstanceState().cursor.type==="default",g=r.getInstanceState().isCoarsePointer,m=r.getOnlySelectedShape(),v=m&&r.isShapeOrAncestorLocked(m),x=m?r.getShapeUtil(m).expandSelectionOutlinePx(m):0;if(vc(o,t==null?void 0:t.x,t==null?void 0:t.y,1,r.getSelectionRotation(),{x:-x,y:-x}),!t)return null;t=t.clone().expandBy(x).zeroFix();const w=r.getZoomLevel(),C=r.getInstanceState().isChangingStyle,P=t.width,k=t.height,I=8/w,_=P<I*2,M=k<I*2,T=P<I*4,R=k<I*4,j=P<I*5,$=k<I*5,L=g?1.75:1,U=6/w*L,F=(T?U/2:U)*(L*.75),G=(R?U/2:U)*(L*.75),D=(m?!r.getShapeUtil(m).hideSelectionBoundsFg(m):!0)&&!C;let z=D&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||D&&r.isIn("select.resizing")&&m&&r.isShapeOfType(m,"text");m&&z&&r.environment.isFirefox&&r.isShapeOfType(m,"embed")&&(z=!1);const V=r.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!C&&!s,K=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!C&&!s,J=!g&&!(_||M)&&(K||V)&&(m?!r.getShapeUtil(m).hideRotateHandle(m):!0)&&!v,ne=g&&(!T||!R)&&(K||V)&&(m?!r.getShapeUtil(m).hideRotateHandle(m):!0)&&!v,me=K&&(m?r.getShapeUtil(m).canResize(m)&&!r.getShapeUtil(m).hideResizeHandles(m):!0)&&!V&&!v,te=_||M,de=_&&M,Te=j||$,Oe=me||V,Pe=!J,Fe=!K||!ne,je=!K||!Oe,$t=!K||!Oe||te,kt=!K||!Oe||te,Lt=!K||!Oe||de&&!V;let mt=g;mt&&m&&m.type==="text"&&(mt=!1);let et=!0;V?et=Te:me&&(et=te||de||mt);const $r=Math.min(24/w,k-G*3),Oi=K&&g&&m&&r.isShapeOfType(m,"text")&&$r*w>=4;return p.jsx("svg",{className:"tl-overlays__item tl-selection__fg tl-svg-context","data-testid":"selection-foreground",children:p.jsxs("g",{ref:o,children:[z&&p.jsx("rect",{className:fe("tl-selection__fg__outline"),width:O(P),height:O(k)}),p.jsx(rp,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:U,corner:"top_left_rotate",cursor:y?qn("nwse-rotate",n):void 0,isHidden:Pe}),p.jsx(rp,{"data-testid":"selection.rotate.top-right",cx:P+U*3,cy:0,targetSize:U,corner:"top_right_rotate",cursor:y?qn("nesw-rotate",n):void 0,isHidden:Pe}),p.jsx(rp,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:k+U*3,targetSize:U,corner:"bottom_left_rotate",cursor:y?qn("swne-rotate",n):void 0,isHidden:Pe}),p.jsx(rp,{"data-testid":"selection.rotate.bottom-right",cx:P+U*3,cy:k+U*3,targetSize:U,corner:"bottom_right_rotate",cursor:y?qn("senw-rotate",n):void 0,isHidden:Pe}),p.jsx($ee,{"data-testid":"selection.rotate.mobile",cx:T?-U*1.5:P/2,cy:T?k/2:-U*1.5,size:I,isHidden:Fe}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":et}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:O(0-(R?G*2:G)),width:O(P),height:O(Math.max(1,G*2)),style:y?{cursor:qn("ns-resize",n)}:void 0,...i}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":et}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:O(P-(T?0:F)),y:0,height:O(k),width:O(Math.max(1,F*2)),style:y?{cursor:qn("ew-resize",n)}:void 0,...a}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":et}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:O(k-(R?0:G)),width:O(P),height:O(Math.max(1,G*2)),style:y?{cursor:qn("ns-resize",n)}:void 0,...l}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":et}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:O(0-(T?F*2:F)),y:0,height:O(k),width:O(Math.max(1,F*2)),style:y?{cursor:qn("ew-resize",n)}:void 0,...c}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":je}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:O(0-(T?F*2:F*1.5)),y:O(0-(R?G*2:G*1.5)),width:O(F*3),height:O(G*3),style:y?{cursor:qn("nwse-resize",n)}:void 0,...u}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":$t}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:O(P-(T?0:F*1.5)),y:O(0-(R?G*2:G*1.5)),width:O(F*3),height:O(G*3),style:y?{cursor:qn("nesw-resize",n)}:void 0,...d}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":Lt}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:O(P-(T?F:F*1.5)),y:O(k-(R?G:G*1.5)),width:O(F*3),height:O(G*3),style:y?{cursor:qn("nwse-resize",n)}:void 0,...h}),p.jsx("rect",{className:fe("tl-transparent",{"tl-hidden":kt}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:O(0-(T?F*3:F*1.5)),y:O(k-(R?0:G*1.5)),width:O(F*3),height:O(G*3),style:y?{cursor:qn("nesw-resize",n)}:void 0,...f}),me&&p.jsxs(p.Fragment,{children:[p.jsx("rect",{"data-testid":"selection.resize.top-left",className:fe("tl-corner-handle",{"tl-hidden":je}),"aria-label":"top_left handle",x:O(0-I/2),y:O(0-I/2),width:O(I),height:O(I)}),p.jsx("rect",{"data-testid":"selection.resize.top-right",className:fe("tl-corner-handle",{"tl-hidden":$t}),"aria-label":"top_right handle",x:O(P-I/2),y:O(0-I/2),width:O(I),height:O(I)}),p.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:fe("tl-corner-handle",{"tl-hidden":Lt}),"aria-label":"bottom_right handle",x:O(P-I/2),y:O(k-I/2),width:O(I),height:O(I)}),p.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:fe("tl-corner-handle",{"tl-hidden":kt}),"aria-label":"bottom_left handle",x:O(0-I/2),y:O(k-I/2),width:O(I),height:O(I)})]}),Oi&&p.jsxs(p.Fragment,{children:[p.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:O(0-I/4),y:O(k/2-$r/2),rx:I/4,width:O(I/2),height:O($r)}),p.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:I/4,x:O(P-I/4),y:O(k/2-$r/2),width:O(I/2),height:O($r)})]}),V&&p.jsx(jee,{size:I,width:P,height:k,hideAlternateHandles:Te})]})})}),rp=function({cx:t,cy:n,targetSize:r,corner:o,cursor:s,isHidden:i,"data-testid":a}){const l=mo(o);return p.jsx("rect",{className:fe("tl-transparent","tl-rotate-corner",{"tl-hidden":i}),"data-testid":a,"aria-label":`${o} target`,pointerEvents:"all",x:O(t-r*3),y:O(n-r*3),width:O(Math.max(1,r*3)),height:O(Math.max(1,r*3)),cursor:s,...l})},Nee=Math.sqrt(Math.PI),$ee=function({cx:t,cy:n,size:r,isHidden:o,"data-testid":s}){const i=mo("mobile_rotate"),a=W(),l=q("zoom level",()=>a.getZoomLevel(),[a]),c=Math.max(14*(1/l),20/Math.max(1,l));return p.jsxs("g",{children:[p.jsx("circle",{"data-testid":s,pointerEvents:"all",className:fe("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":o}),cx:t,cy:n,r:c,...i}),p.jsx("circle",{className:fe("tl-mobile-rotate__fg",{"tl-hidden":o}),cx:t,cy:n,r:r/Nee})]})},Gt={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},un={s:2,m:3.5,l:5,xl:10},Js={s:18,m:24,l:36,xl:44},rc={s:18,m:22,l:26,xl:32},Fs={s:18,m:20,l:24,xl:28},ls={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};var aO={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.downscale=n()})(Kt,function(){function t(_,v,x,w,C,P,k,I){var _=document.createElement("canvas");_.width=x,_.height=w;var M=_.getContext("2d");return M.mozImageSmoothingEnabled=!0,M.imageSmoothingQuality="high",M.webkitImageSmoothingEnabled=!0,M.msImageSmoothingEnabled=!0,M.imageSmoothingEnabled=!0,M.drawImage(v,C,P,k,I,0,0,x,w),_}function n(m){return m+.49<<0}function r(m,v,x,w,C,P,k){for(var I=new ImageData(v,x),_=new Int32Array(m.data.buffer),M=m.width,T=new Int32Array(I.data.buffer),R=I.width,j=v/P,$=x/k,L=n(1/j),U=n(1/$),F=L*U,G=0;G<I.height;G++)for(var D=0;D<R;D++){for(var z=w+n(D/j)+(C+n(G/$))*M,V=0,K=0,J=0,ne=0,me=0;me<U;me++)for(var te=0;te<L;te++){var de=_[z+te+me*M];V+=de<<24>>>24,K+=de<<16>>>24,J+=de<<8>>>24,ne+=de>>>24}V=n(V/F),K=n(K/F),J=n(J/F),ne=n(ne/F),T[D+G*R]=ne<<24|J<<16|K<<8|V}return I}function o(m,v,x,w){var C=new Date,P={},k=C,I="01";return{mark:m?function(_){_=I+". "+(_||"..."),P[_]={"time (ms)":new Date-k},k=new Date,I=("0"+((I>>0)+1)).substr(-2)}:new Function,finish:m?function(){P[I+" TOTAL"]={"time (ms)":new Date-C},console.log("IMAGE SOURCE:",v),console.log("DOWNSCALE TO:",x+"x"+w),console.table(P)}:new Function}}function s(){var m=[],v=[],x=[],w=new Object;return{createSetter:function(C){if(!this.get(C)){var P=m.push(C)-1;return v.push(w),x.push([]),function(k){v[P]=k,x[P]=x[P].reduce(function(I,_){_(k)},[])}}},get:function(C,P){var k=m.indexOf(C);if(~k){if(v[k]===w){x[k].push(P);return}P(v[k])}},has:function(C){return!!~m.indexOf(C)}}}function i(m,v,x,w){m.width=x,m.height=w;var C=m.getContext("2d");return C.drawImage(v,0,0),C.getImageData(0,0,x,w)}function a(m,v){m.width=v.width,m.height=v.height;var x=m.getContext("2d");return x.putImageData(v,0,0),m}function l(m,v,T,R,C,P){var k=C,I=P,_=C/P;m===0&&(m=v*_>>0),v===0&&(v=m/_>>0);var M=m/v;M>_?P=C/M>>0:C=P*M>>0;var T=T||(k-C)/2>>0,R=R||(I-P)/2>>0;return{destWidth:m,destHeight:v,sourceX:T,sourceY:R,sourceWidth:C,sourceHeight:P}}function c(m,v,x){if(v.returnCanvas){x(m);return}if(v.returnBlob){m.toBlob(x,"image/"+(v.imageType||"jpeg"),v.quality||.85);return}var w=m.toDataURL("image/"+(v.imageType||"jpeg"),v.quality||.85);x(w)}function u(m,v){var x=new XMLHttpRequest;x.open("GET",m),x.responseType="arraybuffer",x.addEventListener("load",function(){v(this.response)}),x.send()}function d(m,v){m.complete?v():m.addEventListener("load",v)}function h(m,v){m.readyState>1?v():m.addEventListener("loadeddata",v)}function f(m){if(m instanceof File)return"File";if(m instanceof HTMLImageElement)return"HTMLImageElement";if(m instanceof HTMLVideoElement)return"HTMLVideoElement";if(typeof m=="string")return"URL"}function y(m){if(m.length<3)return new TypeError("3 arguments required, but only "+m.length+" present.");if(!f(m[0]))return new TypeError("First argument should be HTMLImageElement, HTMLVideoElement, File of String");if(typeof m[1]!="number")return new TypeError("Second argument should be a number");if(typeof m[2]!="number")return new TypeError("Third argument should be a number")}function g(m,v,x,w){var C=o(w&&w.debug||!1,m,v,x),P=y(arguments);if(P instanceof TypeError)return Promise.reject(P);w=w||{};var k,I=new Promise(function($,L){k=$});g.canvas=g.canvas||document.createElement("canvas"),g.cache=g.cache||s();var _=g.canvas,M=g.cache;if(M.has(m))return C.mark(),M.get(m,function($){C.mark("PENDING CACHE");var L=$[0],U=$[1],F=l(v,x,w.sourceX,w.sourceY,U.width,U.height);if(F.sourceWidth/F.destWidth>=2&&F.sourceHeight/F.destHeight>=2){C.mark();var G=r(U,F.destWidth,F.destHeight,F.sourceX,F.sourceY,F.sourceWidth,F.sourceHeight);C.mark("DOWNSCALE"),_=a(_,G)}else _=t(_,L,F.destWidth,F.destHeight,F.sourceX,F.sourceY,F.sourceWidth,F.sourceHeight),C.mark("RESIZE WITH CANVAS");c(_,w,function(D){C.mark("PRODUCE RESULT"),k(D),C.finish()})}),I;var T=function($,L,U){var F=l(v,x,w.sourceX,w.sourceY,L,U);if(F.sourceWidth/F.destWidth>=2&&F.sourceHeight/F.destHeight>=2){C.mark();var G=i(_,$,L,U);C.mark("GET IMAGE DATA");var D=r(G,F.destWidth,F.destHeight,F.sourceX,F.sourceY,F.sourceWidth,F.sourceHeight);C.mark("DOWNSCALE"),_=a(_,D),f($)!=="HTMLVideoElement"&&M.createSetter($)([$,G])}else _=t(_,$,F.destWidth,F.destHeight,F.sourceX,F.sourceY,F.sourceWidth,F.sourceHeight),C.mark("RESIZE WITH CANVAS");c(_,w,function(z){C.mark("PRODUCE RESULT"),k(z),C.finish()})},R=window.URL||window.webkitURL;switch(f(m)){case"File":var j=document.createElement("img");C.mark(),j.src=R.createObjectURL(m),C.mark("READ FILE"),d(j,function(){C.mark("LOAD IMAGE"),T(j,j.naturalWidth,j.naturalHeight)});break;case"HTMLImageElement":C.mark(),d(m,function(){C.mark("LOAD IMAGE"),T(m,m.naturalWidth,m.naturalHeight)});break;case"HTMLVideoElement":h(m,function(){T(m,m.videoWidth,m.videoHeight)});break;case"URL":C.mark(),setTimeout(function(){u(m,function($){C.mark("LOAD ARRAY BUFFER");var L=new Uint8Array($),U=new Blob([L],{type:"image/jpeg"}),F=document.createElement("img");F.src=R.createObjectURL(U),C.mark(),d(F,function(){C.mark("LOAD IMAGE"),T(F,F.naturalWidth,F.naturalHeight)})})});break}return I}return g})})(aO);var Lee=aO.exports;const Fee=xa(Lee);/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function zee(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,s,i,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(u){c=!0,o=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return a}}function GE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GE(Object(n),!0).forEach(function(r){Bee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GE(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Bee(e,t,n){return t=qee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uee(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,s;for(s=0;s<r.length;s++)o=r[s],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function Hee(e,t){if(e==null)return{};var n=Uee(e,t),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YE(e,t){return Kee(e)||zee(e,t)||lO(e,t)||Yee()}function op(e){return Vee(e)||Wee(e)||lO(e)||Gee()}function Vee(e){if(Array.isArray(e))return ix(e)}function Kee(e){if(Array.isArray(e))return e}function Wee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lO(e,t){if(e){if(typeof e=="string")return ix(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ix(e,t)}}function ix(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xee(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qee(e){var t=Xee(e,"string");return typeof t=="symbol"?t:String(t)}function Ou(e){var t=e.sizes.shift(),n=Math.max(Math.ceil(t[0]),1),r=Math.max(Math.ceil(t[1]),1),o=[n-1,r-1,1,1],s=Date.now(),i=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,a,l;i?(a=new OffscreenCanvas(1,1),l=new OffscreenCanvas(n,r)):(a=document.createElement("canvas"),a.width=1,a.height=1,l=document.createElement("canvas"),l.width=n,l.height=r);var c=a.getContext("2d"),u=l.getContext("2d");u&&(u.fillRect.apply(u,o),c.drawImage(l,n-1,r-1,1,1,0,0,1,1));var d=c&&c.getImageData(0,0,1,1).data[3]!==0,h=Date.now()-s;return[a,l].forEach(function(f){f.height=0,f.width=0}),i?(postMessage({width:n,height:r,benchmark:h,isTestPass:d}),!d&&e.sizes.length&&Ou(e)):d?e.onSuccess(n,r,h):(e.onError(n,r,h),e.sizes.length&&Ou(e)),d}var _v={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},Qee=["onError","onSuccess"],yl={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},eu={};function Tv(e){var t=e.width===e.height,n=e.height===1,r=e.width===1,o=[];if(!e.width||!e.height)e.sizes.forEach(function(u){var d=t||n?u:1,h=t||r?u:1;o.push([d,h])});else for(var s=e.min||yl.min,i=e.step||yl.step,a=Math.max(e.width,e.height);a>=s;){var l=t||n?a:1,c=t||r?a:1;o.push([l,c]),a-=i}return o}function sp(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),o=e.onError,s=e.onSuccess,i=Hee(e,Qee),a=null;if(!t)return!1;if(e.useWorker&&n){var l=`
            var canvasTest = `.concat(Ou.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),c=new Blob([l],{type:"application/javascript"}),u=URL.createObjectURL(c);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(d){var h=d.data,f=h.width,y=h.height,g=h.benchmark,m=h.isTestPass;m?(eu[r].onSuccess(f,y,g),delete eu[r]):eu[r].onError(f,y,g)}}if(e.usePromise)return new Promise(function(d,h){var f=Qn(Qn({},e),{},{onError:function(v,x,w){var C;if(e.sizes.length===0)C=!0;else{var P=e.sizes.slice(-1),k=YE(P,1),I=YE(k[0],2),_=I[0],M=I[1];C=v===_&&x===M}o(v,x,w),C&&h({width:v,height:x,benchmark:w})},onSuccess:function(v,x,w){s(v,x,w),d({width:v,height:x,benchmark:w})}});if(a){var y=f.onError,g=f.onSuccess;eu[r]={onError:y,onSuccess:g},a.postMessage(i)}else Ou(f)});if(a)eu[r]={onError:o,onSuccess:s},a.postMessage(i);else return Ou(e)}var Mv={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Tv({width:t.max,height:t.max,min:t.min,step:t.step,sizes:op(_v.area)}),r=Qn(Qn(Qn({},yl),t),{},{sizes:n});return sp(r)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Tv({width:1,height:t.max,min:t.min,step:t.step,sizes:op(_v.height)}),r=Qn(Qn(Qn({},yl),t),{},{sizes:n});return sp(r)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Tv({width:t.max,height:1,min:t.min,step:t.step,sizes:op(_v.width)}),r=Qn(Qn(Qn({},yl),t),{},{sizes:n});return sp(r)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Qn(Qn({},yl),t);return n.sizes=op(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),sp(n)}};let Av=null;function cO(){return Av||(Av=Zee()),Av}async function Zee(){const e=await Mv.maxWidth({usePromise:!0}),t=await Mv.maxHeight({usePromise:!0}),n=await Mv.maxArea({usePromise:!0});return{maxWidth:e.width,maxHeight:t.height,maxArea:n.width*n.height}}function XE(e,t){let n=0;for(;e[t+n];)n+=e[t+n]+1;return n+1}function Jee(e){return new TextDecoder("ascii").decode(e.slice(0,3))==="GIF"}function ete(e){const t=new Uint8Array(e);let n,r,o=0,s=0;if(!Jee(e))return!1;for(n=t[10]&128,r=t[10]&7,o+=6,o+=7,o+=n?3*Math.pow(2,r+1):0;s<2&&o<t.length;)switch(t[o]){case 44:s+=1,n=t[o+9]&128,r=t[o+9]&7,o+=10,o+=n?3*Math.pow(2,r+1):0,o+=XE(t,o+1)+1;break;case 33:o+=2,o+=XE(t,o);break;case 59:o=t.length;break;default:o=t.length;break}return s>1}function tte(e,t){const n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}async function nte(e,t,n,r={}){let o=t*2,s=n*2;const{type:i="image/jpeg",quality:a=.92}=r,l=await cO(),c=t/n;if(o>l.maxWidth&&(o=l.maxWidth,s=o/c),s>l.maxHeight&&(s=l.maxHeight,o=s*c),o*s>l.maxArea){const u=Math.sqrt(l.maxArea/(o*s));o*=u,s*=u}return await Fee(e,o,s,{imageType:i.replace("image/",""),quality:a})}async function rte(e){return await new Promise((t,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=()=>{t(r.result?ete(r.result):!1)},r.readAsArrayBuffer(e)})}function ote(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function ste(e){const t=new URL(e).host.replace("www.","");for(const n of tc)if(uO(n.hostnames,t)){const r=n.fromEmbedUrl(e);if(r)return{definition:n,url:r,embedUrl:e}}}const ite=e=>e.split("*").map(t=>ote(t)).join(".+"),uO=(e,t)=>!!e.find(n=>{const r=new RegExp(ite(n));return t.match(r)});function ate(e){const t=new URL(e).host.replace("www.","");for(const n of tc)if(uO(n.hostnames,t)){const r=n.toEmbedUrl(e);if(r)return{definition:n,embedUrl:r,url:e}}}function dO(e){return ate(e)??ste(e)}function ts(e){try{return dO(e)}catch(t){console.error(t)}}const vl="  ",xn=class xn{static insertTextFirefox(t,n){t.setRangeText(n,t.selectionStart||0,t.selectionEnd||0,"end"),t.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(t,n){const r=t.ownerDocument,o=r.activeElement;o!==t&&t.focus(),r.execCommand("insertText",!1,n)||xn.insertTextFirefox(t,n),o===r.body?t.blur():o instanceof HTMLElement&&o!==t&&o.focus()}static set(t,n){t.select(),xn.insert(t,n)}static getSelection(t){const{selectionStart:n,selectionEnd:r}=t;return t.value.slice(n||void 0,r||void 0)}static wrapSelection(t,n,r){const{selectionStart:o,selectionEnd:s}=t,i=xn.getSelection(t);xn.insert(t,n+i+(r??n)),t.selectionStart=(o||0)+n.length,t.selectionEnd=(s||0)+n.length}static replace(t,n,r){let o=0;t.value.replace(n,(...s)=>{const i=o+s[s.length-2],a=s[0].length;t.selectionStart=i,t.selectionEnd=i+a;const l=typeof r=="string"?r:r(...s);return xn.insert(t,l),t.selectionStart=i,o+=l.length-a,l})}static findLineEnd(t,n){const r=t.lastIndexOf(`
`,n-1)+1;return t.charAt(r)!=="	"?n:r+1}static indent(t){var a;const{selectionStart:n,selectionEnd:r,value:o}=t,s=o.slice(n,r),i=(a=/\n/g.exec(s))==null?void 0:a.length;if(i&&i>0){const l=o.lastIndexOf(`
`,n-1)+1,c=t.value.slice(l,r-1),u=c.replace(/^|\n/g,`$&${vl}`),d=u.length-c.length;t.setSelectionRange(l,r-1),xn.insert(t,u),t.setSelectionRange(n+1,r+d)}else xn.insert(t,vl)}static unindent(t){const{selectionStart:n,selectionEnd:r,value:o}=t,s=o.lastIndexOf(`
`,n-1)+1,i=xn.findLineEnd(o,r),a=t.value.slice(s,i),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;t.setSelectionRange(s,i),xn.insert(t,l);const u=/\t| {1,2}/.exec(o.slice(s,n)),d=u?u[0].length:0,h=n-d;t.setSelectionRange(n-d,Math.max(h,r-c))}static indentCE(t){var l;const n=window.getSelection(),r=t.innerText,o=ip(t)??0,s=ip(t)??0,i=r.slice(o,s),a=(l=/\n/g.exec(i))==null?void 0:l.length;if(a&&a>0){const c=r.lastIndexOf(`
`,o-1)+1,u=r.slice(c,s-1),h=u.replace(/^|\n/g,`$&${vl}`).length-u.length;n&&n.setBaseAndExtent(t,o+1,t,s+h)}else{const c=window.getSelection();t.innerText=r.slice(0,o)+vl+r.slice(o),c==null||c.setBaseAndExtent(t,o+1,t,o+2)}}static unindentCE(t){const n=window.getSelection(),r=t.innerText,o=ip(t)??0,s=ip(t)??0,i=r.lastIndexOf(`
`,o-1)+1,a=xn.findLineEnd(r,s),l=r.slice(i,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;if(n){n.setBaseAndExtent(t,i,t,a);const d=/\t| {1,2}/.exec(r.slice(i,o)),h=d?d[0].length:0,f=o-h;n.setBaseAndExtent(t,o-h,t,Math.max(f,s-u))}}static normalizeText(t){return t.replace(xn.fixNewLines,`
`)}static normalizeTextForDom(t){return t.replace(xn.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};S(xn,"fixNewLines",/\r?\n|\r/g);let di=xn;function ip(e){if(typeof window.getSelection>"u")return;const t=window.getSelection();if(!t)return;let n=0;if(t.rangeCount!==0){const r=t.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}return n}const lte=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function cte(e){return lte.test(e)}function ute(e){return e.replace(/\t/g,vl)}function dte(e){const t=e.split(`
`);for(;t[0]&&t[0].trim().length===0;)t.shift();let n=1/0;for(const r of t)if(r.trim().length>0){const o=r.length-r.trimStart().length;n=Math.min(n,o)}return t.map(r=>r.slice(n)).join(`
`)}function hte(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function pte(e){return hte(dte(ute(e)))}const ju=(e,t)=>e.length<=t?e:e.substring(0,t-3)+"...";function fte(e,{maxImageDimension:t,maxAssetSize:n,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:o}){e.registerExternalAssetHandler("file",async({file:s})=>await new Promise((i,a)=>{!r.includes(s.type)&&!o.includes(s.type)&&(console.warn(`File type not allowed: ${s.type}`),a()),s.size>n&&(console.warn(`File size too big: ${(s.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),a());const l=new FileReader;l.onerror=()=>a(l.error),l.onload=async()=>{let c=l.result;s.type==="video/quicktime"&&c.includes("video/quicktime")&&(c=c.replace("video/quicktime","video/mp4"));const u=r.includes(s.type);let d,h;if(u?(d=await UP.getImageSizeFromSrc(c),h=s.type==="image/gif"&&await rte(s)):(h=!0,d=await UP.getVideoSizeFromSrc(c)),isFinite(t)){const g=tte(d,{w:t,h:t});d!==g&&(s.type==="image/jpeg"||s.type==="image/png")&&(d=g)}(s.type==="image/jpeg"||s.type==="image/png")&&(c=await nte(c,d.w,d.h,{type:s.type,quality:.92}));const f=Zi.createId(Np(c)),y=Zi.create({id:f,type:u?"image":"video",typeName:"asset",props:{name:s.name,src:c,w:d.w,h:d.h,mimeType:s.type,isAnimated:h}});i(y)},l.readAsDataURL(s)})),e.registerExternalAssetHandler("url",async({url:s})=>{var a,l,c;let i;try{const d=await(await fetch(s,{method:"GET",mode:"no-cors"})).text(),h=new DOMParser().parseFromString(d,"text/html");i={image:((a=h.head.querySelector('meta[property="og:image"]'))==null?void 0:a.getAttribute("content"))??"",title:((l=h.head.querySelector('meta[property="og:title"]'))==null?void 0:l.getAttribute("content"))??ju(s,32),description:((c=h.head.querySelector('meta[property="og:description"]'))==null?void 0:c.getAttribute("content"))??""}}catch(u){console.error(u),i={image:"",title:ju(s,32),description:""}}return{id:Zi.createId(Np(s)),typeName:"asset",type:"bookmark",props:{src:s,description:i.description,image:i.image,title:i.title},meta:{}}}),e.registerExternalContentHandler("svg-text",async({point:s,text:i})=>{const a=s??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),l=new DOMParser().parseFromString(i,"image/svg+xml").querySelector("svg");if(!l)throw new Error("No <svg/> element present");let c=parseFloat(l.getAttribute("width")||"0"),u=parseFloat(l.getAttribute("height")||"0");if(!(c&&u)){document.body.appendChild(l);const h=l.getBoundingClientRect();document.body.removeChild(l),c=h.width,u=h.height}const d=await e.getAssetForExternalContent({type:"file",file:new File([i],"asset.svg",{type:"image/svg+xml"})});if(!d)throw Error("Could not create an asset");qE(e,[d],a)}),e.registerExternalContentHandler("embed",({point:s,url:i,embed:a})=>{const l=s??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),{width:c,height:u}=a,d=Je(),h={id:d,type:"embed",x:l.x-(c||450)/2,y:l.y-(u||450)/2,props:{w:c,h:u,url:i}};e.createShapes([h]).select(d)}),e.registerExternalContentHandler("files",async({point:s,files:i})=>{const a=s??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),l=new E(a.x,a.y),c=[];await Promise.all(i.map(async(u,d)=>{if(u.size>n)return console.warn(`File size too big: ${(u.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),null;if(!u.type)throw new Error("No mime type");if(!r.concat(o).includes(u.type))return console.warn(`${u.name} not loaded - Extension not allowed.`),null;try{const h=await e.getAssetForExternalContent({type:"file",file:u});if(!h)throw Error("Could not create an asset");c[d]=h}catch(h){return console.error(h),null}})),qE(e,pe(c),l)}),e.registerExternalContentHandler("text",async({point:s,text:i})=>{const a=s??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),l=e.getShapeUtil("text").getDefaultProps(),c=pte(i);let u,d,h,f="middle";const y=c.split(`
`).length>1,g=cte(c);y&&(f=y?g?"end":"start":"middle");const m=e.textMeasure.measureText(c,{...Gt,fontFamily:ls[l.font],fontSize:Js[l.size],maxWidth:null}),v=Math.min(y?e.getViewportPageBounds().width*.9:920,Math.max(200,e.getViewportPageBounds().width*.9));if(m.w>v){const x=e.textMeasure.measureText(c,{...Gt,fontFamily:ls[l.font],fontSize:Js[l.size],maxWidth:v});u=x.w,d=x.h,h=!1,f=g?"end":"start"}else u=m.w,d=m.h,h=!0;a.y-d/2<e.getViewportPageBounds().minY+40&&(a.y=e.getViewportPageBounds().minY+40+d/2),e.createShapes([{id:Je(),type:"text",x:a.x-u/2,y:a.y-d/2,props:{text:c,align:f,autoSize:h,w:u}}])}),e.registerExternalContentHandler("url",async({point:s,url:i})=>{const a=ts(i);if(a)return e.putExternalContent({type:"embed",url:a.url,point:s,embed:a.definition});const l=s??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),c=Zi.createId(Np(i)),u=gte(e,i,l);let d=e.getAsset(c),h=!1;if(!d){h=!0;const f=await e.getAssetForExternalContent({type:"url",url:i});if(!f)throw Error("Could not create an asset");d=f}e.batch(()=>{h&&e.createAssets([d]),e.updateShapes([{id:u.id,type:u.type,props:{assetId:d.id}}])})})}async function qE(e,t,n){if(!t.length)return[];const r=E.From(n),o=[];for(const s of t)switch(s.type){case"bookmark":{o.push({id:Je(),type:"bookmark",x:r.x-150,y:r.y-160,opacity:1,props:{assetId:s.id,url:s.props.src}}),r.x+=300;break}case"image":{o.push({id:Je(),type:"image",x:r.x-s.props.w/2,y:r.y-s.props.h/2,opacity:1,props:{assetId:s.id,w:s.props.w,h:s.props.h}}),r.x+=s.props.w;break}case"video":o.push({id:Je(),type:"video",x:r.x-s.props.w/2,y:r.y-s.props.h/2,opacity:1,props:{assetId:s.id,w:s.props.w,h:s.props.h}}),r.x+=s.props.w}return e.batch(()=>{const s=t.filter(i=>!e.getAsset(i.id));s.length&&e.createAssets(s),e.createShapes(o).select(...o.map(i=>i.id)),hO(e,n)}),o.map(s=>s.id)}function hO(e,t){const n=e.getViewportPageBounds();let r=e.getSelectionPageBounds();if(r){const o=r.center.sub(t);e.updateShapes(e.getSelectedShapes().map(s=>{const i=e.getShapeParentTransform(s).decompose().rotation,a=E.Rot(o,-i);return{id:s.id,type:s.type,x:s.x-a.x,y:s.y-a.y}}))}r=e.getSelectionPageBounds(),r&&!n.contains(r)&&e.zoomToSelection()}function gte(e,t,n){const r={id:Je(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:null,url:t}};return e.batch(()=>{e.createShapes([r]).select(r.id),hO(e,n)}),e.getShape(r.id)}var r0;let mte=(r0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")});S(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const o=this.editor.getOnlySelectedShape();o&&this.editor.getShapeUtil(o).canEdit(o)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(o.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:o}))}})}},S(r0,"id","idle"),r0);var o0;let yte=(o0=class extends ie{constructor(){super(...arguments);S(this,"shape");S(this,"markId","");S(this,"onEnter",()=>{this.didTimeout=!1;const n=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:r=>!r.isLocked&&this.editor.getShapeUtil(r).canBind(r),margin:0,hitInside:!0,renderingOnly:!0});n?this.editor.setHintingShapes([n.id]):this.createArrowShape(),this.startPreciseTimeout()});S(this,"onExit",()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()});S(this,"onPointerMove",()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find(n=>n.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});S(this,"onPointerUp",()=>{this.cancel()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()});S(this,"preciseTimeout",-1);S(this,"didTimeout",!1)}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var u,d;const{originPagePoint:n}=this.editor.inputs,r=Je();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"arrow",x:n.x,y:n.y}]);const o=this.editor.getShape(r);if(!o)throw Error("expected shape");const s=this.editor.getShapeHandles(o);if(!s)throw Error("expected handles for arrow");const i=this.editor.getShapeUtil("arrow"),a=this.shape,l=s.find(h=>h.id==="start"),c=(u=i.onHandleChange)==null?void 0:u.call(i,o,{handle:{...l,x:0,y:0},isPrecise:!0,initial:a});if(c){const h=(d=c.props)==null?void 0:d.start;(h==null?void 0:h.type)==="binding"&&this.editor.setHintingShapes([h.boundShapeId]),this.editor.updateShapes([c],{squashing:!0})}this.shape=this.editor.getShape(r),this.editor.select(r)}updateArrowShapeEndHandle(){var s,i,a;const n=this.shape;if(!n)throw Error("expected shape");const r=this.editor.getShapeHandles(n);if(!r)throw Error("expected handles for arrow");const o={...n,props:{...n.props,end:{...n.props.end,x:0,y:0}}};{const l=this.editor.getShapeUtil("arrow"),c=this.shape,u=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint),d=r.find(f=>f.id==="end"),h=(s=l.onHandleChange)==null?void 0:s.call(l,o,{handle:{...d,x:u.x,y:u.y},isPrecise:!1,initial:c});if(h){const f=(i=h.props)==null?void 0:i.end;(f==null?void 0:f.type)==="binding"&&this.editor.setHintingShapes([f.boundShapeId]),this.editor.updateShapes([h],{squashing:!0})}}{const l=this.editor.getShapeUtil("arrow"),c=this.shape,u=r.find(h=>h.id==="start"),d=(a=l.onHandleChange)==null?void 0:a.call(l,o,{handle:{...u,x:0,y:0},isPrecise:this.didTimeout,initial:c});d&&this.editor.updateShapes([d],{squashing:!0})}this.shape=this.editor.getShape(n.id)}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},S(o0,"id","pointing"),o0);class Gp extends ie{constructor(){super(...arguments);S(this,"shapeType","arrow")}}S(Gp,"id","arrow"),S(Gp,"initial","idle"),S(Gp,"children",()=>[mte,yte]);class zb extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"initialShape");S(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");S(this,"util",this.editor.getShapeUtil(this.shapeType));S(this,"isPen",!1);S(this,"segmentMode","free");S(this,"didJustShiftClickToExtendPreviousShapeLine",!1);S(this,"pagePointWhereCurrentSegmentChanged",{});S(this,"pagePointWhereNextSegmentChanged",null);S(this,"lastRecordedPoint",{});S(this,"mergeNextPoint",!1);S(this,"currentLineLength",0);S(this,"canDraw",!1);S(this,"markId",null);S(this,"onEnter",n=>{this.markId=null,this.info=n,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});S(this,"onPointerMove",()=>{const{editor:{inputs:n}}=this;if(this.isPen!==n.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&n.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(n.isPen?E.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())});S(this,"onKeyDown",n=>{if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()});S(this,"onKeyUp",n=>{if(n.key==="Shift")switch(this.editor.snaps.clear(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateShapes()});S(this,"onExit",()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(n,r){if(!this.canClose())return!1;const o=un[r],s=n[0].points[0],i=n[n.length-1],a=i.points[i.points.length-1];return s!==a&&this.currentLineLength>o*4&&E.Dist(s,a)<o*2}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.editor;this.markId="draw start "+Ge(),this.editor.mark(this.markId),this.isPen=r;const o=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const i=this.editor.getShape(this.initialShape.id);if(i&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const a=Dn(i.props.segments);if(!a)throw Error("Expected a previous segment!");const l=Dn(a.points);if(!l)throw Error("Expected a previous point!");const{x:c,y:u}=this.editor.getPointInShapeSpace(i,n).toFixed(),d=this.isPen?this.info.point.z*1.25:.5,h={type:this.segmentMode,points:[{x:l.x,y:l.y,z:+d.toFixed(2)},{x:c,y:u,z:+d.toFixed(2)}]},f=se.applyToPoint(this.editor.getShapePageTransform(i.id),l);this.pagePointWhereCurrentSegmentChanged=f,this.pagePointWhereNextSegmentChanged=null;const y=[...i.props.segments,h];this.currentLineLength=this.getLineLength(y);const g={id:i.id,type:this.shapeType,props:{segments:y}};this.canClose()&&(g.props.isClosed=this.getIsClosed(y,i.props.size)),this.editor.updateShapes([g]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const s=Je();this.editor.createShapes([{id:s,type:this.shapeType,x:n.x,y:n.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+o.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(s)}updateShapes(){const{inputs:n}=this.editor,{initialShape:r}=this;if(!r)return;const{id:o,props:{size:s}}=r,i=this.editor.getShape(o);if(!i)return;const{segments:a}=i.props,{x:l,y:c,z:u}=this.editor.getPointInShapeSpace(i,n.currentPagePoint).toFixed(),d={x:l,y:c,z:this.isPen?+(u*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,n.currentPagePoint)>ud){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const y=Dn(a);if(!y)throw Error("Expected a previous segment!");const g=Dn(y.points);if(!g)throw Error("Expected a previous last point!");let m;const v=this.editor.getPointInShapeSpace(i,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(y.type==="straight"){this.currentLineLength+=E.Dist(g,v),m={type:"straight",points:[{...g},v]};const w=this.editor.getShapePageTransform(i);this.pagePointWhereCurrentSegmentChanged=se.applyToPoint(w,g)}else m={type:"straight",points:[v,d]};const x={id:o,type:this.shapeType,props:{segments:[...a,m]}};this.canClose()&&(x.props.isClosed=this.getIsClosed(a,s)),this.editor.updateShapes([x],{squashing:!0})}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,n.currentPagePoint)>ud){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const y=a.slice(),g=y[y.length-1],m=Dn(g.points);if(!m)throw Error("No previous point!");const v={type:"free",points:[...E.PointsBetween(m,d,6).map(C=>C.toFixed().toJson())]},x=[...y,v];this.currentLineLength=this.getLineLength(x);const w={id:o,type:this.shapeType,props:{segments:x}};this.canClose()&&(w.props.isClosed=this.getIsClosed(x,s)),this.editor.updateShapes([w],{squashing:!0})}break}case"straight":{const h=a.slice(),f=h[h.length-1],{pagePointWhereCurrentSegmentChanged:y}=this,{currentPagePoint:g,ctrlKey:m}=this.editor.inputs;if(!y)throw Error("We should have a point where the segment changed");let v,x=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(x=!m,this.didJustShiftClickToExtendPreviousShapeLine=!1):x=!m;let w=this.editor.getPointInShapeSpace(i,g).toFixed().toJson(),C=!1,P;if((this.editor.user.getIsSnapMode()?!m:m)&&h.length>2){let _,M=8/this.editor.getZoomLevel();for(let T=0,R=a.length-2;T<R;T++){const j=a[T];if(!j)break;if(j.type==="free")continue;const $=j.points[0],L=Dn(j.points);if(!($&&L))continue;const U=E.NearestPointOnLineSegment($,L,w),F=E.Dist(U,w);if(F<M){_=U.toFixed().toJson(),M=F,P=j;break}}_&&(C=!0,w=_)}if(C&&P){const _=this.editor.getShapePageTransform(i),M=P.points[0],T=Dn(P.points);if(!T)throw Error("Expected a last point!");const R=se.applyToPoint(_,M),j=se.applyToPoint(_,T),$=se.applyToPoint(_,w);this.editor.snaps.setLines([{id:Ge(),type:"points",points:[R,$,j]}])}else{if(this.editor.snaps.clear(),x){const _=E.Angle(y,g),T=mg(_,24)-_;v=E.RotWith(g,y,T)}else v=g;w=this.editor.getPointInShapeSpace(i,v).toFixed().toJson()}this.currentLineLength+=E.Dist(f.points[0],w),h[h.length-1]={...f,type:"straight",points:[f.points[0],w]};const I={id:o,type:this.shapeType,props:{segments:h}};this.canClose()&&(I.props.isClosed=this.getIsClosed(a,s)),this.editor.updateShapes([I],{squashing:!0});break}case"free":{const h=a.slice(),f=h[h.length-1],y=[...f.points];if(y.length&&this.mergeNextPoint){const{z:m}=y[y.length-1];y[y.length-1]={x:d.x,y:d.y,z:m?Math.max(m,d.z):d.z}}else this.currentLineLength+=E.Dist(y[y.length-1],d),y.push(d);h[h.length-1]={...f,points:y},this.currentLineLength=this.getLineLength(h);const g={id:o,type:this.shapeType,props:{segments:h}};if(this.canClose()&&(g.props.isClosed=this.getIsClosed(h,s)),this.editor.updateShapes([g],{squashing:!0}),y.length>500){this.editor.updateShapes([{id:o,type:this.shapeType,props:{isComplete:!0}}]);const{currentPagePoint:m}=this.editor.inputs,v=Je();this.editor.createShapes([{id:v,type:this.shapeType,x:yg(m.x),y:yg(m.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(u*1.25).toFixed():.5}]}]}}]),this.initialShape=structuredClone(this.editor.getShape(v)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const o of n)for(let s=0;s<o.points.length-1;s++){const i=o.points[s],a=o.points[s+1];r+=E.Sub(a,i).len2()}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:n}=this;n&&(this.editor.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}S(zb,"id","drawing");var s0;let pO=(s0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(s0,"id","idle"),s0);class Yp extends ie{constructor(){super(...arguments);S(this,"shapeType","draw");S(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}S(Yp,"id","draw"),S(Yp,"initial","idle"),S(Yp,"children",()=>[pO,zb]);class ax extends Up{constructor(){super(...arguments);S(this,"shapeType","frame");S(this,"onCreate",n=>{if(!n)return;const r=this.editor.getShapePageBounds(n),o=[],s=this.editor.getShapeAncestors(n).map(i=>i.id);this.editor.getCurrentPageShapes().map(i=>{if(i.id===n.id||i.isLocked)return;const a=this.editor.getShapePageBounds(i);a&&r.contains(a)&&vte(i,s,n)&&o.push(i.id)}),this.editor.reparentShapes(o,n.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")})}}S(ax,"id","frame"),S(ax,"initial","idle");function vte(e,t,n){return t.includes(e.id)?!1:e.parentId===n.parentId}var i0;let Ste=(i0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const o=this.editor.getOnlySelectedShape();o&&this.editor.getShapeUtil(o).canEdit(o)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(o.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:o}))}});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(i0,"id","idle"),i0);var a0;let xte=(a0=class extends ie{constructor(){super(...arguments);S(this,"markId","");S(this,"onPointerUp",()=>{this.complete()});S(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,o=Je();this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(To)}}]).select(o).setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs,r=Je();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{geo:this.editor.getStyleForNextShape(To),w:1,h:1}}]);const o=this.editor.getShape(r);if(!o)return;const s=o.props.geo==="star"?new le(0,0,200,190):o.props.geo==="cloud"?new le(0,0,300,180):new le(0,0,200,200),i=s.center,a=this.editor.getShapeParentTransform(o);a&&i.rot(-a.rotation()),this.editor.select(r),this.editor.updateShapes([{id:o.id,type:"geo",x:o.x-i.x,y:o.y-i.y,props:{geo:this.editor.getStyleForNextShape(To),w:s.width,h:s.height}}]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},S(a0,"id","pointing"),a0);class Xp extends ie{constructor(){super(...arguments);S(this,"shapeType","geo")}}S(Xp,"id","geo"),S(Xp,"initial","idle"),S(Xp,"children",()=>[Ste,xte]);class qp extends ie{constructor(){super(...arguments);S(this,"shapeType","highlight");S(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}S(qp,"id","highlight"),S(qp,"initial","idle"),S(qp,"children",()=>[pO,zb]);var l0;let wte=(l0=class extends ie{constructor(){super(...arguments);S(this,"shapeId","");S(this,"onEnter",n=>{this.shapeId=n.shapeId,this.editor.setCursor({type:"cross",rotation:0})});S(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(l0,"id","idle"),l0);const QE=2;var c0;let bte=(c0=class extends ie{constructor(){super(...arguments);S(this,"shape",{});S(this,"markId");S(this,"onEnter",n=>{const{inputs:r}=this.editor,{currentPagePoint:o}=r;this.markId=void 0;const s=n.shapeId&&this.editor.getShape(n.shapeId);if(s&&r.shiftKey){this.markId=`creating:${s.id}`,this.editor.mark(this.markId),this.shape=s;const i=this.editor.getShapeHandles(this.shape);if(!i)return;const a=i.filter(m=>m.type==="vertex").sort(ln),l=a[a.length-1],c=a[a.length-2],u=se.applyToPoint(this.editor.getShapeParentTransform(this.shape),new E(this.shape.x,this.shape.y));let d,h,f;const y=E.Sub(o,u);E.Dist(l,c)<QE||E.Dist(y,l)<QE?(d=l.index,h=l.id,f={...l,x:y.x+.1,y:y.y+.1}):(d=Zo(l.index),h="handle:"+d,f={id:h,type:"vertex",index:d,x:y.x+.1,y:y.y+.1,canBind:!1});const g=ui(this.shape.props.handles);g[f.id]=f,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:g}}])}else{const i=Je();this.markId=`creating:${i}`,this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:"line",x:o.x,y:o.y}]),this.editor.select(i),this.shape=this.editor.getShape(i)}});S(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const n=this.editor.getShapeHandles(this.shape);if(!n)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const r=Dn(n);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...r,x:r.x-.1,y:r.y-.1},onInteractionEnd:"line"})}});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clear()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}},S(c0,"id","pointing"),c0);class Qp extends ie{constructor(){super(...arguments);S(this,"shapeType","line")}}S(Qp,"id","line"),S(Qp,"initial","idle"),S(Qp,"children",()=>[wte,bte]);var u0;let Cte=(u0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(u0,"id","idle"),u0);var d0;let Pte=(d0=class extends ie{constructor(){super(...arguments);S(this,"dragged",!1);S(this,"info",{});S(this,"wasFocusedOnEnter",!1);S(this,"markId","");S(this,"shape",{});S(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen(),this.wasFocusedOnEnter&&(this.shape=this.createShape())});S(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&(this.wasFocusedOnEnter||(this.shape=this.createShape()),this.editor.setCurrentTool("select.translating",{...n,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}}))});S(this,"onPointerUp",()=>{this.complete()});S(this,"onInterrupt",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()})}complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}createShape(){const{inputs:{originPagePoint:n}}=this.editor,r=Je();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"note",x:n.x,y:n.y}]).select(r);const o=this.editor.getShape(r),s=this.editor.getShapeGeometry(o).bounds;return this.editor.updateShapes([{id:r,type:"note",x:o.x-s.width/2,y:o.y-s.height/2}]),this.editor.getShape(r)}},S(d0,"id","pointing"),d0);class Zp extends ie{constructor(){super(...arguments);S(this,"shapeType","note")}}S(Zp,"id","note"),S(Zp,"initial","idle"),S(Zp,"children",()=>[Cte,Pte]);function fd(e){const t=e.getShapeAtPoint(e.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:co/e.getZoomLevel(),renderingOnly:!0});if(!t)return e.setHoveredShape(null);let n;const r=e.getOutermostSelectableShape(t);return r===t||r.id===e.getFocusedGroupId()||e.getSelectedShapeIds().includes(r.id)?n=t:n=r,e.setHoveredShape(n.id)}var h0;let kte=(h0=class extends ie{constructor(){super(...arguments);S(this,"onPointerMove",n=>{switch(n.target){case"shape":case"canvas":fd(this.editor)}});S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});S(this,"onKeyDown",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const o=this.editor.getOnlySelectedShape();o&&this.editor.getShapeUtil(o).canEdit(o)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(o.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:o}))}});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(h0,"id","idle"),h0);var p0;let Ete=(p0=class extends ie{constructor(){super(...arguments);S(this,"shape");S(this,"markId","");S(this,"onExit",()=>{this.editor.setHintingShapes([])});S(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,o=Je();if(this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(o),this.shape=this.editor.getShape(o),!this.shape)return;const{shape:s}=this;this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"text",onCreate:()=>{this.editor.setEditingShape(s.id),this.editor.setCurrentTool("select.editing_shape")}})}});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.cancel()});S(this,"onCancel",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}complete(){var s;this.editor.mark("creating text shape");const n=Je(),{x:r,y:o}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:n,type:"text",x:r,y:o,props:{text:"",autoSize:!0}}]).select(n),this.editor.setEditingShape(n),this.editor.setCurrentTool("select"),(s=this.editor.root.getCurrent())==null||s.transition("editing_shape")}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}},S(p0,"id","pointing"),p0);class Jp extends ie{constructor(){super(...arguments);S(this,"shapeType","text")}}S(Jp,"id","text"),S(Jp,"initial","idle"),S(Jp,"children",()=>[kte,Ete]);const Ite=[Jp,Yp,Xp,Zp,Qp,ax,Gp,qp];function Nt(){return Wn({isDarkMode:Pm()})}const bt=H.memo(function({theme:t,d:n,color:r,fill:o}){switch(o){case"none":return null;case"solid":return p.jsx("path",{fill:t[r].semi,d:n});case"semi":return p.jsx("path",{fill:t.solid,d:n});case"pattern":return p.jsx(_te,{theme:t,color:r,fill:o,d:n})}}),_te=function({d:t,color:n,theme:r}){const o=W(),s=q("zoomLevel",()=>o.getZoomLevel(),[o]),i=Math.ceil(s),a=o.getZoomLevel()<=.18;return p.jsxs(p.Fragment,{children:[p.jsx("path",{fill:r[n].pattern,d:t}),p.jsx("path",{fill:a?r[n].semi:`url(#${Sg[`${i}_${r.id}`]})`,d:t})]})};function mr({d:e,color:t,fill:n,theme:r}){if(n==="none")return;if(n==="pattern"){const s=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",e),i.setAttribute("fill",r[t].pattern);const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",e),a.setAttribute("fill","url(#hash_pattern)"),s.appendChild(i),s.appendChild(a),s}const o=document.createElementNS("http://www.w3.org/2000/svg","path");switch(o.setAttribute("d",e),n){case"semi":{o.setAttribute("fill",r.solid);break}case"solid":{o.setAttribute("fill",r[t].semi);break}}return o}function uo(e,t){if(t){const n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}else return e}function Tte(e){return e.replace(/\s/g,"")}function jm(e,t,n){const{padding:r=0}=n,o=document.createElementNS("http://www.w3.org/2000/svg","text");if(o.setAttribute("font-size",n.fontSize+"px"),o.setAttribute("font-family",n.fontFamily),o.setAttribute("font-style",n.fontStyle),o.setAttribute("font-weight",n.fontWeight),o.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),o.setAttribute("dominant-baseline","mathematical"),o.setAttribute("alignment-baseline","mathematical"),t.length===0)return o;const s=le.From(t[0].box);for(const{box:c}of t)s.union(c);const i=r+(n.offsetX??0),a=(n.offsetY??0)+n.fontSize/2+(n.verticalTextAlign==="start"?r:n.verticalTextAlign==="end"?n.height-r-s.height:(Math.ceil(n.height)-s.height)/2);let l=null;for(const{text:c,box:u}of t){if(l!==null&&u.y>l){const y=document.createElementNS("http://www.w3.org/2000/svg","tspan");y.setAttribute("alignment-baseline","mathematical"),y.setAttribute("x",i+"px"),y.setAttribute("y",u.y+a+"px"),y.textContent=`
`,o.appendChild(y)}const h=document.createElementNS("http://www.w3.org/2000/svg","tspan");h.setAttribute("alignment-baseline","mathematical"),h.setAttribute("x",u.x+i+"px"),h.setAttribute("y",u.y+a+"px");const f=Tte(c);h.textContent=f,o.appendChild(h),l=u.y}return n.stroke&&n.strokeWidth&&(o.setAttribute("stroke",n.stroke),o.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&o.setAttribute("fill",n.fill),o}function Dm(e){return{key:`${Ro.id}:${e}`,getElement:async()=>{const t=Mte(e);if(!t)return null;const n=t.$$_url,r=t.$$_fontface;if(!n||!r)return null;const o=await(await fetch(n)).blob(),s=await new Promise((l,c)=>{const u=new FileReader;u.onload=()=>l(u.result),u.onerror=c,u.readAsDataURL(o)}),i=r.replace(n,s),a=document.createElementNS("http://www.w3.org/2000/svg","style");return a.textContent=i,a}}}function Mte(e){const t=Dd[e];for(const n of document.fonts)if(t.includes(n.family))return n;return null}function Bb(e,t){return{key:`${Ro.id}:${e}`,getElement:async()=>{if(e!=="pattern")return null;const n=8/12,r=document.createElement("div");return r.innerHTML=`
				<svg>
					<defs>
						<mask id="hash_pattern_mask">
							<rect x="0" y="0" width="8" height="8" fill="white" />
							<g
								strokeLinecap="round"
								stroke="black"
							>
								<line x1="${n*1}" y1="${n*3}" x2="${n*3}" y2="${n*1}" />
								<line x1="${n*5}" y1="${n*7}" x2="${n*7}" y2="${n*5}" />
								<line x1="${n*9}" y1="${n*11}" x2="${n*11}" y2="${n*9}" />
							</g>
						</mask>
						<pattern
							id="hash_pattern"
							width="8"
							height="8"
							patternUnits="userSpaceOnUse"
						>
							<rect x="0" y="0" width="8" height="8" fill="${t.solid}" mask="url(#hash_pattern_mask)" />
						</pattern>
					</defs>
				</svg>
			`,Array.from(r.querySelectorAll("defs > *"))}}}function Ub(){return{key:`${Ro.id}:pattern`,component:Ote}}const mu=8,ZE=(e,t,n)=>new Promise((r,o)=>{const s=mu*t*e,i=document.createElement("canvas");i.width=s,i.height=s;const a=i.getContext("2d");if(!a)return;a.fillStyle=n?"#212529":"#f8f9fa",a.fillRect(0,0,s,s),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*t*e;const l=8/12,c=u=>u*t*e;a.beginPath(),a.moveTo(c(l*1),c(l*3)),a.lineTo(c(l*3),c(l*1)),a.moveTo(c(l*5),c(l*7)),a.lineTo(c(l*7),c(l*5)),a.moveTo(c(l*9),c(l*11)),a.lineTo(c(l*11),c(l*9)),a.stroke(),i.toBlob(u=>{!u||qe.throwToBlob.get()?o():r(u)})}),JE=(e,t)=>{const n=document.createElement("canvas");n.width=e[0],n.height=e[1];const r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},Ate=()=>{const e=[];for(let t=1;t<=Math.ceil(Us);t++){const n=JE([1,1],o=>{o.fillStyle=ug.lightMode.black.semi,o.fillRect(0,0,1,1)}),r=JE([1,1],o=>{o.fillStyle=ug.darkMode.black.semi,o.fillRect(0,0,1,1)});e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e};function Rte(){const t=W().getInstanceState().devicePixelRatio,[n,r]=b.useState(!1),o=b.useMemo(()=>Ate(),[]),[s,i]=b.useState(o);return b.useEffect(()=>{const l=[];for(let u=1;u<=Math.ceil(Us);u++)l.push(ZE(t,u,!1).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!1}))),l.push(ZE(t,u,!0).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!0})));let c=!1;return Promise.all(l).then(u=>{c||(i(u),r(!0))}),()=>{c=!0,r(!1)}},[t]),{defs:p.jsx(p.Fragment,{children:s.map(l=>{const c=l.zoom+(l.darkMode?"_dark":"_light");return p.jsx("pattern",{id:Sg[c],width:mu,height:mu,patternUnits:"userSpaceOnUse",children:p.jsx("image",{href:l.url,width:mu,height:mu})},c)})}),isReady:n}}function Ote(){const e=W(),t=b.useRef(null),{defs:n,isReady:r}=Rte();return b.useEffect(()=>{if(r&&e.environment.isSafari){const o=fO(t.current);o&&requestAnimationFrame(()=>{o.style.display="none",requestAnimationFrame(()=>{o.style.display=""})})}},[e,r]),p.jsx("g",{ref:t,children:n})}function fO(e){return e.classList.contains("tl-html-layer")?e:e.parentElement?fO(e.parentElement):null}function pn(e,t,n={}){const{closed:r=!1,snap:o=1,start:s="outset",end:i="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,u=0,d=1,h=0,f=0;switch(l){case"dashed":{d=1,c=Math.min(t*a,e/4);break}case"dotted":{d=100,c=t/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(s==="outset"?(e+=c/2,f+=c/2):s==="skip"&&(e-=c,f-=c),i==="outset"?e+=c/2:i==="skip"&&(e-=c)),u=Math.floor(e/c/(2*d)),u-=u%o,u<3&&l==="dashed"?e/t<5?(c=e,u=1,h=0):(c=e*.333,h=e*.333):(u=Math.max(u,3),c=e/u/(2*d),r?(f=c/2,h=(e-u*c)/u):h=(e-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:f.toString()}}function jte(e,t,n){const r=t==="end"?e.end.point:e.start.point,o=t==="end"?e.start.point:e.end.point,s=e.isStraight?E.Dist(o,r):Math.abs(e.bodyArc.length),i=Math.max(Math.min(s/5,n*3),n);let a;if(e.isStraight)a=E.Nudge(r,o,i);else{const l=TK(r,i,e.handleArc.center,e.handleArc.radius);a=t==="end"?e.handleArc.sweepFlag?l[0]:l[1]:e.handleArc.sweepFlag?l[1]:l[0]}return{point:r,int:a}}function Dte({point:e,int:t}){const n=E.RotWith(t,e,$e/6),r=E.RotWith(t,e,-$e/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y}`}function Nte({point:e,int:t}){const n=E.RotWith(t,e,$e/6),r=E.RotWith(t,e,-$e/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y} Z`}function $te({point:e,int:t}){const n=E.Sub(t,e).div(2),r=E.Add(e,E.Rot(n,Ze)),o=E.Sub(e,E.Rot(n,Ze));return`M ${r.x} ${r.y} L ${t.x} ${t.y} L ${o.x} ${o.y} Z`}function Lte({point:e,int:t}){const n=E.Lrp(e,t,.45),r=E.Dist(n,e);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function Fte({point:e,int:t}){const n=E.Lrp(e,t,.75),r=E.RotWith(n,e,$e/4),o=E.RotWith(n,e,-$e/4),s=E.Lrp(r,o,.5);return s.add(E.Sub(s,e)),`M ${s.x} ${s.y} L ${r.x} ${r.y} ${e.x} ${e.y} L ${o.x} ${o.y} Z`}function zte({int:e,point:t}){const n=E.Lrp(t,e,.85),r=E.Sub(n,t).div(2),o=E.Add(t,E.Rot(r,Ze)),s=E.Sub(t,E.Rot(r,Ze)),i=E.Add(n,E.Rot(r,Ze)),a=E.Sub(n,E.Rot(r,Ze));return`M ${o.x} ${o.y} L ${i.x} ${i.y} L ${a.x} ${a.y} L ${s.x} ${s.y} Z`}function Bte({int:e,point:t}){const n=E.Sub(e,t).div(2),r=E.Add(t,E.Rot(n,Ze)),o=E.Sub(t,E.Rot(n,Ze));return`M ${r.x} ${r.y} L ${o.x} ${o.y}`}function Ga(e,t,n){const r=t==="end"?e.end.arrowhead:e.start.arrowhead;if(r==="none")return;const o=jte(e,t,n);if(o){switch(r){case"bar":return Bte(o);case"square":return zte(o);case"diamond":return Fte(o);case"dot":return Lte(o);case"inverted":return $te(o);case"arrow":return Dte(o);case"triangle":return Nte(o)}return""}}function Ute(e){const{start:t,end:n,handleArc:{radius:r,largeArcFlag:o,sweepFlag:s}}=e;return`M${t.handle.x},${t.handle.y} A${r} ${r} 0 ${o} ${s} ${n.handle.x},${n.handle.y}`}function Rv(e){const{start:t,end:n,bodyArc:{radius:r,largeArcFlag:o,sweepFlag:s}}=e;return`M${t.point.x},${t.point.y} A${r} ${r} 0 ${o} ${s} ${n.point.x},${n.point.y}`}function gO(e,t){return`M${e.x},${e.y}L${t.x},${t.y}`}function Hte(e){return gO(e.start.handle,e.end.handle)}function Ov(e){return gO(e.start.point,e.end.point)}function Hb(e,t,n){const r=W(),o=b.useRef(null),s=b.useRef(!1),i=b.useRef(),a=q("isEditing",()=>r.getEditingShapeId()===e,[r,e]);b.useEffect(()=>{const g=o.current;g&&a&&document.activeElement!==g&&g.focus()},[a]);const l=b.useCallback(()=>{const g=s.current;s.current=!1,requestAnimationFrame(()=>{const m=o.current;if(!m)return;const v=r.getShape(e);v&&(m.value=v.props.text,m.value.length&&!g&&m.select())})},[r,e]),c=b.useCallback(()=>{const g=i.current;requestAnimationFrame(()=>{var x;const m=o.current,v=r.getEditingShapeId();if(m&&v){if(v===e)if(g)if(!g.length)m.focus();else{s.current=!0,m.focus();const w=window.getSelection();w&&g.forEach(C=>w.addRange(C))}else m.focus()}else(x=window.getSelection())==null||x.removeAllRanges(),r.complete()})},[r,e]),u=b.useCallback(g=>{if(a)switch((g.ctrlKey||g.metaKey)&&Ot(g),g.key){case"Enter":{(g.ctrlKey||g.metaKey)&&r.complete();break}case"Tab":{Re(g),g.shiftKey?di.unindent(g.currentTarget):di.indent(g.currentTarget);break}}},[r,a]),d=b.useCallback(g=>{if(!a)return;let m=di.normalizeText(g.currentTarget.value);const v=m.replace(/\t/g,vl);if(v!==m){const x=g.currentTarget.selectionStart;g.currentTarget.value=v,g.currentTarget.selectionStart=x+(v.length-m.length),g.currentTarget.selectionEnd=x+(v.length-m.length),m=v}r.updateShapes([{id:e,type:t,props:{text:m}}])},[r,e,t,a]),h=n.trim().length===0;b.useEffect(()=>{if(!a)return;if(o.current){let m=function(){var x,w;const v=(x=window.getSelection)==null?void 0:x.call(window);if(v&&v.type!=="None"){const C=[];if(v)for(let P=0;P<v.rangeCount;P++)C.push((w=v.getRangeAt)==null?void 0:w.call(v,P));i.current=C}};return document.addEventListener("selectionchange",m),()=>{document.removeEventListener("selectionchange",m)}}},[a]);const f=b.useCallback(g=>{r.dispatch({...Fn(g),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(e)}),Ot(g)},[r,e]);return{rInput:o,isEditing:a,handleFocus:l,handleBlur:c,handleKeyDown:u,handleChange:d,handleInputPointerDown:f,handleDoubleClick:Ot,isEmpty:h}}const Vte=b.memo(function({id:t,text:n,size:r,font:o,position:s,width:i,labelColor:a}){const{rInput:l,isEditing:c,handleFocus:u,handleBlur:d,handleKeyDown:h,handleChange:f,isEmpty:y,handleInputPointerDown:g,handleDoubleClick:m}=Hb(t,"arrow",n),x=di.normalizeTextForDom(n).trim().length>0;return!c&&!x?null:p.jsx("div",{className:"tl-arrow-label","data-font":o,"data-align":"center","data-hastext":!y,"data-isediting":c,style:{textAlign:"center",fontSize:Fs[r],lineHeight:Fs[r]*Gt.lineHeight+"px",transform:`translate(${s.x}px, ${s.y}px)`,color:a},children:p.jsxs("div",{className:"tl-arrow-label__inner",children:[p.jsx("p",{style:{width:i||"9px"},children:n?di.normalizeTextForDom(n):" "}),c&&p.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:u,onChange:f,onKeyDown:h,onBlur:d,onContextMenu:Ot,onPointerDown:g,onDoubleClick:m})]})})});let Kte=0;class ef extends so{constructor(){super(...arguments);S(this,"canEdit",()=>!0);S(this,"canBind",()=>!1);S(this,"canSnap",()=>!1);S(this,"hideResizeHandles",()=>!0);S(this,"hideRotateHandle",()=>!0);S(this,"hideSelectionBoundsBg",()=>!0);S(this,"hideSelectionBoundsFg",()=>!0);S(this,"onHandleChange",(n,{handle:r,isPrecise:o})=>{const s=r.id;if(s==="middle"){const{start:m,end:v}=Qr(this.editor,n),x=E.Sub(v,m),w=E.Per(x),C=E.Med(v,m),P=E.Sub(C,w),k=E.Add(C,w),I=E.NearestPointOnLineSegment(P,k,r,!1);let _=E.Dist(I,C);return E.Clockwise(I,v,C)&&(_*=-1),{id:n.id,type:n.type,props:{bend:_}}}const i=hn(n),l=this.editor.getShapePageTransform(i.id).applyToPoint(r);if(this.editor.inputs.ctrlKey)return i.props[s]={type:"point",x:r.x,y:r.y},i;const c=this.editor.getShapePageTransform(n.id).applyToPoint(r),u=this.editor.getShapeAtPoint(c,{hitInside:!0,hitFrameInside:!0,margin:0,filter:m=>!m.isLocked&&this.editor.getShapeUtil(m).canBind(m)});if(!u)return i.props[s]={type:"point",x:r.x,y:r.y},i;const d=this.editor.getShapeGeometry(u),h=le.ZeroFix(d.bounds),f=this.editor.getPointInShapeSpace(u,l);let y=o;if(!y){const m=i.props[s];(m.type==="point"||m.type==="binding"&&u.id!==m.boundShapeId)&&(y=this.editor.inputs.pointerVelocity.len()<.5)}if(!o){d.isClosed||(y=!0);const m=i.props[s==="start"?"end":"start"];m.type==="binding"&&u.id===m.boundShapeId&&m.isPrecise&&(y=!0)}const g={x:(f.x-h.minX)/h.width,y:(f.y-h.minY)/h.height};return y&&E.Dist(f,h.center)<Math.max(4,Math.min(Math.min(h.width,h.height)*.15,16))/this.editor.getZoomLevel()&&(g.x=.5,g.y=.5),i.props[s]={type:"binding",boundShapeId:u.id,normalizedAnchor:g,isPrecise:y,isExact:this.editor.inputs.altKey},i.props.start.type==="binding"&&i.props.end.type==="binding"&&i.props.start.boundShapeId===i.props.end.boundShapeId&&E.Equals(i.props.start.normalizedAnchor,i.props.end.normalizedAnchor)&&(i.props.end.normalizedAnchor.x+=.05),i});S(this,"onTranslateStart",n=>{const r=n.props.start.type==="binding"?n.props.start.boundShapeId:null,o=n.props.end.type==="binding"?n.props.end.boundShapeId:null,s=this.editor.getSelectedShapeIds();if(r&&(s.includes(r)||this.editor.isAncestorSelected(r))||o&&(s.includes(o)||this.editor.isAncestorSelected(o)))return;const{start:i,end:a}=Qr(this.editor,n);return{id:n.id,type:n.type,props:{...n.props,start:{type:"point",x:i.x,y:i.y},end:{type:"point",x:a.x,y:a.y}}}});S(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:s}=r,i=Qr(this.editor,n),{start:a,end:l}=hn(n.props);let{bend:c}=n.props;a.type==="point"&&(a.x=i.start.x*o,a.y=i.start.y*s),l.type==="point"&&(l.x=i.end.x*o,l.y=i.end.y*s);const u=Math.abs(o),d=Math.abs(s);return o<0&&s>=0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x)):o>=0&&s<0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y)):o>=0&&s>=0?c!==0&&(c*=Math.max(u,d)):o<0&&s<0&&(c!==0&&(c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x,a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y)),{props:{start:a,end:l,bend:c}}});S(this,"onDoubleClickHandle",(n,r)=>{switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}});S(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:s}}=n;s.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])})}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getGeometry(n){const r=this.editor.getArrowInfo(n),o=r.isStraight?new Pg({start:E.From(r.start.point),end:E.From(r.end.point)}):new TG({center:E.Cast(r.handleArc.center),radius:r.handleArc.radius,start:E.Cast(r.start.point),end:E.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let s;if(n.props.text.trim()){const i=o.bounds,{w:a,h:l}=this.editor.textMeasure.measureText(n.props.text,{...Gt,fontFamily:ls[n.props.font],fontSize:Fs[n.props.size],maxWidth:null});let c=a,u=l;if(i.width>i.height){c=Math.max(Math.min(a,64),Math.min(i.width-64,a));const{w:d,h}=this.editor.textMeasure.measureText(n.props.text,{...Gt,fontFamily:ls[n.props.font],fontSize:Fs[n.props.size],maxWidth:c});c=d,u=h}if(c>16*Fs[n.props.size]){c=16*Fs[n.props.size];const{w:d,h}=this.editor.textMeasure.measureText(n.props.text,{...Gt,fontFamily:ls[n.props.font],fontSize:Fs[n.props.size],maxWidth:c});c=d,u=h}s=new xi({x:r.middle.x-c/2-4.25,y:r.middle.y-u/2-4.25,width:c+8.5,height:u+8.5,isFilled:!0,isLabel:!0})}return new Qs({children:s?[o,s]:[o],isSnappable:!1})}getHandles(n){const r=this.editor.getArrowInfo(n);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}]}component(n){const r=Nt(),o=this.editor.getOnlySelectedShape(),s=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.getInstanceState().isReadonly,i=this.editor.getArrowInfo(n),a=le.ZeroFix(this.editor.getShapeGeometry(n).bounds),l=H.useMemo(()=>this.editor.environment.isSafari?Kte+=1:0,[n]);if(!(i!=null&&i.isValid))return null;const c=un[n.props.size],u=i.start.arrowhead&&Ga(i,"start",c),d=i.end.arrowhead&&Ga(i,"end",c),h=i.isStraight?Ov(i):Rv(i);let f=null;if(o===n&&s){const{strokeDasharray:P,strokeDashoffset:k}=pn(i.isStraight?E.Dist(i.start.handle,i.end.handle):Math.abs(i.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});f=n.props.start.type==="binding"||n.props.end.type==="binding"?p.jsx("path",{className:"tl-arrow-hint",d:i.isStraight?Hte(i):Ute(i),strokeDasharray:P,strokeDashoffset:k,strokeWidth:2,markerStart:n.props.start.type==="binding"?n.props.start.isExact?"":n.props.start.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:n.props.end.type==="binding"?n.props.end.isExact?"":n.props.end.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:y,strokeDashoffset:g}=pn(i.isStraight?i.length:Math.abs(i.bodyArc.length),c,{style:n.props.dash}),m=n.props.text.trim()?this.editor.getShapeGeometry(n).children[1]:null,v=!(i.start.arrowhead==="none"||i.start.arrowhead==="arrow"),x=!(i.end.arrowhead==="none"||i.end.arrowhead==="arrow"),w=(n.id+"_clip_"+l).replace(":","_");return p.jsxs(p.Fragment,{children:[p.jsxs(rr,{id:n.id,style:{minWidth:50,minHeight:50},children:[p.jsx("defs",{children:p.jsxs("mask",{id:w,children:[p.jsx("rect",{x:O(-100+a.minX),y:O(-100+a.minY),width:O(a.width+200),height:O(a.height+200),fill:"white"}),m&&p.jsx("rect",{x:m.x,y:m.y,width:m.w,height:m.h,fill:"black",rx:4,ry:4}),u&&v&&p.jsx("path",{d:u,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&x&&p.jsx("path",{d,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),p.jsxs("g",{fill:"none",stroke:r[n.props.color].solid,strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[f,p.jsxs("g",{mask:`url(#${w})`,children:[p.jsx("rect",{x:O(a.minX-100),y:O(a.minY-100),width:O(a.width+200),height:O(a.height+200),opacity:0}),p.jsx("path",{d:h,strokeDasharray:y,strokeDashoffset:g})]}),u&&v&&n.props.fill!=="none"&&p.jsx(bt,{theme:r,d:u,color:n.props.color,fill:n.props.fill}),d&&x&&n.props.fill!=="none"&&p.jsx(bt,{theme:r,d,color:n.props.color,fill:n.props.fill}),u&&p.jsx("path",{d:u}),d&&p.jsx("path",{d})]})]}),p.jsx(Vte,{id:n.id,text:n.props.text,font:n.props.font,size:n.props.size,position:i.middle,width:(m==null?void 0:m.w)??0,labelColor:r[n.props.labelColor].solid})]})}indicator(n){const{start:r,end:o}=Qr(this.editor,n),s=this.editor.getArrowInfo(n),i=this.editor.getShapeGeometry(n),a=i.bounds,l=n.props.text.trim()?i.children[1]:null,c=Im(n.id);if(!s||E.Equals(r,o))return null;const u=un[n.props.size],d=s.start.arrowhead&&Ga(s,"start",u),h=s.end.arrowhead&&Ga(s,"end",u),f=s.isStraight?Ov(s):Rv(s),y=d&&s.start.arrowhead!=="arrow"||h&&s.end.arrowhead!=="arrow"||!!l,g=(n.id+"_clip").replace(":","_");return c&&l?p.jsx("rect",{x:O(l.x),y:O(l.y),width:l.w,height:l.h,rx:3.5,ry:3.5}):p.jsxs("g",{children:[y&&p.jsx("defs",{children:p.jsxs("mask",{id:g,children:[p.jsx("rect",{x:a.minX-100,y:a.minY-100,width:a.w+200,height:a.h+200,fill:"white"}),l&&p.jsx("rect",{x:O(l.x),y:O(l.y),width:l.w,height:l.h,fill:"black",rx:3.5,ry:3.5}),d&&p.jsx("path",{d,fill:s.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),h&&p.jsx("path",{d:h,fill:s.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),p.jsxs("g",{...y?{mask:`url(#${g})`}:void 0,children:[y&&p.jsx("rect",{x:a.minX-100,y:a.minY-100,width:a.width+200,height:a.height+200,opacity:0}),p.jsx("path",{d:f})]}),d&&p.jsx("path",{d}),h&&p.jsx("path",{d:h}),l&&p.jsx("rect",{x:O(l.x),y:O(l.y),width:l.w,height:l.h,rx:3.5,ry:3.5})]})}toSvg(n,r){const o=Wn({isDarkMode:this.editor.user.getIsDarkMode()});r.addExportDef(Bb(n.props.fill,o));const s=o[n.props.color].solid,i=this.editor.getArrowInfo(n),a=un[n.props.size],l=document.createElementNS("http://www.w3.org/2000/svg","g");if(!i)return l;const c=i.start.arrowhead&&Ga(i,"start",a),u=i.end.arrowhead&&Ga(i,"end",a),d=this.editor.getShapeGeometry(n),h=d.bounds,f=n.props.text.trim()?d.children[1]:null,y=(n.id+"_clip").replace(":","_");if(c||u||f){const C=document.createElementNS("http://www.w3.org/2000/svg","defs"),P=document.createElementNS("http://www.w3.org/2000/svg","mask");P.id=y;const k=document.createElementNS("http://www.w3.org/2000/svg","rect");if(k.setAttribute("x",h.minX-100+""),k.setAttribute("y",h.minY-100+""),k.setAttribute("width",h.width+200+""),k.setAttribute("height",h.height+200+""),k.setAttribute("fill","white"),P.appendChild(k),c&&P.appendChild(e2(c,i.start.arrowhead)),u&&P.appendChild(e2(u,i.end.arrowhead)),f){const I=document.createElementNS("http://www.w3.org/2000/svg","rect");I.setAttribute("x",f.x+""),I.setAttribute("y",f.y+""),I.setAttribute("width",f.w+""),I.setAttribute("height",f.h+""),I.setAttribute("fill","black"),P.appendChild(I)}C.appendChild(P),l.appendChild(C)}const g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("mask",`url(#${y})`),l.appendChild(g);const m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x","-100"),m.setAttribute("y","-100"),m.setAttribute("width",h.width+200+""),m.setAttribute("height",h.height+200+""),m.setAttribute("fill","transparent"),m.setAttribute("stroke","none"),g.appendChild(m);const v=Wte(i.isStraight?Ov(i):Rv(i),s,a),{strokeDasharray:x,strokeDashoffset:w}=pn(i.isStraight?i.length:Math.abs(i.bodyArc.length),a,{style:n.props.dash});if(v.setAttribute("stroke-dasharray",x),v.setAttribute("stroke-dashoffset",w),g.appendChild(v),c&&l.appendChild(t2(c,n.props.color,a,n.props.arrowheadStart==="arrow"?"none":n.props.fill,o)),u&&l.appendChild(t2(u,n.props.color,a,n.props.arrowheadEnd==="arrow"?"none":n.props.fill,o)),f){r.addExportDef(Dm(n.props.font));const C={fontSize:Fs[n.props.size],lineHeight:Gt.lineHeight,fontFamily:Dd[n.props.font],padding:0,textAlign:"middle",width:f.w-8,verticalTextAlign:"middle",height:f.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},P=jm(this.editor,this.editor.textMeasure.measureTextSpans(n.props.text,C),C);P.setAttribute("fill",o[n.props.labelColor].solid),Array.from(P.children).forEach(_=>{const M=parseFloat(_.getAttribute("x")||"0"),T=parseFloat(_.getAttribute("y")||"0");_.setAttribute("x",M+4+f.x+"px"),_.setAttribute("y",T+f.y+"px")});const I=P.cloneNode(!0);I.setAttribute("stroke-width","2"),I.setAttribute("fill",o.background),I.setAttribute("stroke",o.background),l.appendChild(I),l.appendChild(P)}return l}getCanvasSvgDefs(){return[Ub()]}}S(ef,"type","arrow"),S(ef,"props",O7),S(ef,"migrations",j7);function e2(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill",t==="arrow"?"none":"black"),n.setAttribute("stroke","none"),n}function Wte(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}function t2(e,t,n,r,o){const s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",e),s.setAttribute("fill","none"),s.setAttribute("stroke",o[t].solid),s.setAttribute("stroke-width",n+"");const i=mr({d:e,fill:r,color:t,theme:o});if(i){const a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.appendChild(i),a.appendChild(s),a}else return s}const n2="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function Xd({url:e,zoomLevel:t}){return p.jsx("a",{className:fe("tl-hyperlink-button",{"tl-hyperlink-button__hidden":t<.32}),href:e,target:"_blank",rel:"noopener noreferrer",onPointerDown:Ot,onPointerUp:Ot,title:e,draggable:!1,children:p.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${n2}") center 100% / 100% no-repeat`,WebkitMask:`url("${n2}") center 100% / 100% no-repeat`}})})}const Gte=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function Vb(e){return Gte.map(n=>{const{offsetX:r,offsetY:o,blur:s,spread:i,color:a}=n,l=new E(r,o),{x:c,y:u}=l.rot(-e);return`${c}px ${u}px ${s}px ${i}px ${a}`}).join(", ")}class tf extends wc{constructor(){super(...arguments);S(this,"canResize",()=>!1);S(this,"hideSelectionBoundsFg",()=>!0);S(this,"onBeforeCreate",n=>{r2(this.editor,n)});S(this,"onBeforeUpdate",(n,r)=>{if(n.props.url!==r.props.url)if(hr.isValid(r.props.url))r2(this.editor,r);else return{...r,props:{...r.props,url:n.props.url}}})}getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(n){const r=n.props.assetId?this.editor.getAsset(n.props.assetId):null,o=this.editor.getShapePageTransform(n).rotation(),s=Yte(n);return p.jsx(va,{children:p.jsxs("div",{className:"tl-bookmark__container",style:{boxShadow:Vb(o)},children:[p.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?p.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):p.jsx("div",{className:"tl-bookmark__placeholder"}),p.jsx(Xd,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]}),p.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&p.jsx("h2",{className:"tl-bookmark__heading",children:ju((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&p.jsx("p",{className:"tl-bookmark__description",children:ju((r==null?void 0:r.props.description)||"",128)}),p.jsx("a",{className:"tl-bookmark__link",href:n.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Ot,onPointerUp:Ot,onClick:Ot,children:ju(s,45)})]})]})})}indicator(n){return p.jsx("rect",{width:O(n.props.w),height:O(n.props.h),rx:"6",ry:"6"})}}S(tf,"type","bookmark"),S(tf,"props",D7),S(tf,"migrations",N7);const Yte=e=>{try{const t=new URL(e.props.url),n=t.pathname.replace(/\/*$/,"");return`${t.hostname}${n}`}catch{return e.props.url}};function r2(e,t){const{url:n}=t.props,r=Zi.createId(Np(n));e.getAsset(r)?t.props.assetId!==r&&e.updateShapes([{id:t.id,type:t.type,props:{assetId:r}}]):(e.updateShapes([{id:t.id,type:t.type,props:{assetId:null}}]),Xte(e,t))}const Xte=KM(async(e,t)=>{const{url:n}=t.props,r=await e.getAssetForExternalContent({type:"url",url:n});r&&e.batch(()=>{e.createAssets([r]),e.updateShapes([{id:t.id,type:t.type,props:{assetId:r.id}}])})},500);function ei(e,t=!1){const n=e.length;if(n<2)return"";let r=e[0].point,o=e[1].point;if(n===2)return`M${Ht(r)}L${Ht(o)}`;let s="";for(let i=2,a=n-1;i<a;i++)r=e[i].point,o=e[i+1].point,s+=$n(r,o);return t?`M${$n(e[0].point,e[1].point)}Q${Ht(e[1].point)}${$n(e[1].point,e[2].point)}T${s}${$n(e[n-1].point,e[0].point)}${$n(e[0].point,e[1].point)}Z`:`M${Ht(e[0].point)}Q${Ht(e[1].point)}${$n(e[1].point,e[2].point)}${e.length>3?"T":""}${s}L${Ht(e[n-1].point)}`}function qte(e,t={}){const{start:n={},end:r={}}=t,{cap:o=!0}=n,{cap:s=!0}=r;la(!n.taper&&!r.taper,"cap taper not supported here"),la(!n.easing&&!r.easing,"cap easing not supported here"),la(o&&s,"cap must be true");const i=Zr(e,t);Ec(i,t);const a=Qte(i);let l="";for(const c of a)l+=Jte(c,t);return l}function Qte(e){if(e.length<=2)return[e];const t=[];let n=[e[0]];for(let r=1;r<e.length-1;r++){const o=e[r-1],s=e[r],i=e[r+1],a=E.Angle(o.point,s.point),l=E.Angle(s.point,i.point),c=Math.abs(Mu(a,l))/Math.PI;if(c>.8){const y={...s,point:s.input};n.push(y),t.push(jv(n)),n=[y];continue}if(n.push(s),c<.25)continue;const u=(o.radius+s.radius+i.radius)/3,d=E.Dist(o.point,s.point)/u,h=E.Dist(s.point,i.point)/u;if(d+h<1.5){n.push(s),t.push(jv(n)),n=[s];continue}}return n.push(e[e.length-1]),t.push(jv(n)),t}function jv(e){const t=e[0];for(;e.length>2;){const r=e[1],o=E.Dist(t.point,r.point),s=(t.radius+r.radius)/2;if(o<s*.5)e.splice(1,1);else break}const n=e[e.length-1];for(;e.length>2;){const r=e[e.length-2],o=E.Dist(n.point,r.point),s=(n.radius+r.radius)/2;if(o<s*.5)e.splice(e.length-2,1);else break}return e.length>1&&(e[0]={...e[0],vector:E.FromAngle(E.Angle(e[1].point,e[0].point))},e[e.length-1]={...e[e.length-1],vector:E.FromAngle(E.Angle(e[e.length-1].point,e[e.length-2].point))}),e}function Zte(e,t,n){return"M "+e+" "+t+" m -"+n+", 0 a "+n+","+n+" 0 1,1 "+n*2+",0 a "+n+","+n+" 0 1,1 -"+n*2+",0"}function Jte(e,t={}){if(e.length===0)return"";if(e.length===1)return Zte(e[0].point.x,e[0].point.y,e[0].radius);const{left:n,right:r}=iO(e,t);r.reverse();let o=`M${Ht(n[0])}T`;for(let s=1;s<n.length;s++)o+=$n(n[s-1],n[s]);{const s=e[e.length-1],i=s.radius,a=s.vector.clone().per().neg(),l=E.Add(s.point,E.Mul(a,i)),c=E.Add(s.point,E.Mul(a,-i));o+=`${Ht(l)}A${O(i)},${O(i)} 0 0 1 ${Ht(c)}T`}for(let s=1;s<r.length;s++)o+=$n(r[s-1],r[s]);{const s=e[0],i=s.radius,a=s.vector.clone().per(),l=E.Add(s.point,E.Mul(a,i)),c=E.Add(s.point,E.Mul(a,-i));o+=`${Ht(l)}A${O(i)},${O(i)} 0 0 1 ${Ht(c)}Z`}return o}function Rg(){const e=W();return q("zoom",()=>e.getZoomLevel()<.35,[e])}const ene=e=>e*.65+MB(e*$e/2)*.35,tne=e=>({size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:dn.easeOutSine,simulatePressure:!0}),nne=e=>({size:1+e*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:ene}),o2=e=>({size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:dn.linear});function lx({strokeWidth:e,showAsComplete:t}){return{size:1+e,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:dn.easeOutSine,last:t}}function ap(e,t,n,r){return{...r?o2(t):e.dash==="draw"?e.isPen?nne(t):tne(t):o2(t),last:e.isComplete||n}}function Sl(e){const t=[];for(const n of e)if(n.type==="free"||n.points.length<2)t.push(...n.points.map(E.Cast));else{const r=Math.max(4,Math.floor(E.Dist(n.points[0],n.points[1])/16));t.push(...E.PointsBetween(n.points[0],n.points[1],r))}return t}function s2(e,t){return{draw:"none",solid:"none",dotted:`0.1 ${t*2}`,dashed:`${t*2} ${t*2}`}[e.props.dash]}class nf extends so{constructor(){super(...arguments);S(this,"hideResizeHandles",n=>Nv(n));S(this,"hideRotateHandle",n=>Nv(n));S(this,"hideSelectionBoundsFg",n=>Nv(n));S(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:s}=r,i=[];for(const a of n.props.segments)i.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:yg(o*l),y:yg(s*c),z:u}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(n){const r=Sl(n.props.segments),o=un[n.props.size];if(n.props.segments.length===1){const i=le.FromPoints(r);if(i.width<o*2&&i.height<o*2)return new cR({x:-o,y:-o,radius:o,isFilled:!0})}const s=Zr(r,ap(n.props,o,!0,!0)).map(i=>i.point);return n.props.isClosed?new Mt({points:s,isFilled:n.props.fill!=="none"}):new Pa({points:s})}component(n){var f;const r=Nt(),o=Rg(),s=un[n.props.size],i=Sl(n.props.segments),a=n.props.isComplete||((f=Dn(n.props.segments))==null?void 0:f.type)==="straight";let l=s;!o&&!n.props.isPen&&n.props.dash==="draw"&&i.length===1&&(l+=ci(n.id)()*(s/6));const c=ap(n.props,l,a,o);if(!o&&n.props.dash==="draw")return p.jsxs(rr,{id:n.id,children:[n.props.isClosed&&n.props.fill&&i.length>1?p.jsx(bt,{theme:r,fill:n.props.isClosed?n.props.fill:"none",color:n.props.color,d:ei(Zr(i,c),n.props.isClosed)}):null,p.jsx("path",{d:qte(i,c),strokeLinecap:"round",fill:r[n.props.color].solid})]});const u=Zr(i,c),d=u.length<2,h=d?Dv(i[0],0):ei(u,n.props.isClosed);return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{theme:r,color:n.props.color,fill:d||n.props.isClosed?n.props.fill:"none",d:h}),p.jsx("path",{d:h,strokeLinecap:"round",fill:d?r[n.props.color].solid:"none",stroke:r[n.props.color].solid,strokeWidth:s,strokeDasharray:d?"none":s2(n,s),strokeDashoffset:"0"})]})}indicator(n){var d;const r=Rg(),o=un[n.props.size],s=Sl(n.props.segments);let i=o;!r&&!n.props.isPen&&n.props.dash==="draw"&&s.length===1&&(i+=ci(n.id)()*(o/6));const a=n.props.isComplete||((d=Dn(n.props.segments))==null?void 0:d.type)==="straight",l=ap(n.props,i,a,!0),c=Zr(s,l),u=c.length>1?ei(c,n.props.isClosed):Dv(s[0],i);return p.jsx("path",{d:u})}toSvg(n,r){var g;const o=Wn({isDarkMode:this.editor.user.getIsDarkMode()});r.addExportDef(Bb(n.props.fill,o));const{color:s}=n.props,i=un[n.props.size],a=Sl(n.props.segments),l=n.props.isComplete||((g=Dn(n.props.segments))==null?void 0:g.type)==="straight";let c=i;!n.props.isPen&&n.props.dash==="draw"&&a.length===1&&(c+=ci(n.id)()*(i/6));const u=ap(n.props,c,l,!1),d=Zr(a,u),h=d.length>1?ei(d,n.props.isClosed):Dv(a[0],c);let f;if(n.props.dash==="draw"||d.length<2){Ec(d,u);const m=Yd(d,u),v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",Fd(m,!0)),v.setAttribute("fill",o[s].solid),v.setAttribute("stroke-linecap","round"),f=v}else{const m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",h),m.setAttribute("stroke",o[s].solid),m.setAttribute("fill","none"),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-width",i.toString()),m.setAttribute("stroke-dasharray",s2(n,i)),m.setAttribute("stroke-dashoffset","0"),f=m}const y=mr({fill:n.props.isClosed?n.props.fill:"none",d:h,color:n.props.color,theme:o});if(y){const m=document.createElementNS("http://www.w3.org/2000/svg","g");return m.appendChild(y),m.appendChild(f),m}return f}getCanvasSvgDefs(){return[Ub()]}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return un[n.props.size]*r/2}}S(nf,"type","draw"),S(nf,"props",$7),S(nf,"migrations",L7);function Dv(e,t){const n=(t+1)*.5;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function Nv(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}function rne(e,t,n={}){const{newPoint:r,handle:o,scaleX:s,scaleY:i}=t,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=n;let d=e.props.w*s,h=e.props.h*i;const f=new E(0,0);if(d>0){if(d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(o){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=h-c;break}case"right":case"left":{f.y=(h-c)/2;break}default:f.y=0}h=c}}else if(f.y=h,h=-h,h<c){switch(o){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-c}h=c}const{x:y,y:g}=f.rot(e.rotation).add(r);return{x:y,y:g,props:{w:Math.min(l,d),h:Math.min(u,h)}}}const one=e=>Object.entries(e).filter(([t,n])=>n).map(([t])=>t).join(" ");class rf extends wc{constructor(){super(...arguments);S(this,"hideSelectionBoundsFg",n=>!this.canResize(n));S(this,"canEdit",()=>!0);S(this,"canUnmount",n=>{var r,o;return!!((o=(r=ts(n.props.url))==null?void 0:r.definition)!=null&&o.canUnmount)});S(this,"canResize",n=>{var r,o;return!!((o=(r=ts(n.props.url))==null?void 0:r.definition)!=null&&o.doesResize)});S(this,"canEditInReadOnly",()=>!0);S(this,"isAspectRatioLocked",n=>{const r=ts(n.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});S(this,"onResize",(n,r)=>{const o=this.isAspectRatioLocked(n),s=ts(n.props.url);let i=(s==null?void 0:s.definition.minWidth)??200,a=(s==null?void 0:s.definition.minHeight)??200;if(o){const l=n.props.w/n.props.h;l>1?i*=l:a/=l}return rne(n,r,{minWidth:i,minHeight:a})})}getDefaultProps(){return{w:300,h:300,url:""}}component(n){const{w:r,h:o,url:s}=n.props,i=Im(n.id),a=b.useMemo(()=>dO(s),[s]),l=q("is hovering",()=>{const{editingShapeId:h,hoveredShapeId:f}=this.editor.getCurrentPageState();if(h&&f!==h){const y=this.editor.getShape(h);if(y&&this.editor.isShapeOfType(y,"embed"))return!0}return!1},[]),c=this.editor.getShapePageTransform(n).rotation(),u=i||l;if((a==null?void 0:a.definition.type)==="github_gist"){const h=a.url.split("/").pop();if(!h)throw Error("No gist id!");return p.jsx(va,{className:"tl-embed-container",id:n.id,children:p.jsx(sne,{id:h,width:O(r),height:O(o),isInteractive:u,pageRotation:c})})}const d=one({...z7,...(a==null?void 0:a.definition.overridePermissions)??{}});return p.jsx(va,{className:"tl-embed-container",id:n.id,children:a!=null&&a.definition?p.jsx("iframe",{className:"tl-embed",sandbox:d,src:a.embedUrl,width:O(r),height:O(o),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:Vb(c),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):null})}indicator(n){const r=b.useMemo(()=>ts(n.props.url),[n.props.url]);return p.jsx("rect",{width:O(n.props.w),height:O(n.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}S(rf,"type","embed"),S(rf,"props",B7),S(rf,"migrations",U7);function sne({id:e,file:t,isInteractive:n,width:r,height:o,style:s,pageRotation:i}){return p.jsx("iframe",{className:"tl-embed",draggable:!1,width:O(r),height:O(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...s,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:Vb(i)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${e}.js${t?`?file=${t}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const ine=b.forwardRef(({id:e,name:t,isEditing:n},r)=>{const o=W(),s=b.useCallback(l=>{l.key==="Enter"&&!l.nativeEvent.isComposing&&(Ot(l),l.currentTarget.blur(),o.setEditingShape(null))},[o]),i=b.useCallback(l=>{const c=o.getShape(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value.trim();u!==d&&o.updateShapes([{id:e,type:"frame",props:{name:d}}],{squashing:!0})},[e,o]),a=b.useCallback(l=>{const c=o.getShape(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value;u!==d&&o.updateShapes([{id:e,type:"frame",props:{name:d}}],{squashing:!0})},[e,o]);return p.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[p.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:t,autoFocus:!0,onKeyDown:s,onBlur:i,onChange:a}),mO(t,"Frame")+""]})}),ane=function({id:t,name:n,width:r,height:o}){const s=W(),i=q("shape rotation",()=>oo(s.getShapePageTransform(t).rotation()),[s,t]),a=Im(t),l=b.useRef(null),c=b.useCallback(y=>{const g=Fn(y);s.getEditingShapeId()!==t&&(s.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:s.getShape(t),...g}),y.preventDefault())},[s,t]);b.useEffect(()=>{const y=l.current;y&&a&&(y.focus(),y.select(),requestAnimationFrame(()=>{document.activeElement!==y&&(y.focus(),y.select())}))},[l,a]);const d=((i+Math.PI/4)*(2/Math.PI)+4)%4,h=["top","left","bottom","right"][Math.floor(d)];let f;switch(h){case"top":f="";break;case"right":f=`translate(${O(r)}px, 0px) rotate(90deg)`;break;case"bottom":f=`translate(${O(r)}px, ${O(o)}px) rotate(180deg)`;break;case"left":f=`translate(0px, ${O(o)}px) rotate(270deg)`;break}return p.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(h==="top"||h==="bottom"?r:o)}px + var(--space-5))`,bottom:"100%",transform:`${f} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:c,children:p.jsx("div",{className:"tl-frame-heading-hit-area",children:p.jsx(ine,{ref:l,id:t,name:n,isEditing:a})})})};function mO(e,t){return e.match(/^\s*$/)?t:e}class of extends wc{constructor(){super(...arguments);S(this,"canBind",()=>!0);S(this,"canEdit",()=>!0);S(this,"canReceiveNewChildrenOfType",(n,r)=>!n.isLocked);S(this,"canDropShapes",(n,r)=>!n.isLocked);S(this,"onDragShapesOver",(n,r)=>r.every(o=>o.parentId===n.id)?{shouldHint:!1}:(this.editor.reparentShapes(r.map(o=>o.id),n.id),{shouldHint:!0}));S(this,"onDragShapesOut",(n,r)=>{const o=this.editor.getShape(n.parentId);o&&this.editor.isShapeOfType(o,"group")?this.editor.reparentShapes(r,o.id):this.editor.reparentShapes(r,this.editor.getCurrentPageId())});S(this,"onResizeEnd",n=>{const r=this.editor.getShapePageBounds(n),o=this.editor.getSortedChildIdsForParent(n.id),s=[];for(const i of o){const a=this.editor.getShapePageBounds(i);r.includes(a)||s.push(i)}s.length>0&&this.editor.reparentShapes(s,this.editor.getCurrentPageId())});S(this,"onResize",(n,r)=>aR(n,r))}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(n){return new xi({width:n.props.w,height:n.props.h,isFilled:!1})}component(n){const r=this.editor.getShapeGeometry(n).bounds,o=Nt(),s=q("is creating this shape",()=>{var l;const i=this.editor.getStateDescendant("select.resizing");if(!i||!i.getIsActive())return!1;const a=i==null?void 0:i.info;return a?a.isCreating&&((l=this.editor.getOnlySelectedShape())==null?void 0:l.id)===n.id:!1},[n.id]);return p.jsxs(p.Fragment,{children:[p.jsx(rr,{children:p.jsx("rect",{className:fe("tl-frame__body",{"tl-frame__creating":s}),width:r.width,height:r.height,fill:o.solid,stroke:o.text})}),s?null:p.jsx(ane,{id:n.id,name:n.props.name,width:r.width,height:r.height})]})}toSvg(n){const r=Wn({isDarkMode:this.editor.user.getIsDarkMode()}),o=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("width",n.props.w.toString()),s.setAttribute("height",n.props.h.toString()),s.setAttribute("fill",r.solid),s.setAttribute("stroke",r.black.solid),s.setAttribute("stroke-width","1"),s.setAttribute("rx","1"),s.setAttribute("ry","1"),o.appendChild(s);const l=((oo(this.editor.getShapePageTransform(n.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4,c=["top","left","bottom","right"][Math.floor(l)];let u;switch(c){case"top":u="";break;case"right":u=`translate(${O(n.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":u=`translate(${O(n.props.w)}px, ${O(n.props.h)}px) rotate(180deg)`;break;case"left":u=`translate(0px, ${O(n.props.h)}px) rotate(270deg)`;break;default:u=""}const d={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:n.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},h=this.editor.textMeasure.measureTextSpans(mO(n.props.name,"Frame")+"",d),f=h[0],y=Dn(h),g=y.box.w+y.box.x-f.box.x,m=jm(this.editor,h,{offsetY:-d.height-2,...d});m.style.setProperty("transform",u);const v=document.createElementNS("http://www.w3.org/2000/svg","rect");return v.setAttribute("x","-8px"),v.setAttribute("y",-d.height-4+"px"),v.setAttribute("width",g+16+"px"),v.setAttribute("height",`${d.height}px`),v.setAttribute("rx","4px"),v.setAttribute("ry","4px"),v.setAttribute("fill",r.background),o.appendChild(v),o.appendChild(m),o}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return p.jsx("rect",{width:O(r.width),height:O(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}S(of,"type","frame"),S(of,"props",H7),S(of,"migrations",V7);function lne(e,t,n,r){if((e==="start-legacy"||e==="end-legacy")&&n.length!==0){const o=le.From(n[0].box);for(const{box:s}of n)o.union(s);if(e==="start-legacy")return(r-2*t-o.width)/2;if(e==="end-legacy")return-(r-2*t-o.width)/2}}function cne(e){return e==="start-legacy"||e==="middle-legacy"||e==="end-legacy"}const yO=H.memo(function({id:t,type:n,text:r,size:o,labelColor:s,font:i,align:a,verticalAlign:l,wrap:c,bounds:u}){const{rInput:d,isEmpty:h,isEditing:f,handleFocus:y,handleChange:g,handleKeyDown:m,handleBlur:v,handleInputPointerDown:x,handleDoubleClick:w}=Hb(t,n,r),C=di.normalizeTextForDom(r),P=C.length>0,k=cne(a),I=Nt();return!f&&!P?null:p.jsx("div",{className:"tl-text-label","data-font":i,"data-align":a,"data-hastext":!h,"data-isediting":f,"data-textwrap":!!c,style:{justifyContent:a==="middle"||k?"center":a,alignItems:l==="middle"?"center":l,...u?{top:u.minY,left:u.minX,width:u.width,height:u.height,position:"absolute"}:{}},children:p.jsxs("div",{className:"tl-text-label__inner",style:{fontSize:rc[o],lineHeight:rc[o]*Gt.lineHeight+"px",minHeight:Gt.lineHeight+32,minWidth:0,color:I[s].solid},children:[p.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:C}),f&&p.jsx("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:y,onChange:g,onKeyDown:m,onBlur:v,onContextMenu:Ot,onPointerDown:x,onDoubleClick:w})]})})});function vO({bounds:e,editor:t,font:n,shape:r}){const s={fontSize:rc[r.props.size],fontFamily:n,textAlign:r.props.align,verticalTextAlign:r.props.verticalAlign,width:Math.ceil(e.width),height:Math.ceil(e.height),padding:16,lineHeight:Gt.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},i=t.textMeasure.measureTextSpans(r.props.text,s),a=lne(r.props.align,16,i,e.width);return a&&(s.offsetX=a),jm(t,i,s)}function nn(e){return`${O(e.x)},${O(e.y)} `}function SO(e=""){let t=0,n=0,r=0,o=0;function s(){const i=t^t<<11;return t=n,n=r,r=o,o^=(o>>>19^i^i>>>8)>>>0,o/4294967296*2}for(let i=0;i<e.length+64;i++)t^=e.charCodeAt(i)|0,s();return s}function gd(e){let t="M";const n=e.length;let r,o,s;for(let i=0,a=n;i<a;i+=3)r=e[i],o=e[i+1],s=e[i+2],t+=`${nn(r)}L${nn(o)}Q${nn(s)}`;return t+=`${nn(e[0])}`,t}function md(e,t,n,r,o){const s=[],i=SO(e);let a=t[0],l;const c=t.length;for(let u=0,d=c*o;u<d;u++){l=E.AddXY(t[(u+1)%c],i()*n,i()*n);const h=E.Sub(l,a),f=E.Len(h),y=E.Div(h,f).mul(Math.min(f/4,r));s.push(E.Add(a,y),E.Add(l,y.neg()),l),a=l}return s}function $v(e,t,n){let r=`M ${nn(t[0])}L`,o=`M ${nn(t[0])}L`;const s=n/3,i=n*2,a=SO(e);let l=t[0],c,u=t[0],d;const h=t.length;for(let f=0,y=h-1;f<y;f++){c=t[f+1],d=E.AddXY(t[f+1],a()*s,a()*s);const g=E.Sub(c,l),m=E.Len(g),v=E.Div(g,m).mul(Math.min(m/4,i)),x=E.Add(l,v),w=E.Add(c,v.neg()),C=E.Sub(d,u),P=E.Len(C),k=E.Div(C,P).mul(Math.min(P/4,i)),I=E.Add(u,k),_=E.Add(d,k.neg());f===y-1?(r+=`${nn(x)}L ${nn(c)}`,o+=`${nn(I)}L ${nn(d)}`):(r+=`${nn(x)}L ${nn(w)}Q ${nn(c)}`,o+=`${nn(I)}L ${nn(_)}Q ${nn(d)}`,l=c,u=d)}return[r,r+o]}function i2(e,t){const n=Math.min(e,t)/2,r=Math.max(e,t)-n*2;return Math.PI*(n*2)+2*r}function une(e,t,n){const r=Math.min(e,t)/2,o=Math.max(e,t)-r*2,i=(Math.PI*(r*2)+2*o)/n,a=e>t?[{type:"straight",start:new E(r,0),delta:new E(1,0)},{type:"arc",center:new E(e-r,r),startAngle:-$e/2},{type:"straight",start:new E(e-r,t),delta:new E(-1,0)},{type:"arc",center:new E(r,r),startAngle:$e/2}]:[{type:"straight",start:new E(e,r),delta:new E(0,1)},{type:"arc",center:new E(r,t-r),startAngle:0},{type:"straight",start:new E(0,t-r),delta:new E(0,-1)},{type:"arc",center:new E(r,r),startAngle:$e}];let l=0;const c=[];for(let u=0;u<n;u++){const d=a[0];d.type==="straight"?c.push(E.Add(d.start,E.Mul(d.delta,l))):c.push(hA(d.center.x,d.center.y,r,d.startAngle+l/r)),l+=i;let h=d.type==="straight"?o:$e*r;for(;l>h;)l-=h,a.push(a.shift()),h=a[0].type==="straight"?o:$e*r}return c}const dne=(e,t,n,r,o)=>{switch(e){case"s":return t;case"m":return n;case"l":return r;case"xl":return o}};function qd(e,t,n,r){const o=ci(n),s=i2(e,t),i=Math.max(Math.ceil(s/dne(r,50,70,100,130)),6,Math.ceil(s/Math.min(e,t))),a=s/i*.2,l=Math.max(e-a*2,1),c=Math.max(t-a*2,1),u=(e-l)/2,d=(t-c)/2,h=i2(l,c)/i,f=une(l,c,i).map(x=>x.addXY(u,d)),y=e<20?0:a*.3,g=t<20?0:a*.3,m=f.slice(0);for(let x=0;x<Math.floor(i/2);x++)m[x]=E.AddXY(m[x],o()*y,o()*g),m[i-x-1]=E.AddXY(m[i-x-1],o()*y,o()*g);const v=[];for(let x=0;x<m.length;x++){const w=x===m.length-1?0:x+1,C=m[x],P=m[w],k=f[x],I=f[w],_=E.Average([k,I]),M=E.Angle(k,I)-Math.PI/2,T=E.Dist(k,I),R=h-T,$=E.Dist(C,P)/T,L=(Math.max(u,d)+R)*$,U=E.Add(_,E.FromAngle(M,L));U.x<0?U.x=0:U.x>e&&(U.x=e),U.y<0?U.y=0:U.y>t&&(U.y=t);const F=xO(C,P,U),G=E.Dist(F||E.Average([C,P]),C);v.push({leftPoint:C,rightPoint:P,arcPoint:U,center:F,radius:G})}return v}function xO(e,t,n){const r=e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y,o=(e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y),s=(e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x),i=-o/(2*r),a=-s/(2*r);return!Number.isFinite(i)||!Number.isFinite(a)?null:new E(i,a)}function hne(e,t,n,r){const o=[],s=qd(e,t,n,r);for(const{center:i,radius:a,leftPoint:l,rightPoint:c}of s)o.push(...pne(l,c,i,a,10));return o}function Qd(e,t,n,r){const o=qd(e,t,n,r);let s=`M${O(o[0].leftPoint.x)},${O(o[0].leftPoint.y)}`;for(const{leftPoint:i,rightPoint:a,radius:l,center:c}of o){if(c===null){s+=` L${O(a.x)},${O(a.y)}`;continue}const u=bO(i,a,c)?"0":"1";s+=` A${O(l)},${O(l)} 0 ${u},1 ${O(a.x)},${O(a.y)}`}return s+=" Z",s}function wO(e,t,n,r){const o=ci(n),s=r==="s"?.5:r==="m"?.7:r==="l"?.9:1.6,i=y=>y+o()*s*2,a=qd(e,t,n,r),u=a.reduce((y,g)=>y+E.Dist(g.leftPoint,g.rightPoint),0)/a.length>s*15?y=>new E(i(y.x),i(y.y)):y=>y;let d=`M${O(a[0].leftPoint.x)},${O(a[0].leftPoint.y)}`,h=u(a[0].leftPoint),f=`M${O(h.x)},${O(h.y)}`;for(const{leftPoint:y,center:g,rightPoint:m,radius:v,arcPoint:x}of a){if(g===null){d+=` L${O(m.x)},${O(m.y)}`;const _=u(m);f+=` L${O(_.x)},${O(_.y)}`,h=_;continue}const w=bO(y,m,g)?"0":"1";d+=` A${O(v)},${O(v)} 0 ${w},1 ${O(m.x)},${O(m.y)}`;const C=u(m),P=u(x),k=xO(h,C,P);if(!k){f+=` L${O(C.x)},${O(C.y)}`,h=C;continue}const I=Math.abs(E.Dist(k,h));f+=` A${O(I)},${O(I)} 0 ${w},1 ${O(C.x)},${O(C.y)}`,h=C}return d+f+" Z"}function pne(e,t,n,r,o){if(n===null)return[E.From(e),E.From(t)];const s=[],i=E.Angle(n,e),a=E.Angle(n,t),l=xm(i,a);for(let c=0;c<o;c++){const u=c/(o-1),d=i+l*u,h=hA(n.x,n.y,r,d);s.push(h)}return s}function bO(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)>0}const fne=b.memo(function({dash:t,fill:n,color:r,strokeWidth:o,w:s,h:i,id:a,size:l}){const c=Nt(),u=Qd(s,i,a,l),d=qd(s,i,a,l);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:c,d:u,fill:n,color:r}),p.jsx("g",{strokeWidth:o,stroke:c[r].solid,fill:"none",pointerEvents:"all",children:d.map(({leftPoint:h,rightPoint:f,center:y,radius:g},m)=>{const v=y?g*oo(oo(E.Angle(y,f))-oo(E.Angle(y,h))):E.Dist(h,f),{strokeDasharray:x,strokeDashoffset:w}=pn(v,o,{style:t,start:"outset",end:"outset"});return p.jsx("path",{d:y?`M${h.x},${h.y}A${g},${g},0,0,1,${f.x},${f.y}`:`M${h.x},${h.y}L${f.x},${f.y}`,strokeDasharray:x,strokeDashoffset:w},m)})})]})});function gne({dash:e,fill:t,color:n,theme:r,strokeWidth:o,w:s,h:i,id:a,size:l}){const c=Qd(s,i,a,l),u=qd(s,i,a,l),d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttribute("stroke-width",o.toString()),d.setAttribute("stroke",r[n].solid),d.setAttribute("fill","none");for(const{leftPoint:f,rightPoint:y,center:g,radius:m}of u){const v=g?m*oo(oo(E.Angle(g,y))-oo(E.Angle(g,f))):E.Dist(f,y),{strokeDasharray:x,strokeDashoffset:w}=pn(v,o,{style:e,start:"outset",end:"outset"}),C=document.createElementNS("http://www.w3.org/2000/svg","path");C.setAttribute("d",g?`M${f.x},${f.y}A${m},${m},0,0,1,${y.x},${y.y}`:`M${f.x},${f.y}L${y.x},${y.y}`),C.setAttribute("stroke-dasharray",x.toString()),C.setAttribute("stroke-dashoffset",w.toString()),d.appendChild(C)}const h=mr({d:c,fill:t,color:n,theme:r});return uo(d,h)}const mne=b.memo(function({w:t,h:n,strokeWidth:r,dash:o,color:s,fill:i}){const a=Nt(),l=t/2,c=n/2,u=Math.max(0,l),d=Math.max(0,c),h=cd(u,d),{strokeDasharray:f,strokeDashoffset:y}=pn(h<64?h*2:h,r,{style:o,snap:4,closed:!0}),g=`M${l-u},${c}a${u},${d},0,1,1,${u*2},0a${u},${d},0,1,1,-${u*2},0`;return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:a,d:g,color:s,fill:i}),p.jsx("path",{d:g,strokeWidth:r,width:O(t),height:O(n),fill:"none",stroke:a[s].solid,strokeDasharray:f,strokeDashoffset:y,pointerEvents:"all"})]})});function yne({w:e,h:t,strokeWidth:n,dash:r,color:o,theme:s,fill:i}){const a=e/2,l=t/2,c=Math.max(0,a-n/2),u=Math.max(0,l-n/2),d=cd(c,u),{strokeDasharray:h,strokeDashoffset:f}=pn(d<64?d*2:d,n,{style:r,snap:4,closed:!0}),y=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`,g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("d",y),g.setAttribute("stroke-width",n.toString()),g.setAttribute("width",e.toString()),g.setAttribute("height",t.toString()),g.setAttribute("fill","none"),g.setAttribute("stroke",s[o].solid),g.setAttribute("stroke-dasharray",h),g.setAttribute("stroke-dashoffset",f);const m=mr({d:y,fill:i,color:o,theme:s});return uo(g,m)}function CO(e,t){if(t>e){const r=e/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${t-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const n=t/2;return`
    M${n},0
    L${e-n},0
    a${n},${n},0,1,1,0,${n*2}
    L${n},${t}
    a${n},${n},0,1,1,0,${-n*2}
    Z`}function PO(e,t){if(e>t){const r=t/2;return cd(r,r)+(e-r*2)*2}const n=e/2;return cd(n,n)+(t-n*2)*2}const vne=b.memo(function({w:t,h:n,strokeWidth:r,dash:o,color:s,fill:i}){const a=Nt(),l=CO(t,n),c=PO(t,n),{strokeDasharray:u,strokeDashoffset:d}=pn(c<64?c*2:c,r,{style:o,snap:4,start:"outset",end:"outset",closed:!0});return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:a,d:l,color:s,fill:i}),p.jsx("path",{d:l,strokeWidth:r,width:O(t),height:O(n),fill:"none",stroke:a[s].solid,strokeDasharray:u,strokeDashoffset:d,pointerEvents:"all"})]})});function a2({w:e,h:t,strokeWidth:n,dash:r,color:o,theme:s,fill:i}){const a=CO(e,t),l=PO(e,t),{strokeDasharray:c,strokeDashoffset:u}=pn(l<64?l*2:l,n,{style:r,snap:4,closed:!0}),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid),d.setAttribute("stroke-dasharray",c),d.setAttribute("stroke-dashoffset",u);const h=mr({d:a,fill:i,color:o,theme:s});return uo(d,h)}const Sne=b.memo(function({dash:t,fill:n,color:r,strokeWidth:o,outline:s,lines:i}){const a=Nt(),l="M"+s[0]+"L"+s.slice(1)+"Z";return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:a,d:l,fill:n,color:r}),p.jsxs("g",{strokeWidth:o,stroke:a[r].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(s.length)).map((c,u)=>{const d=s[u],h=s[(u+1)%s.length],f=E.Dist(d,h),{strokeDasharray:y,strokeDashoffset:g}=pn(f,o,{style:t,start:"outset",end:"outset"});return p.jsx("line",{x1:d.x,y1:d.y,x2:h.x,y2:h.y,strokeDasharray:y,strokeDashoffset:g},u)}),i&&i.map(([c,u],d)=>{const h=E.Dist(c,u),{strokeDasharray:f,strokeDashoffset:y}=pn(h,o,{style:t,start:"skip",end:"outset",snap:t==="dotted"?4:void 0});return p.jsx("path",{d:`M${c.x},${c.y}L${u.x},${u.y}`,stroke:a[r].solid,strokeWidth:o,fill:"none",strokeDasharray:f,strokeDashoffset:y},`line_fg_${d}`)})]})]})});function xne({dash:e,fill:t,color:n,theme:r,strokeWidth:o,outline:s,lines:i}){const a=document.createElementNS("http://www.w3.org/2000/svg","g");if(a.setAttribute("stroke-width",o.toString()),a.setAttribute("stroke",r[n].solid),a.setAttribute("fill","none"),Array.from(Array(s.length)).forEach((c,u)=>{const d=s[u],h=s[(u+1)%s.length],f=E.Dist(d,h),{strokeDasharray:y,strokeDashoffset:g}=pn(f,o,{style:e}),m=document.createElementNS("http://www.w3.org/2000/svg","line");m.setAttribute("x1",d.x.toString()),m.setAttribute("y1",d.y.toString()),m.setAttribute("x2",h.x.toString()),m.setAttribute("y2",h.y.toString()),m.setAttribute("stroke-dasharray",y.toString()),m.setAttribute("stroke-dashoffset",g.toString()),a.appendChild(m)}),i)for(const[c,u]of i){const d=E.Dist(c,u),{strokeDasharray:h,strokeDashoffset:f}=pn(d,o,{style:e,start:"skip",end:"skip",snap:e==="dotted"?4:2}),y=document.createElementNS("http://www.w3.org/2000/svg","line");y.setAttribute("x1",c.x.toString()),y.setAttribute("y1",c.y.toString()),y.setAttribute("x2",u.x.toString()),y.setAttribute("y2",u.y.toString()),y.setAttribute("stroke-dasharray",h.toString()),y.setAttribute("stroke-dashoffset",f.toString()),a.appendChild(y)}const l=mr({d:"M"+s[0]+"L"+s.slice(1)+"Z",fill:t,color:n,theme:r});return uo(a,l)}const wne=b.memo(function({fill:t,color:n,strokeWidth:r,w:o,h:s,id:i,size:a}){const l=Nt(),c=wO(o,s,i,a);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:l,d:c,fill:t,color:n}),p.jsx("path",{d:c,stroke:l[n].solid,strokeWidth:r,fill:"none"})]})});function bne({fill:e,color:t,strokeWidth:n,theme:r,w:o,h:s,id:i,size:a}){const l=wO(o,s,i,a),c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",n.toString()),c.setAttribute("stroke",r[t].solid),c.setAttribute("fill","none");const u=mr({d:l,fill:e,color:t,theme:r});return uo(c,u)}b.memo(function({id:t,w:n,h:r,strokeWidth:o,fill:s,color:i}){const a=Nt(),l=Kb(t,n,r,o),c=IO(t,n,r,o);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:a,d:l,color:i,fill:s}),p.jsx("path",{d:c,fill:a[i].solid,strokeWidth:0,pointerEvents:"all"})]})});function Cne({id:e,w:t,h:n,strokeWidth:r,fill:o,color:s,theme:i}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",IO(e,t,n,r)),a.setAttribute("fill",i[s].solid);const l=mr({d:Kb(e,t,n,r),fill:o,color:s,theme:i});return uo(a,l)}function kO(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function EO(e,t,n,r){const o=ci(e),s=t/2,i=n/2,a=cd(s,i),l=[],c=Ue*o(),u=Ue+Ze/2+Math.abs(o())*Ze,d=Math.max(16,a/10);for(let h=0;h<d;h++){const f=h/(d-1),y=c+f*u,g=Math.cos(y),m=Math.sin(y);l.push(new E(s*g+t*.5+.05*o(),i*m+n/2+.05*o(),Math.min(1,.5+Math.abs(.5-(o()>0?dn.easeInOutSine(f):dn.easeInExpo(f)))/2)))}return Zr(l,kO(r))}function IO(e,t,n,r){const o=kO(r);return Fd(Yd(Ec(EO(e,t,n,r),o),o))}function Kb(e,t,n,r){return ei(EO(e,t,n,r))}const Pne=b.memo(function({id:t,outline:n,lines:r,fill:o,color:s,strokeWidth:i}){const a=Nt(),l=md(t,n,i/3,i*2,2);let c=gd(l);if(r)for(const[h,f]of r)c+=`M${h.x},${h.y}L${f.x},${f.y}`;const u=md(t,n,0,i*2,1),d=gd(u);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{d,fill:o,color:s,theme:a}),p.jsx("path",{d:c,stroke:a[s].solid,strokeWidth:i,fill:"none"})]})});function kne({id:e,outline:t,lines:n,fill:r,color:o,theme:s,strokeWidth:i}){const a=md(e,t,i/3,i*2,2);let l=gd(a);if(n)for(const[f,y]of n)l+=`M${f.x},${f.y}L${y.x},${y.y}`;const c=md(e,t,0,i*2,1),u=gd(c),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",l),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid),d.setAttribute("stroke-width",i.toString());const h=mr({d:u,fill:r,color:o,theme:s});return uo(d,h)}const Ene=b.memo(function({fill:t,color:n,strokeWidth:r,w:o,h:s,id:i,size:a}){const l=Nt(),c=Qd(o,s,i,a);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{theme:l,d:c,fill:t,color:n}),p.jsx("path",{d:c,stroke:l[n].solid,strokeWidth:r,fill:"none"})]})});function Ine({fill:e,color:t,strokeWidth:n,theme:r,w:o,h:s,id:i,size:a}){const l=Qd(o,s,i,a),c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",n.toString()),c.setAttribute("stroke",r[t].solid),c.setAttribute("fill","none");const u=mr({d:l,fill:e,color:t,theme:r});return uo(c,u)}const l2=b.memo(function({w:t,h:n,strokeWidth:r,fill:o,color:s}){const i=Nt(),a=t/2,l=n/2,c=Math.max(0,a),u=Math.max(0,l),d=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`;return p.jsxs(p.Fragment,{children:[p.jsx(bt,{d,color:s,fill:o,theme:i}),p.jsx("path",{d,stroke:i[s].solid,strokeWidth:r,fill:"none"})]})});function _ne({w:e,h:t,strokeWidth:n,fill:r,color:o,theme:s}){const i=e/2,a=t/2,l=Math.max(0,i),c=Math.max(0,a),u=`M${i-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",u),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",s[o].solid);const h=mr({d:u,fill:r,color:o,theme:s});return uo(d,h)}const c2=b.memo(function({w:t,h:n,strokeWidth:r,fill:o,color:s}){const i=Nt(),a=Wb(t,n);return p.jsxs(p.Fragment,{children:[p.jsx(bt,{d:a,color:s,fill:o,theme:i}),p.jsx("path",{d:a,stroke:i[s].solid,strokeWidth:r,fill:"none"})]})});function Tne({w:e,h:t,strokeWidth:n,fill:r,color:o,theme:s}){const i=Wb(e,t),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",i),a.setAttribute("stroke-width",n.toString()),a.setAttribute("width",e.toString()),a.setAttribute("height",t.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",s[o].solid);const l=mr({d:i,fill:r,color:o,theme:s});return uo(a,l)}function Wb(e,t){let n;if(t>e){const r=e/2;n=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${t-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=t/2;n=`
    M${r},0
    L${e-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${t}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return n}const Mne=b.memo(function({outline:t,lines:n,fill:r,color:o,strokeWidth:s}){const i=Nt();let a="M"+t[0]+"L"+t.slice(1)+"Z";if(n)for(const[l,c]of n)a+=`M${l.x},${l.y}L${c.x},${c.y}`;return p.jsxs(p.Fragment,{children:[p.jsx(bt,{d:a,fill:r,color:o,theme:i}),p.jsx("path",{d:a,stroke:i[o].solid,strokeWidth:s,fill:"none"})]})});function Ane({outline:e,lines:t,fill:n,color:r,strokeWidth:o,theme:s}){const i="M"+e[0]+"L"+e.slice(1)+"Z",a=i;let l=i;if(t)for(const[d,h]of t)l+=`M${d.x},${d.y}L${h.x},${h.y}`;const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",o.toString()),c.setAttribute("stroke",s[r].solid),c.setAttribute("fill","none");const u=mr({d:a,fill:n,color:r,theme:s});return uo(c,u)}const Lv=16,wr=17*3;class sf extends wc{constructor(){super(...arguments);S(this,"canEdit",()=>!0);S(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:s}}=n;s.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])});S(this,"onResize",(n,{handle:r,newPoint:o,scaleX:s,scaleY:i,initialShape:a})=>{let l=a.props.w*s,c=(a.props.h+a.props.growY)*i,u=0,d=0;if(n.props.text.trim()){let g=Math.max(Math.abs(l),wr),m=Math.max(Math.abs(c),wr);g<wr&&m===wr&&(g=wr),g===wr&&m<wr&&(m=wr);const v=lp(this.editor,{...n,props:{...n.props,w:g,h:m}}),x=Math.max(Math.abs(l),v.w)*Math.sign(l),w=Math.max(Math.abs(c),v.h)*Math.sign(c);u=Math.abs(x)-Math.abs(l),d=Math.abs(w)-Math.abs(c),l=x,c=w}const h=new E(0,0);s<0&&(h.x+=l),(r==="left"||r==="top_left"||r==="bottom_left")&&(h.x+=s<0?u:-u),i<0&&(h.y+=c),(r==="top"||r==="top_left"||r==="top_right")&&(h.y+=i<0?d:-d);const{x:f,y}=h.rot(n.rotation).add(o);return{x:f,y,props:{w:Math.max(Math.abs(l),1),h:Math.max(Math.abs(c),1),growY:0}}});S(this,"onBeforeCreate",n=>{if(!n.props.text)return n.props.growY?{...n,props:{...n.props,growY:0}}:void 0;const r=n.props.h,o=lp(this.editor,n).h;let s=null;if(o>r?s=o-r:n.props.growY&&(s=0),s!==null)return{...n,props:{...n.props,growY:s}}});S(this,"onBeforeUpdate",(n,r)=>{const o=n.props.text,s=r.props.text;if(o===s&&n.props.font===r.props.font&&n.props.size===r.props.size)return;if(o&&!s)return{...r,props:{...r.props,growY:0}};const i=n.props.w,a=n.props.h,l=lp(this.editor,r),c=l.w,u=l.h;if(!o&&s&&s.length===1){let h=Math.max(i,c),f=Math.max(a,u);return n.props.w<wr&&n.props.h<wr&&(h=Math.max(h,wr),f=Math.max(f,wr),h=Math.max(h,f),f=Math.max(h,f)),{...r,props:{...r.props,w:h,h:f,growY:0}}}let d=null;if(u>a?d=u-a:n.props.growY&&(d=0),d!==null)return{...r,props:{...r.props,growY:d,w:Math.max(r.props.w,c)}};if(c>n.props.w)return{...r,props:{...r.props,w:c}}});S(this,"onDoubleClick",n=>{if(this.editor.inputs.altKey)switch(n.props.geo){case"rectangle":return{...n,props:{geo:"check-box"}};case"check-box":return{...n,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(n){const r=Math.max(1,n.props.w),o=Math.max(1,n.props.h+n.props.growY),s=r/2,i=o/2,a=un[n.props.size],l=n.props.fill!=="none";let c;switch(n.props.geo){case"cloud":{c=new Mt({points:hne(r,o,n.id,n.props.size),isFilled:l});break}case"triangle":{c=new Mt({points:[new E(s,0),new E(r,o),new E(0,o)],isFilled:l});break}case"diamond":{c=new Mt({points:[new E(s,0),new E(r,i),new E(s,o),new E(0,i)],isFilled:l});break}case"pentagon":{c=new Mt({points:Gy(r,o,5),isFilled:l});break}case"hexagon":{c=new Mt({points:Gy(r,o,6),isFilled:l});break}case"octagon":{c=new Mt({points:Gy(r,o,8),isFilled:l});break}case"ellipse":{c=new uR({width:r,height:o,isFilled:l});break}case"oval":{c=new OG({width:r,height:o,isFilled:l});break}case"star":{const m=Ue/5/2,v=Math.floor(5/4)*2,x=5*2-v,w=0,C=Math.floor(5/2)*2,P=Math.cos(-Ze+v*m)*r/2,k=Math.cos(-Ze+x*m)*r/2,I=Math.sin(-Ze+w*m)*o/2,_=Math.sin(-Ze+C*m)*o/2,M=r-Math.abs(P-k),T=o-Math.abs(_-I),R=r/2+k-(r/2-P),j=o/2+I-(o/2-_),$=1,L=(r-R)/2,U=(o-j)/2,F=(r+M)/2,G=(o+T)/2,D=F*$/2,z=G*$/2;c=new Mt({points:Array.from(Array(5*2)).map((V,K)=>{const J=-Ze+K*m;return new E(L+(K%2?D:F)*Math.cos(J),U+(K%2?z:G)*Math.sin(J))}),isFilled:l});break}case"rhombus":{const g=Math.min(r*.38,o*.38);c=new Mt({points:[new E(g,0),new E(r,0),new E(r-g,o),new E(0,o)],isFilled:l});break}case"rhombus-2":{const g=Math.min(r*.38,o*.38);c=new Mt({points:[new E(0,0),new E(r-g,0),new E(r,o),new E(g,o)],isFilled:l});break}case"trapezoid":{const g=Math.min(r*.38,o*.38);c=new Mt({points:[new E(g,0),new E(r-g,0),new E(r,o),new E(0,o)],isFilled:l});break}case"arrow-right":{const g=Math.min(r,o)*.38,m=o*.16;c=new Mt({points:[new E(0,m),new E(r-g,m),new E(r-g,0),new E(r,o/2),new E(r-g,o),new E(r-g,o-m),new E(0,o-m)],isFilled:l});break}case"arrow-left":{const g=Math.min(r,o)*.38,m=o*.16;c=new Mt({points:[new E(g,0),new E(g,m),new E(r,m),new E(r,o-m),new E(g,o-m),new E(g,o),new E(0,o/2)],isFilled:l});break}case"arrow-up":{const g=r*.16,m=Math.min(r,o)*.38;c=new Mt({points:[new E(r/2,0),new E(r,m),new E(r-g,m),new E(r-g,o),new E(g,o),new E(g,m),new E(0,m)],isFilled:l});break}case"arrow-down":{const g=r*.16,m=Math.min(r,o)*.38;c=new Mt({points:[new E(g,0),new E(r-g,0),new E(r-g,o-m),new E(r,o-m),new E(r/2,o),new E(0,o-m),new E(g,o-m)],isFilled:l});break}case"check-box":case"x-box":case"rectangle":{c=new xi({width:r,height:o,isFilled:l,isSnappable:!0});break}}const u=lp(this.editor,n),d=Math.min(r,Math.max(u.w,Math.min(32,Math.max(1,r-8)))),h=Math.min(o,Math.max(u.h,Math.min(32,Math.max(1,r-8)))),f=cp(n.props,a),y=f?f.map(g=>new Pa({points:g})):[];return new Qs({children:[c,new xi({x:n.props.align==="start"?0:n.props.align==="end"?r-d:(r-d)/2,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?o-h:(o-h)/2,width:d,height:h,isFilled:!0,isSnappable:!1,isLabel:!0}),...y],isSnappable:!1})}component(n){const{id:r,type:o,props:s}=n,i=un[s.size],{w:a,color:l,labelColor:c,fill:u,dash:d,growY:h,font:f,align:y,verticalAlign:g,size:m,text:v}=s,x=()=>{const w=s.h+h;switch(s.geo){case"cloud":{if(d==="solid")return p.jsx(Ene,{color:l,fill:u,strokeWidth:i,w:a,h:w,id:r,size:m});if(d==="dashed"||d==="dotted")return p.jsx(fne,{color:l,fill:u,strokeWidth:i,w:a,h:w,id:r,size:m,dash:d});if(d==="draw")return p.jsx(wne,{color:l,fill:u,strokeWidth:i,w:a,h:w,id:r,size:m});break}case"ellipse":{if(d==="solid")return p.jsx(l2,{strokeWidth:i,w:a,h:w,color:l,fill:u});if(d==="dashed"||d==="dotted")return p.jsx(mne,{id:r,strokeWidth:i,w:a,h:w,dash:d,color:l,fill:u});if(d==="draw")return p.jsx(l2,{strokeWidth:i,w:a,h:w,color:l,fill:u});break}case"oval":{if(d==="solid")return p.jsx(c2,{strokeWidth:i,w:a,h:w,color:l,fill:u});if(d==="dashed"||d==="dotted")return p.jsx(vne,{id:r,strokeWidth:i,w:a,h:w,dash:d,color:l,fill:u});if(d==="draw")return p.jsx(c2,{strokeWidth:i,w:a,h:w,color:l,fill:u});break}default:{const C=this.editor.getShapeGeometry(n),P=C instanceof Qs?C.children[0].vertices:C.vertices,k=cp(n.props,i);if(d==="solid")return p.jsx(Mne,{fill:u,color:l,strokeWidth:i,outline:P,lines:k});if(d==="dashed"||d==="dotted")return p.jsx(Sne,{dash:d,fill:u,color:l,strokeWidth:i,outline:P,lines:k});if(d==="draw")return p.jsx(Pne,{id:r,fill:u,color:l,strokeWidth:i,outline:P,lines:k})}}};return p.jsxs(p.Fragment,{children:[p.jsx(rr,{id:r,children:x()}),p.jsxs(va,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h+s.growY},children:[p.jsx(yO,{id:r,type:o,font:f,fill:u,size:m,align:y,verticalAlign:g,text:v,labelColor:c,wrap:!0,bounds:s.geo==="cloud"?this.getGeometry(n).bounds:void 0}),n.props.url&&p.jsx(Xd,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})]})}indicator(n){const{id:r,props:o}=n,{w:s,size:i}=o,a=o.h+o.growY,l=un[i];switch(o.geo){case"ellipse":return o.dash==="draw"?p.jsx("path",{d:Kb(r,s,a,l)}):p.jsx("ellipse",{cx:s/2,cy:a/2,rx:s/2,ry:a/2});case"oval":return p.jsx("path",{d:Wb(s,a)});case"cloud":return p.jsx("path",{d:Qd(s,a,r,i)});default:{const c=this.editor.getShapeGeometry(n),u=c instanceof Qs?c.children[0].vertices:c.vertices;let d;if(o.dash==="draw"){const f=md(r,u,0,l*2,1);d=gd(f)}else d="M"+u[0]+"L"+u.slice(1)+"Z";const h=cp(n.props,l);if(h)for(const[f,y]of h)d+=`M${f.x},${f.y}L${y.x},${y.y}`;return p.jsx("path",{d})}}}toSvg(n,r){const{id:o,props:s}=n,i=un[s.size],a=Wn({isDarkMode:this.editor.user.getIsDarkMode()});r.addExportDef(Bb(n.props.fill,a));let l;switch(s.geo){case"ellipse":{switch(s.dash){case"draw":l=Cne({id:o,w:s.w,h:s.h,color:s.color,fill:s.fill,strokeWidth:i,theme:a});break;case"solid":l=_ne({strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,theme:a});break;default:l=yne({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a});break}break}case"oval":{switch(s.dash){case"draw":l=a2({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a});break;case"solid":l=Tne({strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,theme:a});break;default:l=a2({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a})}break}case"cloud":{switch(s.dash){case"draw":l=bne({id:o,strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,size:s.size,theme:a});break;case"solid":l=Ine({strokeWidth:i,w:s.w,h:s.h,color:s.color,fill:s.fill,size:s.size,id:o,theme:a});break;default:l=gne({id:o,strokeWidth:i,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,theme:a,size:s.size})}break}default:{const c=this.editor.getShapeGeometry(n),u=c instanceof Qs?c.children[0].vertices:c.vertices,d=cp(n.props,i);switch(s.dash){case"draw":l=kne({id:o,fill:s.fill,color:s.color,strokeWidth:i,outline:u,lines:d,theme:a});break;case"solid":l=Ane({fill:s.fill,color:s.color,strokeWidth:i,outline:u,lines:d,theme:a});break;default:l=xne({dash:s.dash,fill:s.fill,color:s.color,strokeWidth:i,outline:u,lines:d,theme:a});break}break}}if(s.text){const c=this.editor.getShapeGeometry(n).bounds;r.addExportDef(Dm(n.props.font));const u=vO({editor:this.editor,shape:n,font:Dd[n.props.font],bounds:c}),d=u.cloneNode(!0);d.setAttribute("fill",a[n.props.labelColor].solid),d.setAttribute("stroke","none");const h=u.cloneNode(!0);h.setAttribute("stroke-width","2"),h.setAttribute("fill",a.background),h.setAttribute("stroke",a.background);const f=document.createElementNS("http://www.w3.org/2000/svg","g");if(f.append(h),f.append(d),l.nodeName==="g")return l.appendChild(f),l;{const y=document.createElementNS("http://www.w3.org/2000/svg","g");return y.appendChild(l),y.appendChild(f),y}}return l}getCanvasSvgDefs(){return[Ub()]}}S(sf,"type","geo"),S(sf,"props",K7),S(sf,"migrations",W7);function lp(e,t){const n=t.props.text;if(!n)return{w:0,h:0};const r=e.textMeasure.measureText("w",{...Gt,fontFamily:ls[t.props.font],fontSize:rc[t.props.size],maxWidth:100}),o={s:2,m:3.5,l:5,xl:10},s=e.textMeasure.measureText(n,{...Gt,fontFamily:ls[t.props.font],fontSize:rc[t.props.size],minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+o[t.props.size]),Math.ceil(t.props.w-Lv*2))});return{w:s.w+Lv*2,h:s.h+Lv*2}}function cp(e,t){switch(e.geo){case"x-box":return Rne(e.w,e.h,t,e.dash);case"check-box":return One(e.w,e.h);default:return}}function Rne(e,t,n,r){const o=r==="draw"?.62:0;if(r==="dashed")return[[new E(0,0),new E(e/2,t/2)],[new E(e,t),new E(e/2,t/2)],[new E(0,t),new E(e/2,t/2)],[new E(e,0),new E(e/2,t/2)]];const s=a=>Math.max(0,Math.min(e,a)),i=a=>Math.max(0,Math.min(t,a));return[[new E(s(n*o),i(n*o)),new E(s(e-n*o),i(t-n*o))],[new E(s(n*o),i(t-n*o)),new E(s(e-n*o),i(n*o))]]}function One(e,t){const n=Math.min(e,t)*.82,r=(e-n)/2,o=(t-n)/2,s=a=>Math.max(0,Math.min(e,a)),i=a=>Math.max(0,Math.min(t,a));return[[new E(s(r+n*.25),i(o+n*.52)),new E(s(r+n*.45),i(o+n*.82))],[new E(s(r+n*.45),i(o+n*.82)),new E(s(r+n*.82),i(o+n*.22))]]}function jne(){const[e,t]=b.useState(!1);return b.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),o=matchMedia("(color-gamut: p3)");t(r&&o.matches);const s=()=>t(r&&o.matches);return o.addEventListener("change",s),()=>o.removeEventListener("change",s)},[]),q(qe.forceSrgb)||!e?"srgb":"p3"}const u2=.35,d2=.82;class af extends so{constructor(){super(...arguments);S(this,"hideResizeHandles",n=>up(n));S(this,"hideRotateHandle",n=>up(n));S(this,"hideSelectionBoundsFg",n=>up(n));S(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:s}=r,i=[];for(const a of n.props.segments)i.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:o*l,y:s*c,z:u}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(n){const r=Ya(n);if(up(n))return new cR({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:o,sw:s}=_O(n,r,!0),i=lx({strokeWidth:s,showAsComplete:!0});return Ec(o,i),new Mt({points:Yd(o,i),isFilled:!0})}component(n){return p.jsx(h2,{strokeWidth:Ya(n),shape:n,opacity:u2})}backgroundComponent(n){return p.jsx(h2,{strokeWidth:Ya(n),shape:n,opacity:d2})}indicator(n){var d;const r=Rg(),o=Ya(n),s=Sl(n.props.segments);let i=o;!r&&!n.props.isPen&&s.length===1&&(i+=ci(n.id)()*(o/6));const a=n.props.isComplete||((d=Dn(n.props.segments))==null?void 0:d.type)==="straight",l=lx({strokeWidth:o,showAsComplete:a}),c=Zr(s,l);let u;return c.length<2?u=Nne(s[0],i):u=ei(c,!1),p.jsx("path",{d:u})}toSvg(n){const r=Wn({isDarkMode:this.editor.user.getIsDarkMode()});return p2(Ya(n),n,u2,r)}toBackgroundSvg(n){const r=Wn({isDarkMode:this.editor.user.getIsDarkMode()});return p2(Ya(n),n,d2,r)}}S(af,"type","highlight"),S(af,"props",X7),S(af,"migrations",q7);function Dne(e){return`M ${e.x} ${e.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function Nne(e,t){const n=t/2;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function _O(e,t,n){var l;const r=Sl(e.props.segments),o=e.props.isComplete||((l=Dn(e.props.segments))==null?void 0:l.type)==="straight";let s=t;!n&&!e.props.isPen&&r.length===1&&(s+=ci(e.id)()*(t/6));const i=lx({strokeWidth:s,showAsComplete:o});return{strokePoints:Zr(r,i),sw:s}}function TO(e,t,n){const{strokePoints:r,sw:o}=_O(e,t,n);return{solidStrokePath:r.length>1?ei(r,!1):Dne(e.props.segments[0].points[0]),sw:o}}function h2({strokeWidth:e,shape:t,opacity:n}){const r=Nt(),o=Rg(),{solidStrokePath:s,sw:i}=TO(t,e,o),a=jne(),l=r[t.props.color].highlight[a];return p.jsx(rr,{id:t.id,style:{opacity:n},children:p.jsx("path",{d:s,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:l,strokeWidth:i})})}function p2(e,t,n,r){const{solidStrokePath:o,sw:s}=TO(t,e,!1),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",o),i.setAttribute("fill","none"),i.setAttribute("stroke",r[t.props.color].highlight.srgb),i.setAttribute("stroke-width",`${s}`),i.setAttribute("opacity",`${n}`),i}function Ya(e){return Js[e.props.size]*1.12}function up(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}function MO(){const[e,t]=b.useState(!1);return b.useEffect(()=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{t(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),e}const $ne=async e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>n(new Error("Failed to load image")),r.crossOrigin="anonymous",r.src=e}),Lne=async e=>{const t=await $ne(e),n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");if(r)return r.drawImage(t,0,0),n.toDataURL()};async function Fne(e){const n=await(await fetch(e)).blob();return new Promise((r,o)=>{const s=new FileReader;s.onloadend=()=>r(s.result),s.onerror=o,s.readAsDataURL(n)})}class lf extends wc{constructor(){super(...arguments);S(this,"isAspectRatioLocked",()=>!0);S(this,"canCrop",()=>!0);S(this,"onDoubleClick",n=>{const r=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.editor.updateShapes([{type:"image",id:n.id,props:{playing:!n.props.playing}}])});S(this,"onDoubleClickEdge",n=>{const r=n.props;if(!r||this.editor.getCroppingShapeId()!==n.id)return;const o=hn(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},s=1/(o.bottomRight.x-o.topLeft.x)*n.props.w,i=1/(o.bottomRight.y-o.topLeft.y)*n.props.h,a=new E(o.topLeft.x*s,o.topLeft.y*i).rot(n.rotation),l={id:n.id,type:n.type,x:n.x-a.x,y:n.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:s,h:i}};this.editor.updateShapes([l])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(n){var h,f;const r=f2(n),o=qk(n.id),s=MO(),[i,a]=b.useState(""),l=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0;if((l==null?void 0:l.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const u=q("onlySelectedShape",()=>{var y;return n.id===((y=this.editor.getOnlySelectedShape())==null?void 0:y.id)},[this.editor])&&o&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),d=s&&(((h=l==null?void 0:l.props.mimeType)==null?void 0:h.includes("video"))||((f=l==null?void 0:l.props.mimeType)==null?void 0:f.includes("gif")));return b.useEffect(()=>{if(l!=null&&l.props.src&&"mimeType"in l.props&&(l==null?void 0:l.props.mimeType)==="image/gif"){let y=!1;return(async()=>{const m=await Lne(l.props.src);y||m&&a(m)})(),()=>{y=!0}}},[s,l==null?void 0:l.props]),p.jsxs(p.Fragment,{children:[(l==null?void 0:l.props.src)&&u&&p.jsx("div",{style:r,children:p.jsx("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!n.props.playing||d?i:l.props.src})`},draggable:!1})}),p.jsxs(va,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h},children:[p.jsxs("div",{className:"tl-image-container",style:r,children:[l!=null&&l.props.src?p.jsx("div",{className:"tl-image",style:{backgroundImage:`url(${!n.props.playing||d?i:l.props.src})`},draggable:!1}):null,(l==null?void 0:l.props.isAnimated)&&!n.props.playing&&p.jsx("div",{className:"tl-image__tg",children:"GIF"})]}),"url"in n.props&&n.props.url&&p.jsx(Xd,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})]})}indicator(n){return qk(n.id)?null:p.jsx("rect",{width:O(n.props.w),height:O(n.props.h)})}async toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=n.props.assetId?this.editor.getAsset(n.props.assetId):null;let s=(o==null?void 0:o.props.src)||"";s&&s.startsWith("http")&&(s=await Fne(s)||"");const i=document.createElementNS("http://www.w3.org/2000/svg","image");i.setAttributeNS("http://www.w3.org/1999/xlink","href",s);const a=f2(n),l=n.props.crop;if(a.transform&&l){const{transform:c,width:u,height:d}=a,h=(l.bottomRight.x-l.topLeft.x)*u,f=(l.bottomRight.y-l.topLeft.y)*d,y=[new E(0,0),new E(h,0),new E(h,f),new E(0,f)],g=document.createElementNS("http://www.w3.org/2000/svg","polygon");g.setAttribute("points",y.map(w=>`${w.x},${w.y}`).join(" "));const m=document.createElementNS("http://www.w3.org/2000/svg","clipPath");m.setAttribute("id","cropClipPath"),m.appendChild(g);const v=document.createElementNS("http://www.w3.org/2000/svg","defs");v.appendChild(m),r.appendChild(v);const x=document.createElementNS("http://www.w3.org/2000/svg","g");x.setAttribute("clip-path","url(#cropClipPath)"),i.setAttribute("width",u.toString()),i.setAttribute("height",d.toString()),i.style.transform=c,x.appendChild(i),r.appendChild(x)}else i.setAttribute("width",n.props.w.toString()),i.setAttribute("height",n.props.h.toString()),r.appendChild(i);return r}}S(lf,"type","image"),S(lf,"props",Z7),S(lf,"migrations",J7);function f2(e){const t=e.props.crop,n=t==null?void 0:t.topLeft;if(!n)return{width:e.props.w,height:e.props.h};const r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,o=1/(t.bottomRight.y-t.topLeft.y)*e.props.h,s=-n.x*r,i=-n.y*o;return{transform:`translate(${s}px, ${i}px)`,width:r,height:o}}function cx(e,t){const{start:n,end:r}=e;return t?`M${O(n.x)},${O(n.y)} L${O(r.x)},${O(r.y)} `:`${O(r.x)},${O(r.y)} `}function ux(e,t){const{a:n,b:r,c:o,d:s}=e;return E.Equals(n,s)?"":`${t?`M${O(n.x)},${O(n.y)}`:""}C${O(r.x)},${O(r.y)} ${O(o.x)},${O(o.y)} ${O(s.x)},${O(s.y)}`}function AO(e,t){let n=e.segments.reduce((r,o,s)=>r+ux(o,s===0),"");return t&&(n+="Z"),n}function zne(e,t){let n=e.segments.reduce((r,o,s)=>r+cx(o,s===0),"");return t&&(n+="Z"),n}function RO(e,t=!1){return e instanceof Pa?zne(e,t):AO(e,t)}function OO(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function jO(e,t,n){const r=t.vertices,o=OO(n);return Zr(r,o)}function Bne(e,t,n){const r=OO(n);return Yd(Ec(jO(e,t,n),r),r)}function g2(e,t,n){const r=Bne(e,t,n);return Fd(r)}function Une(e,t,n){if(e.props.dash==="draw"){const r=jO(e,t,n);return ei(r)}return RO(t)}const Hne=new pb;class cf extends so{constructor(){super(...arguments);S(this,"hideResizeHandles",()=>!0);S(this,"hideRotateHandle",()=>!0);S(this,"hideSelectionBoundsFg",()=>!0);S(this,"hideSelectionBoundsBg",()=>!0);S(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:s}=r,i=hn(n.props.handles);return Object.values(n.props.handles).forEach(({id:a,x:l,y:c})=>{i[a].x=l*o,i[a].y=c*s}),{props:{handles:i}}});S(this,"onHandleChange",(n,{handle:r})=>{const o=hn(n);switch(r.id){case"start":case"end":{o.props.handles[r.id]={...o.props.handles[r.id],x:r.x,y:r.y};break}default:{const s="handle:"+r.index,i=n.props.handles[s];i?o.props.handles[s]={...i,x:r.x,y:r.y}:o.props.handles[s]={id:s,type:"vertex",canBind:!1,index:r.index,x:r.x,y:r.y};break}}return o})}getDefaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,canSnap:!0,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,canSnap:!0,index:"a2",x:.1,y:.1}}}}getGeometry(n){return tu(n)}getHandles(n){return Hne.get(n.props,()=>{const r=n.props.handles,o=tu(n),s=Object.values(r).sort(ln),i=s.slice();for(let a=0;a<o.segments.length;a++){const c=o.segments[a].midPoint(),u=Au(s[a].index,s[a+1].index);i.push({id:`mid-${a}`,type:"create",index:u,x:c.x,y:c.y})}return i.sort(ln)})}getOutlineSegments(n){return this.editor.getShapeGeometry(n).segments.map(o=>o.vertices)}component(n){const r=Nt(),o=tu(n),s=un[n.props.size],{dash:i,color:a}=n.props;if(n.props.spline==="line"){if(i==="solid"){const l=o.points,c="M"+l[0]+"L"+l.slice(1);return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:c,fill:"none",color:a,theme:r}),p.jsx("path",{d:c,stroke:r[a].solid,strokeWidth:s,fill:"none"})]})}if(i==="dashed"||i==="dotted"){const l=o.points,c="M"+l[0]+"L"+l.slice(1);return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:c,fill:"none",color:a,theme:r}),p.jsx("g",{stroke:r[a].solid,strokeWidth:s,children:o.segments.map((u,d)=>{const{strokeDasharray:h,strokeDashoffset:f}=pn(u.length,s,{style:i,start:d>0?"outset":"none",end:d<o.segments.length-1?"outset":"none"});return p.jsx("path",{strokeDasharray:h,strokeDashoffset:f,d:cx(u,!0),fill:"none"},d)})})]})}if(i==="draw"){const l=o.points,[c,u]=$v(n.id,l,s);return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:c,fill:"none",color:a,theme:r}),p.jsx("path",{d:u,stroke:r[a].solid,strokeWidth:s,fill:"none"})]})}}if(n.props.spline==="cubic"){const l=RO(o);if(i==="solid")return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:l,fill:"none",color:a,theme:r}),p.jsx("path",{strokeWidth:s,stroke:r[a].solid,fill:"none",d:l})]});if(i==="dashed"||i==="dotted")return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:l,fill:"none",color:a,theme:r}),p.jsx("g",{stroke:r[a].solid,strokeWidth:s,children:o.segments.map((c,u)=>{const{strokeDasharray:d,strokeDashoffset:h}=pn(c.length,s,{style:i,start:u>0?"outset":"none",end:u<o.segments.length-1?"outset":"none"});return p.jsx("path",{strokeDasharray:d,strokeDashoffset:h,d:ux(c,!0),fill:"none"},u)})})]});if(i==="draw")return p.jsxs(rr,{id:n.id,children:[p.jsx(bt,{d:l,fill:"none",color:a,theme:r}),p.jsx("path",{d:g2(n,o,s),strokeWidth:1,stroke:r[a].solid,fill:r[a].solid})]})}}indicator(n){const r=un[n.props.size],o=tu(n),{dash:s}=n.props;let i;if(n.props.spline==="line"){const a=o.points;if(s==="solid"||s==="dotted"||s==="dashed")i="M"+a[0]+"L"+a.slice(1);else{const[l]=$v(n.id,a,r);i=l}}else i=Une(n,o,r);return p.jsx("path",{d:i})}toSvg(n){const o=Wn({isDarkMode:this.editor.user.getIsDarkMode()})[n.props.color].solid,s=tu(n),i=un[n.props.size];switch(n.props.dash){case"draw":{let a;if(s instanceof Hp)a=g2(n,s,i);else{const[c,u]=$v(n.id,s.points,i);a=u}const l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("stroke-width",i+"px"),l.setAttribute("stroke",o),l.setAttribute("fill","none"),l.setAttribute("d",a),l}case"solid":{let a;if(s instanceof Hp)a=AO(s,!1);else{const c=s.points;a="M"+c[0]+"L"+c.slice(1)}const l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("stroke-width",i+"px"),l.setAttribute("stroke",o),l.setAttribute("fill","none"),l.setAttribute("d",a),l}default:{const{segments:a}=s,l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("stroke",o),l.setAttribute("stroke-width",i.toString());const c=s instanceof Hp?ux:cx;return a.forEach((u,d)=>{const h=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:f,strokeDashoffset:y}=pn(u.length,i,{style:n.props.dash,start:d>0?"outset":"none",end:d<a.length-1?"outset":"none"});h.setAttribute("stroke-dasharray",f.toString()),h.setAttribute("stroke-dashoffset",y.toString()),h.setAttribute("d",c(u,!0)),h.setAttribute("fill","none"),l.appendChild(h)}),l}}}}S(cf,"type","line"),S(cf,"props",nB),S(cf,"migrations",rB);function tu(e){const{spline:t,handles:n}=e.props,r=Object.values(n).sort(ln).map(E.From);switch(t){case"cubic":return new Hp({points:r});case"line":return new Pa({points:r})}}const Jo=200;class uf extends so{constructor(){super(...arguments);S(this,"canEdit",()=>!0);S(this,"hideResizeHandles",()=>!0);S(this,"hideSelectionBoundsFg",()=>!0);S(this,"onBeforeCreate",n=>m2(this.editor,n,n.props.growY));S(this,"onBeforeUpdate",(n,r)=>{if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return m2(this.editor,r,n.props.growY)});S(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:s}}=n;s.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(n){return Jo+n.props.growY}getGeometry(n){const r=this.getHeight(n);return new xi({width:Jo,height:r,isFilled:!0})}component(n){const{id:r,type:o,props:{color:s,font:i,size:a,align:l,text:c,verticalAlign:u}}=n,d=Nt(),h=s==="black"?"yellow":s;return p.jsxs(p.Fragment,{children:[p.jsx("div",{style:{position:"absolute",width:Jo,height:this.getHeight(n)},children:p.jsxs("div",{className:"tl-note__container",style:{color:d[h].solid,backgroundColor:d[h].solid},children:[p.jsx("div",{className:"tl-note__scrim"}),p.jsx(yO,{id:r,type:o,font:i,size:a,align:l,verticalAlign:u,text:c,labelColor:"black",wrap:!0})]})}),"url"in n.props&&n.props.url&&p.jsx(Xd,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){return p.jsx("rect",{rx:"7",width:O(Jo),height:O(this.getHeight(n))})}toSvg(n,r){r.addExportDef(Dm(n.props.font));const o=Wn({isDarkMode:this.editor.user.getIsDarkMode()}),s=this.editor.getShapeGeometry(n).bounds,i=document.createElementNS("http://www.w3.org/2000/svg","g"),a=n.props.color==="black"?"yellow":n.props.color,l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx","10"),l.setAttribute("width",Jo.toString()),l.setAttribute("height",s.height.toString()),l.setAttribute("fill",o[a].solid),l.setAttribute("stroke",o[a].solid),l.setAttribute("stroke-width","1"),i.appendChild(l);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("rx","10"),c.setAttribute("width",Jo.toString()),c.setAttribute("height",s.height.toString()),c.setAttribute("fill",o.background),c.setAttribute("opacity",".28"),i.appendChild(c);const u=vO({editor:this.editor,shape:n,font:Dd[n.props.font],bounds:s});return u.setAttribute("fill",o.text),u.setAttribute("stroke","none"),i.appendChild(u),i}}S(uf,"type","note"),S(uf,"props",oB),S(uf,"migrations",sB);function m2(e,t,n=0){const s=e.textMeasure.measureText(t.props.text,{...Gt,fontFamily:ls[t.props.font],fontSize:rc[t.props.size],maxWidth:Jo-34}).h+17*2;let i=null;if(s>Jo?i=s-Jo:n&&(i=0),i!==null)return{...t,props:{...t.props,growY:i}}}function Vne(e,{initialBounds:t,scaleX:n,scaleY:r,newPoint:o}){const s=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),i=new E(0,0);n<0&&(i.x=-(t.width*s)),r<0&&(i.y=-(t.height*s));const{x:a,y:l}=E.Add(o,i.rot(e.rotation));return{x:a,y:l,props:{scale:s*e.props.scale}}}const Kne=new pb;class df extends so{constructor(){super(...arguments);S(this,"canEdit",()=>!0);S(this,"isAspectRatioLocked",()=>!0);S(this,"onResize",(n,r)=>{const{initialBounds:o,initialShape:s,scaleX:i,handle:a}=r;if(r.mode==="scale_shape"||a!=="right"&&a!=="left")return{id:n.id,type:n.type,...Vne(n,r)};{const l=o.width;let c=l*i;const u=new E(0,0);c=Math.max(1,Math.abs(c)),a==="left"?(u.x=l-c,i<0&&(u.x+=c)):i<0&&(u.x-=c);const{x:d,y:h}=u.rot(n.rotation).add(s);return{id:n.id,type:n.type,x:d,y:h,props:{w:c/s.props.scale,autoSize:!1}}}});S(this,"onBeforeCreate",n=>{if(!n.props.autoSize||n.props.text.trim())return;const r=this.getMinDimensions(n);return{...n,x:n.x-r.width/2,y:n.y-r.height/2}});S(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:s}}=n,i=n.props.text.trimEnd();i.length===0?this.editor.deleteShapes([n.id]):i!==n.props.text&&this.editor.updateShapes([{id:r,type:o,props:{text:s.trimEnd()}}])});S(this,"onBeforeUpdate",(n,r)=>{if(!r.props.autoSize)return;const o=n.props.size!==r.props.size||n.props.align!==r.props.align||n.props.font!==r.props.font||n.props.scale!==1&&r.props.scale===1,s=n.props.text!==r.props.text;if(!o&&!s)return;const i=this.getMinDimensions(n),a=y2(this.editor,r.props),l=i.width*n.props.scale,c=i.height*n.props.scale,u=a.width*r.props.scale,d=a.height*r.props.scale;let h;switch(r.props.align){case"middle":{h=new E((u-l)/2,s?0:(d-c)/2);break}case"end":{h=new E(u-l,s?0:(d-c)/2);break}default:{if(s)break;h=new E(0,(d-c)/2);break}}if(h){h.rot(r.rotation);const{x:f,y}=r;return{...r,x:f-h.x,y:y-h.y,props:{...r.props,w:u}}}else return{...r,props:{...r.props,w:u}}});S(this,"onDoubleClickEdge",n=>{if(!n.props.autoSize)return{id:n.id,type:n.type,props:{autoSize:!0}};if(n.props.scale!==1)return{id:n.id,type:n.type,props:{scale:1}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(n){return Kne.get(n.props,r=>y2(this.editor,r))}getGeometry(n){const{scale:r}=n.props,{width:o,height:s}=this.getMinDimensions(n);return new xi({width:o*r,height:s*r,isFilled:!0})}component(n){const{id:r,type:o,props:{text:s,color:i}}=n,a=Wn({isDarkMode:this.editor.user.getIsDarkMode()}),{width:l,height:c}=this.getMinDimensions(n),{rInput:u,isEmpty:d,isEditing:h,handleFocus:f,handleChange:y,handleKeyDown:g,handleBlur:m,handleInputPointerDown:v,handleDoubleClick:x}=Hb(r,o,s);return p.jsx(va,{id:n.id,children:p.jsxs("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":n.props.font,"data-align":n.props.align,"data-hastext":!d,"data-isediting":h,"data-textwrap":!0,style:{fontSize:Js[n.props.size],lineHeight:Js[n.props.size]*Gt.lineHeight+"px",transform:`scale(${n.props.scale})`,transformOrigin:"top left",width:Math.max(1,l),height:Math.max(Js[n.props.size]*Gt.lineHeight,c),color:a[i].solid},children:[p.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:s}),h?p.jsx("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:h,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:s,onFocus:f,onChange:y,onKeyDown:g,onBlur:m,onTouchEnd:Ot,onContextMenu:Ot,onPointerDown:v,onDoubleClick:x}):null]})})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds,o=W();return n.props.autoSize&&o.getEditingShapeId()===n.id?null:p.jsx("rect",{width:O(r.width),height:O(r.height)})}toSvg(n,r){r.addExportDef(Dm(n.props.font));const o=Wn({isDarkMode:this.editor.user.getIsDarkMode()}),s=this.editor.getShapeGeometry(n).bounds,i=n.props.text,a=s.width/(n.props.scale??1),l=s.height/(n.props.scale??1),c={fontSize:Js[n.props.size],fontFamily:Dd[n.props.font],textAlign:n.props.align,verticalTextAlign:"middle",width:a,height:l,padding:0,lineHeight:Gt.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},u=o[n.props.color].solid,d=document.createElementNS("http://www.w3.org/2000/svg","g"),h=jm(this.editor,this.editor.textMeasure.measureTextSpans(i,c),{...c,stroke:o.background,strokeWidth:2,fill:o.background,padding:0}),f=h.cloneNode(!0);return f.setAttribute("fill",u),f.setAttribute("stroke","none"),d.append(h),d.append(f),d}}S(df,"type","text"),S(df,"props",iB),S(df,"migrations",aB);function y2(e,t){const{font:n,text:r,autoSize:o,size:s,w:i}=t,a=o?16:Math.max(16,i),l=Js[s],c=o?null:Math.floor(Math.max(a,i)),u=e.textMeasure.measureText(r,{...Gt,fontFamily:ls[n],fontSize:l,maxWidth:c});return o&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(l,u.h)}}class hf extends wc{constructor(){super(...arguments);S(this,"canEdit",()=>!0);S(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(n){return p.jsx(Gne,{shape:n,videoUtil:this})}indicator(n){return p.jsx("rect",{width:O(n.props.w),height:O(n.props.h)})}toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=document.createElementNS("http://www.w3.org/2000/svg","image");return o.setAttributeNS("http://www.w3.org/1999/xlink","href",Wne(n.id)),o.setAttribute("width",n.props.w.toString()),o.setAttribute("height",n.props.h.toString()),r.appendChild(o),r}}S(hf,"type","video"),S(hf,"props",lB),S(hf,"migrations",cB);function Wne(e){const t=e.split(":")[1],n=document.querySelector(`.tl-video-shape-${t}`);if(n){const r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}else throw new Error("Video with id "+t+" not found")}const Gne=Ve(function(t){const{shape:n,videoUtil:r}=t,o=r.editor.getShapeGeometry(n).bounds.w*r.editor.getZoomLevel()>=110,s=n.props.assetId?r.editor.getAsset(n.props.assetId):null,{time:i,playing:a}=n.props,l=Im(n.id),c=MO(),u=H.useRef(null),d=H.useCallback(v=>{const x=v.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:x.currentTime}}])},[n.id,r.editor]),h=H.useCallback(v=>{const x=v.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:x.currentTime}}])},[n.id,r.editor]),f=H.useCallback(v=>{const x=v.currentTarget;l&&r.editor.updateShapes([{type:"video",id:n.id,props:{time:x.currentTime}}])},[l,n.id,r.editor]),[y,g]=H.useState(!1),m=H.useCallback(v=>{const x=v.currentTarget;i!==x.currentTime&&(x.currentTime=i),a||x.pause(),g(!0)},[a,i]);return H.useEffect(()=>{const v=u.current;v&&(y&&!l&&i!==v.currentTime&&(v.currentTime=i),l&&document.activeElement!==v&&v.focus())},[l,y,i]),H.useEffect(()=>{if(c){const v=u.current;v.pause(),v.currentTime=0}},[u,c]),p.jsxs(p.Fragment,{children:[p.jsx(va,{id:n.id,children:p.jsx("div",{className:"tl-counter-scaled",children:s!=null&&s.props.src?p.jsx("video",{ref:u,style:l?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${n.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:l&&o,onPlay:d,onPause:h,onTimeUpdate:f,onLoadedData:m,hidden:!y,children:p.jsx("source",{src:s.props.src})}):null})}),"url"in n.props&&n.props.url&&p.jsx(Xd,{url:n.props.url,zoomLevel:r.editor.getZoomLevel()})]})}),Yne=[df,tf,nf,sf,uf,cf,of,ef,af,rf,lf,hf];function Xne(e){return[e.sideEffects.registerAfterChangeHandler("instance",(t,n)=>{t.isFocused!==n.isFocused&&(n.isFocused?(e.getContainer().focus(),e.updateViewportScreenBounds()):(e.complete(),e.getContainer().blur(),e.updateViewportScreenBounds()))}),e.sideEffects.registerAfterChangeHandler("instance_page_state",(t,n)=>{if(t.croppingShapeId!==n.croppingShapeId){const r=e.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!t.croppingShapeId&&n.croppingShapeId?r||e.setCurrentTool("select.crop.idle"):t.croppingShapeId&&!n.croppingShapeId&&r&&e.setCurrentTool("select.idle")}t.editingShapeId!==n.editingShapeId&&(!t.editingShapeId&&n.editingShapeId?e.isIn("select.editing_shape")||e.setCurrentTool("select.editing_shape"):t.editingShapeId&&!n.editingShapeId&&e.isIn("select.editing_shape")&&e.setCurrentTool("select.idle"))})]}class DO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"scribbleId","id");S(this,"markId","");S(this,"excludedShapeIds",new Set);S(this,"onEnter",n=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=n;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(s=>{if(this.editor.isShapeOrAncestorLocked(s))return!0;if(this.editor.isShapeOfType(s,"group")||this.editor.isShapeOfType(s,"frame")){const i=this.editor.getPointInShapeSpace(s,r);return this.editor.getShapeGeometry(s).bounds.containsPoint(i)}return!1}).map(s=>s.id));const o=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=o.id,this.update()});S(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});S(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});S(this,"onPointerMove",()=>{this.update()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()})}update(){const n=this.editor.getErasingShapeIds(),r=this.editor.getZoomLevel(),o=this.editor.getCurrentPageShapes(),{inputs:{currentPagePoint:s,previousPagePoint:i}}=this.editor,{excludedShapeIds:a}=this;this.pushPointToScribble();const l=new Set(n);for(const c of o){if(this.editor.isShapeOfType(c,"group"))continue;const u=this.editor.getShapeMask(c.id);if(u&&!jo(s,u))continue;const d=this.editor.getShapeGeometry(c),h=this.editor.getPointInShapeSpace(c,i),f=this.editor.getPointInShapeSpace(c,s);d.hitTestLineSegment(h,f,co/r)&&l.add(this.editor.getOutermostSelectableShape(c).id)}this.editor.setErasingShapes([...l].filter(c=>!a.has(c)))}complete(){this.editor.deleteShapes(this.editor.getCurrentPageState().erasingShapeIds),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}S(DO,"id","erasing");var f0;let qne=(f0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(f0,"id","idle"),f0);var g0;let Qne=(g0=class extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{const n=this.editor.getZoomLevel(),r=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:o}}=this.editor,s=new Set,i=s.size;for(let a=r.length,l=a-1;l>=0;l--){const c=r[l];if(!(this.editor.isShapeOrAncestorLocked(c)||this.editor.isShapeOfType(c,"group"))&&this.editor.isPointInShape(c,o,{hitInside:!1,margin:co/n})){const u=this.editor.getOutermostSelectableShape(c);if(this.editor.isShapeOfType(u,"frame")&&s.size>i)break;s.add(u.id)}}this.editor.setErasingShapes([...s])});S(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",n)});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.cancel()})}complete(){const n=this.editor.getErasingShapeIds();n.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(n)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}},S(g0,"id","pointing"),g0);class pf extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}S(pf,"id","eraser"),S(pf,"initial","idle"),S(pf,"children",()=>[qne,Qne,DO]);class NO extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.update()});S(this,"onPointerMove",()=>{this.update()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()})}update(){const{currentScreenPoint:n,previousScreenPoint:r}=this.editor.inputs,o=E.Sub(n,r);(Math.abs(o.x)>0||Math.abs(o.y)>0)&&this.editor.pan(o)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:$p}),this.parent.transition("idle")}}S(NO,"id","dragging");var m0;let Zne=(m0=class extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.editor.setCursor({type:"grab",rotation:0})});S(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});S(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},S(m0,"id","idle"),m0);var y0;let Jne=(y0=class extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});S(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",n)});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.complete()})}complete(){this.parent.transition("idle")}},S(y0,"id","pointing"),y0);class ff extends ie{constructor(){super(...arguments);S(this,"onDoubleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{duration:220,easing:dn.easeOutQuint})}});S(this,"onTripleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{duration:320,easing:dn.easeOutQuint})}});S(this,"onQuadrupleClick",n=>{if(n.phase==="settle"){const r=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:o}}=this.editor;r===1?this.editor.zoomToFit({duration:400,easing:dn.easeOutQuint}):this.editor.resetZoom(o,{duration:320,easing:dn.easeOutQuint})}})}}S(ff,"id","hand"),S(ff,"initial","idle"),S(ff,"children",()=>[Zne,Jne,NO]);var v0;let ere=(v0=class extends ie{constructor(){super(...arguments);S(this,"onPointerDown",n=>{this.parent.transition("lasering",n)})}},S(v0,"id","idle"),v0);class $O extends ie{constructor(){super(...arguments);S(this,"scribbleId","id");S(this,"onEnter",()=>{const n=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=n.id,this.pushPointToScribble()});S(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});S(this,"onPointerMove",()=>{this.pushPointToScribble()});S(this,"onPointerUp",()=>{this.complete()});S(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}S($O,"id","lasering");class gf extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}S(gf,"id","laser"),S(gf,"initial","idle"),S(gf,"children",()=>[ere,$O]);class LO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"brush",new le);S(this,"initialSelectedShapeIds",[]);S(this,"excludedShapeIds",new Set);S(this,"initialStartShape",null);S(this,"onEnter",n=>{const{altKey:r,currentPagePoint:o}=this.editor.inputs;if(r){this.parent.transition("scribble_brushing",n);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(s=>this.editor.isShapeOfType(s,"group")||this.editor.isShapeOrAncestorLocked(s)).map(s=>s.id)),this.info=n,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(o)[0],this.onPointerMove()});S(this,"onExit",()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})});S(this,"onTick",()=>{Sb(this.editor)});S(this,"onPointerMove",()=>{this.hitTestShapes()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",n=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",n)});S(this,"onKeyDown",n=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()});S(this,"onKeyUp",()=>{this.hitTestShapes()});S(this,"onInterrupt",()=>{this.editor.updateInstanceState({brush:null})})}complete(){this.parent.transition("idle")}hitTestShapes(){const n=this.editor.getZoomLevel(),r=this.editor.getCurrentPageShapes(),o=this.editor.getCurrentPageId(),{inputs:{originPagePoint:s,currentPagePoint:i,shiftKey:a,ctrlKey:l}}=this.editor;this.brush.setTo(le.FromPoints([s,i]));const c=new Set(a?this.initialSelectedShapeIds:[]);let u,d,h,f,y,g;const{corners:m}=this.brush,{excludedShapeIds:v}=this;e:for(let x=0,w=r.length;x<w;x++){if(h=r[x],v.has(h.id)||c.has(h.id)||(f=this.editor.getShapePageBounds(h),!f))continue e;if(this.brush.contains(f)){this.handleHit(h,i,o,c,m);continue e}if(l||this.editor.isShapeOfType(h,"frame"))continue e;if(this.brush.collides(f)){const C=this.editor.getShapeGeometry(h);if(y=this.editor.getShapePageTransform(h),!y)continue e;g=y.clone().invert().applyToPoints(m);t:for(let P=0;P<g.length;P++)if(u=g[P],d=g[(P+1)%g.length],C.hitTestLineSegment(u,d,co/n)){this.handleHit(h,i,o,c,m);break t}}}this.editor.updateInstanceState({brush:{...this.brush.toJson()}}),this.editor.setSelectedShapes(Array.from(c),{squashing:!0})}handleHit(n,r,o,s,i){if(n.parentId===o){s.add(n.id);return}const a=this.editor.getOutermostSelectableShape(n),l=this.editor.getShapeMask(a.id);l&&!AK(l,i)&&!jo(r,l)||s.add(a.id)}}S(LO,"id","brushing");function Gb(e){const t=e.getZoomLevel(),{inputs:{currentPagePoint:n}}=e;return e.getShapeAtPoint(n,{hitInside:!1,hitLabels:!1,margin:co/t,renderingOnly:!0})??e.getSelectedShapeAtPoint(n)}function FO(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");const{crop:r}=t.props;if(!r)return;const o=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;o==="x"?n.x=0:o==="y"&&(n.y=0),n.rot(-t.rotation);const s=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,i=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=r.bottomRight.y-r.topLeft.y,l=r.bottomRight.x-r.topLeft.x,c=hn(r);return c.topLeft.x=Math.min(1-l,Math.max(0,c.topLeft.x-n.x/s)),c.topLeft.y=Math.min(1-a,Math.max(0,c.topLeft.y-n.y/i)),c.bottomRight.x=c.topLeft.x+l,c.bottomRight.y=c.topLeft.y+a,{id:t.id,type:t.type,props:{crop:c}}}var S0;let tre=(S0=class extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});const n=this.editor.getOnlySelectedShape();this.editor.on("change-history",this.cleanupCroppingState),n&&(this.editor.mark("crop"),this.editor.setCroppingShape(n.id))});S(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)});S(this,"onCancel",()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})});S(this,"onPointerDown",n=>{var r;if(!this.editor.getIsMenuOpen()){if(n.ctrlKey){this.cancel(),this.editor.root.handleEvent(n);return}switch(n.target){case"canvas":{const o=Gb(this.editor);if(o&&!this.editor.isShapeOfType(o,"group")){this.onPointerDown({...n,shape:o,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(n);break}case"shape":{if(n.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",n);return}else(r=this.editor.getShapeUtil(n.shape))!=null&&r.canCrop(n.shape)?(this.editor.setCroppingShape(n.shape.id),this.editor.setSelectedShapes([n.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",n)):(this.cancel(),this.editor.root.handleEvent(n));break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});S(this,"onDoubleClick",n=>{var i;if(this.editor.inputs.shiftKey||n.phase!=="up")return;const r=this.editor.getCroppingShapeId();if(!r)return;const o=this.editor.getShape(r);if(!o)return;const s=this.editor.getShapeUtil(o);s&&n.target==="selection"&&((i=s.onDoubleClickEdge)==null||i.call(s,o))});S(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});S(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});S(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}});S(this,"cleanupCroppingState",()=>{this.editor.getCroppingShapeId()||this.editor.setCurrentTool("select.idle",{})})}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(n=!1){const{editor:{inputs:{keys:r}}}=this,o=r.has("ShiftLeft"),s=new E(0,0);if(r.has("ArrowLeft")&&(s.x+=1),r.has("ArrowRight")&&(s.x-=1),r.has("ArrowUp")&&(s.y+=1),r.has("ArrowDown")&&(s.y-=1),s.equals(new E(0,0)))return;o&&s.mul(10);const i=this.editor.getShape(this.editor.getCroppingShapeId());if(!i)return;const a=FO(this.editor,i,s);a&&(n||this.editor.mark("translate crop"),this.editor.updateShapes([a]))}},S(S0,"id","idle"),S0);class zO extends ie{constructor(){super(...arguments);S(this,"onCancel",()=>{this.editor.setCurrentTool("select.crop.idle",{})});S(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",n)});S(this,"onPointerUp",n=>{this.editor.setCurrentTool("select.crop.idle",n)})}}S(zO,"id","pointing_crop");class BO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"markId","translating crop");S(this,"snapshot",{});S(this,"onEnter",n=>{this.info=n,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()});S(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});S(this,"onPointerMove",()=>{this.updateShapes()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onKeyDown",n=>{switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}});S(this,"onKeyUp",n=>{switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:o}=this.editor.inputs,s=o.clone().sub(r),i=FO(this.editor,n,s);i&&this.editor.updateShapes([i],{squashing:!0})}}S(BO,"id","translating_crop");class mf extends ie{}S(mf,"id","crop"),S(mf,"initial","idle"),S(mf,"children",()=>[tre,BO,zO]);const br=8,oc={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class UO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n,this.updateCursor()});S(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("resizing",this.info)});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.editor.getSelectedShapes(),r=oc[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:n.length===1?n[0].rotation:0}})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}S(UO,"id","pointing_resize_handle");class HO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"markId","");S(this,"snapshot",{});S(this,"onEnter",n=>{this.info=n,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()});S(this,"onPointerMove",()=>{this.updateShapes()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){const n=this.editor.getSelectedShapes()[0];if(!n)return;const r=oc[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:n.rotation}})}updateShapes(){const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n||!this.editor.getShapeUtil("image"))return;const s=n.props,i=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),l=i.clone().sub(a).rot(-n.rotation),c=s.crop??this.getDefaultCrop(),u=hn(c),d=new E(n.x,n.y),h=new E(0,0),f=1/(c.bottomRight.x-c.topLeft.x)*s.w,y=1/(c.bottomRight.y-c.topLeft.y)*s.h;let g=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(y<br)break;g=!0,u.topLeft.y=u.topLeft.y+l.y/y,y*(u.bottomRight.y-u.topLeft.y)<br?(u.topLeft.y=u.bottomRight.y-br/y,h.y=(u.topLeft.y-c.topLeft.y)*y):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-c.topLeft.y)*y):h.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(y<br)break;g=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+l.y/y),y*(u.bottomRight.y-u.topLeft.y)<br&&(u.bottomRight.y=u.topLeft.y+br/y);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(f<br)break;g=!0,u.topLeft.x=u.topLeft.x+l.x/f,f*(u.bottomRight.x-u.topLeft.x)<br?(u.topLeft.x=u.bottomRight.x-br/f,h.x=(u.topLeft.x-c.topLeft.x)*f):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-c.topLeft.x)*f):h.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(f<br)break;g=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+l.x/f),f*(u.bottomRight.x-u.topLeft.x)<br&&(u.bottomRight.x=u.topLeft.x+br/f);break}}if(!g)return;d.add(h.rot(n.rotation));const m={id:n.id,type:n.type,x:d.x,y:d.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*f,h:(u.bottomRight.y-u.topLeft.y)*y}};this.editor.updateShapes([m],{squashing:!0}),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}createSnapshot(){const n=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,o=this.editor.getOnlySelectedShape(),s=this.editor.getSelectionRotatedPageBounds(),i=E.RotWith(s.getHandlePoint(this.info.handle),s.point,n),a=E.Sub(r,i);return{shape:o,cursorHandleOffset:a}}}S(HO,"id","cropping");class VO extends ie{constructor(){super(...arguments);S(this,"shapeId","");S(this,"initialHandle",{});S(this,"initialAdjacentHandle",null);S(this,"initialPagePoint",{});S(this,"markId","");S(this,"initialPageTransform");S(this,"initialPageRotation");S(this,"info",{});S(this,"isPrecise",!1);S(this,"isPreciseId",null);S(this,"pointingId",null);S(this,"onEnter",n=>{const{shape:r,isCreating:o,handle:s}=n;this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.shapeId=r.id,this.markId=o?`creating:${r.id}`:"dragging handle",o||this.editor.mark(this.markId),this.initialHandle=hn(s),this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:o?"cross":"grabbing",rotation:0}},{ephemeral:!0});const i=this.editor.getShapeHandles(r).sort(ln),a=i.findIndex(c=>c.id===n.handle.id);this.initialAdjacentHandle=null;for(let c=a+1;c<i.length;c++){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=i.length-1;c>=0;c--){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}const l=r.props[n.handle.id];this.isPrecise=!1,(l==null?void 0:l.type)==="binding"?(this.editor.setHintingShapes([l.boundShapeId]),this.isPrecise=l.isPrecise,this.isPrecise?this.isPreciseId=l.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([]),this.update(),this.editor.select(this.shapeId)});S(this,"exactTimeout",-1);S(this,"onPointerMove",()=>{this.update()});S(this,"onKeyDown",()=>{this.update()});S(this,"onKeyUp",()=>{this.update()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clear();const{onInteractionEnd:n}=this.info;if(this.editor.getInstanceState().isToolLocked&&n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();const{onInteractionEnd:n}=this.info;if(n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var k;const{editor:n,shapeId:r,initialPagePoint:o}=this,{initialHandle:s,initialPageRotation:i,initialAdjacentHandle:a}=this,l=this.editor.getHintingShapeIds(),c=this.editor.user.getIsSnapMode(),{snaps:u,inputs:{currentPagePoint:d,shiftKey:h,ctrlKey:f,altKey:y,pointerVelocity:g}}=n,m=this.info.shape,v=n.getShape(r);if(!v)return;const x=n.getShapeUtil(v);let w=d.clone().sub(o).rot(-i).add(s);if(h&&a&&s.id!=="middle"){const I=E.Angle(a,w),M=mg(I,24)-I;w=E.RotWith(w,a,M)}if(n.snaps.clear(),s.canSnap&&(c?!f:f)){const I=n.getShapePageTransform(v.id);if(!I)throw Error("Expected a page transform");const _=n.getShapeHandles(v).filter(({type:R})=>R==="vertex").sort(ln).findIndex(({index:R})=>s.index===R),M=x.getOutlineSegments(v).map(R=>se.applyToPoints(I,R)).filter((R,j)=>j!==_-1&&j!==_),T=u.getSnappingHandleDelta({additionalSegments:M,handlePoint:se.applyToPoint(I,w)});T&&(T.rot(-n.getShapeParentTransform(v).rotation()),w.add(T))}const C=(k=x.onHandleChange)==null?void 0:k.call(x,v,{handle:{...s,x:w.x,y:w.y},isPrecise:this.isPrecise||y,initial:m}),P={...v,...C};if(s.canBind){const I=P.props[s.id];(I==null?void 0:I.type)==="binding"?l[0]!==I.boundShapeId&&(n.setHintingShapes([I.boundShapeId]),this.pointingId=I.boundShapeId,this.isPrecise=g.len()<.5||y,this.isPreciseId=this.isPrecise?I.boundShapeId:null,this.resetExactTimeout()):l.length>0&&(n.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}C&&n.updateShapes([P],{squashing:!0})}}S(VO,"id","dragging_handle");class KO extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{const n=this.editor.getEditingShape();if(!n)throw Error("Entered editing state without an editing shape");fd(this.editor),this.editor.select(n)});S(this,"onExit",()=>{var s;const{editingShapeId:n}=this.editor.getCurrentPageState();if(!n)return;this.editor.setEditingShape(null);const r=this.editor.getShape(n),o=this.editor.getShapeUtil(r);(s=o.onEditEnd)==null||s.call(o,r),setTimeout(()=>{this.editor.updateViewportScreenBounds()},500)});S(this,"onPointerMove",n=>{switch(n.target){case"shape":case"canvas":{fd(this.editor);return}}});S(this,"onPointerDown",n=>{switch(n.target){case"canvas":{const r=Gb(this.editor);if(r){this.onPointerDown({...n,shape:r,target:"shape"});return}break}case"shape":{const{shape:r}=n,o=this.editor.getEditingShape();if(!o)throw Error("Expected an editing shape!");if(r.type===o.type)if(this.editor.isShapeOfType(r,"geo")||this.editor.isShapeOfType(r,"arrow")){const i=this.editor.getShapeUtil(r).getGeometry(r).children[1];if(i){const a=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(i.bounds.containsPoint(a)){if(r.id===o.id)return;this.parent.transition("pointing_shape",n);return}}}else{if(r.id===o.id)this.editor.isShapeOfType(r,"frame")&&this.editor.setEditingShape(null);else{this.parent.transition("pointing_shape",n);return}return}break}}this.parent.transition("idle",n),this.editor.root.handleEvent(n)});S(this,"onComplete",n=>{this.parent.transition("idle",n)});S(this,"onCancel",n=>{this.parent.transition("idle",n)})}}S(KO,"id","editing_shape");function v2(e){const t=e.getOnlySelectedShape();return!!(t&&!e.isShapeOrAncestorLocked(t)&&e.getShapeUtil(t).canCrop(t))}function Og(e){const t=e.getSelectedShapeIds(),{shiftKey:n,altKey:r,currentPagePoint:o}=e.inputs,s=e.getShapeAtPoint(o,{hitInside:!1,margin:co/e.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:i=>!i.isLocked});if(s){const i=e.getOutermostSelectableShape(s);if(n&&!r)e.cancelDoubleClick(),t.includes(i.id)?(e.mark("deselecting shape"),e.deselect(i)):(e.mark("shift selecting shape"),e.setSelectedShapes([...t,i.id]));else{let a;i===s||i.id===e.getFocusedGroupId()||t.includes(i.id)?a=s:a=i,a&&!t.includes(a.id)&&(e.mark("selecting shape"),e.select(a.id))}}else{if(n)return;{t.length>0&&(e.mark("selecting none"),e.selectNone());const i=e.getFocusedGroupId();if(Pr(i)){const a=e.getShape(i);e.isPointInShape(a,o,{margin:0,hitInside:!0})||e.setFocusedGroup(null)}}}}var x0;let nre=(x0=class extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{this.parent.setCurrentToolIdMask(void 0),fd(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});S(this,"onPointerMove",()=>{fd(this.editor)});S(this,"onPointerDown",n=>{if(this.editor.getIsMenuOpen())return;const r=n.ctrlKey&&v2(this.editor);if(n.ctrlKey&&!r){if(n.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_shape",n);return}this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{const o=Gb(this.editor);if(o&&!o.isLocked){this.onPointerDown({...n,shape:o,target:"shape"});return}const s=this.editor.getSelectedShapeIds(),i=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((s.length>1||i&&!this.editor.getShapeUtil(i).hideSelectionBoundsBg(i))&&S2(this.editor,a)){this.onPointerDown({...n,target:"selection"});return}this.parent.transition("pointing_canvas",n);break}case"shape":{if(this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_canvas",n);break}this.parent.transition("pointing_shape",n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:{const o=this.editor.getHoveredShape();if(o&&!this.editor.getSelectedShapeIds().includes(o.id)&&!o.isLocked){this.onPointerDown({...n,shape:o,target:"shape"});return}this.parent.transition("pointing_selection",n)}}break}}});S(this,"onDoubleClick",n=>{var r,o,s,i;if(!(this.editor.inputs.shiftKey||n.phase!=="up"))switch(n.target){case"canvas":{const a=this.editor.getHoveredShape(),l=a&&!this.editor.isShapeOfType(a,"group")?a:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:co/this.editor.getZoomLevel(),hitInside:!1}),c=this.editor.getFocusedGroupId();if(l){if(this.editor.isShapeOfType(l,"group")){Og(this.editor);return}else{const u=this.editor.getShape(l.parentId);if(u&&this.editor.isShapeOfType(u,"group")&&!(c&&u.id===c)){Og(this.editor);return}}this.onDoubleClick({...n,shape:l,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(n);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const a=this.editor.getOnlySelectedShape();if(a){const l=this.editor.getShapeUtil(a);if(!this.canInteractWithShapeInReadOnly(a))return;if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const c=(r=l.onDoubleClickEdge)==null?void 0:r.call(l,a);if(c){this.editor.mark("double click edge"),this.editor.updateShapes([c]);return}}if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.parent.transition("crop",n);return}this.shouldStartEditingShape(a)&&this.startEditingShape(a,n)}break}case"shape":{const{shape:a}=n,l=this.editor.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.editor.getInstanceState().isReadonly)break;if(l.onDoubleClick){const c=(o=l.onDoubleClick)==null?void 0:o.call(l,a);if(c){this.editor.updateShapes([c]);return}else if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.mark("select and crop"),this.editor.select((s=n.shape)==null?void 0:s.id),this.parent.transition("crop",n);return}}this.shouldStartEditingShape(a)?this.startEditingShape(a,n):this.handleDoubleClickOnCanvas(n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:a,handle:l}=n,c=this.editor.getShapeUtil(a),u=(i=c.onDoubleClickHandle)==null?void 0:i.call(c,a,l);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(a)&&this.startEditingShape(a,n)}}});S(this,"onRightClick",n=>{switch(n.target){case"canvas":{const r=this.editor.getHoveredShape(),o=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:co/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(o){this.onRightClick({...n,shape:o,target:"shape"});return}const s=this.editor.getSelectedShapeIds(),i=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((s.length>1||i&&!this.editor.getShapeUtil(i).hideSelectionBoundsBg(i))&&S2(this.editor,a)){this.onRightClick({...n,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:r}=this.editor.getCurrentPageState(),{shape:o}=n,s=this.editor.getOutermostSelectableShape(o,i=>!r.includes(i.id));r.includes(s.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([s.id]));break}}});S(this,"onCancel",()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())});S(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);break}}});S(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});S(this,"onKeyUp",n=>{switch(n.code){case"Enter":{const r=this.editor.getSelectedShapes();if(r.every(s=>this.editor.isShapeOfType(s,"group"))){this.editor.setSelectedShapes(r.flatMap(s=>this.editor.getSortedChildIdsForParent(s.id)));return}const o=this.editor.getOnlySelectedShape();if(o&&this.shouldStartEditingShape(o)){this.startEditingShape(o,{...n,target:"shape",shape:o});return}v2(this.editor)&&this.parent.transition("crop",n);break}}});S(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1)}shouldStartEditingShape(n=this.editor.getOnlySelectedShape()){return!n||this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||!this.canInteractWithShapeInReadOnly(n)?!1:this.editor.getShapeUtil(n).canEdit(n)}startEditingShape(n,r){this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||(this.editor.mark("editing shape"),this.editor.setEditingShape(n.id),this.parent.transition("editing_shape",r))}handleDoubleClickOnCanvas(n){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const r=Je(),{x:o,y:s}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:o,y:s,props:{text:"",autoSize:!0}}]);const i=this.editor.getShape(r);if(!i)return;const a=this.editor.getShapeUtil(i);this.editor.getInstanceState().isReadonly&&!a.canEditInReadOnly(i)||(this.editor.setEditingShape(r),this.editor.select(r),this.parent.transition("editing_shape",n))}nudgeSelectedShapes(n=!1){const{editor:{inputs:{keys:r}}}=this,o=r.has("ShiftLeft"),s=new E(0,0);if(r.has("ArrowLeft")&&(s.x-=1),r.has("ArrowRight")&&(s.x+=1),r.has("ArrowUp")&&(s.y-=1),r.has("ArrowDown")&&(s.y+=1),s.equals(new E(0,0)))return;n||this.editor.mark("nudge shapes");const{gridSize:i}=this.editor.getDocumentSettings(),a=this.editor.getInstanceState().isGridMode?o?i*sre:i:o?rre:ore;this.editor.nudgeShapes(this.editor.getSelectedShapeIds(),s.mul(a))}canInteractWithShapeInReadOnly(n){return!!(!this.editor.getInstanceState().isReadonly||this.editor.getShapeUtil(n).canEditInReadOnly(n))}},S(x0,"id","idle"),x0);const rre=10,ore=1,sre=5;function S2(e,t){const n=e.getSelectionRotatedPageBounds();if(!n)return!1;const r=e.getSelectionRotation();return r?jo(t,n.corners.map(o=>E.RotWith(o,n.point,r))):n.containsPoint(t)}class WO extends ie{constructor(){super(...arguments);S(this,"onEnter",()=>{const{inputs:n}=this.editor;n.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});S(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",n)});S(this,"onPointerUp",()=>{Og(this.editor),this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onInterrupt",()=>{this.parent.transition("idle")})}complete(){this.parent.transition("idle")}}S(WO,"id","pointing_canvas");class GO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];r&&(this.updateCursor(r),this.editor.setCroppingShape(r.id))});S(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});S(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})});S(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}updateCursor(n){const r=oc[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:n.rotation}})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}}S(GO,"id","pointing_crop_handle");class YO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n;const r=n.shape.props[n.handle.id];(r==null?void 0:r.type)==="binding"&&this.editor.setHintingShapes([r.boundShapeId]),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});S(this,"onExit",()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});S(this,"onPointerUp",()=>{this.parent.transition("idle",this.info)});S(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle")}}S(YO,"id","pointing_handle");class XO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.updateCursor()});S(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});S(this,"onPointerMove",()=>{const{isDragging:n}=this.editor.inputs;n&&this.parent.transition("rotating",this.info)});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.editor.getSelectionRotation();this.editor.updateInstanceState({cursor:{type:oc[this.info.handle],rotation:n}})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}S(XO,"id","pointing_rotate_handle");class qO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n});S(this,"onPointerUp",n=>{Og(this.editor),this.parent.transition("idle",n)});S(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.parent.transition("translating",n)}});S(this,"onDoubleClick",n=>{var s,i;const r=this.editor.getHoveredShape(),o=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(o){this.parent.transition("idle"),(i=(s=this.parent).onDoubleClick)==null||i.call(s,{...n,target:"shape",shape:this.editor.getShape(o)});return}});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle")}}S(qO,"id","pointing_selection");class QO extends ie{constructor(){super(...arguments);S(this,"hitShape",{});S(this,"hitShapeForPointerUp",{});S(this,"didSelectOnEnter",!1);S(this,"onEnter",n=>{const r=this.editor.getSelectedShapeIds(),o=this.editor.getSelectionRotatedPageBounds(),s=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:i,shiftKey:a,altKey:l}}=this.editor;this.hitShape=n.shape;const c=this.editor.getOutermostSelectableShape(n.shape);if(this.editor.getShapeUtil(n.shape).onClick||c.id===s||r.includes(c.id)||this.editor.isAncestorSelected(c.id)||r.length>1&&(o!=null&&o.containsPoint(i))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=c;return}this.didSelectOnEnter=!0,a&&!l?(this.editor.cancelDoubleClick(),r.includes(c.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...r,c.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([c.id]))});S(this,"onPointerUp",n=>{var u;const r=this.editor.getSelectedShapeIds(),o=this.editor.getFocusedGroupId(),s=this.editor.getZoomLevel(),{inputs:{currentPagePoint:i,shiftKey:a}}=this.editor,l=this.editor.getShapeAtPoint(i,{margin:co/s,hitInside:!0,renderingOnly:!0})??this.hitShape,c=l?this.editor.getOutermostSelectableShape(l):this.hitShapeForPointerUp;if(c){const d=this.editor.getShapeUtil(c);if(d.onClick){const h=(u=d.onClick)==null?void 0:u.call(d,c);if(h){this.editor.mark("shape on click"),this.editor.updateShapes([h]),this.parent.transition("idle",n);return}}if(c.id===o){r.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",n);return}}if(!this.didSelectOnEnter){const d=this.editor.getOutermostSelectableShape(l,h=>!r.includes(h.id));if(r.includes(d.id))if(a)this.editor.mark("deselecting on pointer up"),this.editor.deselect(c);else if(r.includes(c.id)){if(r.length===1&&(this.editor.isShapeOfType(c,"geo")||this.editor.isShapeOfType(c,"arrow"))){const f=this.editor.getShapeGeometry(c).children[1];if(f){const y=this.editor.getPointInShapeSpace(c,i);if(f.bounds.containsPoint(y,0)&&f.hitTestPoint(y)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(c.id);const g=this.editor.getShapeUtil(c);this.editor.getInstanceState().isReadonly&&!g.canEditInReadOnly(c)||(this.editor.setEditingShape(c.id),this.editor.setCurrentTool("select.editing_shape"))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(c.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(c);else if(a){const h=this.editor.getShapeAncestors(d);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(f=>!h.find(y=>y.id===f)),d.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([d.id])}this.parent.transition("idle",n)});S(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.parent.transition("translating",n)}});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.cancel()});S(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle")}}S(QO,"id","pointing_shape");class ZO extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"markId","");S(this,"didHoldCommand",!1);S(this,"creationCursorOffset",{x:0,y:0});S(this,"snapshot",{});S(this,"onEnter",n=>{const{isCreating:r=!1,creationCursorOffset:o={x:0,y:0}}=n;this.info=n,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.creationCursorOffset=o,this.snapshot=this._createSnapshot(),r?(this.markId=`creating:${this.editor.getOnlySelectedShape().id}`,this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0})):(this.markId="starting resizing",this.editor.mark(this.markId)),this.handleResizeStart(),this.updateShapes()});S(this,"onTick",()=>{Sb(this.editor)});S(this,"onPointerMove",()=>{this.updateShapes()});S(this,"onKeyDown",()=>{this.updateShapes()});S(this,"onKeyUp",()=>{this.updateShapes()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clear()});S(this,"_createSnapshot",()=>{const n=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:o}}=this.editor,s=this.editor.getSelectionRotatedPageBounds(),i=E.RotWith(s.getHandlePoint(this.info.handle),s.point,r),a=E.Sub(o,i),l=new Map,c=[];n.forEach(d=>{const h=this.editor.getShape(d);if(h){if(h.type==="frame"&&c.push({id:d,children:pe(this.editor.getSortedChildIdsForParent(h).map(f=>this.editor.getShape(f)))}),l.set(h.id,this._createShapeSnapshot(h)),this.editor.isShapeOfType(h,"frame")&&n.length===1)return;this.editor.visitDescendants(h.id,f=>{const y=this.editor.getShape(f);if(y&&(l.set(y.id,this._createShapeSnapshot(y)),this.editor.isShapeOfType(y,"frame")))return!1})}});const u=![...l.values()].some(d=>!dA(d.pageRotation,r)||d.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:s,cursorHandleOffset:a,selectionRotation:r,selectedShapeIds:n,canShapesDeform:u,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:c}});S(this,"_createShapeSnapshot",n=>{const r=this.editor.getShapePageTransform(n),o=this.editor.getShapeUtil(n);return{shape:n,bounds:this.editor.getShapeGeometry(n).bounds,pageTransform:r,pageRotation:se.Decompose(r).rotation,isAspectRatioLocked:o.isAspectRatioLocked(n)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var n,r;if(this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(n=this.info).onCreate)==null||r.call(n,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:o})=>{var a;const s=this.editor.getShapeUtil(o),i=(a=s.onResizeStart)==null?void 0:a.call(s,o);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:o})=>{var l;const s=this.editor.getShape(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onResizeEnd)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.editor.inputs,{frames:o,shapeSnapshots:s,selectionBounds:i,cursorHandleOffset:a,selectedShapeIds:l,selectionRotation:c,canShapesDeform:u}=this.snapshot,d=r||!u,{ctrlKey:h}=this.editor.inputs,f=this.editor.inputs.currentPagePoint.clone().sub(a).sub(this.creationCursorOffset),y=this.editor.inputs.originPagePoint.clone().sub(a);if(this.editor.getInstanceState().isGridMode&&!h){const{gridSize:_}=this.editor.getDocumentSettings();f.snapToGrid(_)}const g=this.info.handle,m=x2(g,Math.PI);if(this.editor.snaps.clear(),(this.editor.user.getIsSnapMode()?!h:h)&&c%Ze===0){const{nudge:_}=this.editor.snaps.snapResize({dragDelta:E.Sub(f,y),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:x2(g,c),isAspectRatioLocked:d,isResizingFromCenter:n});f.add(_)}const x=E.RotWith(n?i.center:i.getHandlePoint(m),i.point,c),w=E.Sub(f,x).rot(-c),C=E.Sub(y,x).rot(-c),P=E.DivV(w,C);Number.isFinite(P.x)||(P.x=1),Number.isFinite(P.y)||(P.y=1);const k=g==="top"||g==="bottom",I=g==="left"||g==="right";d?I?P.y=Math.abs(P.x):k?P.x=Math.abs(P.y):Math.abs(P.x)>Math.abs(P.y)?P.y=Math.abs(P.x)*(P.y<0?-1:1):P.x=Math.abs(P.y)*(P.x<0?-1:1):(k&&(P.x=1),I&&(P.y=1)),this.info.isCreating||this.updateCursor({dragHandle:g,isFlippedX:P.x<0,isFlippedY:P.y<0,rotation:c});for(const _ of s.keys()){const M=s.get(_);this.editor.resizeShape(_,P,{initialShape:M.shape,initialBounds:M.bounds,initialPageTransform:M.pageTransform,dragHandle:g,mode:l.length===1&&_===l[0]?"resize_bounds":"scale_shape",scaleOrigin:x,scaleAxisRotation:c})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:_,children:M}of o){if(!M.length)continue;const T=s.get(_).shape,R=this.editor.getShape(_);if(!(T&&R))continue;const j=R.x-T.x,$=R.y-T.y,L=new E(j,$).rot(-T.rotation);if(L.x!==0||L.y!==0)for(const U of M)this.editor.updateShape({id:U.id,type:U.type,x:U.x-L.x,y:U.y-L.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:_}of o)if(_.length)for(const M of _)this.editor.updateShape({id:M.id,type:M.type,x:M.x,y:M.y})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:o,rotation:s}){const i={...this.editor.getInstanceState().cursor};switch(n){case"top_left":case"bottom_right":{i.type="nwse-resize",r!==o&&(i.type="nesw-resize");break}case"top_right":case"bottom_left":{i.type="nesw-resize",r!==o&&(i.type="nwse-resize");break}}i.rotation=s,this.editor.setCursor(i)}}S(ZO,"id","resizing");const Fv=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function x2(e,t){t=t%Ue;const n=Math.round(t/($e/4)),r=Fv.indexOf(e);return Fv[(r+n)%Fv.length]}const w2=Math.PI/180;class JO extends ie{constructor(){super(...arguments);S(this,"snapshot",{});S(this,"info",{});S(this,"markId","");S(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const r=ZA({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r,this.handleStart()});S(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}});S(this,"onPointerMove",()=>{this.update()});S(this,"onKeyDown",()=>{this.update()});S(this,"onKeyUp",()=>{this.update()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"update",()=>{const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});zp({editor:this.editor,delta:n,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:oc[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation}})});S(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});S(this,"complete",()=>{zp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}handleStart(){const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});zp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:oc[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation}})}_getRotationFromPointerPosition({snapToNearestDegree:n}){const r=this.editor.getSelectionRotation(),o=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:s,currentPagePoint:i}}=this.editor,{initialCursorAngle:a,initialSelectionRotation:l}=this.snapshot;if(!o)return l;const u=o.center.clone().rotWith(o.point,r).angle(i)-a;let d=l+u;if(s)d=mg(d,24);else if(n&&(d=Math.round(d/w2)*w2,this.editor.getInstanceState().isCoarsePointer)){const h=mg(d,4),f=Mu(d,h);Math.abs(f)<RB(5)&&(d=h)}return d-l}}S(JO,"id","rotating");class ej extends ie{constructor(){super(...arguments);S(this,"hits",new Set);S(this,"size",0);S(this,"scribbleId","id");S(this,"initialSelectedShapeIds",new Set);S(this,"newlySelectedShapeIds",new Set);S(this,"onEnter",()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const n=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=n.id,this.updateScribbleSelection(!0),requestAnimationFrame(()=>{this.editor.updateInstanceState({brush:null})})});S(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});S(this,"onPointerMove",()=>{this.updateScribbleSelection(!0)});S(this,"onPointerUp",()=>{this.complete()});S(this,"onKeyDown",()=>{this.updateScribbleSelection(!1)});S(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")});S(this,"onCancel",()=>{this.cancel()});S(this,"onComplete",()=>{this.complete()});S(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)})}updateScribbleSelection(n){const r=this.editor.getZoomLevel(),o=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:s,originPagePoint:i,previousPagePoint:a,currentPagePoint:l}}=this.editor,{newlySelectedShapeIds:c,initialSelectedShapeIds:u}=this;n&&this.pushPointToScribble();const d=o;let h,f,y,g;for(let m=0,v=d.length;m<v;m++)if(h=d[m],f=this.editor.getShapeGeometry(h),!(this.editor.isShapeOfType(h,"group")||c.has(h.id)||this.editor.isShapeOrAncestorLocked(h))){if(this.editor.isShapeOfType(h,"frame")){const x=this.editor.getPointInShapeSpace(h,i);if(f.bounds.containsPoint(x))continue}if(y=this.editor.getPointInShapeSpace(h,a),g=this.editor.getPointInShapeSpace(h,l),f.hitTestLineSegment(y,g,co/r)){const x=this.editor.getOutermostSelectableShape(h),w=this.editor.getShapeMask(x.id);if(w&&VA(a,l,w)!==null&&!jo(l,w))continue;c.add(x.id)}}this.editor.setSelectedShapes([...new Set(s?[...c,...u]:[...c])],{squashing:!0})}complete(){this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle")}}S(ej,"id","scribble_brushing");const b2=100;class ire{constructor(t){S(this,"prevDroppingShapeId",null);S(this,"droppingNodeTimer",null);S(this,"first",!0);S(this,"dispose",()=>{this.clear()});this.editor=t,t.disposables.add(this.dispose)}updateDroppingNode(t,n){var r;this.first&&(this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,t))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(t,b2*10,n):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(t,b2,n))}setDragTimer(t,n,r){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,t,r)}),this.droppingNodeTimer=null},n)}handleDrag(t,n,r){var l,c,u,d,h;n=pe(n.map(f=>this.editor.getShape(f.id)));const o=((l=this.editor.getDroppingOverShape(t,n))==null?void 0:l.id)??null;if(o===this.prevDroppingShapeId)return;const{prevDroppingShapeId:s}=this,i=s&&this.editor.getShape(s),a=o&&this.editor.getShape(o);if(i&&((u=(c=this.editor.getShapeUtil(i)).onDragShapesOut)==null||u.call(c,i,n)),a){const f=(h=(d=this.editor.getShapeUtil(a)).onDragShapesOver)==null?void 0:h.call(d,a,n);f&&f.shouldHint&&this.editor.setHintingShapes([a.id])}else this.editor.setHintingShapes([]);r==null||r(),this.prevDroppingShapeId=o}dropShapes(t){var r,o;const{prevDroppingShapeId:n}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,t),n){const s=this.editor.getShape(n);if(!s)return;(o=(r=this.editor.getShapeUtil(s)).onDropShapesOver)==null||o.call(r,s,t)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}}class tj extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"selectionSnapshot",{});S(this,"snapshot",{});S(this,"markId","");S(this,"isCloning",!1);S(this,"isCreating",!1);S(this,"onCreate",()=>{});S(this,"dragAndDropManager",new ire(this.editor));S(this,"onEnter",n=>{const{isCreating:r=!1,onCreate:o=()=>{}}=n;if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.isCreating=r,this.onCreate=o,r?this.markId=`creating:${this.editor.getOnlySelectedShape().id}`:(this.markId="translating",this.editor.mark(this.markId)),this.isCloning=!1,this.info=n,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=C2(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()});S(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.dragAndDropManager.clear()});S(this,"onTick",()=>{this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),Sb(this.editor)});S(this,"onPointerMove",()=>{this.updateShapes()});S(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});S(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onComplete",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()});S(this,"updateParentTransforms",()=>{const{editor:n,snapshot:{shapeSnapshots:r}}=this;r.forEach(o=>{const s=n.getShape(o.shape.id);if(!s)return null;const i=jn(s.parentId)?null:se.Inverse(n.getShapePageTransform(s.parentId));o.parentTransform=i})})}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=C2(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var n;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(n=this.onCreate)==null||n.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var a;const s=this.editor.getShapeUtil(o),i=(a=s.onTranslateStart)==null?void 0:a.call(s,o);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var l;const s=this.editor.getShape(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onTranslateEnd)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}handleChange(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var l;const s=this.editor.getShape(o.id),i=this.editor.getShapeUtil(o),a=(l=i.onTranslate)==null?void 0:l.call(i,o,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms),are({editor:this.editor,shapeSnapshots:n.shapeSnapshots,averagePagePoint:n.averagePagePoint,initialSelectionPageBounds:n.initialPageBounds,initialSelectionSnapPoints:n.initialSnapPoints}),this.handleChange()}}S(tj,"id","translating");function C2(e){const t=[],n=[],r=pe(e.getSelectedShapeIds().map(s=>{const i=e.getShape(s);if(!i)return null;t.push(i);const a=e.getShapePageTransform(s).point();if(!a)return null;n.push(a);const l=ms.isId(i.parentId)?null:se.Inverse(e.getShapePageTransform(i.parentId));return{shape:i,pagePoint:a,parentTransform:l}}));let o=[];if(e.getSelectedShapeIds().length===1)o=e.snaps.getSnapPointsCache().get(e.getSelectedShapeIds()[0]);else{const s=e.getSelectionPageBounds();s&&(o=s.snapPoints.map((i,a)=>({id:"selection:"+a,x:i.x,y:i.y})))}return{averagePagePoint:E.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.getSelectionPageBounds(),initialSnapPoints:o}}function are({editor:e,shapeSnapshots:t,averagePagePoint:n,initialSelectionPageBounds:r,initialSelectionSnapPoints:o}){const{inputs:s}=e,i=e.getInstanceState().isGridMode,a=e.getDocumentSettings().gridSize,l=E.Sub(s.currentPagePoint,s.originPagePoint),c=e.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;if(c==="x"?l.x=0:c==="y"&&(l.y=0),e.snaps.clear(),(e.user.getIsSnapMode()?!s.ctrlKey:s.ctrlKey)&&e.inputs.pointerVelocity.len()<.5){const{nudge:f}=e.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:r,lockedAxis:c,initialSelectionSnapPoints:o});l.add(f)}const d=E.Add(n,l);i&&!s.ctrlKey&&d.snapToGrid(a);const h=E.Sub(d,n);e.updateShapes(pe(t.map(({shape:f,pagePoint:y,parentTransform:g})=>{const m=E.Add(y,h),v=g?se.applyToPoint(g,m):m;return{id:f.id,type:f.type,x:v.x,y:v.y}})),{squashing:!0})}class yf extends ie{constructor(){super(...arguments);S(this,"onExit",()=>{this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)})}}S(yf,"id","select"),S(yf,"initial","idle"),S(yf,"children",()=>[mf,HO,nre,WO,QO,tj,LO,ej,GO,qO,UO,KO,ZO,JO,XO,YO,VO]);class nj extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n});S(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}S(nj,"id","idle");class rj extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n});S(this,"onPointerUp",()=>{this.complete()});S(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});S(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:n}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(n,{duration:220}):this.editor.zoomIn(n,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}S(rj,"id","pointing");class oj extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"zoomBrush",new le);S(this,"onEnter",n=>{this.info=n,this.update()});S(this,"onExit",()=>{this.editor.updateInstanceState({zoomBrush:null})});S(this,"onPointerMove",()=>{this.update()});S(this,"onPointerUp",()=>{this.complete()});S(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(le.FromPoints([n,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.editor.getZoomLevel();if(n.width<r&&n.height<r){const o=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(o,{duration:220}):this.editor.zoomIn(o,{duration:220})}else{const o=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(n,o,{duration:220})}this.parent.transition("idle",this.info)}}S(oj,"id","zoom_brushing");class vf extends ie{constructor(){super(...arguments);S(this,"info",{});S(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.updateCursor()});S(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});S(this,"onKeyDown",()=>{this.updateCursor()});S(this,"onKeyUp",n=>{this.updateCursor(),n.code==="KeyZ"&&this.complete()});S(this,"onInterrupt",()=>{this.complete()})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}}S(vf,"id","zoom"),S(vf,"initial","idle"),S(vf,"children",()=>[nj,oj,rj]);const lre=[pf,ff,gf,vf,yf],ea="2.0.0-beta.2";let dx={fonts:{draw:`https://unpkg.com/@tldraw/assets@${ea}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`https://unpkg.com/@tldraw/assets@${ea}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${ea}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${ea}/fonts/IBMPlexMono-Medium.woff2`}};function cre(e){return b.useMemo(()=>e?{fonts:{...dx.fonts,...e==null?void 0:e.fonts}}:dx,[e])}const ure=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"];let nu={...dx,icons:Object.fromEntries(ure.map(e=>[e,`https://unpkg.com/@tldraw/assets@${ea}/icons/icon/${e}.svg`])),translations:Object.fromEntries(ad.map(e=>[e.locale,`https://unpkg.com/@tldraw/assets@${ea}/translations/${e.locale}.json`])),embedIcons:Object.fromEntries(tc.map(e=>[e.type,`https://unpkg.com/@tldraw/assets@${ea}/embed-icons/${e.type}.png`]))};function dre(e){return e?{fonts:Object.assign({...nu.fonts},{...e==null?void 0:e.fonts}),icons:Object.assign({...nu.icons},{...e==null?void 0:e.icons}),embedIcons:Object.assign({...nu.embedIcons},{...e==null?void 0:e.embedIcons}),translations:Object.assign({...nu.translations},{...e==null?void 0:e.translations})}:nu}function hre(e,t){const n=pe(t.map(o=>e.getShape(o)).filter(o=>o&&e.isShapeOfType(o,"frame")));if(!n.length)return;const r=[];e.batch(()=>{n.map(o=>{const s=e.getSortedChildIdsForParent(o.id);s.length&&(e.reparentShapes(s,o.parentId,o.index),r.push(...s))}),e.setSelectedShapes(r),e.deleteShapes(t)})}const pre=50;function fre(e,t,n={}){const r=e.getShape(t);if(!r)return;const o=e.getSortedChildIdsForParent(r.id),s=pe(o.map(f=>e.getShape(f)));if(!s.length)return;const i=le.FromPoints(s.flatMap(f=>{const y=e.getShapeGeometry(f.id);return e.getShapeLocalTransform(f).applyToPoints(y.vertices)})),{padding:a=pre}=n,l=i.w+2*a,c=i.h+2*a,u=a-i.minX,d=a-i.minY;if(u===0&&d===0&&r.props.w===l&&r.props.h===c)return;const h=new E(u,d).rot(r.rotation);e.batch(()=>{const f=o.map(y=>{const g=e.getShape(y);return{id:g.id,type:g.type,x:g.x+u,y:g.y+d}});f.push({id:r.id,type:r.type,x:r.x-h.x,y:r.y-h.y,props:{w:l,h:c}}),e.updateShapes(f)})}const sj=b.createContext(null);function gre({assetUrls:e,children:t}){return p.jsx(sj.Provider,{value:e,children:t})}function Yb(){const e=b.useContext(sj);if(!e)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return e}const hx={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},Xa={locale:"en",label:"English",messages:hx};async function mre(e,t){if(!(await fetch(t.translations.en)).ok)return console.warn("No main translations found."),Xa;if(e==="en")return Xa;const r=ad.find(a=>a.locale===e);if(!r)return console.warn(`No translation found for locale ${e}`),Xa;const s=await(await fetch(t.translations[r.locale])).json();if(!s)return console.warn(`No messages found for locale ${e}`),Xa;const i=[];for(const a in Xa.messages)s[a]||i.push(a);return i.length>0,{locale:e,label:r.label,messages:{...Xa.messages,...s}}}const ij=b.createContext({}),yre=()=>b.useContext(ij),vre=Ve(function({overrides:t,children:n}){const o=W().user.getLocale(),s=Yb(),[i,a]=b.useState(()=>t&&t.en?{locale:"en",label:"English",messages:{...hx,...t.en}}:{locale:"en",label:"English",messages:hx});return b.useEffect(()=>{let l=!1;async function c(){const u=await mre(o,s);u&&!l&&(t&&t[o]?a({...u,messages:{...u.messages,...t[o]}}):a(u))}return c(),()=>{l=!0}},[s,o,t]),p.jsx(ij.Provider,{value:i,children:n})});function Ie(){const e=yre();return b.useCallback(function(n){return e.messages[n]??n},[e])}function Sre(e){return p.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...e,children:p.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[p.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),p.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:p.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const ur=b.memo(function({small:t,invertIcon:n,icon:r,color:o,className:s,...i}){const a=Yb(),l=a.icons[r]??a.icons["question-mark-circle"],c=b.useRef(null);return b.useLayoutEffect(()=>{l||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l,r]),p.jsx("div",{...i,ref:c,className:fe("tlui-icon",{"tlui-icon__small":t},s),style:{color:o,mask:`url(${l}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),aj=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,lj=aj?"":"Ctrl",cj=aj?"":"Alt";function xre(e){return e.split(",")[0].split("").map(t=>{const n=t.replace(/\$/g,lj).replace(/\?/g,cj).replace(/!/g,"");return n[0].toUpperCase()+n.slice(1)})}function Do(e){return" "+e.split(",")[0].split("").map(t=>{const n=t.replace(/\$/g,lj).replace(/\?/g,cj).replace(/!/g,"");return n[0].toUpperCase()+n.slice(1)}).join("")}function Nm({children:e}){return p.jsx("kbd",{className:"tlui-kbd",children:xre(e).map((t,n)=>p.jsx("span",{children:t},n))})}const ae=b.forwardRef(function({label:t,icon:n,invertIcon:r,iconLeft:o,smallIcon:s,kbd:i,isChecked:a=!1,type:l,children:c,spinner:u,...d},h){const f=Ie(),y=t?f(t):"";return p.jsxs("button",{ref:h,draggable:!1,type:"button",...d,title:d.title??y,className:fe("tlui-button",`tlui-button__${l}`,d.className),children:[o&&p.jsx(ur,{icon:o,className:"tlui-button__icon-left",small:!0}),c,t&&p.jsxs("span",{className:"tlui-button__label",draggable:!1,children:[y,a&&p.jsx(ur,{icon:"check"})]}),i&&p.jsx(Nm,{children:i}),n&&!u&&p.jsx(ur,{icon:n,small:!!t||s,invertIcon:r}),u&&p.jsx(Sre,{})]})});var zv="focusScope.autoFocusOnMount",Bv="focusScope.autoFocusOnUnmount",P2={bubbles:!1,cancelable:!0},wre="FocusScope",$m=b.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[a,l]=b.useState(null),c=qt(o),u=qt(s),d=b.useRef(null),h=Ye(t,g=>l(g)),f=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(r){let g=function(w){if(f.paused||!a)return;const C=w.target;a.contains(C)?d.current=C:Ns(d.current,{select:!0})},m=function(w){if(f.paused||!a)return;const C=w.relatedTarget;C!==null&&(a.contains(C)||Ns(d.current,{select:!0}))},v=function(w){if(document.activeElement===document.body)for(const P of w)P.removedNodes.length>0&&Ns(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",m);const x=new MutationObserver(v);return a&&x.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",m),x.disconnect()}}},[r,a,f.paused]),b.useEffect(()=>{if(a){E2.add(f);const g=document.activeElement;if(!a.contains(g)){const v=new CustomEvent(zv,P2);a.addEventListener(zv,c),a.dispatchEvent(v),v.defaultPrevented||(bre(Ire(uj(a)),{select:!0}),document.activeElement===g&&Ns(a))}return()=>{a.removeEventListener(zv,c),setTimeout(()=>{const v=new CustomEvent(Bv,P2);a.addEventListener(Bv,u),a.dispatchEvent(v),v.defaultPrevented||Ns(g??document.body,{select:!0}),a.removeEventListener(Bv,u),E2.remove(f)},0)}}},[a,c,u,f]);const y=b.useCallback(g=>{if(!n&&!r||f.paused)return;const m=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(m&&v){const x=g.currentTarget,[w,C]=Cre(x);w&&C?!g.shiftKey&&v===C?(g.preventDefault(),n&&Ns(w,{select:!0})):g.shiftKey&&v===w&&(g.preventDefault(),n&&Ns(C,{select:!0})):v===x&&g.preventDefault()}},[n,r,f.paused]);return p.jsx(Ce.div,{tabIndex:-1,...i,ref:h,onKeyDown:y})});$m.displayName=wre;function bre(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Ns(r,{select:t}),document.activeElement!==n)return}function Cre(e){const t=uj(e),n=k2(t,e),r=k2(t.reverse(),e);return[n,r]}function uj(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function k2(e,t){for(const n of e)if(!Pre(n,{upTo:t}))return n}function Pre(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function kre(e){return e instanceof HTMLInputElement&&"select"in e}function Ns(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&kre(e)&&t&&e.select()}}var E2=Ere();function Ere(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=I2(e,t),e.unshift(t)},remove(t){var n;e=I2(e,t),(n=e[0])==null||n.resume()}}}function I2(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Ire(e){return e.filter(t=>t.tagName!=="A")}var Uv=0;function Xb(){b.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_2()),document.body.insertAdjacentElement("beforeend",e[1]??_2()),Uv++,()=>{Uv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Uv--}},[])}function _2(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ko=function(){return ko=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ko.apply(this,arguments)};function dj(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function _re(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,s;r<o;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}var Sf="right-scroll-bar-position",xf="width-before-scroll-bar",Tre="with-scroll-bars-hidden",Mre="--removed-body-scroll-bar-size";function Hv(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Are(e,t){var n=b.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var Rre=typeof window<"u"?b.useLayoutEffect:b.useEffect,T2=new WeakMap;function Ore(e,t){var n=Are(null,function(r){return e.forEach(function(o){return Hv(o,r)})});return Rre(function(){var r=T2.get(n);if(r){var o=new Set(r),s=new Set(e),i=n.current;o.forEach(function(a){s.has(a)||Hv(a,null)}),s.forEach(function(a){o.has(a)||Hv(a,i)})}T2.set(n,e)},[e]),n}function jre(e){return e}function Dre(e,t){t===void 0&&(t=jre);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var i=t(s,r);return n.push(i),function(){n=n.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(r=!0;n.length;){var i=n;n=[],i.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var i=[];if(n.length){var a=n;n=[],a.forEach(s),i=n}var l=function(){var u=i;i=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){i.push(u),c()},filter:function(u){return i=i.filter(u),n}}}};return o}function Nre(e){e===void 0&&(e={});var t=Dre(null);return t.options=ko({async:!0,ssr:!1},e),t}var hj=function(e){var t=e.sideCar,n=dj(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return b.createElement(r,ko({},n))};hj.isSideCarExport=!0;function $re(e,t){return e.useMedium(t),hj}var pj=Nre(),Vv=function(){},Lm=b.forwardRef(function(e,t){var n=b.useRef(null),r=b.useState({onScrollCapture:Vv,onWheelCapture:Vv,onTouchMoveCapture:Vv}),o=r[0],s=r[1],i=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,f=e.noIsolation,y=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,x=e.gapMode,w=dj(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,P=Ore([n,t]),k=ko(ko({},w),o);return b.createElement(b.Fragment,null,u&&b.createElement(C,{sideCar:pj,removeScrollBar:c,shards:d,noIsolation:f,inert:y,setCallbacks:s,allowPinchZoom:!!g,lockRef:n,gapMode:x}),i?b.cloneElement(b.Children.only(a),ko(ko({},k),{ref:P})):b.createElement(v,ko({},k,{className:l,ref:P}),a))});Lm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Lm.classNames={fullWidth:xf,zeroRight:Sf};var Lre=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Fre(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Lre();return t&&e.setAttribute("nonce",t),e}function zre(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Bre(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Ure=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Fre())&&(zre(t,n),Bre(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Hre=function(){var e=Ure();return function(t,n){b.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},fj=function(){var e=Hre(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},Vre={left:0,top:0,right:0,gap:0},Kv=function(e){return parseInt(e||"",10)||0},Kre=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Kv(n),Kv(r),Kv(o)]},Wre=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Vre;var t=Kre(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},Gre=fj(),jl="data-scroll-locked",Yre=function(e,t,n,r){var o=e.left,s=e.top,i=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Tre,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(jl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Sf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(xf,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Sf," .").concat(Sf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(xf," .").concat(xf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(jl,`] {
    `).concat(Mre,": ").concat(a,`px;
  }
`)},M2=function(){var e=parseInt(document.body.getAttribute(jl)||"0",10);return isFinite(e)?e:0},Xre=function(){b.useEffect(function(){return document.body.setAttribute(jl,(M2()+1).toString()),function(){var e=M2()-1;e<=0?document.body.removeAttribute(jl):document.body.setAttribute(jl,e.toString())}},[])},qre=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;Xre();var s=b.useMemo(function(){return Wre(o)},[o]);return b.createElement(Gre,{styles:Yre(s,!t,o,n?"":"!important")})},px=!1;if(typeof window<"u")try{var dp=Object.defineProperty({},"passive",{get:function(){return px=!0,!0}});window.addEventListener("test",dp,dp),window.removeEventListener("test",dp,dp)}catch{px=!1}var qa=px?{passive:!1}:!1,Qre=function(e){return e.tagName==="TEXTAREA"},gj=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Qre(e)&&n[t]==="visible")},Zre=function(e){return gj(e,"overflowY")},Jre=function(e){return gj(e,"overflowX")},A2=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=mj(e,r);if(o){var s=yj(e,r),i=s[1],a=s[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},eoe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},toe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},mj=function(e,t){return e==="v"?Zre(t):Jre(t)},yj=function(e,t){return e==="v"?eoe(t):toe(t)},noe=function(e,t){return e==="h"&&t==="rtl"?-1:1},roe=function(e,t,n,r,o){var s=noe(e,window.getComputedStyle(t).direction),i=s*r,a=n.target,l=t.contains(a),c=!1,u=i>0,d=0,h=0;do{var f=yj(e,a),y=f[0],g=f[1],m=f[2],v=g-m-s*y;(y||v)&&mj(e,a)&&(d+=v,h+=y),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(u&&(Math.abs(d)<1||!o)||!u&&(Math.abs(h)<1||!o))&&(c=!0),c},hp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},R2=function(e){return[e.deltaX,e.deltaY]},O2=function(e){return e&&"current"in e?e.current:e},ooe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},soe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},ioe=0,Qa=[];function aoe(e){var t=b.useRef([]),n=b.useRef([0,0]),r=b.useRef(),o=b.useState(ioe++)[0],s=b.useState(fj)[0],i=b.useRef(e);b.useEffect(function(){i.current=e},[e]),b.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var g=_re([e.lockRef.current],(e.shards||[]).map(O2),!0).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),g.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var a=b.useCallback(function(g,m){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var v=hp(g),x=n.current,w="deltaX"in g?g.deltaX:x[0]-v[0],C="deltaY"in g?g.deltaY:x[1]-v[1],P,k=g.target,I=Math.abs(w)>Math.abs(C)?"h":"v";if("touches"in g&&I==="h"&&k.type==="range")return!1;var _=A2(I,k);if(!_)return!0;if(_?P=I:(P=I==="v"?"h":"v",_=A2(I,k)),!_)return!1;if(!r.current&&"changedTouches"in g&&(w||C)&&(r.current=P),!P)return!0;var M=r.current||P;return roe(M,m,g,M==="h"?w:C,!0)},[]),l=b.useCallback(function(g){var m=g;if(!(!Qa.length||Qa[Qa.length-1]!==s)){var v="deltaY"in m?R2(m):hp(m),x=t.current.filter(function(P){return P.name===m.type&&(P.target===m.target||m.target===P.shadowParent)&&ooe(P.delta,v)})[0];if(x&&x.should){m.cancelable&&m.preventDefault();return}if(!x){var w=(i.current.shards||[]).map(O2).filter(Boolean).filter(function(P){return P.contains(m.target)}),C=w.length>0?a(m,w[0]):!i.current.noIsolation;C&&m.cancelable&&m.preventDefault()}}},[]),c=b.useCallback(function(g,m,v,x){var w={name:g,delta:m,target:v,should:x,shadowParent:loe(v)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(C){return C!==w})},1)},[]),u=b.useCallback(function(g){n.current=hp(g),r.current=void 0},[]),d=b.useCallback(function(g){c(g.type,R2(g),g.target,a(g,e.lockRef.current))},[]),h=b.useCallback(function(g){c(g.type,hp(g),g.target,a(g,e.lockRef.current))},[]);b.useEffect(function(){return Qa.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,qa),document.addEventListener("touchmove",l,qa),document.addEventListener("touchstart",u,qa),function(){Qa=Qa.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,qa),document.removeEventListener("touchmove",l,qa),document.removeEventListener("touchstart",u,qa)}},[]);var f=e.removeScrollBar,y=e.inert;return b.createElement(b.Fragment,null,y?b.createElement(s,{styles:soe(o)}):null,f?b.createElement(qre,{gapMode:e.gapMode}):null)}function loe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const coe=$re(pj,aoe);var Fm=b.forwardRef(function(e,t){return b.createElement(Lm,ko({},e,{ref:t,sideCar:coe}))});Fm.classNames=Lm.classNames;var uoe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Za=new WeakMap,pp=new WeakMap,fp={},Wv=0,vj=function(e){return e&&(e.host||vj(e.parentNode))},doe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=vj(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},hoe=function(e,t,n,r){var o=doe(t,Array.isArray(e)?e:[e]);fp[n]||(fp[n]=new WeakMap);var s=fp[n],i=[],a=new Set,l=new Set(o),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};o.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var f=h.getAttribute(r),y=f!==null&&f!=="false",g=(Za.get(h)||0)+1,m=(s.get(h)||0)+1;Za.set(h,g),s.set(h,m),i.push(h),g===1&&y&&pp.set(h,!0),m===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return u(t),a.clear(),Wv++,function(){i.forEach(function(d){var h=Za.get(d)-1,f=s.get(d)-1;Za.set(d,h),s.set(d,f),h||(pp.has(d)||d.removeAttribute(r),pp.delete(d)),f||d.removeAttribute(n)}),Wv--,Wv||(Za=new WeakMap,Za=new WeakMap,pp=new WeakMap,fp={})}},qb=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=uoe(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),hoe(r,o,n,"aria-hidden")):function(){return null}},Qb="Dialog",[Sj,Hce]=vs(Qb),[poe,ho]=Sj(Qb),xj=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:o,onOpenChange:s,modal:i=!0}=e,a=b.useRef(null),l=b.useRef(null),[c=!1,u]=Ss({prop:r,defaultProp:o,onChange:s});return p.jsx(poe,{scope:t,triggerRef:a,contentRef:l,contentId:_o(),titleId:_o(),descriptionId:_o(),open:c,onOpenChange:u,onOpenToggle:b.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})};xj.displayName=Qb;var wj="DialogTrigger",foe=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=ho(wj,n),s=Ye(t,o.triggerRef);return p.jsx(Ce.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":e1(o.open),...r,ref:s,onClick:ee(e.onClick,o.onOpenToggle)})});foe.displayName=wj;var Zb="DialogPortal",[goe,bj]=Sj(Zb,{forceMount:void 0}),Cj=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:o}=e,s=ho(Zb,t);return p.jsx(goe,{scope:t,forceMount:n,children:b.Children.map(r,i=>p.jsx(gr,{present:n||s.open,children:p.jsx(Ad,{asChild:!0,container:o,children:i})}))})};Cj.displayName=Zb;var jg="DialogOverlay",Pj=b.forwardRef((e,t)=>{const n=bj(jg,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,s=ho(jg,e.__scopeDialog);return s.modal?p.jsx(gr,{present:r||s.open,children:p.jsx(moe,{...o,ref:t})}):null});Pj.displayName=jg;var moe=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=ho(jg,n);return p.jsx(Fm,{as:fi,allowPinchZoom:!0,shards:[o.contentRef],children:p.jsx(Ce.div,{"data-state":e1(o.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Sa="DialogContent",kj=b.forwardRef((e,t)=>{const n=bj(Sa,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,s=ho(Sa,e.__scopeDialog);return p.jsx(gr,{present:r||s.open,children:s.modal?p.jsx(yoe,{...o,ref:t}):p.jsx(voe,{...o,ref:t})})});kj.displayName=Sa;var yoe=b.forwardRef((e,t)=>{const n=ho(Sa,e.__scopeDialog),r=b.useRef(null),o=Ye(t,n.contentRef,r);return b.useEffect(()=>{const s=r.current;if(s)return qb(s)},[]),p.jsx(Ej,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ee(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ee(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,a=i.button===0&&i.ctrlKey===!0;(i.button===2||a)&&s.preventDefault()}),onFocusOutside:ee(e.onFocusOutside,s=>s.preventDefault())})}),voe=b.forwardRef((e,t)=>{const n=ho(Sa,e.__scopeDialog),r=b.useRef(!1),o=b.useRef(!1);return p.jsx(Ej,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,a;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),Ej=b.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:s,...i}=e,a=ho(Sa,n),l=b.useRef(null),c=Ye(t,l);return Xb(),p.jsxs(p.Fragment,{children:[p.jsx($m,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:s,children:p.jsx(cc,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":e1(a.open),...i,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),p.jsxs(p.Fragment,{children:[p.jsx(xoe,{titleId:a.titleId}),p.jsx(boe,{contentRef:l,descriptionId:a.descriptionId})]})]})}),Jb="DialogTitle",Ij=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=ho(Jb,n);return p.jsx(Ce.h2,{id:o.titleId,...r,ref:t})});Ij.displayName=Jb;var _j="DialogDescription",Soe=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=ho(_j,n);return p.jsx(Ce.p,{id:o.descriptionId,...r,ref:t})});Soe.displayName=_j;var Tj="DialogClose",Mj=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=ho(Tj,n);return p.jsx(Ce.button,{type:"button",...r,ref:t,onClick:ee(e.onClick,()=>o.onOpenChange(!1))})});Mj.displayName=Tj;function e1(e){return e?"open":"closed"}var Aj="DialogTitleWarning",[Vce,Rj]=mL(Aj,{contentName:Sa,titleName:Jb,docsSlug:"dialog"}),xoe=({titleId:e})=>{const t=Rj(Aj),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return b.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},woe="DialogDescriptionWarning",boe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Rj(woe).contentName}}.`;return b.useEffect(()=>{var s;const o=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Coe=xj,Poe=Cj,koe=Pj,Eoe=kj;function zm({className:e,children:t}){return p.jsx("div",{className:fe("tlui-dialog__header",e),children:t})}function Bm({className:e,children:t}){return p.jsx(Ij,{dir:"ltr",className:fe("tlui-dialog__header__title",e),children:t})}function Um(){return p.jsx("div",{className:"tlui-dialog__header__close",children:p.jsx(Mj,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:p.jsx(ae,{type:"icon","aria-label":"Close",onTouchEnd:e=>e.target.click(),children:p.jsx(ur,{small:!0,icon:"cross-2"})})})})}function yd({className:e,children:t,style:n}){return p.jsx("div",{className:fe("tlui-dialog__body",e),style:n,children:t})}function t1({className:e,children:t}){return p.jsx("div",{className:fe("tlui-dialog__footer",e),children:t})}const n1=b.forwardRef(function({className:t,label:n,icon:r,iconLeft:o,autoselect:s=!1,autofocus:i=!1,defaultValue:a,placeholder:l,onComplete:c,onValueChange:u,onCancel:d,onBlur:h,shouldManuallyMaintainScrollPositionWhenFocused:f=!1,children:y,value:g},m){const v=W(),x=b.useRef(null);b.useImperativeHandle(m,()=>x.current);const w=Ie(),C=b.useRef(a??""),P=b.useRef(a??""),[k,I]=b.useState(!1),_=b.useCallback(j=>{I(!0);const $=j.currentTarget;P.current=$.value,requestAnimationFrame(()=>{s&&$.select()})},[s]),M=b.useCallback(j=>{const $=j.currentTarget.value;P.current=$,u==null||u($)},[u]),T=b.useCallback(j=>{switch(j.key){case"Enter":{j.currentTarget.blur(),Ot(j),c==null||c(j.currentTarget.value);break}case"Escape":{j.currentTarget.value=C.current,j.currentTarget.blur(),Ot(j),d==null||d(j.currentTarget.value);break}}},[c,d]),R=b.useCallback(j=>{I(!1);const $=j.currentTarget.value;h==null||h($)},[h]);return b.useEffect(()=>{if(!v.environment.isIos)return;const j=window.visualViewport;if(k&&f&&j){const $=()=>{var L;(L=x.current)==null||L.scrollIntoView({block:"center"})};return j.addEventListener("resize",$),j.addEventListener("scroll",$),requestAnimationFrame(()=>{var L;(L=x.current)==null||L.scrollIntoView({block:"center"})}),()=>{j.removeEventListener("resize",$),j.removeEventListener("scroll",$)}}},[v,k,f]),p.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[y,n&&p.jsx("label",{children:w(n)}),o&&p.jsx(ur,{icon:o,className:"tlui-icon-left",small:!0}),p.jsx("input",{ref:x,className:fe("tlui-input",t),type:"text",defaultValue:a,onKeyUp:T,onChange:M,onFocus:_,onBlur:R,autoFocus:i,placeholder:l,value:g}),r&&p.jsx(ur,{icon:r,small:!!n})]})});function j2(e){return hr.isValid(e)?{isValid:!0,hasProtocol:!0}:hr.isValid("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const Ioe=Ve(function({onClose:t}){const r=W().getOnlySelectedShape();return r&&"url"in r.props&&typeof r.props.url=="string"?p.jsx(_oe,{onClose:t,selectedShape:r}):null}),_oe=Ve(function({onClose:t,selectedShape:n}){const r=W(),o=Ie(),s=b.useRef(null);b.useEffect(()=>{requestAnimationFrame(()=>{var y;return(y=s.current)==null?void 0:y.focus()})},[]);const i=b.useRef(n.props.url),[a,l]=b.useState(()=>{const y=j2(n.props.url),g=y.isValid===!0?y.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:g,safe:g,valid:!0}}),c=b.useCallback(y=>{const g=y.replace(/https?:\/\/(https?:\/\/)/,(x,w)=>w),m=j2(g),v=m.isValid===!0?m.hasProtocol?g:"https://"+g:"https://";l({actual:g,safe:v,valid:m.isValid})},[]),u=b.useCallback(()=>{const y=r.getOnlySelectedShape();y&&(r.updateShapes([{id:y.id,type:y.type,props:{url:""}}]),t())},[r,t]),d=b.useCallback(()=>{const y=r.getOnlySelectedShape();y&&(y&&"url"in y.props&&y.props.url!==a.safe&&r.updateShapes([{id:y.id,type:y.type,props:{url:a.safe}}]),t())},[r,t,a]),h=b.useCallback(()=>{t()},[t]);if(!n)return t(),null;const f=i.current&&!a.valid;return p.jsxs(p.Fragment,{children:[p.jsxs(zm,{children:[p.jsx(Bm,{children:o("edit-link-dialog.title")}),p.jsx(Um,{})]}),p.jsx(yd,{children:p.jsxs("div",{className:"tlui-edit-link-dialog",children:[p.jsx(n1,{ref:s,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:a.actual,onValueChange:c,onComplete:d,onCancel:h}),p.jsx("div",{children:a.valid?o("edit-link-dialog.detail"):o("edit-link-dialog.invalid-url")})]})}),p.jsxs(t1,{className:"tlui-dialog__footer__actions",children:[p.jsx(ae,{type:"normal",onClick:h,onTouchEnd:h,children:o("edit-link-dialog.cancel")}),f?p.jsx(ae,{type:"danger",onTouchEnd:u,onClick:u,children:o("edit-link-dialog.clear")}):p.jsx(ae,{type:"primary",disabled:!a.valid,onTouchEnd:d,onClick:d,children:o("edit-link-dialog.save")})]})]})}),Oj=Ve(function({onClose:t}){const n=W(),r=Ie(),o=Yb(),[s,i]=b.useState(null),[a,l]=b.useState(""),[c,u]=b.useState(null),[d,h]=b.useState(!1),f=b.useRef(-1);return p.jsxs(p.Fragment,{children:[p.jsxs(zm,{children:[p.jsx(Bm,{children:s?`${r("embed-dialog.title")}  ${s.title}`:r("embed-dialog.title")}),p.jsx(Um,{})]}),s?p.jsxs(p.Fragment,{children:[p.jsxs(yd,{className:"tlui-embed-dialog__enter",children:[p.jsx(n1,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:y=>{l(y);const g=ts(y);u(g&&g.definition.type===s.type?g:null),h(!1),clearTimeout(f.current),f.current=setTimeout(()=>h(!g),320)}}),a===""?p.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[p.jsx("span",{children:r("embed-dialog.instruction")})," ",s.instructionLink&&p.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",p.jsx(ur,{icon:"external-link",small:!0})]})]}):p.jsx("div",{className:"tlui-embed-dialog__warning",children:d?r("embed-dialog.invalid-url"):""})]}),p.jsxs(t1,{className:"tlui-dialog__footer__actions",children:[p.jsx(ae,{type:"normal",onClick:()=>{i(null),u(null),l("")},label:"embed-dialog.back"}),p.jsx("div",{className:"tlui-embed__spacer"}),p.jsx(ae,{type:"normal",label:"embed-dialog.cancel",onClick:t}),p.jsx(ae,{type:"primary",disabled:!c,label:"embed-dialog.create",onClick:()=>{c&&(n.putExternalContent({type:"embed",url:a,point:n.getViewportPageCenter(),embed:c.definition}),t())}})]})]}):p.jsx(p.Fragment,{children:p.jsx(yd,{className:"tlui-embed-dialog__list",children:tc.map(y=>p.jsx(ae,{type:"menu",onClick:()=>i(y),label:y.title,children:p.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${o.embedIcons[y.type]})`}})},y.type))})})]})});var r1={exports:{}};r1.exports;(function(e){var t=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function i(l,c){if(!s[l]){s[l]={};for(var u=0;u<l.length;u++)s[l][l.charAt(u)]=u}return s[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return i(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return n(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),u=new Uint8Array(c.length*2),d=0,h=c.length;d<h;d++){var f=c.charCodeAt(d);u[d*2]=f>>>8,u[d*2+1]=f%256}return u},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),u=0,d=c.length;u<d;u++)c[u]=l[u*2]*256+l[u*2+1];var h=[];return c.forEach(function(f){h.push(n(f))}),a.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return o.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return i(o,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return n(c)})},_compress:function(l,c,u){if(l==null)return"";var d,h,f={},y={},g="",m="",v="",x=2,w=3,C=2,P=[],k=0,I=0,_;for(_=0;_<l.length;_+=1)if(g=l.charAt(_),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=w++,y[g]=!0),m=v+g,Object.prototype.hasOwnProperty.call(f,m))v=m;else{if(Object.prototype.hasOwnProperty.call(y,v)){if(v.charCodeAt(0)<256){for(d=0;d<C;d++)k=k<<1,I==c-1?(I=0,P.push(u(k)),k=0):I++;for(h=v.charCodeAt(0),d=0;d<8;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1}else{for(h=1,d=0;d<C;d++)k=k<<1|h,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=0;for(h=v.charCodeAt(0),d=0;d<16;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1}x--,x==0&&(x=Math.pow(2,C),C++),delete y[v]}else for(h=f[v],d=0;d<C;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1;x--,x==0&&(x=Math.pow(2,C),C++),f[m]=w++,v=String(g)}if(v!==""){if(Object.prototype.hasOwnProperty.call(y,v)){if(v.charCodeAt(0)<256){for(d=0;d<C;d++)k=k<<1,I==c-1?(I=0,P.push(u(k)),k=0):I++;for(h=v.charCodeAt(0),d=0;d<8;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1}else{for(h=1,d=0;d<C;d++)k=k<<1|h,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=0;for(h=v.charCodeAt(0),d=0;d<16;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1}x--,x==0&&(x=Math.pow(2,C),C++),delete y[v]}else for(h=f[v],d=0;d<C;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1;x--,x==0&&(x=Math.pow(2,C),C++)}for(h=2,d=0;d<C;d++)k=k<<1|h&1,I==c-1?(I=0,P.push(u(k)),k=0):I++,h=h>>1;for(;;)if(k=k<<1,I==c-1){P.push(u(k));break}else I++;return P.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var d=[],h=4,f=4,y=3,g="",m=[],v,x,w,C,P,k,I,_={val:u(0),position:c,index:1};for(v=0;v<3;v+=1)d[v]=v;for(w=0,P=Math.pow(2,2),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;switch(w){case 0:for(w=0,P=Math.pow(2,8),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;I=n(w);break;case 1:for(w=0,P=Math.pow(2,16),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;I=n(w);break;case 2:return""}for(d[3]=I,x=I,m.push(I);;){if(_.index>l)return"";for(w=0,P=Math.pow(2,y),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;switch(I=w){case 0:for(w=0,P=Math.pow(2,8),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;d[f++]=n(w),I=f-1,h--;break;case 1:for(w=0,P=Math.pow(2,16),k=1;k!=P;)C=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(C>0?1:0)*k,k<<=1;d[f++]=n(w),I=f-1,h--;break;case 2:return m.join("")}if(h==0&&(h=Math.pow(2,y),y++),d[I])g=d[I];else if(I===f)g=x+x.charAt(0);else return null;m.push(g),d[f++]=x+g.charAt(0),h--,x=g,h==0&&(h=Math.pow(2,y),y++)}}};return a}();e!=null?e.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})})(r1);var jj=r1.exports;async function Toe(e,t,n){var v,x,w;const{elements:r,files:o}=t,s={shapes:[],rootShapeIds:[],assets:[],schema:e.store.schema.serialize()},i=new Map,a=new Map,l=e.getCurrentPageId(),c=new Map,u=[],d=new Set;r.forEach(C=>{if(c.set(C.id,Je()),C.boundElements!==null)for(const P of C.boundElements)P.type==="text"&&d.add(P.id)});let h="a1";for(const C of r){if(d.has(C.id))continue;const P=c.get(C.id),k={id:P,typeName:"shape",parentId:l,index:h,x:C.x,y:C.y,rotation:0,isLocked:C.locked,opacity:Moe(C.opacity),meta:{}};switch(C.angle!==0&&a.set(P,C.angle),C.groupIds&&C.groupIds.length>0?i.has(C.groupIds[0])?(v=i.get(C.groupIds[0]))==null||v.push(P):i.set(C.groupIds[0],[P]):u.push(P),C.type){case"rectangle":case"ellipse":case"diamond":{let I="",_="middle";if(C.boundElements!==null){for(const T of C.boundElements)if(T.type==="text"){const R=r.find(j=>j.id===T.id);R&&(I=R.text,_=D2[R.textAlign])}}const M=C.backgroundColor==="transparent"?C.strokeColor:C.backgroundColor;s.shapes.push({...k,type:"geo",props:{geo:C.type,url:C.link??"",w:C.width,h:C.height,size:gp[C.strokeWidth]??"draw",color:ru[M]??"black",text:I,align:_,dash:mp(C),fill:$oe(C)}});break}case"freedraw":{s.shapes.push({...k,type:"draw",props:{dash:mp(C),size:gp[C.strokeWidth],color:ru[C.strokeColor]??"black",segments:[{type:"free",points:C.points.map(([I,_,M=.5])=>({x:I,y:_,z:M}))}]}});break}case"line":{const I=C.points[0],_=C.points[C.points.length-1],M=QA(C.points.length);s.shapes.push({...k,type:"line",props:{dash:mp(C),size:gp[C.strokeWidth],color:ru[C.strokeColor]??"black",spline:C.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:M[0],x:I[0],y:I[1]},end:{id:"end",type:"vertex",index:M[M.length-1],x:_[0],y:_[1]},...Object.fromEntries(C.points.slice(1,-1).map(([T,R],j)=>{const $=Ge();return[$,{id:$,type:"vertex",index:M[j+1],x:T,y:R}]}))}}});break}case"arrow":{let I="";if(C.boundElements!==null){for(const j of C.boundElements)if(j.type==="text"){const $=r.find(L=>L.id===j.id);$&&(I=$.text)}}const _=C.points[0],M=C.points[C.points.length-1],T=c.get((x=C.startBinding)==null?void 0:x.elementId),R=c.get((w=C.endBinding)==null?void 0:w.elementId);s.shapes.push({...k,type:"arrow",props:{text:I,bend:Noe(C,_,M),dash:mp(C),size:gp[C.strokeWidth]??"m",color:ru[C.strokeColor]??"black",start:T?{type:"binding",boundShapeId:T,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:_[0],y:_[1]},end:R?{type:"binding",boundShapeId:R,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:M[0],y:M[1]},arrowheadEnd:N2[C.endArrowhead]??"none",arrowheadStart:N2[C.startArrowhead]??"none"}});break}case"text":{const{size:I,scale:_}=Roe(C.fontSize);s.shapes.push({...k,type:"text",props:{size:I,scale:_,font:Ooe[C.fontFamily]??"draw",color:ru[C.strokeColor]??"black",text:C.text,align:D2[C.textAlign]}});break}case"image":{const I=o[C.fileId];if(!I)break;const _=Zi.createId();s.assets.push({id:_,typeName:"asset",type:"image",props:{w:C.width,h:C.height,name:C.id??"Untitled",isAnimated:!1,mimeType:I.mimeType,src:I.dataURL},meta:{}}),s.shapes.push({...k,type:"image",props:{w:C.width,h:C.height,assetId:_}})}}h=Zo(h)}const f=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContentOntoCurrentPage(s,{point:f,select:!1,preserveIds:!0});for(const C of i.values())if(C.length>1){e.groupShapes(C);const P=e.getShape(C[0]);P!=null&&P.parentId&&Pr(P.parentId)&&u.push(P.parentId)}for(const[C,P]of a)e.select(C),e.rotateShapesBy([C],P);const y=pe(u.map(C=>e.getShape(C))),g=le.Common(y.map(C=>e.getShapePageBounds(C))),m=e.getViewportPageBounds().center;e.updateShapes(y.map(C=>{const P={x:(C.x??0)-(g.x+g.w/2),y:(C.y??0)-(g.y+g.h/2)};return{id:C.id,type:C.type,x:m.x+P.x,y:m.y+P.y}})),e.setSelectedShapes(u)}const Moe=e=>{const t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},gp={1:"s",2:"m",3:"l",4:"xl"},Aoe={16:"s",20:"m",28:"l",36:"xl"};function Roe(e){const t=Aoe[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}const Ooe={1:"draw",2:"sans",3:"mono"},ru={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},joe={solid:"draw",dashed:"dashed",dotted:"dotted"},Doe={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},D2={left:"start",center:"middle",right:"end"},N2={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function Noe(e,t,n){let r=0;if(e.points.length>2){const o=new E(t[0],t[1]),s=new E(n[0],n[1]),i=new E(e.points[1][0],e.points[1][1]),a=E.Sub(s,o),l=E.Per(a),c=E.Med(s,o),u=E.Sub(c,l),d=E.Add(c,l),h=E.NearestPointOnLineSegment(u,d,i,!1);r=E.Dist(h,c),E.Clockwise(h,s,c)&&(r*=-1)}return r}const mp=e=>{let t=joe[e.strokeStyle]??"draw";return t==="draw"&&e.roughness===0&&(t="solid"),t},$oe=e=>e.backgroundColor==="transparent"?"none":Doe[e.fillStyle]??"solid";async function Dj(e,t,n,r){const s=(await Promise.all(t.map(async i=>await(await fetch(i)).blob()))).map(i=>new File([i],"tldrawFile",{type:i.type}));e.mark("paste"),await e.putExternalContent({type:"files",files:s,point:n,ignoreParent:!1,sources:r}),t.forEach(i=>URL.revokeObjectURL(i))}function Loe(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContentOntoCurrentPage(t,{point:r,select:!0})}async function fx(e,t,n,r){var o;try{if(new URL(t).pathname.match(/\.(png|jpe?g|gif|svg|webp)$/i)&&(o=(await fetch(t,{method:"HEAD"})).headers.get("content-type"))!=null&&o.match(/^image\//)){e.mark("paste"),Dj(e,[t]);return}}catch(s){s.message!=="Failed to fetch"&&console.error(s)}return e.mark("paste"),await e.putExternalContent({type:"url",point:n,url:t,sources:r})}const Nj=()=>{},$j=b.createContext({});function Foe({onEvent:e,children:t}){return p.jsx($j.Provider,{value:e??Nj,children:t})}function Ic(){return b.useContext($j)??Nj}function zoe(e){const t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}const Boe=e=>{try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}},Uoe=e=>{const t=e.split(/[\n\s]/);for(const n of t)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return RA(t)},Hoe=e=>/^<svg/.test(e),Voe=["input","select","textarea"];function wf(e){const{activeElement:t}=document;return e.getIsMenuOpen()||t&&(t.getAttribute("contenteditable")||Voe.indexOf(t.tagName.toLowerCase())>-1)}async function Gv(e){return new Promise((t,n)=>{const r=new FileReader;r.addEventListener("loadend",()=>{const o=r.result;t(o)}),r.addEventListener("error",()=>{n(r.error)}),r.readAsText(e)})}const Koe=e=>e.types.find(t=>t.match(/^image\//)),Yv=(e,t,n,r)=>{const o=Uoe(t);if(o)for(const s of o)fx(e,s,n);else Boe(t)?fx(e,t,n):Hoe(t)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:t,point:n,sources:r})):(e.mark("paste"),e.putExternalContent({type:"text",text:t,point:n,sources:r}))},Woe=async(e,t,n)=>{if(e.getEditingShapeId()!==null)return;if(!t)throw Error("No clipboard data");const r=[];for(const o of Object.values(t.items))switch(o.kind){case"file":{r.push({type:"file",source:new Promise(s=>s(o.getAsFile()))});break}case"string":{o.type==="text/html"?r.push({type:"html",source:new Promise(s=>o.getAsString(s))}):o.type==="text/plain"?r.push({type:"text",source:new Promise(s=>o.getAsString(s))}):r.push({type:o.type,source:new Promise(s=>o.getAsString(s))});break}}Fj(e,r,n)},Lj=async(e,t,n)=>{const r=[];for(const o of t){if(Koe(o))for(const s of o.types)s.match(/^image\//)&&r.push({type:"blob",source:o.getType(s)});o.types.includes("text/html")&&r.push({type:"html",source:new Promise(s=>o.getType("text/html").then(i=>Gv(i).then(s)))}),o.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise(s=>o.getType("text/uri-list").then(i=>Gv(i).then(s)))}),o.types.includes("text/plain")&&r.push({type:"text",source:new Promise(s=>o.getType("text/plain").then(i=>Gv(i).then(s)))})}return await Fj(e,r,n)};async function Fj(e,t,n){const r=t.filter(s=>(s.type==="file"||s.type==="blob")&&s.source!==null);if(r.length){const i=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await Dj(e,i,n)}const o=await Promise.all(t.filter(s=>s.type!=="file").map(s=>new Promise(i=>{const a=s;if(a.type==="file"){i({type:"error",data:null,reason:"unexpected file"});return}a.source.then(l=>{var u;const c=(u=l.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:u[1];if(c)try{const d=jj.decompressFromBase64(c);if(d===null){i({type:"error",data:d,reason:"found tldraw data comment but could not parse base64"});return}else{const h=JSON.parse(d);if(h.type!=="application/tldraw"&&i({type:"error",data:h,reason:`found tldraw data comment but JSON was of a different type: ${h.type}`}),typeof h.data=="string"){i({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}i({type:"tldraw",data:h.data});return}}catch{i({type:"error",data:c,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){i({type:"text",data:l,subtype:"html"});return}if(a.type==="url"){i({type:"text",data:l,subtype:"url"});return}try{const d=JSON.parse(l);if(d.type==="excalidraw/clipboard"){i({type:"excalidraw",data:d});return}else{i({type:"text",data:l,subtype:"json"});return}}catch{i({type:"text",data:l,subtype:"text"});return}}i({type:"error",data:l,reason:"unhandled case"})})})));for(const s of o)if(s.type==="tldraw"){Loe(e,s.data,n);return}for(const s of o)if(s.type==="excalidraw"){Toe(e,s.data,n);return}for(const s of o)if(s.type==="text"&&s.subtype==="html"){const a=new DOMParser().parseFromString(s.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(c=>c.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const c=a.firstElementChild.getAttribute("href");Yv(e,c,n,o);return}if(!o.some(c=>c.type==="text"&&c.subtype!=="html")&&s.data.trim()){Yv(e,zoe(s.data),n,o);return}}for(const s of o)if(s.type==="text"&&s.subtype==="url"){fx(e,s.data,n,o);return}for(const s of o)if(s.type==="text"&&s.subtype==="text"&&s.data.trim()){Yv(e,s.data,n,o);return}}const Dg=e=>{var r;const t=e.getContentFromCurrentPage(e.getSelectedShapeIds());if(!t){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const n=jj.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if(!(typeof navigator>"u")){const o=t.shapes.map(s=>e.isShapeOfType(s,"text")||e.isShapeOfType(s,"geo")||e.isShapeOfType(s,"arrow")?s.props.text:e.isShapeOfType(s,"bookmark")||e.isShapeOfType(s,"embed")?s.props.url:null).filter(T9);if((r=navigator.clipboard)!=null&&r.write){const s=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"});let i=o.join(" ");i===""&&(i=" "),navigator.clipboard.write([new ClipboardItem({"text/html":s,"text/plain":new Blob([i],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}};function Goe(){const e=W(),t=Ic(),n=b.useCallback(function(i){e.getSelectedShapeIds().length!==0&&(Dg(e),t("copy",{source:i}))},[e,t]),r=b.useCallback(function(i){e.getSelectedShapeIds().length!==0&&(Dg(e),e.deleteShapes(e.getSelectedShapeIds()),t("cut",{source:i}))},[e,t]),o=b.useCallback(async function(i,a,l){e.getEditingShapeId()!==null||wf(e)||(Array.isArray(i)&&i[0]instanceof ClipboardItem?(Lj(e,i,l),t("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{o(c,a,l)}))},[e,t]);return{copy:n,cut:r,paste:o}}function Yoe(){const e=W(),t=Ic(),n=q("editor.isFocused",()=>e.getInstanceState().isFocused,[e]);b.useEffect(()=>{if(!n)return;const r=()=>{e.getSelectedShapeIds().length===0||e.getEditingShapeId()!==null||wf(e)||(Dg(e),t("copy",{source:"kbd"}))};function o(){e.getSelectedShapeIds().length===0||e.getEditingShapeId()!==null||wf(e)||(Dg(e),e.deleteShapes(e.getSelectedShapeIds()),t("cut",{source:"kbd"}))}let s=!1;const i=l=>{l.button===1&&(s=!0,requestAnimationFrame(()=>{s=!1}))},a=l=>{if(s){l.stopPropagation();return}e.getEditingShapeId()!==null||wf(e)||(l.clipboardData&&!e.inputs.shiftKey?Woe(e,l.clipboardData):navigator.clipboard.read().then(c=>{Array.isArray(c)&&c[0]instanceof ClipboardItem&&Lj(e,c,e.inputs.currentPagePoint)}),t("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",o),document.addEventListener("paste",a),document.addEventListener("pointerup",i),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",o),document.removeEventListener("paste",a),document.removeEventListener("pointerup",i)}},[e,t,n])}async function Xoe(e,t,n){const{type:r,quality:o,scale:s}=n,i=+e.getAttribute("width"),a=+e.getAttribute("height");let l=i*s,c=a*s;const u=await zj(e),d=URL.createObjectURL(new Blob([u],{type:"image/svg+xml"})),h=await cO();if(i>h.maxWidth&&(l=h.maxWidth,c=l/i*a),a>h.maxHeight&&(c=h.maxHeight,l=c/a*i),l*c>h.maxArea){const v=Math.sqrt(h.maxArea/(l*c));l*=v,c*=v}l=Math.floor(l),c=Math.floor(c);const f=l/i,y=await new Promise(v=>{const x=new Image;x.crossOrigin="anonymous",x.onload=async()=>{t&&await new Promise(P=>setTimeout(P,250));const w=document.createElement("canvas"),C=w.getContext("2d");w.width=l,w.height=c,C.imageSmoothingEnabled=!0,C.imageSmoothingQuality="high",C.drawImage(x,0,0,l,c),URL.revokeObjectURL(d),v(w)},x.onerror=()=>{v(null)},x.src=d});if(!y)return null;const g=await new Promise(v=>y.toBlob(x=>{(!x||qe.throwToBlob.get())&&v(null),v(x)},"image/"+r,o));if(!g)return null;const m=new DataView(await g.arrayBuffer());return Po.setPhysChunk(m,f,{type:"image/"+r})}async function zj(e){const t=e.cloneNode(!0);e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+"");const n=new FileReader,r=Array.from(t.querySelectorAll("image"));for(const s of r){const i=s.getAttribute("xlink:href");if(i&&!i.startsWith("data:")){const a=await(await fetch(i)).blob(),l=await new Promise((c,u)=>{n.onload=()=>c(n.result),n.onerror=()=>u(n.error),n.readAsDataURL(a)});s.setAttribute("xlink:href",l)}}return new XMLSerializer().serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}async function Bj(e,t,n){const r=await e.getSvg(t!=null&&t.length?t:[...e.getCurrentPageShapeIds()],{scale:1,background:e.getInstanceState().exportBackground,...n});if(!r)throw new Error("Could not construct SVG.");return r}async function gx(e,t,n,r={}){switch(n){case"svg":return zj(await Bj(e,t,r));case"json":{const o=e.getContentFromCurrentPage(t);return JSON.stringify(o)}default:gc(n)}}async function Uj(e,t,n,r={}){switch(n){case"svg":return new Blob([await gx(e,t,"svg",r)],{type:"text/plain"});case"json":return new Blob([await gx(e,t,"json",r)],{type:"text/plain"});case"jpeg":case"png":case"webp":{const o=await Xoe(await Bj(e,t,r),e.environment.isSafari,{type:n,quality:1,scale:2});if(!o)throw new Error("Could not construct image.");return o}default:gc(n)}}const qoe={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",json:"text/plain",svg:"text/plain"};function Qoe(e,t,n,r={}){return{blobPromise:Uj(e,t,n,r),mimeType:qoe[n]}}function Zoe(e,t,n="svg",r={}){if(!window.navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(window.navigator.clipboard.write){const{blobPromise:o,mimeType:s}=Qoe(e,t,n,r);return window.navigator.clipboard.write([new ClipboardItem({[s]:o})]).catch(i=>(console.error(i),o.then(a=>window.navigator.clipboard.write([new ClipboardItem({[s]:a})]))))}switch(n){case"json":case"svg":return Joe(async()=>gx(e,t,n,r));case"jpeg":case"png":throw new Error("Copy not supported");default:gc(n)}}async function Joe(e){var t,n;await((n=(t=navigator.clipboard)==null?void 0:t.writeText)==null?void 0:n.call(t,await e()))}const Hj=b.createContext({});function ese({children:e}){const[t,n]=b.useState([]),r=b.useCallback(i=>{const a=i.id??Ge();return n(l=>[...l.filter(c=>c.id!==i.id),{...i,id:a}]),a},[]),o=b.useCallback(i=>(n(a=>a.filter(l=>l.id!==i)),i),[]),s=b.useCallback(()=>{n(()=>[])},[]);return p.jsx(Hj.Provider,{value:{toasts:t,addToast:r,removeToast:o,clearToasts:s},children:e})}function zo(){const e=b.useContext(Hj);if(!e)throw new Error("useToasts must be used within a ToastsProvider");return e}function tse(){const e=W(),{addToast:t}=zo(),n=Ie();return b.useCallback((r,o="svg")=>{Zoe(e,r,o).catch(()=>{t({id:"copy-fail",icon:"warning-triangle",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")})})},[e,t,n])}const Vj=b.createContext({});function nse({children:e}){const t=W(),n=Ic(),[r,o]=b.useState([]),s=b.useCallback(c=>{const u=c.id??Ge();return o(d=>[...d.filter(h=>h.id!==c.id),{...c,id:u}]),n("open-menu",{source:"dialog",id:u}),t.addOpenMenu(u),u},[t,n]),i=b.useCallback((c,u)=>(o(d=>d.map(h=>h.id===c?{...h,...u}:h)),n("open-menu",{source:"dialog",id:c}),t.addOpenMenu(c),c),[t,n]),a=b.useCallback(c=>(o(u=>u.filter(d=>{var h;return d.id===c?((h=d.onClose)==null||h.call(d),!1):!0})),n("close-menu",{source:"dialog",id:c}),t.deleteOpenMenu(c),c),[t,n]),l=b.useCallback(()=>{o(c=>(c.forEach(u=>{var d;(d=u.onClose)==null||d.call(u),n("close-menu",{source:"dialog",id:u.id}),t.deleteOpenMenu(u.id)}),[]))},[t,n]);return p.jsx(Vj.Provider,{value:{dialogs:r,addDialog:s,removeDialog:a,clearDialogs:l,updateDialog:i},children:e})}function Ta(){const e=b.useContext(Vj);if(!e)throw new Error("useDialogs must be used within a DialogsProvider");return e}async function rse(e,t,n="png",r={}){let o=`shapes at ${$2()}`;if(t.length===1){const a=e.getShape(t[0]);e.isShapeOfType(a,"frame")?o=a.props.name??"frame":o=`${a.id.replace(/:/,"_")} at ${$2()}`}o+=`.${n}`;const s=await Uj(e,t,n,r),i=new File([s],o,{type:s.type});ose(i)}function $2(){const e=new Date,t=String(e.getFullYear()).slice(2),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return`${t}-${n}-${r} ${o}.${s}.${i}`}function ose(e){const t=document.createElement("a"),n=URL.createObjectURL(e);t.href=n,t.download=e.name,t.click(),URL.revokeObjectURL(n)}function sse(){const e=W(),{addToast:t}=zo(),n=Ie();return b.useCallback((r,o="png")=>{rse(e,r,o,{scale:1,background:e.getInstanceState().exportBackground}).catch(s=>{console.error(s.message),t({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc")})})},[e,t,n])}function Kj(){const e=W(),t=b.useRef();return b.useEffect(()=>{const n=window.document.createElement("input");n.type="file",n.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",n.multiple=!0,t.current=n;async function r(o){const s=o.target.files;!s||s.length===0||(await e.putExternalContent({type:"files",files:Array.from(s),point:e.getViewportPageBounds().center,ignoreParent:!1}),n.value="")}return n.addEventListener("change",r),()=>{t.current=void 0,n.removeEventListener("change",r)}},[e]),b.useCallback(()=>{var n;(n=t.current)==null||n.click()},[t])}function ise(){const e=W(),t=b.useRef(null),n=b.useRef(null);return b.useCallback(async function(){const o=document.createElement("div"),s=document.createElement("style"),i=(v,x)=>{v&&(v.innerHTML=""),x&&document.head.contains(x)&&document.head.removeChild(x),v&&document.body.contains(v)&&document.body.removeChild(v)};i(t.current,n.current),t.current=o,n.current=s;const a=`tl-print-surface-${Ge()}`;o.className=a,s.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(s),document.body.appendChild(o)},c=()=>{e.once("change-history",()=>{i(o,s)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function u(v,x,w){try{o.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${v.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${w.outerHTML}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${x?"":"hide"}">
          ${x??""}
        </div>
      </div>`}catch(C){console.error(C)}}function d(){e.environment.isChromeForIos?(l(),window.print()):e.environment.isSafari?(l(),document.execCommand("print",!1)):window.print()}const h=e.getSelectedShapeIds(),f=e.getCurrentPageId(),y=e.getPages(),m={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(e.getSelectedShapeIds().length>0){const v=await e.getSvg(h,m);if(v){const x=y.find(w=>w.id===f);u(`tldraw  ${x==null?void 0:x.name}`,null,v),d()}}else{const v=e.getCurrentPage(),x=await e.getSvg(e.getSortedChildIdsForParent(v.id),m);x&&(u(`tldraw  ${v.name}`,null,x),d())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[e])}const Wj=b.createContext({});function ase(e){return Object.fromEntries(e.map(t=>[t.id,t]))}function lse({overrides:e,children:t}){const n=W(),{addDialog:r,clearDialogs:o}=Ta(),{clearToasts:s}=zo(),i=Kj(),a=ise(),{cut:l,copy:c,paste:u}=Goe(),d=tse(),h=sse(),f=Ic(),y=b.useMemo(()=>{function g(){return n.isIn("select")||(n.complete(),n.setCurrentTool("select")),!1}function m(){return n.getSelectedShapeIds().length>0}const x=ase([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(w){m()&&(g()||(f("edit-link",{source:w}),n.mark("edit-link"),r({component:Ioe})))}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(w){f("insert-embed",{source:w}),r({component:Oj})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(w){f("insert-media",{source:w}),i()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(w){f("undo",{source:w}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(w){f("redo",{source:w}),n.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(w){f("export-as",{format:"svg",source:w}),h(n.getSelectedShapeIds(),"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(w){f("export-as",{format:"png",source:w}),h(n.getSelectedShapeIds(),"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(w){f("export-as",{format:"json",source:w}),h(n.getSelectedShapeIds(),"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(w){f("copy-as",{format:"svg",source:w}),d(n.getSelectedShapeIds(),"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(w){f("copy-as",{format:"png",source:w}),d(n.getSelectedShapeIds(),"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(w){f("copy-as",{format:"json",source:w}),d(n.getSelectedShapeIds(),"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(w){m()&&(g()||(f("toggle-auto-size",{source:w}),n.mark("toggling auto size"),n.updateShapes(n.getSelectedShapes().filter(C=>n.isShapeOfType(C,"text")&&C.props.autoSize===!1).map(C=>({id:C.id,type:C.type,props:{...C.props,w:8,autoSize:!0}})))))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(w){f("open-embed-link",{source:w});const C=n.getSelectedShapeIds(),P="No embed shapes selected";if(C.length!==1){console.error(P);return}const k=n.getShape(C[0]);if(!k||!n.isShapeOfType(k,"embed")){console.error(P);return}DG(k.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(w){var C,P;if(((C=n.root.getCurrent())==null?void 0:C.id)!=="zoom"&&(f("zoom-tool",{source:w}),!(n.inputs.shiftKey||n.inputs.ctrlKey))){const k=n.root.getCurrent();k&&((P=k.getCurrent())==null?void 0:P.id)==="idle"&&n.setCurrentTool("zoom",{onInteractionEnd:k.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(w){m()&&(g()||n.batch(()=>{f("convert-to-bookmark",{source:w});const C=n.getSelectedShapes(),P=[],k=[];for(const I of C){if(!I||!n.isShapeOfType(I,"embed")||!I.props.url)continue;const _=new E(I.x,I.y);_.rot(-I.rotation),_.add(new E(I.props.w/2-300/2,I.props.h/2-320/2)),_.rot(I.rotation);const M={id:Je(),type:"bookmark",rotation:I.rotation,x:_.x,y:_.y,opacity:1,props:{url:I.props.url}};P.push(M),k.push(I.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(k),n.createShapes(P)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(w){m()&&(g()||(f("convert-to-embed",{source:w}),n.batch(()=>{const C=n.getSelectedShapeIds(),P=pe(C.map(_=>n.getShape(_))),k=[],I=[];for(const _ of P){if(!n.isShapeOfType(_,"bookmark"))continue;const{url:M}=_.props,T=ts(_.props.url);if(!T||!T.definition)continue;const{width:R,height:j}=T.definition,$=new E(_.x,_.y);$.rot(-_.rotation),$.add(new E(_.props.w/2-R/2,_.props.h/2-j/2)),$.rot(_.rotation);const L={id:Je(),type:"embed",x:$.x,y:$.y,rotation:_.rotation,props:{url:M,w:R,h:j}};k.push(L),I.push(_.id)}n.mark("convert shapes to embed"),n.deleteShapes(I),n.createShapes(k)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(w){if(!m()||g())return;f("duplicate-shapes",{source:w});const C=n.getSelectedShapeIds(),P=le.Common(pe(C.map(I=>n.getShapePageBounds(I)))),k=n.getInstanceState().canMoveCamera?{x:P.width+10,y:0}:{x:16/n.getZoomLevel(),y:16/n.getZoomLevel()};n.mark("duplicate shapes"),n.duplicateShapes(C,k)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(w){m()&&(g()||(f("ungroup-shapes",{source:w}),n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(w){if(!m()||g())return;f("group-shapes",{source:w});const C=n.getOnlySelectedShape();C&&n.isShapeOfType(C,"group")?(n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())):(n.mark("group"),n.groupShapes(n.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",readonlyOk:!1,onSelect(w){if(!m())return;f("remove-frame",{source:w});const C=n.getSelectedShapes();C.length>0&&C.every(P=>n.isShapeOfType(P,"frame"))&&(n.mark("remove-frame"),hre(n,C.map(P=>P.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",readonlyOk:!1,onSelect(w){if(!m())return;f("fit-frame-to-content",{source:w});const C=n.getOnlySelectedShape();C&&n.isShapeOfType(C,"frame")&&(n.mark("fit-frame-to-content"),fre(n,C.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"left",source:w}),n.mark("align left"),n.alignShapes(n.getSelectedShapeIds(),"left")))}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"center-horizontal",source:w}),n.mark("align center horizontal"),n.alignShapes(n.getSelectedShapeIds(),"center-horizontal")))}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"right",source:w}),n.mark("align right"),n.alignShapes(n.getSelectedShapeIds(),"right")))}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"center-vertical",source:w}),n.mark("align center vertical"),n.alignShapes(n.getSelectedShapeIds(),"center-vertical")))}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"top",source:w}),n.mark("align top"),n.alignShapes(n.getSelectedShapeIds(),"top")))}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(w){m()&&(g()||(f("align-shapes",{operation:"bottom",source:w}),n.mark("align bottom"),n.alignShapes(n.getSelectedShapeIds(),"bottom")))}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(w){m()&&(g()||(f("distribute-shapes",{operation:"horizontal",source:w}),n.mark("distribute horizontal"),n.distributeShapes(n.getSelectedShapeIds(),"horizontal")))}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(w){m()&&(g()||(f("distribute-shapes",{operation:"vertical",source:w}),n.mark("distribute vertical"),n.distributeShapes(n.getSelectedShapeIds(),"vertical")))}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(w){m()&&(g()||(f("stretch-shapes",{operation:"horizontal",source:w}),n.mark("stretch horizontal"),n.stretchShapes(n.getSelectedShapeIds(),"horizontal")))}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(w){m()&&(g()||(f("stretch-shapes",{operation:"vertical",source:w}),n.mark("stretch vertical"),n.stretchShapes(n.getSelectedShapeIds(),"vertical")))}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(w){m()&&(g()||(f("flip-shapes",{operation:"horizontal",source:w}),n.mark("flip horizontal"),n.flipShapes(n.getSelectedShapeIds(),"horizontal")))}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(w){m()&&(g()||(f("flip-shapes",{operation:"vertical",source:w}),n.mark("flip vertical"),n.flipShapes(n.getSelectedShapeIds(),"vertical")))}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(w){m()&&(g()||(f("pack-shapes",{source:w}),n.mark("pack"),n.packShapes(n.getSelectedShapeIds(),16)))}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(w){m()&&(g()||(f("stack-shapes",{operation:"vertical",source:w}),n.mark("stack-vertical"),n.stackShapes(n.getSelectedShapeIds(),"vertical",16)))}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(w){m()&&(g()||(f("stack-shapes",{operation:"horizontal",source:w}),n.mark("stack-horizontal"),n.stackShapes(n.getSelectedShapeIds(),"horizontal",16)))}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(w){m()&&(g()||(f("reorder-shapes",{operation:"toFront",source:w}),n.mark("bring to front"),n.bringToFront(n.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(w){m()&&(g()||(f("reorder-shapes",{operation:"forward",source:w}),n.mark("bring forward"),n.bringForward(n.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(w){m()&&(g()||(f("reorder-shapes",{operation:"backward",source:w}),n.mark("send backward"),n.sendBackward(n.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(w){m()&&(g()||(f("reorder-shapes",{operation:"toBack",source:w}),n.mark("send to back"),n.sendToBack(n.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(w){m()&&(g()||(n.mark("cut"),l(w)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(w){m()&&(g()||c(w))}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(w){var C;(C=navigator.clipboard)==null||C.read().then(P=>{u(P,w,w==="context-menu"?n.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(w){n.batch(()=>{g()||(f("select-all-shapes",{source:w}),n.mark("select all kbd"),n.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(w){m()&&(g()||(f("select-none-shapes",{source:w}),n.mark("select none"),n.selectNone()))}},{id:"delete",label:"action.delete",kbd:",del,backspace",icon:"trash",readonlyOk:!1,onSelect(w){m()&&(g()||(f("delete-shapes",{source:w}),n.mark("delete"),n.deleteShapes(n.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(w){if(!m()||g())return;f("rotate-cw",{source:w}),n.mark("rotate-cw");const C=n.getSelectionRotation()%(Ze/2),P=Tu(C,0)||Tu(C,Ze/2);n.rotateShapesBy(n.getSelectedShapeIds(),Ze/2-(P?0:C))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(w){if(!m()||g())return;f("rotate-ccw",{source:w}),n.mark("rotate-ccw");const C=n.getSelectionRotation()%(Ze/2),P=Tu(C,0);n.rotateShapesBy(n.getSelectedShapeIds(),P?-(Ze/2):-C)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(w){f("zoom-in",{source:w}),n.zoomIn(n.getViewportScreenCenter(),{duration:es})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(w){f("zoom-out",{source:w}),n.zoomOut(n.getViewportScreenCenter(),{duration:es})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(w){f("reset-zoom",{source:w}),n.resetZoom(n.getViewportScreenCenter(),{duration:es})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(w){f("zoom-to-fit",{source:w}),n.zoomToFit({duration:es})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(w){m()&&(g()||(f("zoom-to-selection",{source:w}),n.zoomToSelection({duration:es})))}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(w){f("toggle-snap-mode",{source:w}),n.user.updateUserPreferences({isSnapMode:!n.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(w){f("toggle-dark-mode",{source:w}),n.user.updateUserPreferences({isDarkMode:!n.user.getIsDarkMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(w){f("toggle-reduce-motion",{source:w}),n.user.updateUserPreferences({animationSpeed:n.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:"action.toggle-edge-scrolling",menuLabel:"action.toggle-edge-scrolling.menu",readonlyOk:!0,onSelect(w){f("toggle-edge-scrolling",{source:w}),n.user.updateUserPreferences({edgeScrollSpeed:n.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(w){f("toggle-transparent",{source:w}),n.updateInstanceState({exportBackground:!n.getInstanceState().exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(w){f("toggle-tool-lock",{source:w}),n.updateInstanceState({isToolLocked:!n.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",readonlyOk:!1,onSelect(w){f("unlock-all",{source:w});const C=[];for(const P of n.getCurrentPageShapes())P.isLocked&&C.push({id:P.id,type:P.type,isLocked:!1});C.length>0&&n.updateShapes(C)}},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(w){requestAnimationFrame(()=>{n.batch(()=>{f("toggle-focus-mode",{source:w}),o(),s(),n.updateInstanceState({isFocusMode:!n.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(w){f("toggle-grid-mode",{source:w}),n.updateInstanceState({isGridMode:!n.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(w){f("toggle-debug-mode",{source:w}),n.updateInstanceState({isDebugMode:!n.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(w){f("print",{source:w}),a()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(w){f("exit-pen-mode",{source:w}),n.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(w){f("stop-following",{source:w}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(w){f("zoom-to-content",{source:w}),n.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect(w){n.mark("locking"),f("toggle-lock",{source:w}),n.toggleLock(n.getSelectedShapeIds())}}]);return e?e(n,x,void 0):x},[n,f,e,r,i,h,d,l,c,u,o,s,a]);return p.jsx(Wj.Provider,{value:y,children:t})}function yn(){const e=b.useContext(Wj);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}function Hm(e){return e.filter(t=>t!=null&&t!==!1)}function be(e,...t){const n=Hm(t);return n.length===0?null:{id:e,type:"group",checkbox:n.every(r=>r.type==="item"&&r.actionItem.checkbox),disabled:n.every(r=>r.disabled),readonlyOk:n.some(r=>r.readonlyOk),children:n}}function bo(e,t,...n){const r=Hm(n);return r.length===0?null:{id:e,type:"submenu",label:t,children:r,disabled:r.every(o=>o.disabled),readonlyOk:r.some(o=>o.readonlyOk)}}function o1(e,t={}){const{readonlyOk:n=!0,disabled:r=!1}=t;return{id:e,type:"custom",disabled:r,readonlyOk:n}}function B(e,t={}){if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");const{checked:n=!1,disabled:r=!1}=t;return{id:e.id,type:"item",actionItem:e,disabled:r,checked:n,readonlyOk:e.readonlyOk}}function cse(e){return e.getSelectedShapeIds().map(r=>e.getShape(r)).filter(r=>!(!r||e.isShapeOfType(r,"arrow")&&r.props.start.type==="binding"||e.isShapeOfType(r,"arrow")&&r.props.end.type==="binding"))}const Gj=()=>{const e=W();return q("threeStackableItems",()=>cse(e).length>2,[e])};function use(e){const t=e.getSelectedShapes(),n=[],r=new Map;t.forEach(s=>{s.type==="arrow"?n.push(s):r.set(s.id,s)});const o=n.filter(s=>!(s.props.start.type==="binding"&&!r.has(s.props.start.boundShapeId)||s.props.end.type==="binding"&&!r.has(s.props.end.boundShapeId)));return Array.from(r.values()).concat(o)}const s1=()=>{const e=W();return q("allowGroup",()=>use(e).length>1,[e])},i1=()=>{const e=W();return q("allowUngroup",()=>e.getSelectedShapeIds().some(t=>{var n;return((n=e.getShape(t))==null?void 0:n.type)==="group"}),[e])},Yj=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,Xv=[0,390,428,468,580,640,840,1023],Xj=H.createContext(0);function dse({forceMobile:e=!1,children:t}){const n=W(),r=q("breakpoint",()=>{const{width:o}=n.getViewportScreenBounds(),s=e?3:Xv.length-1;for(let i=0;i<s;i++)if(o>Xv[i]&&o<=Xv[i+1])return i;return s},[n]);return p.jsx(Xj.Provider,{value:r,children:t})}function Nr(){return b.useContext(Xj)}function a1(){const e=W();return q("hasLinkShapeSelected",()=>{const t=e.getSelectedShapes();return t.length===1&&"url"in t[0].props&&t[0].type!=="embed"},[e])}const qj=H.createContext({}),hse=({overrides:e,children:t})=>{const n=W(),r=yn(),o=q("selected count",()=>n.getSelectedShapeIds().length,[n]),s=o>0,i=o>1,a=o>2,l=Gj(),c=s1(),u=i1(),d=a1(),h=Nr(),f=q("zoom is 1",()=>n.getZoomLevel()===1,[n]),y=b.useMemo(()=>{const g=[B(r["align-left"],{disabled:!i}),B(r["align-center-horizontal"],{disabled:!i}),B(r["align-right"],{disabled:!i}),B(r["stretch-horizontal"],{disabled:!i}),B(r["align-top"],{disabled:!i}),B(r["align-center-vertical"],{disabled:!i}),B(r["align-bottom"],{disabled:!i}),B(r["stretch-vertical"],{disabled:!i}),B(r["distribute-horizontal"],{disabled:!a}),B(r["distribute-vertical"],{disabled:!a}),B(r["stack-horizontal"],{disabled:!l}),B(r["stack-vertical"],{disabled:!l}),B(r["send-to-back"],{disabled:!s}),B(r["send-backward"],{disabled:!s}),B(r["bring-forward"],{disabled:!s}),B(r["bring-to-front"],{disabled:!s}),h<5?B(r["zoom-to-100"],{disabled:!!f}):B(r["rotate-ccw"],{disabled:!s}),B(r["rotate-cw"],{disabled:!s}),B(r["edit-link"],{disabled:!d}),c?B(r.group,{disabled:!i}):u?B(r.ungroup):B(r.group,{disabled:!i})];return e?e(n,g,{actions:r,oneSelected:s,twoSelected:i,threeSelected:a}):g},[n,f,c,e,r,s,i,a,l,u,d,h]);return p.jsx(qj.Provider,{value:y,children:t})};function pse(){const e=H.useContext(qj);if(!e)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}function fse(){const e=W();return q("onlyFlippableShape",()=>{const t=e.getSelectedShapes();return t.length===1&&t.every(n=>e.isShapeOfType(n,"group")||e.isShapeOfType(n,"arrow")||e.isShapeOfType(n,"line")||e.isShapeOfType(n,"draw"))},[e])}function Qj(){const e=W();return q("showAutoSizeToggle",()=>{const t=e.getSelectedShapes();return t.length===1&&e.isShapeOfType(t[0],"text")&&t[0].props.autoSize===!1},[e])}const Zj=H.createContext({}),gse=Ve(function({overrides:t,children:n}){var _;const r=W(),o=yn(),s=Qj(),i=fse(),a=r.getSelectedShapes(),l=a.length,c=l>0,u=l>1,d=l>2,h=Gj(),f=q("atLeastOneShapeOnPage",()=>r.getCurrentPageShapeIds().size>0,[]),y=q("isTransparentBg",()=>r.getInstanceState().exportBackground,[]),g=s1(),m=i1(),v=!!((_=window.navigator.clipboard)!=null&&_.write),x=a1(),w=r.getOnlySelectedShape(),C=c&&a.every(M=>r.isShapeOfType(M,"frame")),P=w&&r.isShapeOfType(w,"frame")&&r.getSortedChildIdsForParent(w).length>0,k=w&&r.isShapeOrAncestorLocked(w),I=b.useMemo(()=>{let M=Hm([be("selection",s&&B(o["toggle-auto-size"]),x&&!k&&B(o["edit-link"]),c&&!k&&B(o.duplicate),g&&!k&&B(o.group),m&&!k&&B(o.ungroup),C&&!k&&B(o["remove-frame"]),P&&!k&&B(o["fit-frame-to-content"]),c&&B(o["toggle-lock"])),be("modify",(u||i)&&bo("arrange","context-menu.arrange",u&&be("align",B(o["align-left"]),B(o["align-center-horizontal"]),B(o["align-right"]),B(o["align-top"]),B(o["align-center-vertical"]),B(o["align-bottom"])),d&&be("distribute",B(o["distribute-horizontal"]),B(o["distribute-vertical"])),u&&be("stretch",B(o["stretch-horizontal"]),B(o["stretch-vertical"])),i&&!k&&be("flip",B(o["flip-horizontal"]),B(o["flip-vertical"])),u&&be("order",B(o.pack,{disabled:!u}),h&&B(o["stack-vertical"]),h&&B(o["stack-horizontal"]))),c&&!k&&bo("reorder","context-menu.reorder",be("reorder",B(o["bring-to-front"]),B(o["bring-forward"]),B(o["send-backward"]),B(o["send-to-back"]))),c&&!k&&o1("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),be("clipboard-group",c&&!k&&B(o.cut),c&&B(o.copy),Yj&&B(o.paste)),f&&be("conversions",bo("copy-as","context-menu.copy-as",be("copy-as-group",B(o["copy-as-svg"]),v&&B(o["copy-as-png"]),B(o["copy-as-json"])),be("export-bg",B(o["toggle-transparent"],{checked:!y}))),bo("export-as","context-menu.export-as",be("export-as-group",B(o["export-as-svg"]),B(o["export-as-png"]),B(o["export-as-json"])),be("export-bg,",B(o["toggle-transparent"],{checked:!y})))),f&&be("set-selection-group",B(o["select-all"]),c&&B(o["select-none"])),c&&!k&&be("delete-group",B(o.delete))]);return t&&(M=t(r,M,{actions:o,oneSelected:c,twoSelected:u,threeSelected:d,showAutoSizeToggle:s,showUngroup:m,onlyFlippableShapeSelected:i})),M},[r,t,o,c,u,d,s,i,f,h,g,m,C,P,v,x,y,k]);return p.jsx(Zj.Provider,{value:I,children:n})});function Jj(){const e=H.useContext(Zj);if(!e)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}const e3=b.createContext({});function mse({overrides:e,children:t}){const n=W(),r=Ic(),{addDialog:o}=Ta(),s=Kj(),i=b.useMemo(()=>{const a=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(c){n.setCurrentTool("select"),r("select-tool",{source:c,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(c){n.setCurrentTool("hand"),r("select-tool",{source:c,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(c){n.setCurrentTool("eraser"),r("select-tool",{source:c,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(c){n.setCurrentTool("draw"),r("select-tool",{source:c,id:"draw"})}},...[...To.values].map(c=>({id:c,label:`tool.${c}`,readonlyOk:!1,meta:{geo:c},kbd:c==="rectangle"?"r":c==="ellipse"?"o":void 0,icon:"geo-"+c,onSelect(u){n.batch(()=>{n.updateInstanceState({stylesForNextShape:{...n.getInstanceState().stylesForNextShape,[To.id]:c}},{ephemeral:!0}),n.setCurrentTool("geo"),r("select-tool",{source:u,id:`geo-${c}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(c){n.setCurrentTool("arrow"),r("select-tool",{source:c,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(c){n.setCurrentTool("line"),r("select-tool",{source:c,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(c){n.setCurrentTool("frame"),r("select-tool",{source:c,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(c){n.setCurrentTool("text"),r("select-tool",{source:c,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(c){s(),r("select-tool",{source:c,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(c){n.setCurrentTool("note"),r("select-tool",{source:c,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(c){n.setCurrentTool("laser"),r("select-tool",{source:c,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(c){o({component:Oj}),r("select-tool",{source:c,id:"embed"})}}];a.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(c){n.setCurrentTool("highlight"),r("select-tool",{source:c,id:"highlight"})}});const l=Object.fromEntries(a.map(c=>[c.id,c]));return e?e(n,l,{insertMedia:s}):l},[e,n,r,s,o]);return p.jsx(e3.Provider,{value:i,children:t})}function l1(){const e=b.useContext(e3);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}const t3=H.createContext({}),yse=Ve(function({overrides:t,children:n}){const r=W(),o=l1(),s=yn(),i=b.useMemo(()=>{const a=pe([be("shortcuts-dialog.tools",B(s["toggle-tool-lock"]),B(o.select),B(o.draw),B(o.eraser),B(o.hand),B(o.rectangle),B(o.ellipse),B(o.arrow),B(o.line),B(o.text),B(o.frame),B(o.note),B(o.laser)),be("shortcuts-dialog.file",B(s["insert-media"]),B(s.print)),be("shortcuts-dialog.preferences",B(s["toggle-dark-mode"]),B(s["toggle-focus-mode"]),B(s["toggle-grid"])),be("shortcuts-dialog.edit",B(s.undo),B(s.redo),B(s.cut),B(s.copy),B(s.paste),B(s["select-all"]),B(s.delete),B(s.duplicate),B(s["export-as-svg"]),B(s["export-as-png"])),be("shortcuts-dialog.view",B(s["zoom-in"]),B(s["zoom-out"]),B(s["zoom-to-100"]),B(s["zoom-to-fit"]),B(s["zoom-to-selection"])),be("shortcuts-dialog.transform",B(s["bring-to-front"]),B(s["bring-forward"]),B(s["send-backward"]),B(s["send-to-back"]),B(s.group),B(s.ungroup),B(s["flip-horizontal"]),B(s["flip-vertical"]),B(s["align-top"]),B(s["align-center-vertical"]),B(s["align-bottom"]),B(s["align-left"]),B(s["align-center-horizontal"]),B(s["align-right"]))]);return t?t(r,a,{tools:o,actions:s}):a},[r,t,s,o]);return p.jsx(t3.Provider,{value:i,children:n})});function vse(){const e=H.useContext(t3);if(!e)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}const Sse=()=>{const e=Ie(),t=Dr(),n=vse();function r(o){if(!o||t&&!o.readonlyOk)return null;switch(o.type){case"group":return p.jsxs("div",{className:"tlui-shortcuts-dialog__group",children:[p.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(o.id)}),p.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:o.children.filter(s=>s&&s.type==="item"&&s.actionItem.kbd).map(r)})]},o.id);case"item":{const{id:s,label:i,shortcutsLabel:a,kbd:l}=o.actionItem;return p.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair",children:[p.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(a??i)}),p.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:p.jsx(Nm,{children:l})})]},s)}}}return p.jsxs(p.Fragment,{children:[p.jsxs(zm,{className:"tlui-shortcuts-dialog__header",children:[p.jsx(Bm,{children:e("shortcuts-dialog.title")}),p.jsx(Um,{})]}),p.jsx(yd,{className:"tlui-shortcuts-dialog__body",children:n.map(r)}),p.jsx("div",{className:"tlui-dialog__scrim"})]})};function n3(){const e=W();return{languages:ad,currentLanguage:e.user.getLocale()}}const r3=H.createContext({}),xse=Ve(function({overrides:t,children:n}){const r=W(),o=yn(),s=r.getSelectedShapeIds().length,i=s>0,a=s>1,l=s>2,{languages:c,currentLanguage:u}=n3(),{addDialog:d}=Ta(),h=b.useMemo(()=>{const f=pe([be("top",o1("LANGUAGE_MENU",{readonlyOk:!0}),B({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){d({component:Sse})}}))]);return t?t(r,f,{actions:o,currentLanguage:u,languages:c,oneSelected:i,twoSelected:a,threeSelected:l}):f},[r,t,c,o,i,a,l,u,d]);return p.jsx(r3.Provider,{value:h,children:n})});function wse(){const e=H.useContext(r3);if(!e)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}function o3(){const e=W();return q("useCanRedo",()=>e.getCanRedo(),[e])}function s3(){const e=W();return q("useCanUndo",()=>e.getCanUndo(),[e])}const i3=H.createContext({});function bse({overrides:e,children:t}){var F;const n=W(),r=yn(),s=Nr()<5,i=q("isDarkMode",()=>n.user.getIsDarkMode(),[n]),a=q("animationSpeed",()=>n.user.getAnimationSpeed(),[n]),l=q("edgeScrollSpeed",()=>n.user.getEdgeScrollSpeed(),[n]),c=q("isGridMode",()=>n.getInstanceState().isGridMode,[n]),u=q("isSnapMode",()=>n.user.getIsSnapMode(),[n]),d=q("isToolLock",()=>n.getInstanceState().isToolLocked,[n]),h=q("isFocusMode",()=>n.getInstanceState().isFocusMode,[n]),f=q("isDebugMode",()=>n.getInstanceState().isDebugMode,[n]),y=q("exportBackground",()=>n.getInstanceState().exportBackground,[n]),g=q("emptyPage",()=>n.getCurrentPageShapeIds().size===0,[n]),m=q("selectedCount",()=>n.getSelectedShapeIds().length,[n]),v=m===0,x=m>0,w=m>1,C=m>2,P=!!((F=window.navigator.clipboard)!=null&&F.write),k=a1(),I=Qj(),_=s1(),M=i1(),T=s3(),R=o3(),j=q("isZoomedTo100",()=>n.getZoomLevel()===1,[n]),$=q("oneEmbedSelected",()=>{const G=n.getOnlySelectedShape();return G?!!(n.isShapeOfType(G,"embed")&&G.props.url&&!n.isShapeOrAncestorLocked(G)):!1},[]),L=q("oneEmbeddableBookmarkSelected",()=>{const G=n.getOnlySelectedShape();return G?!!(n.isShapeOfType(G,"bookmark")&&G.props.url&&ts(G.props.url)&&!n.isShapeOrAncestorLocked(G)):!1},[]),U=b.useMemo(()=>{const G=Hm([be("menu",bo("file","menu.file",be("print",B(r.print,{disabled:g}))),bo("edit","menu.edit",be("undo-actions",B(r.undo,{disabled:!T}),B(r.redo,{disabled:!R})),be("clipboard-actions",B(r.cut,{disabled:v}),B(r.copy,{disabled:v}),B(r.paste,{disabled:!Yj})),be("conversions",bo("copy-as","menu.copy-as",be("copy-as-group",B(r["copy-as-svg"],{disabled:g}),B(r["copy-as-png"],{disabled:g||!P}),B(r["copy-as-json"],{disabled:g})),be("export-bg",B(r["toggle-transparent"],{checked:!y}))),bo("export-as","menu.export-as",be("export-as-group",B(r["export-as-svg"],{disabled:g}),B(r["export-as-png"],{disabled:g}),B(r["export-as-json"],{disabled:g})),be("export-bg",B(r["toggle-transparent"],{checked:!y})))),be("set-selection-group",B(r["select-all"],{disabled:g}),B(r["select-none"],{disabled:!x})),be("selection",I&&B(r["toggle-auto-size"]),k&&B(r["edit-link"]),B(r.duplicate,{disabled:!x}),_&&B(r.group),M&&B(r.ungroup),B(r["unlock-all"],{disabled:g})),be("delete-group",B(r.delete,{disabled:!x})),be("embeds",$&&B(r["open-embed-link"]),$&&B(r["convert-to-bookmark"]),L&&B(r["convert-to-embed"]))),bo("view","menu.view",be("view-actions",B(r["zoom-in"]),B(r["zoom-out"]),B(r["zoom-to-100"],{disabled:j}),B(r["zoom-to-fit"],{disabled:g}),B(r["zoom-to-selection"],{disabled:g||!x})))),be("extras",B(r["insert-embed"]),B(r["insert-media"])),be("preferences",bo("preferences","menu.preferences",be("preferences-actions",B(r["toggle-snap-mode"],{checked:u}),B(r["toggle-tool-lock"],{checked:d}),B(r["toggle-grid"],{checked:c}),B(r["toggle-dark-mode"],{checked:i}),B(r["toggle-focus-mode"],{checked:h}),B(r["toggle-edge-scrolling"],{checked:l===1}),B(r["toggle-reduce-motion"],{checked:a===0}),B(r["toggle-debug-mode"],{checked:f}))),s&&o1("LANGUAGE_MENU",{readonlyOk:!0}))]);return e?e(n,G,{actions:r,noneSelected:v,oneSelected:x,twoSelected:w,threeSelected:C}):G},[n,e,r,x,w,C,g,s,_,M,k,P,I,v,T,R,a,i,c,u,d,h,y,f,l,j,L,$]);return p.jsx(i3.Provider,{value:U,children:t})}function Cse(){const e=H.useContext(i3);if(!e)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}function We(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}const a3=H.createContext([]);function Pse({overrides:e,children:t}){const n=W(),r=l1(),o=H.useMemo(()=>{const s=pe([We(r.select),We(r.hand),We(r.draw),We(r.eraser),We(r.arrow),We(r.text),We(r.note),We(r.asset),We(r.rectangle),We(r.ellipse),We(r.diamond),We(r.triangle),We(r.trapezoid),We(r.rhombus),We(r.hexagon),We(r.cloud),We(r.star),We(r.oval),We(r["x-box"]),We(r["check-box"]),We(r["arrow-left"]),We(r["arrow-up"]),We(r["arrow-down"]),We(r["arrow-right"]),We(r.line),We(r.highlight),We(r.frame),We(r.laser)]);return e?e(n,s,{tools:r}):s},[n,e,r]);return p.jsx(a3.Provider,{value:o,children:t})}function kse(){const e=H.useContext(a3);if(!e)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}function Ese(){const{addToast:e,removeToast:t,clearToasts:n}=zo(),{addDialog:r,clearDialogs:o,removeDialog:s,updateDialog:i}=Ta(),l=Nr()<5,c=Ie();return b.useMemo(()=>({addToast:e,removeToast:t,clearToasts:n,addDialog:r,clearDialogs:o,removeDialog:s,updateDialog:i,msg:c,isMobile:l}),[r,e,o,n,c,s,t,i,l])}function Ise(e,t){const n={};for(const r of e)if(r.translations)for(const[o,s]of is(r.translations)){let i=n[o];i||(i=n[o]={}),Object.assign(i,s)}return{actionsMenu:(r,o,s)=>{for(const i of e)i.actionsMenu&&(o=i.actionsMenu(r,o,{...t,...s}));return o},actions:(r,o)=>{for(const s of e)s.actions&&(o=s.actions(r,o,t));return o},contextMenu:(r,o,s)=>{for(const i of e)i.contextMenu&&(o=i.contextMenu(r,o,{...t,...s}));return o},helpMenu:(r,o,s)=>{for(const i of e)i.helpMenu&&(o=i.helpMenu(r,o,{...t,...s}));return o},menu:(r,o,s)=>{for(const i of e)i.menu&&(o=i.menu(r,o,{...t,...s}));return o},toolbar:(r,o,s)=>{for(const i of e)i.toolbar&&(o=i.toolbar(r,o,{...t,...s}));return o},keyboardShortcutsMenu:(r,o,s)=>{for(const i of e)i.keyboardShortcutsMenu&&(o=i.keyboardShortcutsMenu(r,o,{...t,...s}));return o},tools:(r,o,s)=>{for(const i of e)i.tools&&(o=i.tools(r,o,{...t,...s}));return o},translations:n}}function l3(e){return b.useMemo(()=>e,e)}function _se(e){const t=l3(e==null?[]:Array.isArray(e)?e:[e]);return b.useMemo(()=>{const n={};for(const r of t)if(r.translations)for(const[o,s]of is(r.translations)){let i=n[o];i||(i=n[o]={}),Object.assign(i,s)}return n},[t])}function Tse(e){const t=Ese(),n=l3(e==null?[]:Array.isArray(e)?e:[e]);return b.useMemo(()=>Ise(n,t),[n,t])}function Mse({overrides:e,assetUrls:t,onUiEvent:n,forceMobile:r,children:o}){return p.jsx(gre,{assetUrls:dre(t),children:p.jsx(vre,{overrides:_se(e),children:p.jsx(Foe,{onEvent:n,children:p.jsx(ese,{children:p.jsx(nse,{children:p.jsx(dse,{forceMobile:r,children:p.jsx(Ase,{overrides:e,children:o})})})})})})})}function Ase({overrides:e,children:t}){const n=Tse(e);return p.jsx(lse,{overrides:n.actions,children:p.jsx(mse,{overrides:n.tools,children:p.jsx(Pse,{overrides:n.toolbar,children:p.jsx(hse,{overrides:n.actionsMenu,children:p.jsx(yse,{overrides:n.keyboardShortcutsMenu,children:p.jsx(gse,{overrides:n.contextMenu,children:p.jsx(xse,{overrides:n.helpMenu,children:p.jsx(bse,{overrides:n.menu,children:t})})})})})})})})}function Rse(){const e=W(),n=yn()["back-to-content"],[r,o]=b.useState(!1);return b.useEffect(()=>{let s=!1;const i=setInterval(()=>{const a=e.getRenderingShapes(),l=e.getRenderingBounds(),u=a.filter(d=>d.maskedPageBounds&&l.includes(d.maskedPageBounds)).length===0&&e.getCurrentPageShapes().length>0;s!==u&&(o(u),s=u)},1e3);return()=>{clearInterval(i)}},[e]),r?p.jsx(ae,{iconLeft:n.icon,label:n.label,type:"low",onClick:()=>{n.onSelect("helper-buttons"),o(!1)}}):null}var Ose=b.createContext(void 0);function Vm(e){const t=b.useContext(Ose);return e||t||"ltr"}function jse(e,t=[]){let n=[];function r(s,i){const a=b.createContext(i),l=n.length;n=[...n,i];function c(d){const{scope:h,children:f,...y}=d,g=(h==null?void 0:h[e][l])||a,m=b.useMemo(()=>y,Object.values(y));return p.jsx(g.Provider,{value:m,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,y=b.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=n.map(i=>b.createContext(i));return function(a){const l=(a==null?void 0:a[e])||s;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return o.scopeName=e,[r,Dse(o,...t)]}function Dse(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var qv="rovingFocusGroup.onEntryFocus",Nse={bubbles:!1,cancelable:!0},Km="RovingFocusGroup",[mx,c3,$se]=tm(Km),[Lse,Wm]=jse(Km,[$se]),[Fse,zse]=Lse(Km),u3=b.forwardRef((e,t)=>p.jsx(mx.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(mx.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(Bse,{...e,ref:t})})}));u3.displayName=Km;var Bse=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=b.useRef(null),f=Ye(t,h),y=Vm(s),[g=null,m]=Ss({prop:i,defaultProp:a,onChange:l}),[v,x]=b.useState(!1),w=qt(c),C=c3(n),P=b.useRef(!1),[k,I]=b.useState(0);return b.useEffect(()=>{const _=h.current;if(_)return _.addEventListener(qv,w),()=>_.removeEventListener(qv,w)},[w]),p.jsx(Fse,{scope:n,orientation:r,dir:y,loop:o,currentTabStopId:g,onItemFocus:b.useCallback(_=>m(_),[m]),onItemShiftTab:b.useCallback(()=>x(!0),[]),onFocusableItemAdd:b.useCallback(()=>I(_=>_+1),[]),onFocusableItemRemove:b.useCallback(()=>I(_=>_-1),[]),children:p.jsx(Ce.div,{tabIndex:v||k===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...e.style},onMouseDown:ee(e.onMouseDown,()=>{P.current=!0}),onFocus:ee(e.onFocus,_=>{const M=!P.current;if(_.target===_.currentTarget&&M&&!v){const T=new CustomEvent(qv,Nse);if(_.currentTarget.dispatchEvent(T),!T.defaultPrevented){const R=C().filter(F=>F.focusable),j=R.find(F=>F.active),$=R.find(F=>F.id===g),U=[j,$,...R].filter(Boolean).map(F=>F.ref.current);p3(U,u)}}P.current=!1}),onBlur:ee(e.onBlur,()=>x(!1))})})}),d3="RovingFocusGroupItem",h3=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:s,...i}=e,a=_o(),l=s||a,c=zse(d3,n),u=c.currentTabStopId===l,d=c3(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return b.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),p.jsx(mx.ItemSlot,{scope:n,id:l,focusable:r,active:o,children:p.jsx(Ce.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...i,ref:t,onMouseDown:ee(e.onMouseDown,y=>{r?c.onItemFocus(l):y.preventDefault()}),onFocus:ee(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:ee(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){c.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const g=Vse(y,c.orientation,c.dir);if(g!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(x=>x.focusable).map(x=>x.ref.current);if(g==="last")v.reverse();else if(g==="prev"||g==="next"){g==="prev"&&v.reverse();const x=v.indexOf(y.currentTarget);v=c.loop?Kse(v,x+1):v.slice(x+1)}setTimeout(()=>p3(v))}})})})});h3.displayName=d3;var Use={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Hse(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Vse(e,t,n){const r=Hse(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Use[r]}function p3(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function Kse(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var f3=u3,g3=h3,yx=["Enter"," "],Wse=["ArrowDown","PageUp","Home"],m3=["ArrowUp","PageDown","End"],Gse=[...Wse,...m3],Yse={ltr:[...yx,"ArrowRight"],rtl:[...yx,"ArrowLeft"]},Xse={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Zd="Menu",[vd,qse,Qse]=tm(Zd),[Ma,Gm]=vs(Zd,[Qse,pc,Wm]),Jd=pc(),y3=Wm(),[v3,Ai]=Ma(Zd),[Zse,eh]=Ma(Zd),S3=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:o,onOpenChange:s,modal:i=!0}=e,a=Jd(t),[l,c]=b.useState(null),u=b.useRef(!1),d=qt(s),h=Vm(o);return b.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),p.jsx(Lw,{...a,children:p.jsx(v3,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:p.jsx(Zse,{scope:t,onClose:b.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:i,children:r})})})};S3.displayName=Zd;var Jse="MenuAnchor",c1=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Jd(n);return p.jsx(lm,{...o,...r,ref:t})});c1.displayName=Jse;var u1="MenuPortal",[eie,x3]=Ma(u1,{forceMount:void 0}),w3=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:o}=e,s=Ai(u1,t);return p.jsx(eie,{scope:t,forceMount:n,children:p.jsx(gr,{present:n||s.open,children:p.jsx(Ad,{asChild:!0,container:o,children:r})})})};w3.displayName=u1;var Ar="MenuContent",[tie,d1]=Ma(Ar),b3=b.forwardRef((e,t)=>{const n=x3(Ar,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=Ai(Ar,e.__scopeMenu),i=eh(Ar,e.__scopeMenu);return p.jsx(vd.Provider,{scope:e.__scopeMenu,children:p.jsx(gr,{present:r||s.open,children:p.jsx(vd.Slot,{scope:e.__scopeMenu,children:i.modal?p.jsx(nie,{...o,ref:t}):p.jsx(rie,{...o,ref:t})})})})}),nie=b.forwardRef((e,t)=>{const n=Ai(Ar,e.__scopeMenu),r=b.useRef(null),o=Ye(t,r);return b.useEffect(()=>{const s=r.current;if(s)return qb(s)},[]),p.jsx(h1,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ee(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),rie=b.forwardRef((e,t)=>{const n=Ai(Ar,e.__scopeMenu);return p.jsx(h1,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),h1=b.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:y,...g}=e,m=Ai(Ar,n),v=eh(Ar,n),x=Jd(n),w=y3(n),C=qse(n),[P,k]=b.useState(null),I=b.useRef(null),_=Ye(t,I,m.onContentChange),M=b.useRef(0),T=b.useRef(""),R=b.useRef(0),j=b.useRef(null),$=b.useRef("right"),L=b.useRef(0),U=y?Fm:b.Fragment,F=y?{as:fi,allowPinchZoom:!0}:void 0,G=z=>{var Te,Oe;const V=T.current+z,K=C().filter(Pe=>!Pe.disabled),J=document.activeElement,ne=(Te=K.find(Pe=>Pe.ref.current===J))==null?void 0:Te.textValue,me=K.map(Pe=>Pe.textValue),te=gie(me,V,ne),de=(Oe=K.find(Pe=>Pe.textValue===te))==null?void 0:Oe.ref.current;(function Pe(Fe){T.current=Fe,window.clearTimeout(M.current),Fe!==""&&(M.current=window.setTimeout(()=>Pe(""),1e3))})(V),de&&setTimeout(()=>de.focus())};b.useEffect(()=>()=>window.clearTimeout(M.current),[]),Xb();const D=b.useCallback(z=>{var K,J;return $.current===((K=j.current)==null?void 0:K.side)&&yie(z,(J=j.current)==null?void 0:J.area)},[]);return p.jsx(tie,{scope:n,searchRef:T,onItemEnter:b.useCallback(z=>{D(z)&&z.preventDefault()},[D]),onItemLeave:b.useCallback(z=>{var V;D(z)||((V=I.current)==null||V.focus(),k(null))},[D]),onTriggerLeave:b.useCallback(z=>{D(z)&&z.preventDefault()},[D]),pointerGraceTimerRef:R,onPointerGraceIntentChange:b.useCallback(z=>{j.current=z},[]),children:p.jsx(U,{...F,children:p.jsx($m,{asChild:!0,trapped:o,onMountAutoFocus:ee(s,z=>{var V;z.preventDefault(),(V=I.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:p.jsx(cc,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:p.jsx(f3,{asChild:!0,...w,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:P,onCurrentTabStopIdChange:k,onEntryFocus:ee(l,z=>{v.isUsingKeyboardRef.current||z.preventDefault()}),preventScrollOnEntryFocus:!0,children:p.jsx(Fw,{role:"menu","aria-orientation":"vertical","data-state":F3(m.open),"data-radix-menu-content":"",dir:v.dir,...x,...g,ref:_,style:{outline:"none",...g.style},onKeyDown:ee(g.onKeyDown,z=>{const K=z.target.closest("[data-radix-menu-content]")===z.currentTarget,J=z.ctrlKey||z.altKey||z.metaKey,ne=z.key.length===1;K&&(z.key==="Tab"&&z.preventDefault(),!J&&ne&&G(z.key));const me=I.current;if(z.target!==me||!Gse.includes(z.key))return;z.preventDefault();const de=C().filter(Te=>!Te.disabled).map(Te=>Te.ref.current);m3.includes(z.key)&&de.reverse(),pie(de)}),onBlur:ee(e.onBlur,z=>{z.currentTarget.contains(z.target)||(window.clearTimeout(M.current),T.current="")}),onPointerMove:ee(e.onPointerMove,Sd(z=>{const V=z.target,K=L.current!==z.clientX;if(z.currentTarget.contains(V)&&K){const J=z.clientX>L.current?"right":"left";$.current=J,L.current=z.clientX}}))})})})})})})});b3.displayName=Ar;var oie="MenuGroup",p1=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Ce.div,{role:"group",...r,ref:t})});p1.displayName=oie;var sie="MenuLabel",C3=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Ce.div,{...r,ref:t})});C3.displayName=sie;var Ng="MenuItem",L2="menu.itemSelect",Ym=b.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...o}=e,s=b.useRef(null),i=eh(Ng,e.__scopeMenu),a=d1(Ng,e.__scopeMenu),l=Ye(t,s),c=b.useRef(!1),u=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(L2,{bubbles:!0,cancelable:!0});d.addEventListener(L2,f=>r==null?void 0:r(f),{once:!0}),Sw(d,h),h.defaultPrevented?c.current=!1:i.onClose()}};return p.jsx(P3,{...o,ref:l,disabled:n,onClick:ee(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:ee(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:ee(e.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||yx.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Ym.displayName=Ng;var P3=b.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...s}=e,i=d1(Ng,n),a=y3(n),l=b.useRef(null),c=Ye(t,l),[u,d]=b.useState(!1),[h,f]=b.useState("");return b.useEffect(()=>{const y=l.current;y&&f((y.textContent??"").trim())},[s.children]),p.jsx(vd.ItemSlot,{scope:n,disabled:r,textValue:o??h,children:p.jsx(g3,{asChild:!0,...a,focusable:!r,children:p.jsx(Ce.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:ee(e.onPointerMove,Sd(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ee(e.onPointerLeave,Sd(y=>i.onItemLeave(y))),onFocus:ee(e.onFocus,()=>d(!0)),onBlur:ee(e.onBlur,()=>d(!1))})})})}),iie="MenuCheckboxItem",k3=b.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...o}=e;return p.jsx(M3,{scope:e.__scopeMenu,checked:n,children:p.jsx(Ym,{role:"menuitemcheckbox","aria-checked":$g(n)?"mixed":n,...o,ref:t,"data-state":m1(n),onSelect:ee(o.onSelect,()=>r==null?void 0:r($g(n)?!0:!n),{checkForDefaultPrevented:!1})})})});k3.displayName=iie;var E3="MenuRadioGroup",[aie,lie]=Ma(E3,{value:void 0,onValueChange:()=>{}}),I3=b.forwardRef((e,t)=>{const{value:n,onValueChange:r,...o}=e,s=qt(r);return p.jsx(aie,{scope:e.__scopeMenu,value:n,onValueChange:s,children:p.jsx(p1,{...o,ref:t})})});I3.displayName=E3;var _3="MenuRadioItem",T3=b.forwardRef((e,t)=>{const{value:n,...r}=e,o=lie(_3,e.__scopeMenu),s=n===o.value;return p.jsx(M3,{scope:e.__scopeMenu,checked:s,children:p.jsx(Ym,{role:"menuitemradio","aria-checked":s,...r,ref:t,"data-state":m1(s),onSelect:ee(r.onSelect,()=>{var i;return(i=o.onValueChange)==null?void 0:i.call(o,n)},{checkForDefaultPrevented:!1})})})});T3.displayName=_3;var f1="MenuItemIndicator",[M3,cie]=Ma(f1,{checked:!1}),A3=b.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...o}=e,s=cie(f1,n);return p.jsx(gr,{present:r||$g(s.checked)||s.checked===!0,children:p.jsx(Ce.span,{...o,ref:t,"data-state":m1(s.checked)})})});A3.displayName=f1;var uie="MenuSeparator",R3=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(Ce.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});R3.displayName=uie;var die="MenuArrow",O3=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Jd(n);return p.jsx(zw,{...o,...r,ref:t})});O3.displayName=die;var g1="MenuSub",[hie,j3]=Ma(g1),D3=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:o}=e,s=Ai(g1,t),i=Jd(t),[a,l]=b.useState(null),[c,u]=b.useState(null),d=qt(o);return b.useEffect(()=>(s.open===!1&&d(!1),()=>d(!1)),[s.open,d]),p.jsx(Lw,{...i,children:p.jsx(v3,{scope:t,open:r,onOpenChange:d,content:c,onContentChange:u,children:p.jsx(hie,{scope:t,contentId:_o(),triggerId:_o(),trigger:a,onTriggerChange:l,children:n})})})};D3.displayName=g1;var yu="MenuSubTrigger",N3=b.forwardRef((e,t)=>{const n=Ai(yu,e.__scopeMenu),r=eh(yu,e.__scopeMenu),o=j3(yu,e.__scopeMenu),s=d1(yu,e.__scopeMenu),i=b.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},u=b.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return b.useEffect(()=>u,[u]),b.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),p.jsx(c1,{asChild:!0,...c,children:p.jsx(P3,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":F3(n.open),...e,ref:em(t,o.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ee(e.onPointerMove,Sd(d=>{s.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ee(e.onPointerLeave,Sd(d=>{var f,y;u();const h=(f=n.content)==null?void 0:f.getBoundingClientRect();if(h){const g=(y=n.content)==null?void 0:y.dataset.side,m=g==="right",v=m?-5:5,x=h[m?"left":"right"],w=h[m?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x,y:h.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ee(e.onKeyDown,d=>{var f;const h=s.searchRef.current!=="";e.disabled||h&&d.key===" "||Yse[r.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});N3.displayName=yu;var $3="MenuSubContent",L3=b.forwardRef((e,t)=>{const n=x3(Ar,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=Ai(Ar,e.__scopeMenu),i=eh(Ar,e.__scopeMenu),a=j3($3,e.__scopeMenu),l=b.useRef(null),c=Ye(t,l);return p.jsx(vd.Provider,{scope:e.__scopeMenu,children:p.jsx(gr,{present:r||s.open,children:p.jsx(vd.Slot,{scope:e.__scopeMenu,children:p.jsx(h1,{id:a.contentId,"aria-labelledby":a.triggerId,...o,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ee(e.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ee(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ee(e.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),h=Xse[i.dir].includes(u.key);d&&h&&(s.onOpenChange(!1),(f=a.trigger)==null||f.focus(),u.preventDefault())})})})})})});L3.displayName=$3;function F3(e){return e?"open":"closed"}function $g(e){return e==="indeterminate"}function m1(e){return $g(e)?"indeterminate":e?"checked":"unchecked"}function pie(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function fie(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function gie(e,t,n){const o=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=fie(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function mie(e,t){const{x:n,y:r}=e;let o=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const a=t[s].x,l=t[s].y,c=t[i].x,u=t[i].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(o=!o)}return o}function yie(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return mie(n,t)}function Sd(e){return t=>t.pointerType==="mouse"?e(t):void 0}var z3=S3,B3=c1,U3=w3,H3=b3,V3=p1,K3=C3,W3=Ym,G3=k3,Y3=I3,X3=T3,q3=A3,Q3=R3,Z3=O3,J3=D3,eD=N3,tD=L3,y1="DropdownMenu",[vie,Kce]=vs(y1,[Gm]),vn=Gm(),[Sie,nD]=vie(y1),rD=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:o,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=vn(t),c=b.useRef(null),[u=!1,d]=Ss({prop:o,defaultProp:s,onChange:i});return p.jsx(Sie,{scope:t,triggerId:_o(),triggerRef:c,contentId:_o(),open:u,onOpenChange:d,onOpenToggle:b.useCallback(()=>d(h=>!h),[d]),modal:a,children:p.jsx(z3,{...l,open:u,onOpenChange:d,dir:r,modal:a,children:n})})};rD.displayName=y1;var oD="DropdownMenuTrigger",sD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=e,s=nD(oD,n),i=vn(n);return p.jsx(B3,{asChild:!0,...i,children:p.jsx(Ce.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:em(t,s.triggerRef),onPointerDown:ee(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ee(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});sD.displayName=oD;var xie="DropdownMenuPortal",iD=e=>{const{__scopeDropdownMenu:t,...n}=e,r=vn(t);return p.jsx(U3,{...r,...n})};iD.displayName=xie;var aD="DropdownMenuContent",lD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=nD(aD,n),s=vn(n),i=b.useRef(!1);return p.jsx(H3,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...r,ref:t,onCloseAutoFocus:ee(e.onCloseAutoFocus,a=>{var l;i.current||(l=o.triggerRef.current)==null||l.focus(),i.current=!1,a.preventDefault()}),onInteractOutside:ee(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!o.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lD.displayName=aD;var wie="DropdownMenuGroup",cD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(V3,{...o,...r,ref:t})});cD.displayName=wie;var bie="DropdownMenuLabel",Cie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(K3,{...o,...r,ref:t})});Cie.displayName=bie;var Pie="DropdownMenuItem",uD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(W3,{...o,...r,ref:t})});uD.displayName=Pie;var kie="DropdownMenuCheckboxItem",dD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(G3,{...o,...r,ref:t})});dD.displayName=kie;var Eie="DropdownMenuRadioGroup",Iie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(Y3,{...o,...r,ref:t})});Iie.displayName=Eie;var _ie="DropdownMenuRadioItem",Tie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(X3,{...o,...r,ref:t})});Tie.displayName=_ie;var Mie="DropdownMenuItemIndicator",hD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(q3,{...o,...r,ref:t})});hD.displayName=Mie;var Aie="DropdownMenuSeparator",Rie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(Q3,{...o,...r,ref:t})});Rie.displayName=Aie;var Oie="DropdownMenuArrow",jie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(Z3,{...o,...r,ref:t})});jie.displayName=Oie;var Die=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:o,defaultOpen:s}=e,i=vn(t),[a=!1,l]=Ss({prop:r,defaultProp:s,onChange:o});return p.jsx(J3,{...i,open:a,onOpenChange:l,children:n})},Nie="DropdownMenuSubTrigger",pD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(eD,{...o,...r,ref:t})});pD.displayName=Nie;var $ie="DropdownMenuSubContent",fD=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=vn(n);return p.jsx(tD,{...o,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fD.displayName=$ie;var gD=rD,xd=sD,v1=iD,mD=lD,Lie=cD,el=uD,yD=dD,Fie=hD,zie=Die,Bie=pD,Uie=fD;function Aa(e,t){const n=W(),r=b.useRef(!1),o=Ic(),s=b.useRef(0),i=b.useCallback(l=>{const c=Date.now();c-s.current<50||(s.current=c,r.current=l,n.batch(()=>{l?(n.complete(),n.addOpenMenu(e)):n.updateInstanceState({openMenus:n.getOpenMenus().filter(u=>!u.startsWith(e))}),t==null||t(l)}))},[n,e,t]),a=q("is menu open",()=>n.getOpenMenus().includes(e),[n,e]);return b.useEffect(()=>(r.current&&(o("open-menu",{source:"unknown",id:e}),n.addOpenMenu(e)),()=>{r.current&&(n.deleteOpenMenu(e),n.getOpenMenus().forEach(l=>{l.startsWith(e)&&(o("close-menu",{source:"unknown",id:e}),n.deleteOpenMenu(l))}),r.current=!1)}),[n,e,o]),[a,i]}function bi({id:e,children:t,modal:n=!1,debugOpen:r=!1}){const[o,s]=Aa(e);return p.jsx(gD,{open:r||o,dir:"ltr",modal:n,onOpenChange:s,children:t})}function th({children:e,"data-testid":t}){return p.jsx(xd,{dir:"ltr","data-testid":t,asChild:!0,onTouchEnd:n=>Re(n),children:e})}function Ci({side:e="bottom",align:t="start",sideOffset:n=8,alignOffset:r=8,children:o}){const s=mn();return p.jsx(v1,{container:s,children:p.jsx(mD,{className:"tlui-menu",align:t,sideOffset:n,side:e,alignOffset:r,collisionPadding:4,children:o})})}function S1({id:e,children:t}){const[n,r]=Aa(e);return p.jsx(zie,{open:n,onOpenChange:r,children:t})}function x1({label:e,"data-testid":t,"data-direction":n}){return p.jsx(Bie,{dir:"ltr","data-direction":n,"data-testid":t,asChild:!0,children:p.jsx(ae,{type:"menu",className:"tlui-menu__submenu__trigger",label:e,icon:"chevron-right"})})}function w1({alignOffset:e=0,sideOffset:t=5,children:n}){const r=mn();return p.jsx(v1,{container:r,children:p.jsx(Uie,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:t,collisionPadding:4,children:n})})}function cs({children:e,size:t="medium"}){return p.jsx(Lie,{dir:"ltr",className:"tlui-menu__group","data-size":t,children:e})}function or({noClose:e,...t}){return p.jsx(el,{dir:"ltr",asChild:!0,onClick:e||t.isChecked!==void 0?Re:void 0,children:p.jsx(ae,{...t})})}function vD({children:e,onSelect:t,...n}){return p.jsxs(yD,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",onSelect:r=>{t==null||t(r),Re(r)},...n,children:[p.jsx(ur,{small:!0,icon:n.checked?"check":"checkbox-empty"}),e]})}function Hie({children:e,onSelect:t,...n}){return p.jsxs(yD,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",onSelect:r=>{t==null||t(r),Re(r)},...n,children:[p.jsx("div",{className:"tlui-button__checkbox__indicator",children:p.jsx(Fie,{dir:"ltr",children:p.jsx(ur,{icon:"check",small:!0})})}),e]})}let F2=0;function Vie(e,t){const n=Array(t),r=Math.floor(Math.sqrt(t));for(let o=0;o<t;o++)F2++,n[o]={id:Je("box"+F2),type:"geo",x:o%r*132,y:Math.floor(o/r)*132};e.batch(()=>{e.createShapes(n).setSelectedShapes(n.map(o=>o.id))})}const Kie=b.memo(function({renderDebugMenuItems:t}){const n=Ie();return p.jsxs("div",{className:"tlui-debug-panel",children:[p.jsx(Wie,{}),p.jsx(Gie,{}),p.jsxs(bi,{id:"debug",children:[p.jsx(th,{children:p.jsx(ae,{type:"icon",icon:"dots-horizontal",title:n("debug-panel.more")})}),p.jsx(Ci,{side:"top",align:"end",alignOffset:0,children:p.jsx(Yie,{renderDebugMenuItems:t})})]})]})}),Wie=Ve(function(){const t=W();return p.jsx("div",{className:"tlui-debug-panel__current-state",children:t.getPath()})}),Gie=function(){const t=W(),n=q("rendering shapes count",()=>t.getRenderingShapes().length,[t]);return p.jsxs("div",{children:[n," Shapes"]})},Yie=Ve(function({renderDebugMenuItems:t}){const n=W(),{addToast:r}=zo(),{addDialog:o}=Ta(),[s,i]=b.useState(!1);return p.jsxs(p.Fragment,{children:[p.jsxs(cs,{children:[p.jsx(or,{type:"menu",onClick:()=>{r({id:Ge(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0}),r({id:Ge(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),r({id:Ge(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,icon:"twitter",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]})},label:"Show toast"}),p.jsx(or,{type:"menu",onClick:()=>{o({component:({onClose:a})=>p.jsx(qie,{displayDontShowAgain:!0,onCancel:()=>{a()},onContinue:()=>{a()}}),onClose:()=>{}})},label:"Show dialog"}),p.jsx(or,{type:"menu",onClick:()=>Vie(n,100),label:"Create 100 shapes"}),p.jsx(or,{type:"menu",onClick:()=>{function a({children:h}){let f=0;if(!h.length)return 0;for(const y of[...h])f++,f+=a(y);return f}const l=n.getSelectedShapes(),c=l.length===0?n.getRenderingShapes():l,u=c.map(h=>document.getElementById(h.id).parentElement);let d=u.length;for(const h of u)d+=a(h);window.alert(`Shapes ${c.length}, DOM nodes:${d}`)},label:"Count shapes / nodes"}),(()=>{if(s)throw Error("oh no!")})(),p.jsx(or,{type:"menu",onClick:()=>{i(!0)},label:"Throw error"}),p.jsx(or,{type:"menu",onClick:()=>{pA()},label:"Hard reset"})]}),p.jsxs(cs,{children:[p.jsx(ou,{flag:qe.debugSvg}),p.jsx(ou,{flag:qe.forceSrgb}),p.jsx(ou,{flag:qe.debugGeometry}),p.jsx(ou,{flag:qe.hideShapes})]}),p.jsx(cs,{children:Object.values(fB).map(a=>p.jsx(ou,{flag:a},a.name))}),t==null?void 0:t()]})});function Xie({label:e,value:t,onChange:n}){return p.jsx(vD,{title:e,checked:t,onSelect:()=>n(!t),children:p.jsx("span",{className:"tlui-button__label",draggable:!1,children:e})})}const ou=Ve(function({flag:t,onChange:n}){return p.jsx(Xie,{label:t.name.replace(/([a-z0-9])([A-Z])/g,r=>`${r[0]} ${r[1].toLowerCase()}`).replace(/^[a-z]/,r=>r.toUpperCase()),value:t.get(),onChange:r=>{t.set(r),n==null||n(r)}})});function qie({title:e="title",body:t="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:o=!1,onCancel:s,onContinue:i}){const[a,l]=b.useState(!1);return p.jsxs(p.Fragment,{children:[p.jsxs(zm,{children:[p.jsx(Bm,{children:e}),p.jsx(Um,{})]}),p.jsx(yd,{style:{maxWidth:350},children:t}),p.jsxs(t1,{className:"tlui-dialog__footer__actions",children:[o&&p.jsx(ae,{type:"normal",onClick:()=>l(!a),iconLeft:a?"check":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),p.jsx(ae,{type:"normal",onClick:s,children:n}),p.jsx(ae,{type:"primary",onClick:async()=>i(),children:r})]})]})}const Qie=({id:e,component:t,onClose:n})=>{const{removeDialog:r}=Ta(),o=mn(),s=b.useCallback(i=>{if(!i){if(n)try{n()}catch(a){console.warn(a)}r(e)}},[e,n,r]);return p.jsx(Coe,{onOpenChange:s,defaultOpen:!0,children:p.jsx(Poe,{container:o,children:p.jsx(koe,{dir:"ltr",className:"tlui-dialog__overlay",children:p.jsx(Eoe,{dir:"ltr",className:"tlui-dialog__content",children:p.jsx(t,{onClose:()=>s(!1)})})})})})};function Zie(){const{dialogs:e}=Ta();return p.jsx(p.Fragment,{children:e.map(t=>p.jsx(Qie,{...t},t.id))})}const Jie=H.memo(Zie);function eae(){const e=W(),t=q("follow",()=>e.getInstanceState().followingUserId,[e]);return t?p.jsx(tae,{userId:t}):null}function tae({userId:e}){const t=OA(e);return t?p.jsx("div",{className:"tlui-following-indicator",style:{borderColor:t.color}}):null}function SD(){const e=W(),{languages:t,currentLanguage:n}=n3(),r=b.useCallback(o=>e.user.updateUserPreferences({locale:o}),[e]);return p.jsxs(S1,{id:"help menu language",children:[p.jsx(x1,{label:"menu.language","data-direction":"left"}),p.jsx(w1,{sideOffset:-4,children:p.jsx(cs,{children:t.map(({locale:o,label:s})=>p.jsx(Hie,{title:o,checked:o===n,onSelect:()=>r(o),children:p.jsx("span",{className:"tlui-button__label",children:s})},o))})})]})}const nae=b.memo(function(){const t=mn(),n=Ie(),[r,o]=Aa("help menu");return p.jsx("div",{className:"tlui-help-menu",children:p.jsxs(gD,{dir:"ltr",open:r,onOpenChange:o,modal:!1,children:[p.jsx(xd,{asChild:!0,dir:"ltr",children:p.jsx(ae,{type:"help",className:"tlui-button",smallIcon:!0,title:n("help-menu.title"),icon:"question-mark"})}),p.jsx(v1,{container:t,children:p.jsx(mD,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:p.jsx(rae,{})})})]})})});function rae(){const e=wse(),t=Dr();function n(r){if(!r||t&&!r.readonlyOk)return null;switch(r.type){case"custom":{if(r.id==="LANGUAGE_MENU")return p.jsx(SD,{},"item");break}case"group":return p.jsx(cs,{size:"small",children:r.children.map(n)},r.id);case"submenu":return p.jsxs(S1,{id:`help menu ${r.id}`,children:[p.jsx(x1,{label:r.label}),p.jsx(w1,{children:r.children.map(n)})]},r.id);case"item":{const{id:o,kbd:s,label:i,onSelect:a,icon:l}=r.actionItem;return p.jsx(or,{type:"menu",kbd:s,label:i,onClick:()=>a("help-menu"),iconLeft:l},o)}}}return p.jsx(p.Fragment,{children:e.map(n)})}var b1="Popover",[xD,Wce]=vs(b1,[pc]),nh=pc(),[oae,Ri]=xD(b1),wD=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:o,onOpenChange:s,modal:i=!1}=e,a=nh(t),l=b.useRef(null),[c,u]=b.useState(!1),[d=!1,h]=Ss({prop:r,defaultProp:o,onChange:s});return p.jsx(Lw,{...a,children:p.jsx(oae,{scope:t,contentId:_o(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:b.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:c,onCustomAnchorAdd:b.useCallback(()=>u(!0),[]),onCustomAnchorRemove:b.useCallback(()=>u(!1),[]),modal:i,children:n})})};wD.displayName=b1;var bD="PopoverAnchor",sae=b.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=Ri(bD,n),s=nh(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:a}=o;return b.useEffect(()=>(i(),()=>a()),[i,a]),p.jsx(lm,{...s,...r,ref:t})});sae.displayName=bD;var CD="PopoverTrigger",PD=b.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=Ri(CD,n),s=nh(n),i=Ye(t,o.triggerRef),a=p.jsx(Ce.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":TD(o.open),...r,ref:i,onClick:ee(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?a:p.jsx(lm,{asChild:!0,...s,children:a})});PD.displayName=CD;var C1="PopoverPortal",[iae,aae]=xD(C1,{forceMount:void 0}),kD=e=>{const{__scopePopover:t,forceMount:n,children:r,container:o}=e,s=Ri(C1,t);return p.jsx(iae,{scope:t,forceMount:n,children:p.jsx(gr,{present:n||s.open,children:p.jsx(Ad,{asChild:!0,container:o,children:r})})})};kD.displayName=C1;var sc="PopoverContent",ED=b.forwardRef((e,t)=>{const n=aae(sc,e.__scopePopover),{forceMount:r=n.forceMount,...o}=e,s=Ri(sc,e.__scopePopover);return p.jsx(gr,{present:r||s.open,children:s.modal?p.jsx(lae,{...o,ref:t}):p.jsx(cae,{...o,ref:t})})});ED.displayName=sc;var lae=b.forwardRef((e,t)=>{const n=Ri(sc,e.__scopePopover),r=b.useRef(null),o=Ye(t,r),s=b.useRef(!1);return b.useEffect(()=>{const i=r.current;if(i)return qb(i)},[]),p.jsx(Fm,{as:fi,allowPinchZoom:!0,children:p.jsx(ID,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ee(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ee(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ee(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),cae=b.forwardRef((e,t)=>{const n=Ri(sc,e.__scopePopover),r=b.useRef(!1),o=b.useRef(!1);return p.jsx(ID,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,a;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const i=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&o.current&&s.preventDefault()}})}),ID=b.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=Ri(sc,n),f=nh(n);return Xb(),p.jsx($m,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:s,children:p.jsx(cc,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:p.jsx(Fw,{"data-state":TD(h.open),role:"dialog",id:h.contentId,...f,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_D="PopoverClose",uae=b.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=Ri(_D,n);return p.jsx(Ce.button,{type:"button",...r,ref:t,onClick:ee(e.onClick,()=>o.onOpenChange(!1))})});uae.displayName=_D;var dae="PopoverArrow",hae=b.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,o=nh(n);return p.jsx(zw,{...o,...r,ref:t})});hae.displayName=dae;function TD(e){return e?"open":"closed"}var pae=wD,fae=PD,MD=kD,AD=ED;const P1=({id:e,children:t,onOpenChange:n,open:r})=>{const[o,s]=Aa(e,n);return p.jsx(pae,{onOpenChange:s,open:r||o,children:p.jsx("div",{className:"tlui-popover",children:t})})},k1=({children:e,disabled:t,"data-testid":n})=>p.jsx(fae,{"data-testid":n,disabled:t,asChild:!0,dir:"ltr",children:e}),RD=({side:e,children:t,align:n="center",sideOffset:r=8,alignOffset:o=0})=>{const s=mn();return p.jsx(MD,{container:s,children:p.jsx(AD,{className:"tlui-popover__content",side:e,sideOffset:r,align:n,alignOffset:o,dir:"ltr",children:t})})},OD=b.memo(function(){const t=Ie(),n=mn(),r=pse(),o=Dr();function s(i){if(!i||o&&!i.readonlyOk)return null;switch(i.type){case"item":{const{id:a,icon:l,label:c,kbd:u,onSelect:d}=i.actionItem;return p.jsx(ae,{"data-testid":`menu-item.${i.id}`,icon:l,type:"icon",title:c?u?`${t(c)} ${Do(u)}`:`${t(c)}`:u?`${Do(u)}`:"",onClick:()=>d("actions-menu"),disabled:i.disabled},a)}}}return p.jsxs(P1,{id:"actions-menu",children:[p.jsx(k1,{children:p.jsx(ae,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:t("actions-menu.title"),type:"icon",smallIcon:!0})}),p.jsx(MD,{container:n,children:p.jsx(AD,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:p.jsx("div",{className:"tlui-actions-menu tlui-buttons__grid",children:r.map(s)})})})]})}),jD=Ve(function(){const t=W(),n=yn(),r=Ie(),o=n.duplicate;return p.jsx(ae,{icon:o.icon,type:"icon",onClick:()=>o.onSelect("quick-actions"),disabled:!(t.isIn("select")&&t.getSelectedShapeIds().length>0),title:`${r(o.label)} ${Do(o.kbd)}`,smallIcon:!0})}),gae=b.memo(function(){const t=Ie();return p.jsxs(bi,{id:"main menu",children:[p.jsx(th,{children:p.jsx(ae,{type:"icon",className:"tlui-menu__trigger","data-testid":"main.menu",title:t("menu.title"),icon:"menu",smallIcon:!0})}),p.jsx(Ci,{alignOffset:0,sideOffset:6,children:p.jsx(mae,{})})]})});function mae(){const e=W(),t=Ie(),n=Cse(),r=Nr(),o=Dr();function s(i,a,l,c){if(!a)return null;switch(a.type){case"custom":return o&&!a.readonlyOk?null:a.id==="LANGUAGE_MENU"?p.jsx(SD,{},"item"):null;case"group":return o&&!a.readonlyOk?null:p.jsx(cs,{size:c<=1?"medium":r<3||(l==null?void 0:l.type)==="submenu"&&c>2?"tiny":"medium",children:a.children.map(u=>s(i,u,a,c+1))},a.id);case"submenu":return o&&!a.readonlyOk?null:p.jsxs(S1,{id:`main menu ${l?l.id+" ":""}${a.id}`,children:[p.jsx(x1,{label:a.label,"data-testid":`menu-item.${a.id}`}),p.jsx(w1,{sideOffset:-4,alignOffset:-1,children:a.children.map(u=>s(i,u,a,c+1))})]},a.id);case"item":{if(o&&!a.readonlyOk)return null;const{id:u,checkbox:d,menuLabel:h,label:f,onSelect:y,kbd:g}=a.actionItem,m=h??f,v=m?t(m):void 0;return d?p.jsxs(vD,{onSelect:()=>y("menu"),title:v||"",checked:a.checked,disabled:a.disabled,children:[v&&p.jsx("span",{className:"tlui-button__label",children:v}),g&&p.jsx(Nm,{children:g})]},u):p.jsx(or,{type:"menu","data-testid":`menu-item.${a.id}`,kbd:g,label:m,onClick:()=>y("menu"),disabled:a.disabled},u)}}}return p.jsx(p.Fragment,{children:n.map(i=>s(e,i,null,0))})}const yae=function({name:t,id:n,isCurrentPage:r}){const o=W(),s=b.useRef(null),i=b.useCallback(l=>{o.renamePage(n,l||"New Page",{ephemeral:!0})},[o,n]),a=b.useCallback(l=>{o.mark("rename page"),o.renamePage(n,l||"New Page",{ephemeral:!1})},[o,n]);return p.jsx(n1,{className:"tlui-page-menu__item__input",ref:l=>s.current=l,defaultValue:t,onValueChange:i,onComplete:a,onCancel:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},vx=(e,t,n,r)=>{let o;const s=e.getPages(),i=n>r?s[r-1]:s[r],a=n>r?s[r]:s[r+1];i&&!a?o=Zo(i.index):!i&&a?o=FK(s[0].index):o=Au(i.index,a.index),o!==s[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:o}))},z2=Ve(function({index:t,listSize:n,item:r,onRename:o}){const s=W(),i=Ie(),a=s.getPages(),l=b.useCallback(()=>{s.mark("creating page");const h=ms.createId();s.duplicatePage(r.id,h)},[s,r]),c=b.useCallback(()=>{vx(s,r.id,t,t-1)},[s,r,t]),u=b.useCallback(()=>{vx(s,r.id,t,t+1)},[s,r,t]),d=b.useCallback(()=>{s.mark("deleting page"),s.deletePage(r.id)},[s,r]);return p.jsxs(bi,{id:`page item submenu ${t}`,children:[p.jsx(th,{children:p.jsx(ae,{type:"icon",title:i("page-menu.submenu.title"),icon:"dots-vertical"})}),p.jsxs(Ci,{alignOffset:0,children:[p.jsxs(cs,{children:[o&&p.jsx(el,{dir:"ltr",onSelect:o,asChild:!0,children:p.jsx(ae,{type:"menu",label:"page-menu.submenu.rename"})}),p.jsx(el,{dir:"ltr",onSelect:l,disabled:a.length>=vg,asChild:!0,children:p.jsx(ae,{type:"menu",label:"page-menu.submenu.duplicate-page"})}),t>0&&p.jsx(el,{dir:"ltr",onSelect:c,asChild:!0,children:p.jsx(ae,{type:"menu",label:"page-menu.submenu.move-up"})}),t<n-1&&p.jsx(el,{dir:"ltr",onSelect:u,asChild:!0,children:p.jsx(ae,{type:"menu",label:"page-menu.submenu.move-down"})})]}),n>1&&p.jsx(cs,{children:p.jsx(el,{dir:"ltr",onSelect:d,asChild:!0,children:p.jsx(ae,{type:"menu",label:"page-menu.submenu.delete"})})})]})]})}),vae=function(){const t=W(),n=Ie(),r=Nr(),o=b.useCallback(()=>m(!1),[]),[s,i]=Aa("page-menu",o),a=36,l=b.useRef(null),c=q("pages",()=>t.getPages(),[t]),u=q("currentPage",()=>t.getCurrentPage(),[t]),d=q("currentPageId",()=>t.getCurrentPageId(),[t]),h=Dr(),f=q("maxPageCountReached",()=>t.getPages().length>=vg,[t]),y=q("isCoarsePointer",()=>t.getInstanceState().isCoarsePointer,[t]),[g,m]=b.useState(!1),v=b.useCallback(()=>{h||m(T=>!T)},[h]),x=b.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[w,C]=b.useState(Object.fromEntries(c.map((T,R)=>[T.id,{y:R*a,offsetY:0,isSelected:!1}])));b.useLayoutEffect(()=>{C(Object.fromEntries(c.map((T,R)=>[T.id,{y:R*a,offsetY:0,isSelected:!1}])))},[a,c]),b.useEffect(()=>{s&&requestAnimationFrame(()=>{const T=document.querySelector(`[data-testid="page-menu-item-${d}"]`);if(T){const R=l.current;if(!R)return;const j=T.offsetTop,$=R.scrollTop;j<$&&R.scrollTo({top:j});const L=j+a,U=R.scrollTop+R.offsetHeight;L>U&&R.scrollTo({top:L-R.offsetHeight})}})},[a,d,s]);const P=b.useCallback(T=>{const{clientY:R,currentTarget:j}=T,{dataset:{id:$,index:L}}=j;if(!$||!L)return;const U=x.current;Nd(T.currentTarget,T),U.status="pointing",U.pointing={id:$,index:+L};const G=w[$].y;U.startY=R,U.startIndex=Math.max(0,Math.min(Math.round(G/a),c.length-1))},[a,c.length,w]),k=b.useCallback(T=>{const R=x.current;if(R.status==="pointing"){const{clientY:j}=T,$=j-R.startY;Math.abs($)>5&&(R.status="dragging")}if(R.status==="dragging"){const{clientY:j}=T,$=j-R.startY,L=w[R.pointing.id],{startIndex:U,pointing:F}=R,G=L.y+$,D=Math.max(0,Math.min(Math.round(G/a),c.length-1)),z={...w};if(z[F.id]={y:L.y,offsetY:$,isSelected:!0},D!==R.dragIndex){R.dragIndex=D;for(let V=0;V<c.length;V++){const K=c[V];if(K.id===R.pointing.id)continue;let{y:J}=z[K.id];D===U?J=V*a:D<U?D<=V&&V<U?J=(V+1)*a:J=V*a:D>U&&(D>=V&&V>U?J=(V-1)*a:J=V*a),J!==z[K.id].y&&(z[K.id]={y:J,offsetY:0,isSelected:!0})}}C(z)}},[a,c,w]),I=b.useCallback(T=>{const R=x.current;if(R.status==="dragging"){const{id:j,index:$}=R.pointing;vx(t,j,$,R.dragIndex)}$d(T.currentTarget,T),R.status="idle"},[t]),_=b.useCallback(T=>{const R=x.current;T.key==="Escape"&&(R.status==="dragging"&&C(Object.fromEntries(c.map((j,$)=>[j.id,{y:$*a,offsetY:0,isSelected:!1}]))),R.status="idle")},[a,c]),M=b.useCallback(()=>{h||t.batch(()=>{t.mark("creating page");const T=ms.createId();t.createPage({name:n("page-menu.new-page-initial-name"),id:T}),t.setCurrentPage(T),m(!0)})},[t,n,h]);return p.jsxs(P1,{id:"pages",onOpenChange:i,open:s,children:[p.jsx(k1,{children:p.jsx(ae,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",type:"menu",title:u.name,children:p.jsx("div",{className:"tlui-page-menu__name",children:u.name})})}),p.jsx(RD,{side:"bottom",align:"start",sideOffset:6,children:p.jsxs("div",{className:"tlui-page-menu__wrapper",children:[p.jsxs("div",{className:"tlui-page-menu__header",children:[p.jsx("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!h&&p.jsxs("div",{className:"tlui-buttons__horizontal",children:[p.jsx(ae,{type:"icon","data-testid":"page-menu.edit",title:n(g?"page-menu.edit-done":"page-menu.edit-start"),icon:g?"check":"edit",onClick:v}),p.jsx(ae,{type:"icon","data-testid":"page-menu.create",icon:"plus",title:n(f?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:f,onClick:M})]})]}),p.jsx("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:a*c.length+4},ref:l,children:c.map((T,R)=>{const j=w[T.id]??{position:R*40,offsetY:0};return g?p.jsxs("div",{"data-testid":`page-menu-item-${T.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:T.id===u.id?888:R,transform:`translate(0px, ${j.y+j.offsetY}px)`},children:[p.jsx(ae,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:P,onPointerUp:I,onPointerMove:k,onKeyDown:_,"data-id":T.id,"data-index":R}),r<5&&y?p.jsx(ae,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const $=window.prompt("Rename page",T.name);$&&$!==T.name&&t.renamePage(T.id,$)},onDoubleClick:v,isChecked:T.id===u.id,children:p.jsx("span",{children:T.name})}):p.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:a},children:p.jsx(yae,{id:T.id,name:T.name,isCurrentPage:T.id===u.id})}),!h&&p.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":g,children:p.jsx(z2,{index:R,item:T,listSize:c.length})})]},T.id+"_editing"):p.jsxs("div",{"data-testid":`page-menu-item-${T.id}`,className:"tlui-page-menu__item",children:[p.jsxs(ae,{type:"normal",className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>t.setCurrentPage(T.id),onDoubleClick:v,isChecked:T.id===u.id,title:n("page-menu.go-to-page"),children:[p.jsx("div",{className:"tlui-page-menu__item__button__check",children:T.id===u.id&&p.jsx(ur,{icon:"check"})}),p.jsx("span",{children:T.name})]}),!h&&p.jsx("div",{className:"tlui-page_menu__item__submenu",children:p.jsx(z2,{index:R,item:T,listSize:c.length,onRename:()=>{if(t.environment.isIos){const $=window.prompt("Rename page",T.name);$&&$!==T.name&&t.renamePage(T.id,$)}else t.batch(()=>{m(!0),t.setCurrentPage(T.id)})}})})]},T.id)})})]})})]})},DD=b.memo(function(){const t=Ie(),n=o3(),o=yn().redo;return p.jsx(ae,{"data-testid":"main.redo",icon:o.icon,type:"icon",title:`${t(o.label)} ${Do(o.kbd)}`,disabled:!n,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),ND=Ve(function(){const t=W(),n=yn(),r=Ie(),o=n.delete;return Dr()?null:p.jsx(ae,{icon:o.icon,type:"icon",onClick:()=>{o.onSelect("quick-actions"),t.getContainer().focus()},disabled:!(t.isIn("select")&&t.getSelectedShapeIds().length>0),title:`${r(o.label)} ${Do(o.kbd)}`,smallIcon:!0})}),$D=b.memo(function(){const t=Ie(),n=s3(),o=yn().undo;return p.jsx(ae,{"data-testid":"main.undo",icon:o.icon,type:"icon",title:`${t(o.label)} ${Do(o.kbd)}`,disabled:!n,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),Sae=Ve(function(){const t=W(),n=Nr(),r=Dr();return p.jsx("div",{className:"tlui-menu-zone",children:p.jsxs("div",{className:"tlui-buttons__horizontal",children:[p.jsx(gae,{}),p.jsx(vae,{}),n>=6&&!r&&!t.isInAny("hand","zoom")&&p.jsxs(p.Fragment,{children:[p.jsx($D,{}),p.jsx(DD,{}),p.jsx(ND,{}),p.jsx(jD,{}),p.jsx(OD,{})]})]})})});function xae(e,t){const[n,r]=H.useState(t);H.useLayoutEffect(()=>{const s=localStorage.getItem(e);if(s)try{r(JSON.parse(s))}catch{console.error(`Could not restore value ${e} from local storage.`)}},[e]);const o=H.useCallback(s=>{r(i=>{const a=typeof s=="function"?s(i):s;return localStorage.setItem(e,JSON.stringify(a)),a})},[e]);return[n,o]}class Du{constructor(t){S(this,"dpr",1);S(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"});S(this,"id",Ge());S(this,"cvs",null);S(this,"pageBounds",[]);S(this,"collaborators",[]);S(this,"canvasScreenBounds",new le);S(this,"canvasPageBounds",new le);S(this,"contentPageBounds",new le);S(this,"contentScreenBounds",new le);S(this,"originPagePoint",new E);S(this,"originPageCenter",new E);S(this,"isInViewport",!1);S(this,"debug",!1);S(this,"updateContentScreenBounds",()=>{const{contentScreenBounds:t,contentPageBounds:n,canvasScreenBounds:r}=this;let{x:o,y:s,w:i,h:a}=t;if(n.w>n.h){const l=r.w/(n.w/n.h);l>r.h?(o=(r.w-r.w*(r.h/l))/2,s=0,i=r.w*(r.h/l),a=r.h):(o=0,s=(r.h-l)/2,i=r.w,a=l)}else if(n.w<n.h){const l=r.h/(n.h/n.w);o=(r.w-l)/2,s=0,i=l,a=r.h}else o=r.h/2,s=0,i=r.h,a=r.h;t.set(o,s,i,a)});S(this,"updateCanvasPageBounds",()=>{const{canvasPageBounds:t,canvasScreenBounds:n,contentPageBounds:r,contentScreenBounds:o}=this;t.set(0,0,r.width/(o.width/n.width),r.height/(o.height/n.height)),t.center=r.center});S(this,"getScreenPoint",(t,n)=>{const{canvasScreenBounds:r}=this,o=(t-r.minX)*this.dpr,s=(n-r.minY)*this.dpr;return{x:o,y:s}});S(this,"getPagePoint",(t,n)=>{const{contentPageBounds:r,contentScreenBounds:o,canvasPageBounds:s}=this,{x:i,y:a}=this.getScreenPoint(t,n);return new E(s.minX+i*r.width/o.width,s.minY+a*r.height/o.height,1)});S(this,"minimapScreenPointToPagePoint",(t,n,r=!1,o=!1)=>{const{editor:s}=this,i=s.getViewportPageBounds();let{x:a,y:l}=this.getPagePoint(t,n);if(o){const c=this.editor.getCurrentPageBounds(),u=i,d=((c==null?void 0:c.minX)??0)-u.width/2,h=((c==null?void 0:c.maxX)??0)+u.width/2,f=((c==null?void 0:c.minY)??0)-u.height/2,y=((c==null?void 0:c.maxY)??0)+u.height/2,g=Math.max(0,d+u.width-a),m=Math.max(0,-(h-u.width-a)),v=Math.max(0,f+u.height-l),x=Math.max(0,-(y-u.height-l)),w=Math.max(0,g-m),C=Math.max(0,m-g),P=Math.max(0,v-x),k=Math.max(0,x-v);w&&w>C?a+=w/2:C&&(a-=C/2),P&&P>k?l+=P/2:k&&(l-=k/2),a=wo(a,d,h),l=wo(l,f,y)}if(r){const{originPagePoint:c}=this,u=Math.abs(a-c.x),d=Math.abs(l-c.y);u>d?l=c.y:a=c.x}return new E(a,l)});S(this,"render",()=>{const{cvs:t,pageBounds:n}=this;this.updateCanvasPageBounds();const{editor:r,canvasScreenBounds:o,canvasPageBounds:s,contentPageBounds:i,contentScreenBounds:a}=this,{width:l,height:c}=o,u=r.getSelectedShapeIds(),d=r.getViewportPageBounds();if(!t||!n)return;const h=t.getContext("2d");if(!h)throw new Error("Minimap (shapes): Could not get context");h.resetTransform(),h.globalAlpha=1,h.clearRect(0,0,l,c);const f=a.width/i.width,y=a.height/i.height;h.translate((l-a.width)/2,(c-a.height)/2),h.scale(f,y),h.translate(-i.minX,-i.minY);const g=8/f,m=8/f,v=1/f,x=1/f,w=g/4,C=m/4,P=new Path2D,k=new Path2D,{shapeFill:I,selectFill:_,viewportFill:M}=this.colors;let T;for(let U=0,F=n.length;U<F;U++)T=n[U],Du.roundedRect(u.includes(T.id)?k:P,T.minX,T.minY,T.width,T.height,wo(g,v,T.width/w),wo(m,x,T.height/C));if(h.fillStyle=I,h.fill(P),h.fillStyle=_,h.fill(k),this.debug){const U=le.Common(n),{minX:F,minY:G,width:D,height:z}=U;h.strokeStyle="green",h.lineWidth=2/f,h.strokeRect(F+1/f,G+1/y,D-2/f,z-2/y)}{const{brush:U}=r.getInstanceState();if(U){const{x:F,y:G,w:D,h:z}=U;h.beginPath(),Du.sharpRect(h,F,G,D,z),h.closePath(),h.fillStyle=M,h.fill()}}{const{minX:U,minY:F,width:G,height:D}=d;h.beginPath();const z=12/f,V=12/f;Du.roundedRect(h,U,F,G,D,Math.min(G/4,z),Math.min(D/4,V)),h.closePath(),h.fillStyle=M,h.fill(),this.debug&&(h.strokeStyle="orange",h.strokeRect(U+1/f,F+1/y,G-2/f,D-2/y))}const R=2.5/f,j=2.5/y,$=r.getCurrentPageId();let L;for(let U=0;U<this.collaborators.length;U++)L=this.collaborators[U],L.currentPageId===$&&(h.beginPath(),h.ellipse(wo(L.cursor.x,s.minX+R,s.maxX-R),wo(L.cursor.y,s.minY+j,s.maxY-j),5/f,5/y,0,0,Ue),h.fillStyle=L.color,h.fill());if(this.debug){h.lineWidth=2/f;{const{minX:U,minY:F,width:G,height:D}=i;h.strokeStyle="red",h.strokeRect(U+1/f,F+1/y,G-2/f,D-2/y)}{const{minX:U,minY:F,width:G,height:D}=s;h.strokeStyle="blue",h.strokeRect(U+1/f,F+1/y,G-2/f,D-2/y)}}});this.editor=t}setDpr(t){this.dpr=+t.toFixed(2)}static roundedRect(t,n,r,o,s,i,a){if(i<1&&a<1){t.rect(n,r,o,s);return}t.moveTo(n+i,r),t.lineTo(n+o-i,r),t.quadraticCurveTo(n+o,r,n+o,r+a),t.lineTo(n+o,r+s-a),t.quadraticCurveTo(n+o,r+s,n+o-i,r+s),t.lineTo(n+i,r+s),t.quadraticCurveTo(n,r+s,n,r+s-a),t.lineTo(n,r+a),t.quadraticCurveTo(n,r,n+i,r)}static sharpRect(t,n,r,o,s,i,a){t.rect(n,r,o,s)}}function wae({shapeFill:e,selectFill:t,viewportFill:n}){const r=W(),o=b.useRef(null),s=b.useRef(!1),i=Pm(),a=HM("dpr",()=>r.getInstanceState().devicePixelRatio,[r]),l=b.useMemo(()=>r.store.query.records("instance_presence"),[r]),c=b.useMemo(()=>new Du(r),[r]);b.useEffect(()=>{const y=requestAnimationFrame(()=>{const g=getComputedStyle(r.getContainer());c.colors={shapeFill:g.getPropertyValue(e).trim(),selectFill:g.getPropertyValue(t).trim(),viewportFill:g.getPropertyValue(n).trim()},c.render()});return()=>{cancelAnimationFrame(y)}},[r,t,e,n,c,i]);const u=b.useCallback(y=>{if(!r.getCurrentPageShapeIds().size)return;const g=c.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),m=c.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0);c.originPagePoint.setTo(m),c.originPageCenter.setTo(r.getViewportPageBounds().center),r.centerOnPoint(g,{duration:es})},[r,c]),d=b.useCallback(y=>{const g=y.currentTarget;if(Nd(g,y),!r.getCurrentPageShapeIds().size)return;s.current=!0,c.isInViewport=!1;const m=c.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),v=c.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0),x=r.getViewportPageBounds();if(c.isInViewport=x.containsPoint(v),c.isInViewport)c.originPagePoint.setTo(v),c.originPageCenter.setTo(x.center);else{const C=E.Sub(x.center,x.point),P=E.Add(m,C);c.originPagePoint.setTo(P),c.originPageCenter.setTo(m),r.centerOnPoint(m,{duration:es})}function w(C){g&&$d(g,C),s.current=!1,document.body.removeEventListener("pointerup",w)}document.body.addEventListener("pointerup",w)},[r,c]),h=b.useCallback(y=>{const g=c.minimapScreenPointToPagePoint(y.clientX,y.clientY,y.shiftKey,!0);if(s.current){if(c.isInViewport){const w=c.originPagePoint.clone().sub(c.originPageCenter);r.centerOnPoint(E.Sub(g,w));return}r.centerOnPoint(g)}const m=c.getPagePoint(y.clientX,y.clientY),v=r.pageToScreen(m),x={type:"pointer",target:"canvas",name:"pointer_move",...Fn(y),point:v,isPen:r.getInstanceState().isPenMode};r.dispatch(x)},[r,c]),f=b.useCallback(y=>{const g=EA(y);r.dispatch({type:"wheel",name:"wheel",delta:g,point:new E(y.clientX,y.clientY),shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey})},[r]);return aa("update when dpr changes",()=>{const y=a.get();c.setDpr(y);const g=o.current,m=g.getBoundingClientRect(),v=m.width*y,x=m.height*y;g.width=v,g.height=x,c.canvasScreenBounds.set(m.x,m.y,v,x),c.cvs=o.current},[a,c]),aa("minimap render when pagebounds or collaborators changes",()=>{const y=r.getCurrentPageShapeIds(),g=r.getCurrentPageBounds(),m=r.getViewportPageBounds();a.get(),c.contentPageBounds=g?le.Expand(g,m):m,c.updateContentScreenBounds();const v=[];y.forEach(x=>{let w=r.getShapePageBounds(x);if(!w)return;const C=r.getShapeMask(x);if(C){const P=US(C,w.corners);if(!P)return;w=le.FromPoints(P)}w&&(w.id=x,v.push(w))}),c.pageBounds=v,c.collaborators=l.get(),c.render()},[r,c]),p.jsx("div",{className:"tlui-minimap",children:p.jsx("canvas",{ref:o,className:"tlui-minimap__canvas",onDoubleClick:u,onPointerMove:h,onPointerDown:d,onWheel:f})})}const Qv=Ve(function(){const t=W(),n=Ie(),r=Nr(),o=t.getZoomLevel(),s=t.getCurrentPageShapeIds().size>0,i=t.getSelectedShapeIds().length>0,a=t.getZoomLevel()===1,l=b.useCallback(()=>{t.resetZoom(t.getViewportScreenCenter(),{duration:es})},[t]);return p.jsxs(bi,{id:"zoom",children:[p.jsx(th,{children:p.jsx(ae,{type:"icon",title:`${n("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,icon:r<4?"zoom-in":void 0,children:r<4?null:p.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(o*100),"%"]})})}),p.jsx(Ci,{side:"top",align:"start",alignOffset:0,children:p.jsxs(cs,{children:[p.jsx(su,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),p.jsx(su,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),p.jsx(su,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:a}),p.jsx(su,{action:"zoom-to-fit",disabled:!s,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),p.jsx(su,{action:"zoom-to-selection",disabled:!i,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function su(e){const{action:t,disabled:n=!1,noClose:r=!1}=e,o=yn();return p.jsx(or,{type:"menu",label:o[t].label,kbd:o[t].kbd,"data-testid":e["data-testid"],onClick:()=>o[t].onSelect("zoom-menu"),noClose:r,disabled:n})}const bae=b.memo(function(){const t=yn(),n=Ie(),r=Nr(),[o,s]=xae("minimap",!0),i=b.useCallback(()=>{s(a=>!a)},[s]);return r<4?null:p.jsxs("div",{className:"tlui-navigation-zone",children:[p.jsx("div",{className:"tlui-buttons__horizontal",children:r<6?p.jsx(Qv,{}):o?p.jsxs(p.Fragment,{children:[p.jsx(Qv,{}),p.jsx(ae,{type:"icon",icon:o?"chevrons-ne":"chevrons-sw","data-testid":"minimap.toggle",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:i})]}):p.jsxs(p.Fragment,{children:[p.jsx(ae,{type:"icon",icon:"minus","data-testid":"minimap.zoom-out",title:`${n(t["zoom-out"].label)} ${Do(t["zoom-out"].kbd)}`,onClick:()=>t["zoom-out"].onSelect("navigation-zone")}),p.jsx(Qv,{}),p.jsx(ae,{type:"icon",icon:"plus","data-testid":"minimap.zoom-in",title:`${n(t["zoom-in"].label)} ${Do(t["zoom-in"].kbd)}`,onClick:()=>t["zoom-in"].onSelect("navigation-zone")}),p.jsx(ae,{type:"icon",icon:o?"chevrons-ne":"chevrons-sw","data-testid":"minimap.toggle",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:i})]})}),r>=6&&!o&&p.jsx(wae,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),Cae=Ve(function(){const n=W().getInstanceState().isPenMode,r=yn();if(!n)return null;const o=r["exit-pen-mode"];return p.jsx(ae,{type:"normal",label:o.label,iconLeft:o.icon,onClick:()=>o.onSelect("helper-buttons")})}),Pae=Ve(function(){const t=W(),n=yn();if(!t.getInstanceState().followingUserId)return null;const r=n["stop-following"];return p.jsx(ae,{type:"normal",label:r.label,iconLeft:r.icon,onClick:()=>r.onSelect("people-menu")})}),kae=[jr,ma,ec,Oo];function LD(){const e=W();return q("getRelevantStyles",()=>{var r;const t=new HS(e.getSharedStyles()),n=e.getSelectedShapeIds().length>0||!!((r=e.root.getCurrent())!=null&&r.shapeType);if(t.size===0&&e.isIn("select")&&e.getSelectedShapeIds().length===0)for(const o of kae)t.applyValue(o,e.getStyleForNextShape(o));return t.size===0&&!n?null:{styles:t,opacity:e.getSharedOpacity()}},[e])}function Eae(e){const{uiType:t,items:n,title:r,style:o,value:s,onValueChange:i}=e,a=W(),l=Ie(),c=b.useRef(!1),{handleButtonClick:u,handleButtonPointerDown:d,handleButtonPointerEnter:h,handleButtonPointerUp:f}=b.useMemo(()=>{const g=()=>{c.current=!1,window.removeEventListener("pointerup",g)};return{handleButtonClick:C=>{const{id:P}=C.currentTarget.dataset;s.type==="shared"&&s.value===P||(a.mark("point picker item"),i(o,P,!1))},handleButtonPointerDown:C=>{const{id:P}=C.currentTarget.dataset;a.mark("point picker item"),i(o,P,!0),c.current=!0,window.addEventListener("pointerup",g)},handleButtonPointerEnter:C=>{if(!c.current)return;const{id:P}=C.currentTarget.dataset;i(o,P,!0)},handleButtonPointerUp:C=>{const{id:P}=C.currentTarget.dataset;i(o,P,!1)}}},[s,a,i,o]),y=q("theme",()=>Wn({isDarkMode:a.user.getIsDarkMode()}),[a]);return p.jsx("div",{className:fe("tlui-buttons__grid"),children:n.map(g=>p.jsx(ae,{type:"icon","data-id":g.value,"data-testid":`style.${t}.${g.value}`,"aria-label":g.value,"data-state":s.type==="shared"&&s.value===g.value?"hinted":void 0,title:r+"  "+l(`${t}-style.${g.value}`),className:fe("tlui-button-grid__button"),style:o===jr?{color:y[g.value].solid}:void 0,onPointerEnter:h,onPointerDown:d,onPointerUp:f,onClick:u,icon:g.icon},g.value))})}const xl=b.memo(Eae);function FD(e,[t,n]){return Math.min(n,Math.max(t,e))}function Iae(e){const t=b.useRef({value:e,previous:e});return b.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var zD=["PageUp","PageDown"],BD=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],UD={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},_c="Slider",[Sx,_ae,Tae]=tm(_c),[HD,Gce]=vs(_c,[Tae]),[Mae,Xm]=HD(_c),VD=b.forwardRef((e,t)=>{const{name:n,min:r=0,max:o=100,step:s=1,orientation:i="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,form:y,...g}=e,m=b.useRef(new Set),v=b.useRef(0),w=i==="horizontal"?Aae:Rae,[C=[],P]=Ss({prop:u,defaultProp:c,onChange:R=>{var $;($=[...m.current][v.current])==null||$.focus(),d(R)}}),k=b.useRef(C);function I(R){const j=$ae(C,R);T(R,j)}function _(R){T(R,v.current)}function M(){const R=k.current[v.current];C[v.current]!==R&&h(C)}function T(R,j,{commit:$}={commit:!1}){const L=Bae(s),U=Uae(Math.round((R-r)/s)*s+r,L),F=FD(U,[r,o]);P((G=[])=>{const D=Dae(G,F,j);if(zae(D,l*s)){v.current=D.indexOf(F);const z=String(D)!==String(G);return z&&$&&h(D),z?D:G}else return G})}return p.jsx(Mae,{scope:e.__scopeSlider,name:n,disabled:a,min:r,max:o,valueIndexToChangeRef:v,thumbs:m.current,values:C,orientation:i,form:y,children:p.jsx(Sx.Provider,{scope:e.__scopeSlider,children:p.jsx(Sx.Slot,{scope:e.__scopeSlider,children:p.jsx(w,{"aria-disabled":a,"data-disabled":a?"":void 0,...g,ref:t,onPointerDown:ee(g.onPointerDown,()=>{a||(k.current=C)}),min:r,max:o,inverted:f,onSlideStart:a?void 0:I,onSlideMove:a?void 0:_,onSlideEnd:a?void 0:M,onHomeKeyDown:()=>!a&&T(r,0,{commit:!0}),onEndKeyDown:()=>!a&&T(o,C.length-1,{commit:!0}),onStepKeyDown:({event:R,direction:j})=>{if(!a){const U=zD.includes(R.key)||R.shiftKey&&BD.includes(R.key)?10:1,F=v.current,G=C[F],D=s*U*j;T(G+D,F,{commit:!0})}}})})})})});VD.displayName=_c;var[KD,WD]=HD(_c,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Aae=b.forwardRef((e,t)=>{const{min:n,max:r,dir:o,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=b.useState(null),f=Ye(t,w=>h(w)),y=b.useRef(),g=Vm(o),m=g==="ltr",v=m&&!s||!m&&s;function x(w){const C=y.current||d.getBoundingClientRect(),P=[0,C.width],I=E1(P,v?[n,r]:[r,n]);return y.current=C,I(w-C.left)}return p.jsx(KD,{scope:e.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:p.jsx(GD,{dir:g,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const C=x(w.clientX);i==null||i(C)},onSlideMove:w=>{const C=x(w.clientX);a==null||a(C)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:w=>{const P=UD[v?"from-left":"from-right"].includes(w.key);c==null||c({event:w,direction:P?-1:1})}})})}),Rae=b.forwardRef((e,t)=>{const{min:n,max:r,inverted:o,onSlideStart:s,onSlideMove:i,onSlideEnd:a,onStepKeyDown:l,...c}=e,u=b.useRef(null),d=Ye(t,u),h=b.useRef(),f=!o;function y(g){const m=h.current||u.current.getBoundingClientRect(),v=[0,m.height],w=E1(v,f?[r,n]:[n,r]);return h.current=m,w(g-m.top)}return p.jsx(KD,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:p.jsx(GD,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const m=y(g.clientY);s==null||s(m)},onSlideMove:g=>{const m=y(g.clientY);i==null||i(m)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:g=>{const v=UD[f?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:v?-1:1})}})})}),GD=b.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:o,onSlideEnd:s,onHomeKeyDown:i,onEndKeyDown:a,onStepKeyDown:l,...c}=e,u=Xm(_c,n);return p.jsx(Ce.span,{...c,ref:t,onKeyDown:ee(e.onKeyDown,d=>{d.key==="Home"?(i(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):zD.concat(BD).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:ee(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:ee(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&o(d)}),onPointerUp:ee(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),YD="SliderTrack",XD=b.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,o=Xm(YD,n);return p.jsx(Ce.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...r,ref:t})});XD.displayName=YD;var xx="SliderRange",qD=b.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,o=Xm(xx,n),s=WD(xx,n),i=b.useRef(null),a=Ye(t,i),l=o.values.length,c=o.values.map(h=>ZD(h,o.min,o.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return p.jsx(Ce.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...r,ref:a,style:{...e.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});qD.displayName=xx;var wx="SliderThumb",QD=b.forwardRef((e,t)=>{const n=_ae(e.__scopeSlider),[r,o]=b.useState(null),s=Ye(t,a=>o(a)),i=b.useMemo(()=>r?n().findIndex(a=>a.ref.current===r):-1,[n,r]);return p.jsx(Oae,{...e,ref:s,index:i})}),Oae=b.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:o,...s}=e,i=Xm(wx,n),a=WD(wx,n),[l,c]=b.useState(null),u=Ye(t,x=>c(x)),d=l?i.form||!!l.closest("form"):!0,h=eM(l),f=i.values[r],y=f===void 0?0:ZD(f,i.min,i.max),g=Nae(r,i.values.length),m=h==null?void 0:h[a.size],v=m?Lae(m,y,a.direction):0;return b.useEffect(()=>{if(l)return i.thumbs.add(l),()=>{i.thumbs.delete(l)}},[l,i.thumbs]),p.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${y}% + ${v}px)`},children:[p.jsx(Sx.ItemSlot,{scope:e.__scopeSlider,children:p.jsx(Ce.span,{role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":i.min,"aria-valuenow":f,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...s,ref:u,style:f===void 0?{display:"none"}:e.style,onFocus:ee(e.onFocus,()=>{i.valueIndexToChangeRef.current=r})})}),d&&p.jsx(jae,{name:o??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:f},r)]})});QD.displayName=wx;var jae=e=>{const{value:t,...n}=e,r=b.useRef(null),o=Iae(t);return b.useEffect(()=>{const s=r.current,i=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(i,"value").set;if(o!==t&&l){const c=new Event("input",{bubbles:!0});l.call(s,t),s.dispatchEvent(c)}},[o,t]),p.jsx("input",{style:{display:"none"},...n,ref:r,defaultValue:t})};function Dae(e=[],t,n){const r=[...e];return r[n]=t,r.sort((o,s)=>o-s)}function ZD(e,t,n){const s=100/(n-t)*(e-t);return FD(s,[0,100])}function Nae(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function $ae(e,t){if(e.length===1)return 0;const n=e.map(o=>Math.abs(o-t)),r=Math.min(...n);return n.indexOf(r)}function Lae(e,t,n){const r=e/2,s=E1([0,50],[0,r]);return(r-s(t)*n)*n}function Fae(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function zae(e,t){if(t>0){const n=Fae(e);return Math.min(...n)>=t}return!0}function E1(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function Bae(e){return(String(e).split(".")[1]||"").length}function Uae(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var Hae=VD,Vae=XD,Kae=qD,Wae=QD;const Gae=b.memo(function(t){const{title:n,steps:r,value:o,label:s,onValueChange:i}=t,a=W(),l=Ie(),c=b.useCallback(h=>{i(h[0],!0)},[i]),u=b.useCallback(()=>{a.mark("click slider")},[a]),d=b.useCallback(()=>{o&&i(o,!1)},[o,i]);return p.jsx("div",{className:"tlui-slider__container",children:p.jsxs(Hae,{"data-testid":t["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:o?[o]:void 0,onPointerDown:u,onValueChange:c,onPointerUp:d,title:n+"  "+l(s),children:[p.jsx(Vae,{className:"tlui-slider__track",dir:"ltr",children:o!==null&&p.jsx(Kae,{className:"tlui-slider__range",dir:"ltr"})}),o!==null&&p.jsx(Wae,{className:"tlui-slider__thumb",dir:"ltr"})]})})}),Yae=b.memo(function({label:t,uiTypeA:n,uiTypeB:r,labelA:o,labelB:s,itemsA:i,itemsB:a,styleA:l,styleB:c,valueA:u,valueB:d,onValueChange:h}){const f=Ie(),y=b.useMemo(()=>{var m;return((m=i.find(v=>u.type==="shared"&&u.value===v.value))==null?void 0:m.icon)??"mixed"},[i,u]),g=b.useMemo(()=>{var m;return((m=a.find(v=>d.type==="shared"&&d.value===v.value))==null?void 0:m.icon)??"mixed"},[a,d]);return u===void 0&&d===void 0?null:p.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[p.jsx("div",{title:f(t),className:"tlui-style-panel__double-select-picker-label",children:f(t)}),p.jsxs("div",{className:"tlui-buttons__horizontal",children:[p.jsxs(bi,{id:`style panel ${n} A`,children:[p.jsx(xd,{asChild:!0,onTouchEnd:m=>Re(m),children:p.jsx(ae,{type:"icon","data-testid":`style.${n}`,title:f(o)+"  "+(u===null||u.type==="mixed"?f("style-panel.mixed"):f(`${n}-style.${u.value}`)),icon:y,invertIcon:!0,smallIcon:!0})}),p.jsx(Ci,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:p.jsx("div",{className:"tlui-buttons__grid",children:i.map(m=>p.jsx(or,{type:"icon",title:f(o)+"  "+f(`${n}-style.${m.value}`),"data-testid":`style.${n}.${m.value}`,icon:m.icon,onClick:()=>h(l,m.value,!1),invertIcon:!0},m.value))})})]}),p.jsxs(bi,{id:`style panel ${r}`,children:[p.jsx(xd,{asChild:!0,onTouchEnd:m=>Re(m),children:p.jsx(ae,{type:"icon","data-testid":`style.${r}`,title:f(s)+"  "+(d===null||d.type==="mixed"?f("style-panel.mixed"):f(`${r}-style.${d.value}`)),icon:g,smallIcon:!0})}),p.jsx(Ci,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:p.jsx("div",{className:"tlui-buttons__grid",children:a.map(m=>p.jsx(or,{type:"icon",title:f(s)+"  "+f(`${r}-style.${m.value}`),"data-testid":`style.${r}.${m.value}`,icon:m.icon,onClick:()=>h(c,m.value,!1)},m.value))})})]})]})]})}),I1=b.memo(function({id:t,label:n,uiType:r,style:o,items:s,type:i,value:a,onValueChange:l}){const c=Ie(),u=b.useMemo(()=>{var d;return(d=s.find(h=>a.type==="shared"&&h.value===a.value))==null?void 0:d.icon},[s,a]);return p.jsxs(bi,{id:`style panel ${t}`,children:[p.jsx(xd,{asChild:!0,onTouchEnd:d=>Re(d),children:p.jsx(ae,{type:i,"data-testid":`style.${r}`,title:a.type==="mixed"?c("style-panel.mixed"):c(`${r}-style.${a.value}`),label:n,icon:u??"mixed"})}),p.jsx(Ci,{side:"left",align:"center",alignOffset:0,children:p.jsx("div",{className:"tlui-buttons__grid",children:s.map(d=>p.jsx(or,{type:"icon","data-testid":`style.${r}.${d.value}`,title:c(`${r}-style.${d.value}`),icon:d.icon,onClick:()=>l(o,d.value,!1)},d.value))})})]})}),Jr={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},JD=function({isMobile:t}){const n=W(),r=LD(),o=b.useCallback(()=>{t||n.updateInstanceState({isChangingStyle:!1})},[n,t]);if(!r)return null;const{styles:s,opacity:i}=r,a=s.get(To),l=s.get(hg),c=s.get(dg),u=s.get(fg),d=s.get(Ro),h=a===void 0,f=l===void 0&&c===void 0,y=u===void 0,g=d===void 0;return p.jsxs("div",{className:"tlui-style-panel","data-ismobile":t,onPointerLeave:o,children:[p.jsx(Xae,{styles:s,opacity:i}),!g&&p.jsx(qae,{styles:s}),!(h&&f&&y)&&p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[p.jsx(Qae,{styles:s}),p.jsx(Jae,{styles:s}),p.jsx(Zae,{styles:s})]})]})};function rh(){const e=W();return H.useMemo(()=>function(n,r,o){e.batch(()=>{e.isIn("select")&&e.setStyleForSelectedShapes(n,r,{squashing:o}),e.setStyleForNextShapes(n,r,{squashing:o}),e.updateInstanceState({isChangingStyle:!0})})},[e])}const iu=[.1,.25,.5,.75,1];function Xae({styles:e,opacity:t}){const n=W(),r=Ie(),o=rh(),s=H.useCallback((h,f)=>{const y=iu[h];n.batch(()=>{n.isIn("select")&&n.setOpacityForSelectedShapes(y,{ephemeral:f}),n.setOpacityForNextShapes(y,{ephemeral:f}),n.updateInstanceState({isChangingStyle:!0})})},[n]),i=e.get(jr),a=e.get(ec),l=e.get(ma),c=e.get(Oo),u=a!==void 0||l!==void 0||c!==void 0,d=t.type==="mixed"?-1:iu.indexOf(S9(iu,h=>Math.abs(h-t.value)));return p.jsxs(p.Fragment,{children:[p.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[i===void 0?null:p.jsx(xl,{title:r("style-panel.color"),uiType:"color",style:jr,items:Jr.color,value:i,onValueChange:o}),t===void 0?null:p.jsx(Gae,{"data-testid":"style.opacity",value:d>=0?d:iu.length-1,label:t.type==="mixed"?"style-panel.mixed":`opacity-style.${t.value}`,onValueChange:s,steps:iu.length-1,title:r("style-panel.opacity")})]}),u&&p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[a===void 0?null:p.jsx(xl,{title:r("style-panel.fill"),uiType:"fill",style:ec,items:Jr.fill,value:a,onValueChange:o}),l===void 0?null:p.jsx(xl,{title:r("style-panel.dash"),uiType:"dash",style:ma,items:Jr.dash,value:l,onValueChange:o}),c===void 0?null:p.jsx(xl,{title:r("style-panel.size"),uiType:"size",style:Oo,items:Jr.size,value:c,onValueChange:o})]})]})}function qae({styles:e}){const t=Ie(),n=rh(),r=e.get(Ro),o=e.get(id),s=e.get(pg);return r===void 0&&o===void 0?null:p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[r===void 0?null:p.jsx(xl,{title:t("style-panel.font"),uiType:"font",style:Ro,items:Jr.font,value:r,onValueChange:n}),o===void 0?null:p.jsxs("div",{className:"tlui-style-panel__row",children:[p.jsx(xl,{title:t("style-panel.align"),uiType:"align",style:id,items:Jr.horizontalAlign,value:o,onValueChange:n}),p.jsx("div",{className:"tlui-style-panel__row__extra-button",children:s===void 0?p.jsx(ae,{type:"icon",title:t("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):p.jsx(I1,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:pg,items:Jr.verticalAlign,value:s,onValueChange:n})})]})]})}function Qae({styles:e}){const t=rh(),n=e.get(To);return n===void 0?null:p.jsx(I1,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:To,items:Jr.geo,value:n,onValueChange:t})}function Zae({styles:e}){const t=rh(),n=e.get(fg);return n===void 0?null:p.jsx(I1,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:fg,items:Jr.spline,value:n,onValueChange:t})}function Jae({styles:e}){const t=rh(),n=e.get(hg),r=e.get(dg);return!n||!r?null:p.jsx(Yae,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:dg,itemsA:Jr.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:hg,itemsB:Jr.arrowheadEnd,valueB:n,onValueChange:t,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}function ele({toast:e}){const{removeToast:t}=zo(),n=Ie(),r=s=>{s||t(e.id)},o=e.actions&&e.actions.length>0;return p.jsxs(kw,{onOpenChange:r,className:"tlui-toast__container",duration:e.keepOpen?1/0:5e3,children:[e.icon&&p.jsx("div",{className:"tlui-toast__icon",children:p.jsx(ur,{icon:e.icon})}),p.jsxs("div",{className:"tlui-toast__main",children:[p.jsxs("div",{className:"tlui-toast__content",children:[e.title&&p.jsx(Ew,{className:"tlui-toast__title",children:e.title}),e.description&&p.jsx(Iw,{className:"tlui-toast__description",children:e.description})]}),e.actions&&p.jsxs("div",{className:"tlui-toast__actions",children:[e.actions.map((s,i)=>p.jsx(_w,{altText:s.label,asChild:!0,onClick:s.onClick,children:p.jsx(ae,{type:s.type,children:s.label})},i)),p.jsx(Xf,{asChild:!0,children:p.jsx(ae,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:e.closeLabel??n("toast.close")})})]})]}),!o&&p.jsx(Xf,{asChild:!0,children:p.jsx(ae,{type:"normal",className:"tlui-toast__close",children:e.closeLabel??n("toast.close")})})]})}function tle(){const{toasts:e}=zo();return p.jsx(p.Fragment,{children:e.map(t=>p.jsx(ele,{toast:t},t.id))})}const nle=b.memo(tle);function rle(){const{toasts:e}=zo(),[t,n]=b.useState(!1);return b.useEffect(()=>{let r=!1;return e.length?n(!0):setTimeout(()=>{r||n(!1)},1e3),()=>{r=!0}},[e.length,n]),t?p.jsx(Cw,{className:"tlui-toast__viewport"}):null}function ole(){const e=W(),t=Ie(),n=LD(),r=n==null?void 0:n.styles.get(jr),o=Wn({isDarkMode:e.user.getIsDarkMode()}),s=((r==null?void 0:r.type)==="shared"?o[r.value]:o.black).solid,i=q("isHandOrEraserToolActive",()=>e.isInAny("hand","zoom","eraser","laser"),[e]),a=b.useCallback(l=>{l||e.updateInstanceState({isChangingStyle:!1})},[e]);return p.jsxs(P1,{id:"style menu",onOpenChange:a,children:[p.jsx(k1,{disabled:i,children:p.jsx(ae,{type:"tool","data-testid":"mobile.styles",style:{color:i?"var(--color-muted-1)":s},title:t("style-panel.title"),children:p.jsx(ur,{icon:i?"blob":(r==null?void 0:r.type)==="mixed"?"mixed":"blob"})})}),p.jsx(RD,{side:"top",align:"end",children:p.jsx(JD,{isMobile:!0})})]})}const sle=["select","hand","draw","eraser","text","zoom","laser","highlight"];function ile({activeToolId:e}){const t=W(),n=Nr(),r=Ie(),o=q("is tool locked",()=>t.getInstanceState().isToolLocked,[t]);return!e||sle.includes(e)?null:p.jsx(ae,{type:"normal",title:r("action.toggle-tool-lock"),className:fe("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<5}),icon:o?"lock":"unlock",onClick:()=>t.updateInstanceState({isToolLocked:!o}),smallIcon:!0})}const ale=b.memo(function(){const t=W(),n=Ie(),r=Nr(),o=H.useRef(void 0),s=Dr(),i=kse(),a=i.find(m=>m.toolItem.id==="laser"),l=q("current tool id",()=>t.getCurrentToolId(),[t]),c=q("geo",()=>t.getSharedStyles().getAsKnownValue(To),[t]),u=!s,d=m=>m.label?`${n(m.label)} ${m.kbd?Do(m.kbd):""}`:"",h=i.find(m=>Ja(m.toolItem,l,c)),{itemsInPanel:f,itemsInDropdown:y,dropdownFirstItem:g}=H.useMemo(()=>{const m=[],v=[];let x;const w=Math.min(8,5+r);for(let C=4;C<i.length;C++){const P=i[C];C<w?m.push(P):(P===h&&(x=P),v.push(P))}return x||(o.current||(o.current=v[0]),x=o.current,v.includes(x)||(x=v[0])),o.current=x,v.length<=2&&(m.push(...v),v.length=0),{itemsInPanel:m,itemsInDropdown:v,dropdownFirstItem:x}},[i,h,r]);return p.jsx("div",{className:"tlui-toolbar",children:p.jsxs("div",{className:"tlui-toolbar__inner",children:[p.jsxs("div",{className:"tlui-toolbar__left",children:[!s&&p.jsxs("div",{className:"tlui-toolbar__extras",children:[r<6&&!(l==="hand"||l==="zoom")&&p.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[p.jsx($D,{}),p.jsx(DD,{}),p.jsx(ND,{}),p.jsx(jD,{}),p.jsx(OD,{})]}),p.jsx(ile,{activeToolId:l})]}),p.jsxs("div",{className:fe("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[i.slice(0,2).map(({toolItem:m})=>p.jsx(au,{item:m,title:d(m),isSelected:Ja(m,l,c)},m.id)),s&&a&&p.jsx(au,{item:a.toolItem,title:d(a.toolItem),isSelected:Ja(a.toolItem,l,c)},a.toolItem.id),u&&p.jsxs(p.Fragment,{children:[i.slice(2,4).map(({toolItem:m})=>p.jsx(au,{item:m,title:d(m),isSelected:Ja(m,l,c)},m.id)),f.map(({toolItem:m})=>p.jsx(au,{item:m,title:d(m),isSelected:Ja(m,l,c)},m.id)),y.length?p.jsxs(p.Fragment,{children:[p.jsx(au,{item:g.toolItem,title:d(g.toolItem),isSelected:Ja(g.toolItem,l,c)},g.toolItem.id),p.jsxs(bi,{id:"toolbar overflow",modal:!1,children:[p.jsx(th,{children:p.jsx(ae,{className:"tlui-toolbar__overflow",icon:"chevron-up",type:"tool","data-testid":"tools.more",title:n("tool-panel.more")})}),p.jsx(Ci,{side:"top",align:"center",children:p.jsx(lle,{toolbarItems:y})})]})]}):null]})]})]}),r<5&&!s&&p.jsx("div",{className:"tlui-toolbar__tools",children:p.jsx(ole,{})})]})})}),lle=Ve(function({toolbarItems:t}){const n=Ie();return p.jsx("div",{className:"tlui-buttons__grid",children:t.map(({toolItem:{id:r,meta:o,kbd:s,label:i,onSelect:a,icon:l}})=>p.jsx(or,{type:"icon",className:"tlui-button-grid__button","data-testid":`tools.more.${r}`,"data-tool":r,"data-geo":(o==null?void 0:o.geo)??"","aria-label":i,onClick:()=>a("toolbar"),title:i?`${n(i)} ${s?Do(s):""}`:"",icon:l},r))})});function au({item:e,title:t,isSelected:n}){var r;return p.jsx(ae,{type:"tool","data-testid":`tools.${e.id}`,"data-tool":e.id,"data-geo":((r=e.meta)==null?void 0:r.geo)??"","aria-label":e.label,title:t,icon:e.icon,"data-state":n?"selected":void 0,onClick:()=>e.onSelect("toolbar"),onTouchStart:o=>{Re(o),e.onSelect("toolbar")}})}const Ja=(e,t,n)=>{var r,o;return(r=e.meta)!=null&&r.geo?t==="geo"&&n===((o=e.meta)==null?void 0:o.geo):t===e.id};function cle(){const e=W(),{addToast:t}=zo();b.useEffect(()=>{function n({name:r,count:o}){t({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${o}). Please delete some shapes or move to a different page to continue.`})}return e.addListener("max-shapes",n),()=>{e.removeListener("max-shapes",n)}},[e,t])}const Zv=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Jv(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),n)}function lu(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on".concat(t),n)}function e4(e,t){const n=t.slice(0,t.length-1);for(let r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function t4(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function ule(e,t){const n=e.length>=t.length?e:t,r=e.length>=t.length?t:e;let o=!0;for(let s=0;s<n.length;s++)r.indexOf(n[s])===-1&&(o=!1);return o}const wd={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":Zv?173:189,"=":Zv?61:187,";":Zv?59:186,"'":222,"[":219,"]":221,"\\":220},No={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,command:91},bf={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Ut={16:!1,18:!1,17:!1,91:!1},pt={};for(let e=1;e<20;e++)wd["f".concat(e)]=111+e;let at=[],Nu=null,n4="all";const qo=new Map,oh=e=>wd[e.toLowerCase()]||No[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),dle=e=>Object.keys(wd).find(t=>wd[t]===e),hle=e=>Object.keys(No).find(t=>No[t]===e);function r4(e){n4=e||"all"}function bd(){return n4||"all"}function ple(){return at.slice(0)}function fle(){return at.map(e=>dle(e)||hle(e)||String.fromCharCode(e))}function gle(){const e=[];return Object.keys(pt).forEach(t=>{pt[t].forEach(n=>{let{key:r,scope:o,mods:s,shortcut:i}=n;e.push({scope:o,shortcut:i,mods:s,keys:r.split("+").map(a=>oh(a))})})}),e}function mle(e){const t=e.target||e.srcElement,{tagName:n}=t;let r=!0;const o=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(o||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(r=!1),r}function yle(e){return typeof e=="string"&&(e=oh(e)),at.indexOf(e)!==-1}function vle(e,t){let n,r;e||(e=bd());for(const o in pt)if(Object.prototype.hasOwnProperty.call(pt,o))for(n=pt[o],r=0;r<n.length;)n[r].scope===e?n.splice(r,1).forEach(i=>{let{element:a}=i;return _1(a)}):r++;bd()===e&&r4(t||"all")}function Sle(e){let t=e.keyCode||e.which||e.charCode;const n=at.indexOf(t);if(n>=0&&at.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&at.splice(0,at.length),(t===93||t===224)&&(t=91),t in Ut){Ut[t]=!1;for(const r in No)No[r]===t&&(eo[r]=!1)}}function o4(e){if(typeof e>"u")Object.keys(pt).forEach(o=>{Array.isArray(pt[o])&&pt[o].forEach(s=>yp(s)),delete pt[o]}),_1(null);else if(Array.isArray(e))e.forEach(o=>{o.key&&yp(o)});else if(typeof e=="object")e.key&&yp(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[o,s]=n;typeof o=="function"&&(s=o,o=""),yp({key:e,scope:o,method:s,splitKey:"+"})}}const yp=e=>{let{key:t,scope:n,method:r,splitKey:o="+"}=e;t4(t).forEach(i=>{const a=i.split(o),l=a.length,c=a[l-1],u=c==="*"?"*":oh(c);if(!pt[u])return;n||(n=bd());const d=l>1?e4(No,a):[],h=[];pt[u]=pt[u].filter(f=>{const g=(r?f.method===r:!0)&&f.scope===n&&ule(f.mods,d);return g&&h.push(f.element),!g}),h.forEach(f=>_1(f))})};function B2(e,t,n,r){if(t.element!==r)return;let o;if(t.scope===n||t.scope==="all"){o=t.mods.length>0;for(const s in Ut)Object.prototype.hasOwnProperty.call(Ut,s)&&(!Ut[s]&&t.mods.indexOf(+s)>-1||Ut[s]&&t.mods.indexOf(+s)===-1)&&(o=!1);(t.mods.length===0&&!Ut[16]&&!Ut[18]&&!Ut[17]&&!Ut[91]||o||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(at),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function U2(e,t){const n=pt["*"];let r=e.keyCode||e.which||e.charCode;if(!eo.filter.call(this,e))return;if((r===93||r===224)&&(r=91),at.indexOf(r)===-1&&r!==229&&at.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(a=>{const l=bf[a];e[a]&&at.indexOf(l)===-1?at.push(l):!e[a]&&at.indexOf(l)>-1?at.splice(at.indexOf(l),1):a==="metaKey"&&e[a]&&(at=at.filter(c=>c in bf||c===r))}),r in Ut){Ut[r]=!0;for(const a in No)No[a]===r&&(eo[a]=!0);if(!n)return}for(const a in Ut)Object.prototype.hasOwnProperty.call(Ut,a)&&(Ut[a]=e[bf[a]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(at.indexOf(17)===-1&&at.push(17),at.indexOf(18)===-1&&at.push(18),Ut[17]=!0,Ut[18]=!0);const o=bd();if(n)for(let a=0;a<n.length;a++)n[a].scope===o&&(e.type==="keydown"&&n[a].keydown||e.type==="keyup"&&n[a].keyup)&&B2(e,n[a],o,t);if(!(r in pt))return;const s=pt[r],i=s.length;for(let a=0;a<i;a++)if((e.type==="keydown"&&s[a].keydown||e.type==="keyup"&&s[a].keyup)&&s[a].key){const l=s[a],{splitKey:c}=l,u=l.key.split(c),d=[];for(let h=0;h<u.length;h++)d.push(oh(u[h]));d.sort().join("")===at.sort().join("")&&B2(e,l,o,t)}}function eo(e,t,n){at=[];const r=t4(e);let o=[],s="all",i=document,a=0,l=!1,c=!0,u="+",d=!1,h=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(s=t.scope),t.element&&(i=t.element),t.keyup&&(l=t.keyup),t.keydown!==void 0&&(c=t.keydown),t.capture!==void 0&&(d=t.capture),typeof t.splitKey=="string"&&(u=t.splitKey),t.single===!0&&(h=!0)),typeof t=="string"&&(s=t),h&&o4(e,s);a<r.length;a++)e=r[a].split(u),o=[],e.length>1&&(o=e4(No,e)),e=e[e.length-1],e=e==="*"?"*":oh(e),e in pt||(pt[e]=[]),pt[e].push({keyup:l,keydown:c,scope:s,mods:o,shortcut:r[a],method:n,key:r[a],splitKey:u,element:i});if(typeof i<"u"&&window){if(!qo.has(i)){const f=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return U2(g,i)},y=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;U2(g,i),Sle(g)};qo.set(i,{keydownListener:f,keyupListenr:y,capture:d}),Jv(i,"keydown",f,d),Jv(i,"keyup",y,d)}if(!Nu){const f=()=>{at=[]};Nu={listener:f,capture:d},Jv(window,"focus",f,d)}}}function xle(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(pt).forEach(n=>{pt[n].filter(o=>o.scope===t&&o.shortcut===e).forEach(o=>{o&&o.method&&o.method()})})}function _1(e){const t=Object.values(pt).flat();if(t.findIndex(r=>{let{element:o}=r;return o===e})<0){const{keydownListener:r,keyupListenr:o,capture:s}=qo.get(e)||{};r&&o&&(lu(e,"keyup",o,s),lu(e,"keydown",r,s),qo.delete(e))}if((t.length<=0||qo.size<=0)&&(Object.keys(qo).forEach(o=>{const{keydownListener:s,keyupListenr:i,capture:a}=qo.get(o)||{};s&&i&&(lu(o,"keyup",i,a),lu(o,"keydown",s,a),qo.delete(o))}),qo.clear(),Object.keys(pt).forEach(o=>delete pt[o]),Nu)){const{listener:o,capture:s}=Nu;lu(window,"focus",o,s),Nu=null}}const e0={getPressedKeyString:fle,setScope:r4,getScope:bd,deleteScope:vle,getPressedKeyCodes:ple,getAllKeyCodes:gle,isPressed:yle,filter:mle,trigger:xle,unbind:o4,keyMap:wd,modifier:No,modifierMap:bf};for(const e in e0)Object.prototype.hasOwnProperty.call(e0,e)&&(eo[e]=e0[e]);if(typeof window<"u"){const e=window.hotkeys;eo.noConflict=t=>(t&&window.hotkeys===eo&&(window.hotkeys=e),eo),window.hotkeys=eo}const H2=["copy","cut","paste","asset"];function wle(){const e=W(),t=Dr(),n=yn(),r=l1(),o=q("is focused",()=>e.getInstanceState().isFocused,[e]);b.useEffect(()=>{if(!o)return;const s=e.getContainer();eo.setScope(e.store.id);const i=(l,c)=>{eo(l,{element:s,scope:e.store.id},c)},a=()=>e.getIsMenuOpen()||e.getEditingShapeId()!==null||e.getCrashingError();for(const l of Object.values(n))l.kbd&&(t&&!l.readonlyOk||H2.includes(l.id)||i(V2(l.kbd),c=>{a()||(Re(c),l.onSelect("kbd"))}));for(const l of Object.values(r))!l.kbd||!l.readonlyOk&&e.getInstanceState().isReadonly||H2.includes(l.id)||i(V2(l.kbd),c=>{a()||(Re(c),l.onSelect("kbd"))});return()=>{eo.deleteScope(e.store.id)}},[n,r,t,e,o])}function V2(e){return ble(e).map(t=>{let n="";const r=t.split("");return r.length===1?n=r[0]:r[0]==="!"?n=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?n=`alt+shift+${r[2]}`:n=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?n=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?n=`cmd++${r[2]},ctrl+alt+${r[2]}`:n=`cmd+${r[1]},ctrl+${r[1]}`:n=t,n}).join(",")}function ble(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}const Cle=H.memo(function({shareZone:t,topZone:n,renderDebugMenuItems:r,children:o,hideUi:s,...i}){return p.jsx(Mse,{...i,children:p.jsx(Ple,{hideUi:s,shareZone:t,topZone:n,renderDebugMenuItems:r,children:o})})}),Ple=H.memo(function({children:t,hideUi:n,...r}){return p.jsxs(p.Fragment,{children:[t,n?null:p.jsx(kle,{...r})]})}),kle=H.memo(function({shareZone:t,topZone:n,renderDebugMenuItems:r}){const o=W(),s=Ie(),i=Nr(),a=q("isReadonlyMode",()=>o.getInstanceState().isReadonly,[o]),l=q("focus",()=>o.getInstanceState().isFocusMode,[o]),c=q("debug",()=>o.getInstanceState().isDebugMode,[o]);wle(),Yoe(),cle();const{"toggle-focus-mode":u}=yn();return p.jsx(bw,{children:p.jsxs("div",{className:fe("tlui-layout",{"tlui-layout__mobile":i<5}),"data-breakpoint":i,children:[l?p.jsx("div",{className:"tlui-layout__top",children:p.jsx(ae,{type:"icon",className:"tlui-focus-button",title:`${s("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>u.onSelect("menu")})}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"tlui-layout__top",children:[p.jsxs("div",{className:"tlui-layout__top__left",children:[p.jsx(Sae,{}),p.jsxs("div",{className:"tlui-helper-buttons",children:[p.jsx(Cae,{}),p.jsx(Rse,{}),p.jsx(Pae,{})]})]}),p.jsx("div",{className:"tlui-layout__top__center",children:n}),p.jsxs("div",{className:"tlui-layout__top__right",children:[t,i>=5&&!a&&p.jsx("div",{className:"tlui-style-panel__wrapper",children:p.jsx(JD,{})})]})]}),p.jsxs("div",{className:"tlui-layout__bottom",children:[p.jsxs("div",{className:"tlui-layout__bottom__main",children:[p.jsx(bae,{}),p.jsx(ale,{}),i>=4&&p.jsx(nae,{})]}),c&&p.jsx(Kie,{renderDebugMenuItems:r??null})]})]}),p.jsx(nle,{}),p.jsx(Jie,{}),p.jsx(rle,{}),p.jsx(eae,{})]})})});var T1="ContextMenu",[Ele,Yce]=vs(T1,[Gm]),Sn=Gm(),[Ile,s4]=Ele(T1),i4=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:o,modal:s=!0}=e,[i,a]=b.useState(!1),l=Sn(t),c=qt(r),u=b.useCallback(d=>{a(d),c(d)},[c]);return p.jsx(Ile,{scope:t,open:i,onOpenChange:u,modal:s,children:p.jsx(z3,{...l,dir:o,open:i,onOpenChange:u,modal:s,children:n})})};i4.displayName=T1;var a4="ContextMenuTrigger",l4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...o}=e,s=s4(a4,n),i=Sn(n),a=b.useRef({x:0,y:0}),l=b.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=b.useRef(0),u=b.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{a.current={x:h.clientX,y:h.clientY},s.onOpenChange(!0)};return b.useEffect(()=>u,[u]),b.useEffect(()=>void(r&&u()),[r,u]),p.jsxs(p.Fragment,{children:[p.jsx(B3,{...i,virtualRef:l}),p.jsx(Ce.span,{"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,...o,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:ee(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:ee(e.onPointerDown,vp(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:ee(e.onPointerMove,vp(u)),onPointerCancel:r?e.onPointerCancel:ee(e.onPointerCancel,vp(u)),onPointerUp:r?e.onPointerUp:ee(e.onPointerUp,vp(u))})]})});l4.displayName=a4;var _le="ContextMenuPortal",c4=e=>{const{__scopeContextMenu:t,...n}=e,r=Sn(t);return p.jsx(U3,{...r,...n})};c4.displayName=_le;var u4="ContextMenuContent",d4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=s4(u4,n),s=Sn(n),i=b.useRef(!1);return p.jsx(H3,{...s,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,a),!a.defaultPrevented&&i.current&&a.preventDefault(),i.current=!1},onInteractOutside:a=>{var l;(l=e.onInteractOutside)==null||l.call(e,a),!a.defaultPrevented&&!o.modal&&(i.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});d4.displayName=u4;var Tle="ContextMenuGroup",h4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(V3,{...o,...r,ref:t})});h4.displayName=Tle;var Mle="ContextMenuLabel",Ale=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(K3,{...o,...r,ref:t})});Ale.displayName=Mle;var Rle="ContextMenuItem",p4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(W3,{...o,...r,ref:t})});p4.displayName=Rle;var Ole="ContextMenuCheckboxItem",f4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(G3,{...o,...r,ref:t})});f4.displayName=Ole;var jle="ContextMenuRadioGroup",Dle=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(Y3,{...o,...r,ref:t})});Dle.displayName=jle;var Nle="ContextMenuRadioItem",$le=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(X3,{...o,...r,ref:t})});$le.displayName=Nle;var Lle="ContextMenuItemIndicator",Fle=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(q3,{...o,...r,ref:t})});Fle.displayName=Lle;var zle="ContextMenuSeparator",Ble=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(Q3,{...o,...r,ref:t})});Ble.displayName=zle;var Ule="ContextMenuArrow",Hle=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(Z3,{...o,...r,ref:t})});Hle.displayName=Ule;var Vle="ContextMenuSub",g4=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,open:o,defaultOpen:s}=e,i=Sn(t),[a,l]=Ss({prop:o,defaultProp:s,onChange:r});return p.jsx(J3,{...i,open:a,onOpenChange:l,children:n})};g4.displayName=Vle;var Kle="ContextMenuSubTrigger",m4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(eD,{...o,...r,ref:t})});m4.displayName=Kle;var Wle="ContextMenuSubContent",y4=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,o=Sn(n);return p.jsx(tD,{...o,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});y4.displayName=Wle;function vp(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var Gle=i4,Yle=l4,bx=c4,Xle=d4,Cx=h4,Px=p4,qle=f4,v4=g4,S4=m4,x4=y4;const Qle=Ve(function(){const t=W(),n=mn(),r=t.getPages(),o=t.getCurrentPageId(),s=Ie(),{addToast:i}=zo();return p.jsxs(v4,{children:[p.jsx(S4,{dir:"ltr",asChild:!0,children:p.jsx(ae,{type:"menu",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),p.jsx(bx,{container:n,children:p.jsxs(x4,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[p.jsx(Cx,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:r.map(a=>p.jsx(Px,{disabled:o===a.id,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.getSelectedShapeIds(),a.id);const l=t.getPage(a.id);l&&i({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPage(o)}}]})},asChild:!0,children:p.jsx(ae,{type:"menu",title:a.name,className:"tlui-context-menu__move-to-page__name",children:p.jsx("span",{className:"tlui-button__label",children:a.name})})},a.id))},"pages"),p.jsx(Cx,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:p.jsx(Px,{onSelect:()=>{const a=ms.createId(),l=t.getSelectedShapeIds();t.batch(()=>{t.mark("move_shapes_to_page"),t.createPage({name:s("page-menu.new-page-initial-name"),id:a}),t.moveShapesToPage(l,a)})},asChild:!0,children:p.jsx(ae,{type:"menu",title:s("context.pages.new-page"),className:"tlui-context-menu__move-to-page__name",children:p.jsx("span",{className:"tlui-button__label",children:s("context.pages.new-page")})})},"new-page")},"new-page")]})})]})}),Zle=function({children:t}){const n=W(),r=Jj(),o=b.useCallback(d=>{if(d){if(n.getInstanceState().isCoarsePointer){const h=n.getSelectedShapes(),{inputs:{currentPagePoint:f}}=n,y=n.getShapesAtPoint(f);if(!n.getSelectedShapes().length||!y.some(g=>h.includes(g))){const g=y.filter(m=>n.isShapeOrAncestorLocked(m));g.length&&n.select(...g.map(m=>m.id))}}}else{const h=n.getOnlySelectedShape();h&&n.isShapeOrAncestorLocked(h)&&n.setSelectedShapes([])}},[n]),[s,i]=Aa("context menu",o),a=Dr(),l=r.length===0||a&&r.every(d=>!d.readonlyOk),u=!q("isSelectToolActive",()=>n.getCurrentToolId()==="select",[n])||l;return p.jsxs(Gle,{dir:"ltr",onOpenChange:i,modal:!1,children:[p.jsx(Yle,{onContextMenu:u?Re:void 0,dir:"ltr",disabled:u,children:t}),s&&p.jsx(Jle,{})]})},Jle=b.forwardRef(function(){const t=W(),n=Ie(),r=Jj(),[o,s]=Aa("context menu sub"),i=Dr(),a=Nr(),l=mn(),[c,u]=b.useState(!1);function d(h,f,y,g){if(!f||i&&!f.readonlyOk)return null;switch(f.type){case"custom":{switch(f.id){case"MOVE_TO_PAGE_MENU":return p.jsx(Qle,{},f.id)}break}case"group":return p.jsx(Cx,{dir:"ltr",className:fe("tlui-menu__group",{"tlui-menu__group__small":(y==null?void 0:y.type)==="submenu"}),"data-testid":`menu-item.${f.id}`,children:f.children.map(m=>d(h,m,f,g+1))},f.id);case"submenu":return p.jsxs(v4,{onOpenChange:s,children:[p.jsx(S4,{dir:"ltr",disabled:f.disabled,asChild:!0,children:p.jsx(ae,{type:"menu",label:f.label,"data-testid":`menu-item.${f.id}`,icon:"chevron-right"})}),p.jsx(bx,{container:l,children:p.jsx(x4,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:f.children.map(m=>d(h,m,f,g+1))})})]},f.id);case"item":{if(i&&!f.readonlyOk)return null;const{id:m,checkbox:v,contextMenuLabel:x,label:w,onSelect:C,kbd:P,icon:k}=f.actionItem,I=x??w,_=I?n(I):void 0;return v?p.jsxs(qle,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",disabled:f.disabled,onSelect:M=>{C("context-menu"),Re(M)},title:_||void 0,checked:f.checked,children:[p.jsx(ur,{small:!0,icon:f.checked?"check":"checkbox-empty"}),_&&p.jsx("span",{className:"tlui-button__label",draggable:!1,children:_}),P&&p.jsx(Nm,{children:P})]},m):p.jsx(Px,{dir:"ltr",asChild:!0,children:p.jsx(ae,{type:"menu","data-testid":`menu-item.${m}`,kbd:P,label:I,disabled:f.disabled,iconLeft:a<3&&g>2?k:void 0,onClick:()=>{c?u(!1):C("context-menu")}})},m)}}}return p.jsx(bx,{container:l,children:p.jsx(Xle,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:Re,children:r.map(h=>d(t,h,null,0))})})}),Sp=(e,t)=>{const[n,r]=b.useState(2);return b.useEffect(()=>{const{url:o,style:s="normal",weight:i="500",display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d}=t;let h=!1;r(2);const f={style:s,weight:i,display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d},y=new FontFace(e,`url(${o})`,f);return y.load().then(()=>{h||(document.fonts.add(y),r(0))}).catch(g=>{h||(console.error(g),r(1))}),y.$$_url=o,y.$$_fontface=`
@font-face {
	font-family: ${y.family};
	font-stretch: ${y.stretch};
	font-weight: ${y.weight};
	font-style: ${y.style};
	src: url("${o}") format("woff2")
}`,()=>{document.fonts.delete(y),h=!0}},[e,t]),n};function ece(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}function tce(e){const t=b.useMemo(()=>ece(e),[e]),n=[Sp("tldraw_draw",t.draw),Sp("tldraw_serif",t.serif),Sp("tldraw_sans",t.sansSerif),Sp("tldraw_mono",t.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}function nce(e){const{children:t,maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:o,acceptedVideoMimeTypes:s,onMount:i,...a}=e,l=EG(a.components??{}),c=Xk(a.shapeUtils??[]),u=Xk(a.tools??[]),d={initialState:"select",...a,components:b.useMemo(()=>({Scribble:WE,CollaboratorScribble:WE,SelectionForeground:Dee,SelectionBackground:Oee,Handles:Iee,HoveredShapeIndicator:_ee,...l}),[l]),shapeUtils:b.useMemo(()=>[...Yne,...c],[c]),tools:b.useMemo(()=>[...lre,...Ite,...u],[u])},h=cre(a.assetUrls),{done:f,error:y}=tce(h);return y?p.jsx(bG,{children:"Could not load assets. Please refresh the page."}):f?p.jsx(vG,{...d,children:p.jsxs(Cle,{...d,children:[p.jsx(Zle,{children:p.jsx(db,{})}),p.jsx(rce,{maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:o,acceptedVideoMimeTypes:s,onMount:i}),t]})}):p.jsx(iR,{children:"Loading assets..."})}function rce({maxImageDimension:e=1e3,maxAssetSize:t=10*1024*1024,acceptedImageMimeTypes:n=["image/jpeg","image/png","image/gif","image/svg+xml"],acceptedVideoMimeTypes:r=["video/mp4","video/quicktime"],onMount:o}){const s=W(),i=oce(a=>{const l=[];return l.push(...Xne(a)),fte(a,{maxImageDimension:e,maxAssetSize:t,acceptedImageMimeTypes:n,acceptedVideoMimeTypes:r}),l.push(o==null?void 0:o(a)),()=>{l.forEach(c=>c==null?void 0:c())}});return b.useLayoutEffect(()=>{if(s)return i==null?void 0:i(s)},[s,i]),null}function oce(e){const t=b.useRef();return b.useLayoutEffect(()=>{t.current=e}),b.useDebugValue(e),b.useCallback((...n)=>{const r=t.current;return la(r,"fn does not exist"),r(...n)},[])}_e({tldrawFileFormatVersion:H9,schema:_e({schemaVersion:zh,storeVersion:zh,recordVersions:NS(ve,_e({version:zh,subTypeVersions:NS(ve,zh).optional(),subTypeKey:ve.optional()}))}),records:In(_e({id:ve,typeName:ve}).allowUnknownProperties())});const sce=()=>{const e=W(),t=b.useCallback(()=>{const n=e==null?void 0:e.store.getSnapshot();console.log("Saving whiteboard:",n)},[e]);return p.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex gap-2",children:p.jsx("button",{onClick:t,className:"px-3 py-1.5 text-xs font-medium bg-white/80 hover:bg-white shadow-sm rounded-md transition-colors",children:"Save"})})},ice=({className:e})=>p.jsx("div",{className:Ct("relative w-full h-full rounded-lg overflow-hidden border shadow-sm animate-fade-in",e),children:p.jsx(nce,{className:"tldraw",persistenceKey:"travel-whiteboard",children:p.jsx(sce,{})})}),Hi=b.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Ct("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Hi.displayName="Card";const Vi=b.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Ct("flex flex-col space-y-1.5 p-6",e),...t}));Vi.displayName="CardHeader";const Ki=b.forwardRef(({className:e,...t},n)=>p.jsx("h3",{ref:n,className:Ct("text-2xl font-semibold leading-none tracking-tight",e),...t}));Ki.displayName="CardTitle";const Wi=b.forwardRef(({className:e,...t},n)=>p.jsx("p",{ref:n,className:Ct("text-sm text-muted-foreground",e),...t}));Wi.displayName="CardDescription";const Gi=b.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Ct("p-6 pt-0",e),...t}));Gi.displayName="CardContent";const ace=b.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Ct("flex items-center p-6 pt-0",e),...t}));ace.displayName="CardFooter";const w4=b.forwardRef(({className:e,type:t,...n},r)=>p.jsx("input",{type:t,className:Ct("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));w4.displayName="Input";var M1="Tabs",[lce,Xce]=vs(M1,[Wm]),b4=Wm(),[cce,A1]=lce(M1),C4=b.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:s,orientation:i="horizontal",dir:a,activationMode:l="automatic",...c}=e,u=Vm(a),[d,h]=Ss({prop:r,onChange:o,defaultProp:s});return p.jsx(cce,{scope:n,baseId:_o(),value:d,onValueChange:h,orientation:i,dir:u,activationMode:l,children:p.jsx(Ce.div,{dir:u,"data-orientation":i,...c,ref:t})})});C4.displayName=M1;var P4="TabsList",k4=b.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...o}=e,s=A1(P4,n),i=b4(n);return p.jsx(f3,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:r,children:p.jsx(Ce.div,{role:"tablist","aria-orientation":s.orientation,...o,ref:t})})});k4.displayName=P4;var E4="TabsTrigger",I4=b.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...s}=e,i=A1(E4,n),a=b4(n),l=M4(i.baseId,r),c=A4(i.baseId,r),u=r===i.value;return p.jsx(g3,{asChild:!0,...a,focusable:!o,active:u,children:p.jsx(Ce.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:l,...s,ref:t,onMouseDown:ee(e.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ee(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ee(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!o&&d&&i.onValueChange(r)})})})});I4.displayName=E4;var _4="TabsContent",T4=b.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:o,children:s,...i}=e,a=A1(_4,n),l=M4(a.baseId,r),c=A4(a.baseId,r),u=r===a.value,d=b.useRef(u);return b.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),p.jsx(gr,{present:o||u,children:({present:h})=>p.jsx(Ce.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});T4.displayName=_4;function M4(e,t){return`${e}-trigger-${t}`}function A4(e,t){return`${e}-content-${t}`}var uce=C4,R4=k4,O4=I4,j4=T4;const dce=uce,D4=b.forwardRef(({className:e,...t},n)=>p.jsx(R4,{ref:n,className:Ct("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));D4.displayName=R4.displayName;const Cf=b.forwardRef(({className:e,...t},n)=>p.jsx(O4,{ref:n,className:Ct("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Cf.displayName=O4.displayName;const Pf=b.forwardRef(({className:e,...t},n)=>p.jsx(j4,{ref:n,className:Ct("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Pf.displayName=j4.displayName;const hce=({className:e})=>{const[t,n]=b.useState("Paris Adventure");return p.jsxs("div",{className:Ct("w-full space-y-6 animate-slide-in",e),children:[p.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 items-start md:items-center",children:[p.jsxs("div",{children:[p.jsx("div",{className:"inline-block px-2 py-1 bg-primary/10 text-primary text-xs font-medium rounded-full mb-2",children:"Planning Mode"}),p.jsx("h2",{className:"text-2xl font-bold",children:p.jsx(w4,{value:t,onChange:r=>n(r.target.value),className:"text-2xl font-bold border-0 p-0 h-auto bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0"})}),p.jsx("p",{className:"text-muted-foreground mt-1",children:"Use the whiteboard to visualize your travel plans"})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(i6,{className:"h-4 w-4"}),p.jsx("span",{children:"Share"})]}),p.jsxs(xo,{size:"sm",className:"gap-2",children:[p.jsx(jT,{className:"h-4 w-4"}),p.jsx("span",{children:"Save Trip"})]})]})]}),p.jsxs(dce,{defaultValue:"planning",className:"w-full",children:[p.jsxs(D4,{className:"grid grid-cols-3 md:w-[400px]",children:[p.jsx(Cf,{value:"planning",children:"Planning"}),p.jsx(Cf,{value:"itinerary",children:"Itinerary"}),p.jsx(Cf,{value:"checklist",children:"Checklist"})]}),p.jsxs(Pf,{value:"planning",className:"space-y-4 mt-4",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs(Hi,{className:"overflow-hidden",children:[p.jsxs(Vi,{className:"p-4",children:[p.jsxs(Ki,{className:"flex items-center gap-2",children:[p.jsx(o6,{className:"h-4 w-4 text-primary"}),"Ideas & Inspiration"]}),p.jsx(Wi,{children:"Capture your travel ideas"})]}),p.jsx(Gi,{className:"p-4 pt-0",children:p.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the whiteboard to brainstorm ideas for your trip."})})]}),p.jsxs(Hi,{className:"overflow-hidden",children:[p.jsxs(Vi,{className:"p-4",children:[p.jsxs(Ki,{className:"flex items-center gap-2",children:[p.jsx(vS,{className:"h-4 w-4 text-primary"}),"Destinations"]}),p.jsx(Wi,{children:"Map out your journey"})]}),p.jsx(Gi,{className:"p-4 pt-0",children:p.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag & drop locations on the whiteboard to plan your route."})})]}),p.jsxs(Hi,{className:"overflow-hidden",children:[p.jsxs(Vi,{className:"p-4",children:[p.jsxs(Ki,{className:"flex items-center gap-2",children:[p.jsx(sP,{className:"h-4 w-4 text-primary"}),"Timeline"]}),p.jsx(Wi,{children:"Visualize your schedule"})]}),p.jsx(Gi,{className:"p-4 pt-0",children:p.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a visual timeline of your activities and travels."})})]})]}),p.jsxs(Hi,{className:"overflow-hidden",children:[p.jsxs(Vi,{className:"p-4",children:[p.jsxs(Ki,{className:"flex items-center gap-2",children:[p.jsx(iP,{className:"h-4 w-4 text-primary"}),"Travel Tools"]}),p.jsx(Wi,{children:"Drag these elements onto your whiteboard"})]}),p.jsxs(Gi,{className:"p-4 pt-0 flex gap-2 flex-wrap",children:[p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(vS,{className:"h-4 w-4"}),p.jsx("span",{children:"Location"})]}),p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(n6,{className:"h-4 w-4"}),p.jsx("span",{children:"Activity"})]}),p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(sP,{className:"h-4 w-4"}),p.jsx("span",{children:"Date"})]}),p.jsxs(xo,{variant:"outline",size:"sm",className:"gap-2",children:[p.jsx(iP,{className:"h-4 w-4"}),p.jsx("span",{children:"Direction"})]})]})]})]}),p.jsx(Pf,{value:"itinerary",className:"mt-4",children:p.jsxs(Hi,{children:[p.jsxs(Vi,{children:[p.jsx(Ki,{children:"Trip Itinerary"}),p.jsx(Wi,{children:"Organize your daily activities"})]}),p.jsx(Gi,{children:p.jsx("p",{className:"text-muted-foreground",children:"Your itinerary will appear here once you've finalized your plans on the whiteboard."})})]})}),p.jsx(Pf,{value:"checklist",className:"mt-4",children:p.jsxs(Hi,{children:[p.jsxs(Vi,{children:[p.jsx(Ki,{children:"Travel Checklist"}),p.jsx(Wi,{children:"Keep track of essentials"})]}),p.jsx(Gi,{children:p.jsx("p",{className:"text-muted-foreground",children:"Your travel checklist will appear here as you add items."})})]})})]})]})},pce=()=>p.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-background to-muted/30",children:[p.jsx(t9,{}),p.jsx("main",{className:"flex-grow pt-20 pb-8 px-4 md:px-6 max-w-7xl mx-auto w-full",children:p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[p.jsx("section",{className:"order-2 lg:order-1",children:p.jsx(hce,{})}),p.jsx("section",{className:"order-1 lg:order-2 h-[500px] lg:h-[700px]",children:p.jsx(ice,{})})]})}),p.jsx("footer",{className:"py-6 border-t",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 md:px-6 text-center text-sm text-muted-foreground",children:p.jsx("p",{children:"WanderBoard  Plan your travels visually"})})})]}),fce=()=>{const e=OM();return b.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:p.jsxs("div",{className:"text-center",children:[p.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),p.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),p.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},gce=new pz,mce=()=>p.jsx(gz,{client:gce,children:p.jsxs(VF,{children:[p.jsx(H6,{}),p.jsx(v8,{}),p.jsx(Jz,{children:p.jsxs(qz,{children:[p.jsx(TS,{path:"/",element:p.jsx(pce,{})}),p.jsx(TS,{path:"*",element:p.jsx(fce,{})})]})})]})});pT(document.getElementById("root")).render(p.jsx(mce,{}));
